var Uz=Object.create;var{defineProperty:lZ,getPrototypeOf:zz,getOwnPropertyNames:Hz}=Object;var Gz=Object.prototype.hasOwnProperty;var l6=($,Z,J)=>{J=$!=null?Uz(zz($)):{};const Q=Z||!$||!$.__esModule?lZ(J,"default",{value:$,enumerable:!0}):J;for(let K of Hz($))if(!Gz.call(Q,K))lZ(Q,K,{get:()=>$[K],enumerable:!0});return Q};var E=($,Z)=>()=>(Z||$((Z={exports:{}}).exports,Z),Z.exports);var Yz=($,Z)=>{for(var J in Z)lZ($,J,{get:Z[J],enumerable:!0,configurable:!0,set:(Q)=>Z[J]=()=>Q})};var S7=E((zC,IQ)=>{var wz=Number.MAX_SAFE_INTEGER||9007199254740991,jz=["major","premajor","minor","preminor","patch","prepatch","prerelease"];IQ.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:wz,RELEASE_TYPES:jz,SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var h7=E((HC,RQ)=>{var Bz=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...$)=>console.error("SEMVER",...$):()=>{};RQ.exports=Bz});var n6=E((A8,PQ)=>{var{MAX_SAFE_COMPONENT_LENGTH:nZ,MAX_SAFE_BUILD_LENGTH:Fz,MAX_LENGTH:Nz}=S7(),Cz=h7();A8=PQ.exports={};var Lz=A8.re=[],_z=A8.safeRe=[],s=A8.src=[],i=A8.t={},Oz=0,oZ="[a-zA-Z0-9-]",Iz=[["\\s",1],["\\d",Nz],[oZ,Fz]],Rz=($)=>{for(let[Z,J]of Iz)$=$.split(`${Z}*`).join(`${Z}{0,${J}}`).split(`${Z}+`).join(`${Z}{1,${J}}`);return $},J0=($,Z,J)=>{const Q=Rz(Z),K=Oz++;Cz($,K,Z),i[$]=K,s[K]=Z,Lz[K]=new RegExp(Z,J?"g":void 0),_z[K]=new RegExp(Q,J?"g":void 0)};J0("NUMERICIDENTIFIER","0|[1-9]\\d*");J0("NUMERICIDENTIFIERLOOSE","\\d+");J0("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${oZ}*`);J0("MAINVERSION",`(${s[i.NUMERICIDENTIFIER]})\\.`+`(${s[i.NUMERICIDENTIFIER]})\\.`+`(${s[i.NUMERICIDENTIFIER]})`);J0("MAINVERSIONLOOSE",`(${s[i.NUMERICIDENTIFIERLOOSE]})\\.`+`(${s[i.NUMERICIDENTIFIERLOOSE]})\\.`+`(${s[i.NUMERICIDENTIFIERLOOSE]})`);J0("PRERELEASEIDENTIFIER",`(?:${s[i.NUMERICIDENTIFIER]}|${s[i.NONNUMERICIDENTIFIER]})`);J0("PRERELEASEIDENTIFIERLOOSE",`(?:${s[i.NUMERICIDENTIFIERLOOSE]}|${s[i.NONNUMERICIDENTIFIER]})`);J0("PRERELEASE",`(?:-(${s[i.PRERELEASEIDENTIFIER]}(?:\\.${s[i.PRERELEASEIDENTIFIER]})*))`);J0("PRERELEASELOOSE",`(?:-?(${s[i.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[i.PRERELEASEIDENTIFIERLOOSE]})*))`);J0("BUILDIDENTIFIER",`${oZ}+`);J0("BUILD",`(?:\\+(${s[i.BUILDIDENTIFIER]}(?:\\.${s[i.BUILDIDENTIFIER]})*))`);J0("FULLPLAIN",`v?${s[i.MAINVERSION]}${s[i.PRERELEASE]}?${s[i.BUILD]}?`);J0("FULL",`^${s[i.FULLPLAIN]}\$`);J0("LOOSEPLAIN",`[v=\\s]*${s[i.MAINVERSIONLOOSE]}${s[i.PRERELEASELOOSE]}?${s[i.BUILD]}?`);J0("LOOSE",`^${s[i.LOOSEPLAIN]}\$`);J0("GTLT","((?:<|>)?=?)");J0("XRANGEIDENTIFIERLOOSE",`${s[i.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);J0("XRANGEIDENTIFIER",`${s[i.NUMERICIDENTIFIER]}|x|X|\\*`);J0("XRANGEPLAIN",`[v=\\s]*(${s[i.XRANGEIDENTIFIER]})`+`(?:\\.(${s[i.XRANGEIDENTIFIER]})`+`(?:\\.(${s[i.XRANGEIDENTIFIER]})`+`(?:${s[i.PRERELEASE]})?${s[i.BUILD]}?`+")?)?");J0("XRANGEPLAINLOOSE",`[v=\\s]*(${s[i.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${s[i.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${s[i.XRANGEIDENTIFIERLOOSE]})`+`(?:${s[i.PRERELEASELOOSE]})?${s[i.BUILD]}?`+")?)?");J0("XRANGE",`^${s[i.GTLT]}\\s*${s[i.XRANGEPLAIN]}\$`);J0("XRANGELOOSE",`^${s[i.GTLT]}\\s*${s[i.XRANGEPLAINLOOSE]}\$`);J0("COERCE",`(^|[^\\d])(\\d{1,${nZ}})`+`(?:\\.(\\d{1,${nZ}}))?`+`(?:\\.(\\d{1,${nZ}}))?`+"(?:$|[^\\d])");J0("COERCERTL",s[i.COERCE],!0);J0("LONETILDE","(?:~>?)");J0("TILDETRIM",`(\\s*)${s[i.LONETILDE]}\\s+`,!0);A8.tildeTrimReplace="$1~";J0("TILDE",`^${s[i.LONETILDE]}${s[i.XRANGEPLAIN]}\$`);J0("TILDELOOSE",`^${s[i.LONETILDE]}${s[i.XRANGEPLAINLOOSE]}\$`);J0("LONECARET","(?:\\^)");J0("CARETTRIM",`(\\s*)${s[i.LONECARET]}\\s+`,!0);A8.caretTrimReplace="$1^";J0("CARET",`^${s[i.LONECARET]}${s[i.XRANGEPLAIN]}\$`);J0("CARETLOOSE",`^${s[i.LONECARET]}${s[i.XRANGEPLAINLOOSE]}\$`);J0("COMPARATORLOOSE",`^${s[i.GTLT]}\\s*(${s[i.LOOSEPLAIN]})\$|^\$`);J0("COMPARATOR",`^${s[i.GTLT]}\\s*(${s[i.FULLPLAIN]})\$|^\$`);J0("COMPARATORTRIM",`(\\s*)${s[i.GTLT]}\\s*(${s[i.LOOSEPLAIN]}|${s[i.XRANGEPLAIN]})`,!0);A8.comparatorTrimReplace="$1$2$3";J0("HYPHENRANGE",`^\\s*(${s[i.XRANGEPLAIN]})`+"\\s+-\\s+"+`(${s[i.XRANGEPLAIN]})`+"\\s*$");J0("HYPHENRANGELOOSE",`^\\s*(${s[i.XRANGEPLAINLOOSE]})`+"\\s+-\\s+"+`(${s[i.XRANGEPLAINLOOSE]})`+"\\s*$");J0("STAR","(<|>)?=?\\s*\\*");J0("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");J0("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var e5=E((GC,DQ)=>{var Pz=Object.freeze({loose:!0}),Dz=Object.freeze({}),Az=($)=>{if(!$)return Dz;if(typeof $!=="object")return Pz;return $};DQ.exports=Az});var sZ=E((YC,kQ)=>{var AQ=/^[0-9]+$/,MQ=($,Z)=>{const J=AQ.test($),Q=AQ.test(Z);if(J&&Q)$=+$,Z=+Z;return $===Z?0:J&&!Q?-1:Q&&!J?1:$<Z?-1:1},Mz=($,Z)=>MQ(Z,$);kQ.exports={compareIdentifiers:MQ,rcompareIdentifiers:Mz}});var $$=E((wC,vQ)=>{var $9=h7(),{MAX_LENGTH:EQ,MAX_SAFE_INTEGER:Z9}=S7(),{safeRe:TQ,t:bQ}=n6(),kz=e5(),{compareIdentifiers:o6}=sZ();class s${constructor($,Z){if(Z=kz(Z),$ instanceof s$)if($.loose===!!Z.loose&&$.includePrerelease===!!Z.includePrerelease)return $;else $=$.version;else if(typeof $!=="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof $}".`);if($.length>EQ)throw new TypeError(`version is longer than ${EQ} characters`);$9("SemVer",$,Z),this.options=Z,this.loose=!!Z.loose,this.includePrerelease=!!Z.includePrerelease;const J=$.trim().match(Z.loose?TQ[bQ.LOOSE]:TQ[bQ.FULL]);if(!J)throw new TypeError(`Invalid Version: ${$}`);if(this.raw=$,this.major=+J[1],this.minor=+J[2],this.patch=+J[3],this.major>Z9||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Z9||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Z9||this.patch<0)throw new TypeError("Invalid patch version");if(!J[4])this.prerelease=[];else this.prerelease=J[4].split(".").map((Q)=>{if(/^[0-9]+$/.test(Q)){const K=+Q;if(K>=0&&K<Z9)return K}return Q});this.build=J[5]?J[5].split("."):[],this.format()}format(){if(this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length)this.version+=`-${this.prerelease.join(".")}`;return this.version}toString(){return this.version}compare($){if($9("SemVer.compare",this.version,this.options,$),!($ instanceof s$)){if(typeof $==="string"&&$===this.version)return 0;$=new s$($,this.options)}if($.version===this.version)return 0;return this.compareMain($)||this.comparePre($)}compareMain($){if(!($ instanceof s$))$=new s$($,this.options);return o6(this.major,$.major)||o6(this.minor,$.minor)||o6(this.patch,$.patch)}comparePre($){if(!($ instanceof s$))$=new s$($,this.options);if(this.prerelease.length&&!$.prerelease.length)return-1;else if(!this.prerelease.length&&$.prerelease.length)return 1;else if(!this.prerelease.length&&!$.prerelease.length)return 0;let Z=0;do{const J=this.prerelease[Z],Q=$.prerelease[Z];if($9("prerelease compare",Z,J,Q),J===void 0&&Q===void 0)return 0;else if(Q===void 0)return 1;else if(J===void 0)return-1;else if(J===Q)continue;else return o6(J,Q)}while(++Z)}compareBuild($){if(!($ instanceof s$))$=new s$($,this.options);let Z=0;do{const J=this.build[Z],Q=$.build[Z];if($9("prerelease compare",Z,J,Q),J===void 0&&Q===void 0)return 0;else if(Q===void 0)return 1;else if(J===void 0)return-1;else if(J===Q)continue;else return o6(J,Q)}while(++Z)}inc($,Z,J){switch($){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",Z,J);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",Z,J);break;case"prepatch":this.prerelease.length=0,this.inc("patch",Z,J),this.inc("pre",Z,J);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",Z,J);this.inc("pre",Z,J);break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0,this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":{const Q=Number(J)?1:0;if(!Z&&J===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[Q];else{let K=this.prerelease.length;while(--K>=0)if(typeof this.prerelease[K]==="number")this.prerelease[K]++,K=-2;if(K===-1){if(Z===this.prerelease.join(".")&&J===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(Q)}}if(Z){let K=[Z,Q];if(J===!1)K=[Z];if(o6(this.prerelease[0],Z)===0){if(isNaN(this.prerelease[1]))this.prerelease=K}else this.prerelease=K}break}default:throw new Error(`invalid increment argument: ${$}`)}if(this.raw=this.format(),this.build.length)this.raw+=`+${this.build.join(".")}`;return this}}vQ.exports=s$});var w6=E((jC,hQ)=>{var SQ=$$(),Ez=($,Z,J=!1)=>{if($ instanceof SQ)return $;try{return new SQ($,Z)}catch(Q){if(!J)return null;throw Q}};hQ.exports=Ez});var yQ=E((BC,fQ)=>{var Tz=w6(),bz=($,Z)=>{const J=Tz($,Z);return J?J.version:null};fQ.exports=bz});var xQ=E((FC,gQ)=>{var vz=w6(),Sz=($,Z)=>{const J=vz($.trim().replace(/^[=v]+/,""),Z);return J?J.version:null};gQ.exports=Sz});var pQ=E((NC,cQ)=>{var mQ=$$(),hz=($,Z,J,Q,K)=>{if(typeof J==="string")K=Q,Q=J,J=void 0;try{return new mQ($ instanceof mQ?$.version:$,J).inc(Z,Q,K).version}catch(q){return null}};cQ.exports=hz});var lQ=E((CC,dQ)=>{var uQ=w6(),fz=($,Z)=>{const J=uQ($,null,!0),Q=uQ(Z,null,!0),K=J.compare(Q);if(K===0)return null;const q=K>0,V=q?J:Q,X=q?Q:J,W=!!V.prerelease.length;if(!!X.prerelease.length&&!W){if(!X.patch&&!X.minor)return"major";if(V.patch)return"patch";if(V.minor)return"minor";return"major"}const z=W?"pre":"";if(J.major!==Q.major)return z+"major";if(J.minor!==Q.minor)return z+"minor";if(J.patch!==Q.patch)return z+"patch";return"prerelease"};dQ.exports=fz});var oQ=E((LC,nQ)=>{var yz=$$(),gz=($,Z)=>new yz($,Z).major;nQ.exports=gz});var iQ=E((_C,sQ)=>{var xz=$$(),mz=($,Z)=>new xz($,Z).minor;sQ.exports=mz});var rQ=E((OC,aQ)=>{var cz=$$(),pz=($,Z)=>new cz($,Z).patch;aQ.exports=pz});var eQ=E((IC,tQ)=>{var uz=w6(),dz=($,Z)=>{const J=uz($,Z);return J&&J.prerelease.length?J.prerelease:null};tQ.exports=dz});var f$=E((RC,ZK)=>{var $K=$$(),lz=($,Z,J)=>new $K($,J).compare(new $K(Z,J));ZK.exports=lz});var QK=E((PC,JK)=>{var nz=f$(),oz=($,Z,J)=>nz(Z,$,J);JK.exports=oz});var qK=E((DC,KK)=>{var sz=f$(),iz=($,Z)=>sz($,Z,!0);KK.exports=iz});var J9=E((AC,XK)=>{var VK=$$(),az=($,Z,J)=>{const Q=new VK($,J),K=new VK(Z,J);return Q.compare(K)||Q.compareBuild(K)};XK.exports=az});var UK=E((MC,WK)=>{var rz=J9(),tz=($,Z)=>$.sort((J,Q)=>rz(J,Q,Z));WK.exports=tz});var HK=E((kC,zK)=>{var ez=J9(),$H=($,Z)=>$.sort((J,Q)=>ez(Q,J,Z));zK.exports=$H});var f7=E((EC,GK)=>{var ZH=f$(),JH=($,Z,J)=>ZH($,Z,J)>0;GK.exports=JH});var Q9=E((TC,YK)=>{var QH=f$(),KH=($,Z,J)=>QH($,Z,J)<0;YK.exports=KH});var iZ=E((bC,wK)=>{var qH=f$(),VH=($,Z,J)=>qH($,Z,J)===0;wK.exports=VH});var aZ=E((vC,jK)=>{var XH=f$(),WH=($,Z,J)=>XH($,Z,J)!==0;jK.exports=WH});var K9=E((SC,BK)=>{var UH=f$(),zH=($,Z,J)=>UH($,Z,J)>=0;BK.exports=zH});var q9=E((hC,FK)=>{var HH=f$(),GH=($,Z,J)=>HH($,Z,J)<=0;FK.exports=GH});var rZ=E((fC,NK)=>{var YH=iZ(),wH=aZ(),jH=f7(),BH=K9(),FH=Q9(),NH=q9(),CH=($,Z,J,Q)=>{switch(Z){case"===":if(typeof $==="object")$=$.version;if(typeof J==="object")J=J.version;return $===J;case"!==":if(typeof $==="object")$=$.version;if(typeof J==="object")J=J.version;return $!==J;case"":case"=":case"==":return YH($,J,Q);case"!=":return wH($,J,Q);case">":return jH($,J,Q);case">=":return BH($,J,Q);case"<":return FH($,J,Q);case"<=":return NH($,J,Q);default:throw new TypeError(`Invalid operator: ${Z}`)}};NK.exports=CH});var LK=E((yC,CK)=>{var LH=$$(),_H=w6(),{safeRe:V9,t:X9}=n6(),OH=($,Z)=>{if($ instanceof LH)return $;if(typeof $==="number")$=String($);if(typeof $!=="string")return null;Z=Z||{};let J=null;if(!Z.rtl)J=$.match(V9[X9.COERCE]);else{let Q;while((Q=V9[X9.COERCERTL].exec($))&&(!J||J.index+J[0].length!==$.length)){if(!J||Q.index+Q[0].length!==J.index+J[0].length)J=Q;V9[X9.COERCERTL].lastIndex=Q.index+Q[1].length+Q[2].length}V9[X9.COERCERTL].lastIndex=-1}if(J===null)return null;return _H(`${J[2]}.${J[3]||"0"}.${J[4]||"0"}`,Z)};CK.exports=OH});var OK=E((gC,_K)=>{_K.exports=function($){$.prototype[Symbol.iterator]=function*(){for(let Z=this.head;Z;Z=Z.next)yield Z.value}}});var RK=E((xC,IK)=>{var V0=function($){var Z=this;if(!(Z instanceof V0))Z=new V0;if(Z.tail=null,Z.head=null,Z.length=0,$&&typeof $.forEach==="function")$.forEach(function(K){Z.push(K)});else if(arguments.length>0)for(var J=0,Q=arguments.length;J<Q;J++)Z.push(arguments[J]);return Z},IH=function($,Z,J){var Q=Z===$.head?new j6(J,null,Z,$):new j6(J,Z,Z.next,$);if(Q.next===null)$.tail=Q;if(Q.prev===null)$.head=Q;return $.length++,Q},RH=function($,Z){if($.tail=new j6(Z,$.tail,null,$),!$.head)$.head=$.tail;$.length++},PH=function($,Z){if($.head=new j6(Z,null,$.head,$),!$.tail)$.tail=$.head;$.length++},j6=function($,Z,J,Q){if(!(this instanceof j6))return new j6($,Z,J,Q);if(this.list=Q,this.value=$,Z)Z.next=this,this.prev=Z;else this.prev=null;if(J)J.prev=this,this.next=J;else this.next=null};IK.exports=V0;V0.Node=j6;V0.create=V0;V0.prototype.removeNode=function($){if($.list!==this)throw new Error("removing node which does not belong to this list");var{next:Z,prev:J}=$;if(Z)Z.prev=J;if(J)J.next=Z;if($===this.head)this.head=Z;if($===this.tail)this.tail=J;return $.list.length--,$.next=null,$.prev=null,$.list=null,Z};V0.prototype.unshiftNode=function($){if($===this.head)return;if($.list)$.list.removeNode($);var Z=this.head;if($.list=this,$.next=Z,Z)Z.prev=$;if(this.head=$,!this.tail)this.tail=$;this.length++};V0.prototype.pushNode=function($){if($===this.tail)return;if($.list)$.list.removeNode($);var Z=this.tail;if($.list=this,$.prev=Z,Z)Z.next=$;if(this.tail=$,!this.head)this.head=$;this.length++};V0.prototype.push=function(){for(var $=0,Z=arguments.length;$<Z;$++)RH(this,arguments[$]);return this.length};V0.prototype.unshift=function(){for(var $=0,Z=arguments.length;$<Z;$++)PH(this,arguments[$]);return this.length};V0.prototype.pop=function(){if(!this.tail)return;var $=this.tail.value;if(this.tail=this.tail.prev,this.tail)this.tail.next=null;else this.head=null;return this.length--,$};V0.prototype.shift=function(){if(!this.head)return;var $=this.head.value;if(this.head=this.head.next,this.head)this.head.prev=null;else this.tail=null;return this.length--,$};V0.prototype.forEach=function($,Z){Z=Z||this;for(var J=this.head,Q=0;J!==null;Q++)$.call(Z,J.value,Q,this),J=J.next};V0.prototype.forEachReverse=function($,Z){Z=Z||this;for(var J=this.tail,Q=this.length-1;J!==null;Q--)$.call(Z,J.value,Q,this),J=J.prev};V0.prototype.get=function($){for(var Z=0,J=this.head;J!==null&&Z<$;Z++)J=J.next;if(Z===$&&J!==null)return J.value};V0.prototype.getReverse=function($){for(var Z=0,J=this.tail;J!==null&&Z<$;Z++)J=J.prev;if(Z===$&&J!==null)return J.value};V0.prototype.map=function($,Z){Z=Z||this;var J=new V0;for(var Q=this.head;Q!==null;)J.push($.call(Z,Q.value,this)),Q=Q.next;return J};V0.prototype.mapReverse=function($,Z){Z=Z||this;var J=new V0;for(var Q=this.tail;Q!==null;)J.push($.call(Z,Q.value,this)),Q=Q.prev;return J};V0.prototype.reduce=function($,Z){var J,Q=this.head;if(arguments.length>1)J=Z;else if(this.head)Q=this.head.next,J=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var K=0;Q!==null;K++)J=$(J,Q.value,K),Q=Q.next;return J};V0.prototype.reduceReverse=function($,Z){var J,Q=this.tail;if(arguments.length>1)J=Z;else if(this.tail)Q=this.tail.prev,J=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var K=this.length-1;Q!==null;K--)J=$(J,Q.value,K),Q=Q.prev;return J};V0.prototype.toArray=function(){var $=new Array(this.length);for(var Z=0,J=this.head;J!==null;Z++)$[Z]=J.value,J=J.next;return $};V0.prototype.toArrayReverse=function(){var $=new Array(this.length);for(var Z=0,J=this.tail;J!==null;Z++)$[Z]=J.value,J=J.prev;return $};V0.prototype.slice=function($,Z){if(Z=Z||this.length,Z<0)Z+=this.length;if($=$||0,$<0)$+=this.length;var J=new V0;if(Z<$||Z<0)return J;if($<0)$=0;if(Z>this.length)Z=this.length;for(var Q=0,K=this.head;K!==null&&Q<$;Q++)K=K.next;for(;K!==null&&Q<Z;Q++,K=K.next)J.push(K.value);return J};V0.prototype.sliceReverse=function($,Z){if(Z=Z||this.length,Z<0)Z+=this.length;if($=$||0,$<0)$+=this.length;var J=new V0;if(Z<$||Z<0)return J;if($<0)$=0;if(Z>this.length)Z=this.length;for(var Q=this.length,K=this.tail;K!==null&&Q>Z;Q--)K=K.prev;for(;K!==null&&Q>$;Q--,K=K.prev)J.push(K.value);return J};V0.prototype.splice=function($,Z,...J){if($>this.length)$=this.length-1;if($<0)$=this.length+$;for(var Q=0,K=this.head;K!==null&&Q<$;Q++)K=K.next;var q=[];for(var Q=0;K&&Q<Z;Q++)q.push(K.value),K=this.removeNode(K);if(K===null)K=this.tail;if(K!==this.head&&K!==this.tail)K=K.prev;for(var Q=0;Q<J.length;Q++)K=IH(this,K,J[Q]);return q};V0.prototype.reverse=function(){var $=this.head,Z=this.tail;for(var J=$;J!==null;J=J.prev){var Q=J.prev;J.prev=J.next,J.next=Q}return this.head=Z,this.tail=$,this};try{OK()(V0)}catch($){}});var TK=E((mC,EK)=>{var DH=RK(),B6=Symbol("max"),k8=Symbol("length"),s6=Symbol("lengthCalculator"),g7=Symbol("allowStale"),F6=Symbol("maxAge"),M8=Symbol("dispose"),PK=Symbol("noDisposeOnSet"),g0=Symbol("lruList"),i$=Symbol("cache"),AK=Symbol("updateAgeOnGet"),tZ=()=>1;class MK{constructor($){if(typeof $==="number")$={max:$};if(!$)$={};if($.max&&(typeof $.max!=="number"||$.max<0))throw new TypeError("max must be a non-negative number");const Z=this[B6]=$.max||Infinity,J=$.length||tZ;if(this[s6]=typeof J!=="function"?tZ:J,this[g7]=$.stale||!1,$.maxAge&&typeof $.maxAge!=="number")throw new TypeError("maxAge must be a number");this[F6]=$.maxAge||0,this[M8]=$.dispose,this[PK]=$.noDisposeOnSet||!1,this[AK]=$.updateAgeOnGet||!1,this.reset()}set max($){if(typeof $!=="number"||$<0)throw new TypeError("max must be a non-negative number");this[B6]=$||Infinity,y7(this)}get max(){return this[B6]}set allowStale($){this[g7]=!!$}get allowStale(){return this[g7]}set maxAge($){if(typeof $!=="number")throw new TypeError("maxAge must be a non-negative number");this[F6]=$,y7(this)}get maxAge(){return this[F6]}set lengthCalculator($){if(typeof $!=="function")$=tZ;if($!==this[s6])this[s6]=$,this[k8]=0,this[g0].forEach((Z)=>{Z.length=this[s6](Z.value,Z.key),this[k8]+=Z.length});y7(this)}get lengthCalculator(){return this[s6]}get length(){return this[k8]}get itemCount(){return this[g0].length}rforEach($,Z){Z=Z||this;for(let J=this[g0].tail;J!==null;){const Q=J.prev;DK(this,$,J,Z),J=Q}}forEach($,Z){Z=Z||this;for(let J=this[g0].head;J!==null;){const Q=J.next;DK(this,$,J,Z),J=Q}}keys(){return this[g0].toArray().map(($)=>$.key)}values(){return this[g0].toArray().map(($)=>$.value)}reset(){if(this[M8]&&this[g0]&&this[g0].length)this[g0].forEach(($)=>this[M8]($.key,$.value));this[i$]=new Map,this[g0]=new DH,this[k8]=0}dump(){return this[g0].map(($)=>W9(this,$)?!1:{k:$.key,v:$.value,e:$.now+($.maxAge||0)}).toArray().filter(($)=>$)}dumpLru(){return this[g0]}set($,Z,J){if(J=J||this[F6],J&&typeof J!=="number")throw new TypeError("maxAge must be a number");const Q=J?Date.now():0,K=this[s6](Z,$);if(this[i$].has($)){if(K>this[B6])return i6(this,this[i$].get($)),!1;const X=this[i$].get($).value;if(this[M8]){if(!this[PK])this[M8]($,X.value)}return X.now=Q,X.maxAge=J,X.value=Z,this[k8]+=K-X.length,X.length=K,this.get($),y7(this),!0}const q=new kK($,Z,K,Q,J);if(q.length>this[B6]){if(this[M8])this[M8]($,Z);return!1}return this[k8]+=q.length,this[g0].unshift(q),this[i$].set($,this[g0].head),y7(this),!0}has($){if(!this[i$].has($))return!1;const Z=this[i$].get($).value;return!W9(this,Z)}get($){return eZ(this,$,!0)}peek($){return eZ(this,$,!1)}pop(){const $=this[g0].tail;if(!$)return null;return i6(this,$),$.value}del($){i6(this,this[i$].get($))}load($){this.reset();const Z=Date.now();for(let J=$.length-1;J>=0;J--){const Q=$[J],K=Q.e||0;if(K===0)this.set(Q.k,Q.v);else{const q=K-Z;if(q>0)this.set(Q.k,Q.v,q)}}}prune(){this[i$].forEach(($,Z)=>eZ(this,Z,!1))}}var eZ=($,Z,J)=>{const Q=$[i$].get(Z);if(Q){const K=Q.value;if(W9($,K)){if(i6($,Q),!$[g7])return}else if(J){if($[AK])Q.value.now=Date.now();$[g0].unshiftNode(Q)}return K.value}},W9=($,Z)=>{if(!Z||!Z.maxAge&&!$[F6])return!1;const J=Date.now()-Z.now;return Z.maxAge?J>Z.maxAge:$[F6]&&J>$[F6]},y7=($)=>{if($[k8]>$[B6])for(let Z=$[g0].tail;$[k8]>$[B6]&&Z!==null;){const J=Z.prev;i6($,Z),Z=J}},i6=($,Z)=>{if(Z){const J=Z.value;if($[M8])$[M8](J.key,J.value);$[k8]-=J.length,$[i$].delete(J.key),$[g0].removeNode(Z)}};class kK{constructor($,Z,J,Q,K){this.key=$,this.value=Z,this.length=J,this.now=Q,this.maxAge=K||0}}var DK=($,Z,J,Q)=>{let K=J.value;if(W9($,K)){if(i6($,J),!$[g7])K=void 0}if(K)Z.call(Q,K.value,K.key,$)};EK.exports=MK});var y$=E((cC,hK)=>{class x7{constructor($,Z){if(Z=MH(Z),$ instanceof x7)if($.loose===!!Z.loose&&$.includePrerelease===!!Z.includePrerelease)return $;else return new x7($.raw,Z);if($ instanceof $J)return this.raw=$.value,this.set=[[$]],this.format(),this;if(this.options=Z,this.loose=!!Z.loose,this.includePrerelease=!!Z.includePrerelease,this.raw=$.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((J)=>this.parseRange(J.trim())).filter((J)=>J.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const J=this.set[0];if(this.set=this.set.filter((Q)=>!vK(Q[0])),this.set.length===0)this.set=[J];else if(this.set.length>1){for(let Q of this.set)if(Q.length===1&&hH(Q[0])){this.set=[Q];break}}}this.format()}format(){return this.range=this.set.map(($)=>$.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange($){const J=((this.options.includePrerelease&&vH)|(this.options.loose&&SH))+":"+$,Q=bK.get(J);if(Q)return Q;const K=this.options.loose,q=K?C$[W$.HYPHENRANGELOOSE]:C$[W$.HYPHENRANGE];$=$.replace(q,lH(this.options.includePrerelease)),B0("hyphen replace",$),$=$.replace(C$[W$.COMPARATORTRIM],EH),B0("comparator trim",$),$=$.replace(C$[W$.TILDETRIM],TH),B0("tilde trim",$),$=$.replace(C$[W$.CARETTRIM],bH),B0("caret trim",$);let V=$.split(" ").map((z)=>fH(z,this.options)).join(" ").split(/\s+/).map((z)=>dH(z,this.options));if(K)V=V.filter((z)=>{return B0("loose invalid filter",z,this.options),!!z.match(C$[W$.COMPARATORLOOSE])});B0("range list",V);const X=new Map,W=V.map((z)=>new $J(z,this.options));for(let z of W){if(vK(z))return[z];X.set(z.value,z)}if(X.size>1&&X.has(""))X.delete("");const U=[...X.values()];return bK.set(J,U),U}intersects($,Z){if(!($ instanceof x7))throw new TypeError("a Range is required");return this.set.some((J)=>{return SK(J,Z)&&$.set.some((Q)=>{return SK(Q,Z)&&J.every((K)=>{return Q.every((q)=>{return K.intersects(q,Z)})})})})}test($){if(!$)return!1;if(typeof $==="string")try{$=new kH($,this.options)}catch(Z){return!1}for(let Z=0;Z<this.set.length;Z++)if(nH(this.set[Z],$,this.options))return!0;return!1}}hK.exports=x7;var AH=TK(),bK=new AH({max:1000}),MH=e5(),$J=m7(),B0=h7(),kH=$$(),{safeRe:C$,t:W$,comparatorTrimReplace:EH,tildeTrimReplace:TH,caretTrimReplace:bH}=n6(),{FLAG_INCLUDE_PRERELEASE:vH,FLAG_LOOSE:SH}=S7(),vK=($)=>$.value==="<0.0.0-0",hH=($)=>$.value==="",SK=($,Z)=>{let J=!0;const Q=$.slice();let K=Q.pop();while(J&&Q.length)J=Q.every((q)=>{return K.intersects(q,Z)}),K=Q.pop();return J},fH=($,Z)=>{return B0("comp",$,Z),$=xH($,Z),B0("caret",$),$=yH($,Z),B0("tildes",$),$=cH($,Z),B0("xrange",$),$=uH($,Z),B0("stars",$),$},U$=($)=>!$||$.toLowerCase()==="x"||$==="*",yH=($,Z)=>{return $.trim().split(/\s+/).map((J)=>gH(J,Z)).join(" ")},gH=($,Z)=>{const J=Z.loose?C$[W$.TILDELOOSE]:C$[W$.TILDE];return $.replace(J,(Q,K,q,V,X)=>{B0("tilde",$,Q,K,q,V,X);let W;if(U$(K))W="";else if(U$(q))W=`>=${K}.0.0 <${+K+1}.0.0-0`;else if(U$(V))W=`>=${K}.${q}.0 <${K}.${+q+1}.0-0`;else if(X)B0("replaceTilde pr",X),W=`>=${K}.${q}.${V}-${X} <${K}.${+q+1}.0-0`;else W=`>=${K}.${q}.${V} <${K}.${+q+1}.0-0`;return B0("tilde return",W),W})},xH=($,Z)=>{return $.trim().split(/\s+/).map((J)=>mH(J,Z)).join(" ")},mH=($,Z)=>{B0("caret",$,Z);const J=Z.loose?C$[W$.CARETLOOSE]:C$[W$.CARET],Q=Z.includePrerelease?"-0":"";return $.replace(J,(K,q,V,X,W)=>{B0("caret",$,K,q,V,X,W);let U;if(U$(q))U="";else if(U$(V))U=`>=${q}.0.0${Q} <${+q+1}.0.0-0`;else if(U$(X))if(q==="0")U=`>=${q}.${V}.0${Q} <${q}.${+V+1}.0-0`;else U=`>=${q}.${V}.0${Q} <${+q+1}.0.0-0`;else if(W)if(B0("replaceCaret pr",W),q==="0")if(V==="0")U=`>=${q}.${V}.${X}-${W} <${q}.${V}.${+X+1}-0`;else U=`>=${q}.${V}.${X}-${W} <${q}.${+V+1}.0-0`;else U=`>=${q}.${V}.${X}-${W} <${+q+1}.0.0-0`;else if(B0("no pr"),q==="0")if(V==="0")U=`>=${q}.${V}.${X}${Q} <${q}.${V}.${+X+1}-0`;else U=`>=${q}.${V}.${X}${Q} <${q}.${+V+1}.0-0`;else U=`>=${q}.${V}.${X} <${+q+1}.0.0-0`;return B0("caret return",U),U})},cH=($,Z)=>{return B0("replaceXRanges",$,Z),$.split(/\s+/).map((J)=>pH(J,Z)).join(" ")},pH=($,Z)=>{$=$.trim();const J=Z.loose?C$[W$.XRANGELOOSE]:C$[W$.XRANGE];return $.replace(J,(Q,K,q,V,X,W)=>{B0("xRange",$,Q,K,q,V,X,W);const U=U$(q),z=U||U$(V),H=z||U$(X),G=H;if(K==="="&&G)K="";if(W=Z.includePrerelease?"-0":"",U)if(K===">"||K==="<")Q="<0.0.0-0";else Q="*";else if(K&&G){if(z)V=0;if(X=0,K===">")if(K=">=",z)q=+q+1,V=0,X=0;else V=+V+1,X=0;else if(K==="<=")if(K="<",z)q=+q+1;else V=+V+1;if(K==="<")W="-0";Q=`${K+q}.${V}.${X}${W}`}else if(z)Q=`>=${q}.0.0${W} <${+q+1}.0.0-0`;else if(H)Q=`>=${q}.${V}.0${W} <${q}.${+V+1}.0-0`;return B0("xRange return",Q),Q})},uH=($,Z)=>{return B0("replaceStars",$,Z),$.trim().replace(C$[W$.STAR],"")},dH=($,Z)=>{return B0("replaceGTE0",$,Z),$.trim().replace(C$[Z.includePrerelease?W$.GTE0PRE:W$.GTE0],"")},lH=($)=>(Z,J,Q,K,q,V,X,W,U,z,H,G,Y)=>{if(U$(Q))J="";else if(U$(K))J=`>=${Q}.0.0${$?"-0":""}`;else if(U$(q))J=`>=${Q}.${K}.0${$?"-0":""}`;else if(V)J=`>=${J}`;else J=`>=${J}${$?"-0":""}`;if(U$(U))W="";else if(U$(z))W=`<${+U+1}.0.0-0`;else if(U$(H))W=`<${U}.${+z+1}.0-0`;else if(G)W=`<=${U}.${z}.${H}-${G}`;else if($)W=`<${U}.${z}.${+H+1}-0`;else W=`<=${W}`;return`${J} ${W}`.trim()},nH=($,Z,J)=>{for(let Q=0;Q<$.length;Q++)if(!$[Q].test(Z))return!1;if(Z.prerelease.length&&!J.includePrerelease){for(let Q=0;Q<$.length;Q++){if(B0($[Q].semver),$[Q].semver===$J.ANY)continue;if($[Q].semver.prerelease.length>0){const K=$[Q].semver;if(K.major===Z.major&&K.minor===Z.minor&&K.patch===Z.patch)return!0}}return!1}return!0}});var m7=E((pC,cK)=>{var c7=Symbol("SemVer ANY");class U9{static get ANY(){return c7}constructor($,Z){if(Z=fK(Z),$ instanceof U9)if($.loose===!!Z.loose)return $;else $=$.value;if($=$.trim().split(/\s+/).join(" "),JJ("comparator",$,Z),this.options=Z,this.loose=!!Z.loose,this.parse($),this.semver===c7)this.value="";else this.value=this.operator+this.semver.version;JJ("comp",this)}parse($){const Z=this.options.loose?yK[gK.COMPARATORLOOSE]:yK[gK.COMPARATOR],J=$.match(Z);if(!J)throw new TypeError(`Invalid comparator: ${$}`);if(this.operator=J[1]!==void 0?J[1]:"",this.operator==="=")this.operator="";if(!J[2])this.semver=c7;else this.semver=new xK(J[2],this.options.loose)}toString(){return this.value}test($){if(JJ("Comparator.test",$,this.options.loose),this.semver===c7||$===c7)return!0;if(typeof $==="string")try{$=new xK($,this.options)}catch(Z){return!1}return ZJ($,this.operator,this.semver,this.options)}intersects($,Z){if(!($ instanceof U9))throw new TypeError("a Comparator is required");if(this.operator===""){if(this.value==="")return!0;return new mK($.value,Z).test(this.value)}else if($.operator===""){if($.value==="")return!0;return new mK(this.value,Z).test($.semver)}if(Z=fK(Z),Z.includePrerelease&&(this.value==="<0.0.0-0"||$.value==="<0.0.0-0"))return!1;if(!Z.includePrerelease&&(this.value.startsWith("<0.0.0")||$.value.startsWith("<0.0.0")))return!1;if(this.operator.startsWith(">")&&$.operator.startsWith(">"))return!0;if(this.operator.startsWith("<")&&$.operator.startsWith("<"))return!0;if(this.semver.version===$.semver.version&&this.operator.includes("=")&&$.operator.includes("="))return!0;if(ZJ(this.semver,"<",$.semver,Z)&&this.operator.startsWith(">")&&$.operator.startsWith("<"))return!0;if(ZJ(this.semver,">",$.semver,Z)&&this.operator.startsWith("<")&&$.operator.startsWith(">"))return!0;return!1}}cK.exports=U9;var fK=e5(),{safeRe:yK,t:gK}=n6(),ZJ=rZ(),JJ=h7(),xK=$$(),mK=y$()});var p7=E((uC,pK)=>{var oH=y$(),sH=($,Z,J)=>{try{Z=new oH(Z,J)}catch(Q){return!1}return Z.test($)};pK.exports=sH});var dK=E((dC,uK)=>{var iH=y$(),aH=($,Z)=>new iH($,Z).set.map((J)=>J.map((Q)=>Q.value).join(" ").trim().split(" "));uK.exports=aH});var nK=E((lC,lK)=>{var rH=$$(),tH=y$(),eH=($,Z,J)=>{let Q=null,K=null,q=null;try{q=new tH(Z,J)}catch(V){return null}return $.forEach((V)=>{if(q.test(V)){if(!Q||K.compare(V)===-1)Q=V,K=new rH(Q,J)}}),Q};lK.exports=eH});var sK=E((nC,oK)=>{var $G=$$(),ZG=y$(),JG=($,Z,J)=>{let Q=null,K=null,q=null;try{q=new ZG(Z,J)}catch(V){return null}return $.forEach((V)=>{if(q.test(V)){if(!Q||K.compare(V)===1)Q=V,K=new $G(Q,J)}}),Q};oK.exports=JG});var rK=E((oC,aK)=>{var QJ=$$(),QG=y$(),iK=f7(),KG=($,Z)=>{$=new QG($,Z);let J=new QJ("0.0.0");if($.test(J))return J;if(J=new QJ("0.0.0-0"),$.test(J))return J;J=null;for(let Q=0;Q<$.set.length;++Q){const K=$.set[Q];let q=null;if(K.forEach((V)=>{const X=new QJ(V.semver.version);switch(V.operator){case">":if(X.prerelease.length===0)X.patch++;else X.prerelease.push(0);X.raw=X.format();case"":case">=":if(!q||iK(X,q))q=X;break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${V.operator}`)}}),q&&(!J||iK(J,q)))J=q}if(J&&$.test(J))return J;return null};aK.exports=KG});var eK=E((sC,tK)=>{var qG=y$(),VG=($,Z)=>{try{return new qG($,Z).range||"*"}catch(J){return null}};tK.exports=VG});var z9=E((iC,Qq)=>{var XG=$$(),Jq=m7(),{ANY:WG}=Jq,UG=y$(),zG=p7(),$q=f7(),Zq=Q9(),HG=q9(),GG=K9(),YG=($,Z,J,Q)=>{$=new XG($,Q),Z=new UG(Z,Q);let K,q,V,X,W;switch(J){case">":K=$q,q=HG,V=Zq,X=">",W=">=";break;case"<":K=Zq,q=GG,V=$q,X="<",W="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(zG($,Z,Q))return!1;for(let U=0;U<Z.set.length;++U){const z=Z.set[U];let H=null,G=null;if(z.forEach((Y)=>{if(Y.semver===WG)Y=new Jq(">=0.0.0");if(H=H||Y,G=G||Y,K(Y.semver,H.semver,Q))H=Y;else if(V(Y.semver,G.semver,Q))G=Y}),H.operator===X||H.operator===W)return!1;if((!G.operator||G.operator===X)&&q($,G.semver))return!1;else if(G.operator===W&&V($,G.semver))return!1}return!0};Qq.exports=YG});var qq=E((aC,Kq)=>{var wG=z9(),jG=($,Z,J)=>wG($,Z,">",J);Kq.exports=jG});var Xq=E((rC,Vq)=>{var BG=z9(),FG=($,Z,J)=>BG($,Z,"<",J);Vq.exports=FG});var zq=E((tC,Uq)=>{var Wq=y$(),NG=($,Z,J)=>{return $=new Wq($,J),Z=new Wq(Z,J),$.intersects(Z,J)};Uq.exports=NG});var Gq=E((eC,Hq)=>{var CG=p7(),LG=f$();Hq.exports=($,Z,J)=>{const Q=[];let K=null,q=null;const V=$.sort((z,H)=>LG(z,H,J));for(let z of V)if(CG(z,Z,J)){if(q=z,!K)K=z}else{if(q)Q.push([K,q]);q=null,K=null}if(K)Q.push([K,null]);const X=[];for(let[z,H]of Q)if(z===H)X.push(z);else if(!H&&z===V[0])X.push("*");else if(!H)X.push(`>=${z}`);else if(z===V[0])X.push(`<=${H}`);else X.push(`${z} - ${H}`);const W=X.join(" || "),U=typeof Z.raw==="string"?Z.raw:String(Z);return W.length<U.length?W:Z}});var Nq=E(($L,Fq)=>{var Yq=y$(),qJ=m7(),{ANY:KJ}=qJ,u7=p7(),VJ=f$(),_G=($,Z,J={})=>{if($===Z)return!0;$=new Yq($,J),Z=new Yq(Z,J);let Q=!1;$:for(let K of $.set){for(let q of Z.set){const V=IG(K,q,J);if(Q=Q||V!==null,V)continue $}if(Q)return!1}return!0},OG=[new qJ(">=0.0.0-0")],wq=[new qJ(">=0.0.0")],IG=($,Z,J)=>{if($===Z)return!0;if($.length===1&&$[0].semver===KJ)if(Z.length===1&&Z[0].semver===KJ)return!0;else if(J.includePrerelease)$=OG;else $=wq;if(Z.length===1&&Z[0].semver===KJ)if(J.includePrerelease)return!0;else Z=wq;const Q=new Set;let K,q;for(let Y of $)if(Y.operator===">"||Y.operator===">=")K=jq(K,Y,J);else if(Y.operator==="<"||Y.operator==="<=")q=Bq(q,Y,J);else Q.add(Y.semver);if(Q.size>1)return null;let V;if(K&&q){if(V=VJ(K.semver,q.semver,J),V>0)return null;else if(V===0&&(K.operator!==">="||q.operator!=="<="))return null}for(let Y of Q){if(K&&!u7(Y,String(K),J))return null;if(q&&!u7(Y,String(q),J))return null;for(let w of Z)if(!u7(Y,String(w),J))return!1;return!0}let X,W,U,z,H=q&&!J.includePrerelease&&q.semver.prerelease.length?q.semver:!1,G=K&&!J.includePrerelease&&K.semver.prerelease.length?K.semver:!1;if(H&&H.prerelease.length===1&&q.operator==="<"&&H.prerelease[0]===0)H=!1;for(let Y of Z){if(z=z||Y.operator===">"||Y.operator===">=",U=U||Y.operator==="<"||Y.operator==="<=",K){if(G){if(Y.semver.prerelease&&Y.semver.prerelease.length&&Y.semver.major===G.major&&Y.semver.minor===G.minor&&Y.semver.patch===G.patch)G=!1}if(Y.operator===">"||Y.operator===">="){if(X=jq(K,Y,J),X===Y&&X!==K)return!1}else if(K.operator===">="&&!u7(K.semver,String(Y),J))return!1}if(q){if(H){if(Y.semver.prerelease&&Y.semver.prerelease.length&&Y.semver.major===H.major&&Y.semver.minor===H.minor&&Y.semver.patch===H.patch)H=!1}if(Y.operator==="<"||Y.operator==="<="){if(W=Bq(q,Y,J),W===Y&&W!==q)return!1}else if(q.operator==="<="&&!u7(q.semver,String(Y),J))return!1}if(!Y.operator&&(q||K)&&V!==0)return!1}if(K&&U&&!q&&V!==0)return!1;if(q&&z&&!K&&V!==0)return!1;if(G||H)return!1;return!0},jq=($,Z,J)=>{if(!$)return Z;const Q=VJ($.semver,Z.semver,J);return Q>0?$:Q<0?Z:Z.operator===">"&&$.operator===">="?Z:$},Bq=($,Z,J)=>{if(!$)return Z;const Q=VJ($.semver,Z.semver,J);return Q<0?$:Q>0?Z:Z.operator==="<"&&$.operator==="<="?Z:$};Fq.exports=_G});var H9=E((ZL,_q)=>{var XJ=n6(),Cq=S7(),RG=$$(),Lq=sZ(),PG=w6(),DG=yQ(),AG=xQ(),MG=pQ(),kG=lQ(),EG=oQ(),TG=iQ(),bG=rQ(),vG=eQ(),SG=f$(),hG=QK(),fG=qK(),yG=J9(),gG=UK(),xG=HK(),mG=f7(),cG=Q9(),pG=iZ(),uG=aZ(),dG=K9(),lG=q9(),nG=rZ(),oG=LK(),sG=m7(),iG=y$(),aG=p7(),rG=dK(),tG=nK(),eG=sK(),$Y=rK(),ZY=eK(),JY=z9(),QY=qq(),KY=Xq(),qY=zq(),VY=Gq(),XY=Nq();_q.exports={parse:PG,valid:DG,clean:AG,inc:MG,diff:kG,major:EG,minor:TG,patch:bG,prerelease:vG,compare:SG,rcompare:hG,compareLoose:fG,compareBuild:yG,sort:gG,rsort:xG,gt:mG,lt:cG,eq:pG,neq:uG,gte:dG,lte:lG,cmp:nG,coerce:oG,Comparator:sG,Range:iG,satisfies:aG,toComparators:rG,maxSatisfying:tG,minSatisfying:eG,minVersion:$Y,validRange:ZY,outside:JY,gtr:QY,ltr:KY,intersects:qY,simplifyRange:VY,subset:XY,SemVer:RG,re:XJ.re,src:XJ.src,tokens:XJ.t,SEMVER_SPEC_VERSION:Cq.SEMVER_SPEC_VERSION,RELEASE_TYPES:Cq.RELEASE_TYPES,compareIdentifiers:Lq.compareIdentifiers,rcompareIdentifiers:Lq.rcompareIdentifiers}});var Sq=E((yL,FJ)=>{var n7=function(){},HY=function($,Z,J){this.fn=$,this.context=Z,this.once=J||!1},vq=function($,Z,J,Q,K){if(typeof J!=="function")throw new TypeError("The listener must be a function");var q=new HY(J,Q||$,K),V=G$?G$+Z:Z;if(!$._events[V])$._events[V]=q,$._eventsCount++;else if(!$._events[V].fn)$._events[V].push(q);else $._events[V]=[$._events[V],q];return $},j9=function($,Z){if(--$._eventsCount===0)$._events=new n7;else delete $._events[Z]},Z$=function(){this._events=new n7,this._eventsCount=0},zY=Object.prototype.hasOwnProperty,G$="~";if(Object.create){if(n7.prototype=Object.create(null),!new n7().__proto__)G$=!1}Z$.prototype.eventNames=function $(){var Z=[],J,Q;if(this._eventsCount===0)return Z;for(Q in J=this._events)if(zY.call(J,Q))Z.push(G$?Q.slice(1):Q);if(Object.getOwnPropertySymbols)return Z.concat(Object.getOwnPropertySymbols(J));return Z};Z$.prototype.listeners=function $(Z){var J=G$?G$+Z:Z,Q=this._events[J];if(!Q)return[];if(Q.fn)return[Q.fn];for(var K=0,q=Q.length,V=new Array(q);K<q;K++)V[K]=Q[K].fn;return V};Z$.prototype.listenerCount=function $(Z){var J=G$?G$+Z:Z,Q=this._events[J];if(!Q)return 0;if(Q.fn)return 1;return Q.length};Z$.prototype.emit=function $(Z,J,Q,K,q,V){var X=G$?G$+Z:Z;if(!this._events[X])return!1;var W=this._events[X],U=arguments.length,z,H;if(W.fn){if(W.once)this.removeListener(Z,W.fn,void 0,!0);switch(U){case 1:return W.fn.call(W.context),!0;case 2:return W.fn.call(W.context,J),!0;case 3:return W.fn.call(W.context,J,Q),!0;case 4:return W.fn.call(W.context,J,Q,K),!0;case 5:return W.fn.call(W.context,J,Q,K,q),!0;case 6:return W.fn.call(W.context,J,Q,K,q,V),!0}for(H=1,z=new Array(U-1);H<U;H++)z[H-1]=arguments[H];W.fn.apply(W.context,z)}else{var G=W.length,Y;for(H=0;H<G;H++){if(W[H].once)this.removeListener(Z,W[H].fn,void 0,!0);switch(U){case 1:W[H].fn.call(W[H].context);break;case 2:W[H].fn.call(W[H].context,J);break;case 3:W[H].fn.call(W[H].context,J,Q);break;case 4:W[H].fn.call(W[H].context,J,Q,K);break;default:if(!z)for(Y=1,z=new Array(U-1);Y<U;Y++)z[Y-1]=arguments[Y];W[H].fn.apply(W[H].context,z)}}}return!0};Z$.prototype.on=function $(Z,J,Q){return vq(this,Z,J,Q,!1)};Z$.prototype.once=function $(Z,J,Q){return vq(this,Z,J,Q,!0)};Z$.prototype.removeListener=function $(Z,J,Q,K){var q=G$?G$+Z:Z;if(!this._events[q])return this;if(!J)return j9(this,q),this;var V=this._events[q];if(V.fn){if(V.fn===J&&(!K||V.once)&&(!Q||V.context===Q))j9(this,q)}else{for(var X=0,W=[],U=V.length;X<U;X++)if(V[X].fn!==J||K&&!V[X].once||Q&&V[X].context!==Q)W.push(V[X]);if(W.length)this._events[q]=W.length===1?W[0]:W;else j9(this,q)}return this};Z$.prototype.removeAllListeners=function $(Z){var J;if(Z){if(J=G$?G$+Z:Z,this._events[J])j9(this,J)}else this._events=new n7,this._eventsCount=0;return this};Z$.prototype.off=Z$.prototype.removeListener;Z$.prototype.addListener=Z$.prototype.on;Z$.prefixed=G$;Z$.EventEmitter=Z$;if(typeof FJ!=="undefined")FJ.exports=Z$});var xq=E((gL,_J)=>{var N9=function($,Z,J){J=J||2;var Q=Z&&Z.length,K=Q?Z[0]*J:$.length,q=fq($,0,K,J,!0),V=[];if(!q||q.next===q.prev)return V;var X,W,U,z,H,G,Y;if(Q)q=BY($,Z,q,J);if($.length>80*J){X=U=$[0],W=z=$[1];for(var w=J;w<K;w+=J){if(H=$[w],G=$[w+1],H<X)X=H;if(G<W)W=G;if(H>U)U=H;if(G>z)z=G}Y=Math.max(U-X,z-W),Y=Y!==0?32767/Y:0}return o7(q,V,J,X,W,Y,0),V},fq=function($,Z,J,Q,K){var q,V;if(K===LJ($,Z,J,Q)>0)for(q=Z;q<J;q+=Q)V=hq(q,$[q],$[q+1],V);else for(q=J-Q;q>=Z;q-=Q)V=hq(q,$[q],$[q+1],V);if(V&&C9(V,V.next))i7(V),V=V.next;return V},N6=function($,Z){if(!$)return $;if(!Z)Z=$;var J=$,Q;do if(Q=!1,!J.steiner&&(C9(J,J.next)||O0(J.prev,J,J.next)===0)){if(i7(J),J=Z=J.prev,J===J.next)break;Q=!0}else J=J.next;while(Q||J!==Z);return Z},o7=function($,Z,J,Q,K,q,V){if(!$)return;if(!V&&q)_Y($,Q,K,q);var X=$,W,U;while($.prev!==$.next){if(W=$.prev,U=$.next,q?YY($,Q,K,q):GY($)){Z.push(W.i/J|0),Z.push($.i/J|0),Z.push(U.i/J|0),i7($),$=U.next,X=U.next;continue}if($=U,$===X){if(!V)o7(N6($),Z,J,Q,K,q,1);else if(V===1)$=wY(N6($),Z,J),o7($,Z,J,Q,K,q,2);else if(V===2)jY($,Z,J,Q,K,q);break}}},GY=function($){var Z=$.prev,J=$,Q=$.next;if(O0(Z,J,Q)>=0)return!1;var K=Z.x,q=J.x,V=Q.x,X=Z.y,W=J.y,U=Q.y,z=K<q?K<V?K:V:q<V?q:V,H=X<W?X<U?X:U:W<U?W:U,G=K>q?K>V?K:V:q>V?q:V,Y=X>W?X>U?X:U:W>U?W:U,w=Q.next;while(w!==Z){if(w.x>=z&&w.x<=G&&w.y>=H&&w.y<=Y&&r6(K,X,q,W,V,U,w.x,w.y)&&O0(w.prev,w,w.next)>=0)return!1;w=w.next}return!0},YY=function($,Z,J,Q){var K=$.prev,q=$,V=$.next;if(O0(K,q,V)>=0)return!1;var X=K.x,W=q.x,U=V.x,z=K.y,H=q.y,G=V.y,Y=X<W?X<U?X:U:W<U?W:U,w=z<H?z<G?z:G:H<G?H:G,j=X>W?X>U?X:U:W>U?W:U,B=z>H?z>G?z:G:H>G?H:G,C=NJ(Y,w,Z,J,Q),N=NJ(j,B,Z,J,Q),F=$.prevZ,L=$.nextZ;while(F&&F.z>=C&&L&&L.z<=N){if(F.x>=Y&&F.x<=j&&F.y>=w&&F.y<=B&&F!==K&&F!==V&&r6(X,z,W,H,U,G,F.x,F.y)&&O0(F.prev,F,F.next)>=0)return!1;if(F=F.prevZ,L.x>=Y&&L.x<=j&&L.y>=w&&L.y<=B&&L!==K&&L!==V&&r6(X,z,W,H,U,G,L.x,L.y)&&O0(L.prev,L,L.next)>=0)return!1;L=L.nextZ}while(F&&F.z>=C){if(F.x>=Y&&F.x<=j&&F.y>=w&&F.y<=B&&F!==K&&F!==V&&r6(X,z,W,H,U,G,F.x,F.y)&&O0(F.prev,F,F.next)>=0)return!1;F=F.prevZ}while(L&&L.z<=N){if(L.x>=Y&&L.x<=j&&L.y>=w&&L.y<=B&&L!==K&&L!==V&&r6(X,z,W,H,U,G,L.x,L.y)&&O0(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0},wY=function($,Z,J){var Q=$;do{var K=Q.prev,q=Q.next.next;if(!C9(K,q)&&yq(K,Q,Q.next,q)&&s7(K,q)&&s7(q,K))Z.push(K.i/J|0),Z.push(Q.i/J|0),Z.push(q.i/J|0),i7(Q),i7(Q.next),Q=$=q;Q=Q.next}while(Q!==$);return N6(Q)},jY=function($,Z,J,Q,K,q){var V=$;do{var X=V.next.next;while(X!==V.prev){if(V.i!==X.i&&RY(V,X)){var W=gq(V,X);V=N6(V,V.next),W=N6(W,W.next),o7(V,Z,J,Q,K,q,0),o7(W,Z,J,Q,K,q,0);return}X=X.next}V=V.next}while(V!==$)},BY=function($,Z,J,Q){var K=[],q,V,X,W,U;for(q=0,V=Z.length;q<V;q++){if(X=Z[q]*Q,W=q<V-1?Z[q+1]*Q:$.length,U=fq($,X,W,Q,!1),U===U.next)U.steiner=!0;K.push(IY(U))}K.sort(FY);for(q=0;q<K.length;q++)J=NY(K[q],J);return J},FY=function($,Z){return $.x-Z.x},NY=function($,Z){var J=CY($,Z);if(!J)return Z;var Q=gq(J,$);return N6(Q,Q.next),N6(J,J.next)},CY=function($,Z){var J=Z,Q=$.x,K=$.y,q=(-Infinity),V;do{if(K<=J.y&&K>=J.next.y&&J.next.y!==J.y){var X=J.x+(K-J.y)*(J.next.x-J.x)/(J.next.y-J.y);if(X<=Q&&X>q){if(q=X,V=J.x<J.next.x?J:J.next,X===Q)return V}}J=J.next}while(J!==Z);if(!V)return null;var W=V,U=V.x,z=V.y,H=Infinity,G;J=V;do{if(Q>=J.x&&J.x>=U&&Q!==J.x&&r6(K<z?Q:q,K,U,z,K<z?q:Q,K,J.x,J.y)){if(G=Math.abs(K-J.y)/(Q-J.x),s7(J,$)&&(G<H||G===H&&(J.x>V.x||J.x===V.x&&LY(V,J))))V=J,H=G}J=J.next}while(J!==W);return V},LY=function($,Z){return O0($.prev,$,Z.prev)<0&&O0(Z.next,$,$.next)<0},_Y=function($,Z,J,Q){var K=$;do{if(K.z===0)K.z=NJ(K.x,K.y,Z,J,Q);K.prevZ=K.prev,K.nextZ=K.next,K=K.next}while(K!==$);K.prevZ.nextZ=null,K.prevZ=null,OY(K)},OY=function($){var Z,J,Q,K,q,V,X,W,U=1;do{J=$,$=null,q=null,V=0;while(J){V++,Q=J,X=0;for(Z=0;Z<U;Z++)if(X++,Q=Q.nextZ,!Q)break;W=U;while(X>0||W>0&&Q){if(X!==0&&(W===0||!Q||J.z<=Q.z))K=J,J=J.nextZ,X--;else K=Q,Q=Q.nextZ,W--;if(q)q.nextZ=K;else $=K;K.prevZ=q,q=K}J=Q}q.nextZ=null,U*=2}while(V>1);return $},NJ=function($,Z,J,Q,K){return $=($-J)*K|0,Z=(Z-Q)*K|0,$=($|$<<8)&16711935,$=($|$<<4)&252645135,$=($|$<<2)&858993459,$=($|$<<1)&1431655765,Z=(Z|Z<<8)&16711935,Z=(Z|Z<<4)&252645135,Z=(Z|Z<<2)&858993459,Z=(Z|Z<<1)&1431655765,$|Z<<1},IY=function($){var Z=$,J=$;do{if(Z.x<J.x||Z.x===J.x&&Z.y<J.y)J=Z;Z=Z.next}while(Z!==$);return J},r6=function($,Z,J,Q,K,q,V,X){return(K-V)*(Z-X)>=($-V)*(q-X)&&($-V)*(Q-X)>=(J-V)*(Z-X)&&(J-V)*(q-X)>=(K-V)*(Q-X)},RY=function($,Z){return $.next.i!==Z.i&&$.prev.i!==Z.i&&!PY($,Z)&&(s7($,Z)&&s7(Z,$)&&DY($,Z)&&(O0($.prev,$,Z.prev)||O0($,Z.prev,Z))||C9($,Z)&&O0($.prev,$,$.next)>0&&O0(Z.prev,Z,Z.next)>0)},O0=function($,Z,J){return(Z.y-$.y)*(J.x-Z.x)-(Z.x-$.x)*(J.y-Z.y)},C9=function($,Z){return $.x===Z.x&&$.y===Z.y},yq=function($,Z,J,Q){var K=F9(O0($,Z,J)),q=F9(O0($,Z,Q)),V=F9(O0(J,Q,$)),X=F9(O0(J,Q,Z));if(K!==q&&V!==X)return!0;if(K===0&&B9($,J,Z))return!0;if(q===0&&B9($,Q,Z))return!0;if(V===0&&B9(J,$,Q))return!0;if(X===0&&B9(J,Z,Q))return!0;return!1},B9=function($,Z,J){return Z.x<=Math.max($.x,J.x)&&Z.x>=Math.min($.x,J.x)&&Z.y<=Math.max($.y,J.y)&&Z.y>=Math.min($.y,J.y)},F9=function($){return $>0?1:$<0?-1:0},PY=function($,Z){var J=$;do{if(J.i!==$.i&&J.next.i!==$.i&&J.i!==Z.i&&J.next.i!==Z.i&&yq(J,J.next,$,Z))return!0;J=J.next}while(J!==$);return!1},s7=function($,Z){return O0($.prev,$,$.next)<0?O0($,Z,$.next)>=0&&O0($,$.prev,Z)>=0:O0($,Z,$.prev)<0||O0($,$.next,Z)<0},DY=function($,Z){var J=$,Q=!1,K=($.x+Z.x)/2,q=($.y+Z.y)/2;do{if(J.y>q!==J.next.y>q&&J.next.y!==J.y&&K<(J.next.x-J.x)*(q-J.y)/(J.next.y-J.y)+J.x)Q=!Q;J=J.next}while(J!==$);return Q},gq=function($,Z){var J=new CJ($.i,$.x,$.y),Q=new CJ(Z.i,Z.x,Z.y),K=$.next,q=Z.prev;return $.next=Z,Z.prev=$,J.next=K,K.prev=J,Q.next=J,J.prev=Q,q.next=Q,Q.prev=q,Q},hq=function($,Z,J,Q){var K=new CJ($,Z,J);if(!Q)K.prev=K,K.next=K;else K.next=Q.next,K.prev=Q,Q.next.prev=K,Q.next=K;return K},i7=function($){if($.next.prev=$.prev,$.prev.next=$.next,$.prevZ)$.prevZ.nextZ=$.nextZ;if($.nextZ)$.nextZ.prevZ=$.prevZ},CJ=function($,Z,J){this.i=$,this.x=Z,this.y=J,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1},LJ=function($,Z,J,Q){var K=0;for(var q=Z,V=J-Q;q<J;q+=Q)K+=($[V]-$[q])*($[q+1]+$[V+1]),V=q;return K};_J.exports=N9;_J.exports.default=N9;N9.deviation=function($,Z,J,Q){var K=Z&&Z.length,q=K?Z[0]*J:$.length,V=Math.abs(LJ($,0,q,J));if(K)for(var X=0,W=Z.length;X<W;X++){var U=Z[X]*J,z=X<W-1?Z[X+1]*J:$.length;V-=Math.abs(LJ($,U,z,J))}var H=0;for(X=0;X<Q.length;X+=3){var G=Q[X]*J,Y=Q[X+1]*J,w=Q[X+2]*J;H+=Math.abs(($[G]-$[w])*($[Y+1]-$[G+1])-($[G]-$[Y])*($[w+1]-$[G+1]))}return V===0&&H===0?0:Math.abs((H-V)/V)};N9.flatten=function($){var Z=$[0][0].length,J={vertices:[],holes:[],dimensions:Z},Q=0;for(var K=0;K<$.length;K++){for(var q=0;q<$[K].length;q++)for(var V=0;V<Z;V++)J.vertices.push($[K][q][V]);if(K>0)Q+=$[K-1].length,J.holes.push(Q)}return J}});var AW=E((XB)=>{XB.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer!=="undefined";XB.SYMBOL_SUPPORT=typeof Symbol!=="undefined"});var C0=E((fd,kW)=>{var MW=AW(),zB=MW.ARRAY_BUFFER_SUPPORT,HB=MW.SYMBOL_SUPPORT;kW.exports=function $(Z,J){var Q,K,q,V,X;if(!Z)throw new Error("obliterator/forEach: invalid iterable.");if(typeof J!=="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(Z)||zB&&ArrayBuffer.isView(Z)||typeof Z==="string"||Z.toString()==="[object Arguments]"){for(q=0,V=Z.length;q<V;q++)J(Z[q],q);return}if(typeof Z.forEach==="function"){Z.forEach(J);return}if(HB&&(Symbol.iterator in Z)&&typeof Z.next!=="function")Z=Z[Symbol.iterator]();if(typeof Z.next==="function"){Q=Z,q=0;while(X=Q.next(),X.done!==!0)J(X.value,q),q++;return}for(K in Z)if(Z.hasOwnProperty(K))J(Z[K],K);return}});var l5=E((BB)=>{var wB=function($){return function(Z,J){return $(J,Z)}},jB=function($){if($===2)return function(Z,J){if(Z[0]<J[0])return-1;if(Z[0]>J[0])return 1;if(Z[1]<J[1])return-1;if(Z[1]>J[1])return 1;return 0};return function(Z,J){var Q=0;while(Q<$){if(Z[Q]<J[Q])return-1;if(Z[Q]>J[Q])return 1;Q++}return 0}},GB=function($,Z){if($<Z)return-1;if($>Z)return 1;return 0},YB=function($,Z){if($<Z)return 1;if($>Z)return-1;return 0};BB.DEFAULT_COMPARATOR=GB;BB.DEFAULT_REVERSE_COMPARATOR=YB;BB.reverseComparator=wB;BB.createTupleComparator=jB});var B$=E((MB)=>{var _B=Math.pow(2,8)-1,OB=Math.pow(2,16)-1,IB=Math.pow(2,32)-1,RB=Math.pow(2,7)-1,PB=Math.pow(2,15)-1,DB=Math.pow(2,31)-1;MB.getPointerArray=function($){var Z=$-1;if(Z<=_B)return Uint8Array;if(Z<=OB)return Uint16Array;if(Z<=IB)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")};MB.getSignedPointerArray=function($){var Z=$-1;if(Z<=RB)return Int8Array;if(Z<=PB)return Int16Array;if(Z<=DB)return Int32Array;return Float64Array};MB.getNumberType=function($){if($===($|0))if(Math.sign($)===-1){if($<=127&&$>=-128)return Int8Array;if($<=32767&&$>=-32768)return Int16Array;return Int32Array}else{if($<=255)return Uint8Array;if($<=65535)return Uint16Array;return Uint32Array}return Float64Array};var AB={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};MB.getMinimalRepresentation=function($,Z){var J=null,Q=0,K,q,V,X,W;for(X=0,W=$.length;X<W;X++)if(V=Z?Z($[X]):$[X],q=MB.getNumberType(V),K=AB[q.name],K>Q)Q=K,J=q;return J};MB.isTypedArray=function($){return typeof ArrayBuffer!=="undefined"&&ArrayBuffer.isView($)};MB.concat=function(){var $=0,Z,J,Q;for(Z=0,Q=arguments.length;Z<Q;Z++)$+=arguments[Z].length;var K=new arguments[0].constructor($);for(Z=0,J=0;Z<Q;Z++)K.set(arguments[Z],J),J+=arguments[Z].length;return K};MB.indices=function($){var Z=MB.getPointerArray($),J=new Z($);for(var Q=0;Q<$;Q++)J[Q]=Q;return J}});var A$=E((yB)=>{var SB=function($){return Array.isArray($)||vW.isTypedArray($)},N4=function($){if(typeof $.length==="number")return $.length;if(typeof $.size==="number")return $.size;return},hB=function($){var Z=N4($),J=typeof Z==="number"?new Array(Z):[],Q=0;return bW($,function(K){J[Q++]=K}),J},fB=function($){var Z=N4($),J=typeof Z==="number"?vW.getPointerArray(Z):Array,Q=typeof Z==="number"?new Array(Z):[],K=typeof Z==="number"?new J(Z):[],q=0;return bW($,function(V){Q[q]=V,K[q]=q++}),[Q,K]},bW=C0(),vW=B$();yB.isArrayLike=SB;yB.guessLength=N4;yB.toArray=hB;yB.toArrayWithIndices=fB});var fZ=E((md,yW)=>{var L4=function($,Z,J,Q){var K=Z[Q],q,V;while(Q>J){if(q=Q-1>>1,V=Z[q],$(K,V)<0){Z[Q]=V,Q=q;continue}break}Z[Q]=K},n5=function($,Z,J){var Q=Z.length,K=J,q=Z[J],V=2*J+1,X;while(V<Q){if(X=V+1,X<Q&&$(Z[V],Z[X])>=0)V=X;Z[J]=Z[V],J=V,V=2*J+1}Z[J]=q,L4($,Z,K,J)},hW=function($,Z,J){Z.push(J),L4($,Z,0,Z.length-1)},_4=function($,Z){var J=Z.pop();if(Z.length!==0){var Q=Z[0];return Z[0]=J,n5($,Z,0),Q}return J},O7=function($,Z,J){if(Z.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var Q=Z[0];return Z[0]=J,n5($,Z,0),Q},fW=function($,Z,J){var Q;if(Z.length!==0&&$(Z[0],J)<0)Q=Z[0],Z[0]=J,J=Q,n5($,Z,0);return J},c6=function($,Z){var J=Z.length,Q=J>>1,K=Q;while(--K>=0)n5($,Z,K)},O4=function($,Z){var J=Z.length,Q=0,K=new Array(J);while(Q<J)K[Q++]=_4($,Z);return K},pB=function($,Z,J){if(arguments.length===2)J=Z,Z=$,$=hZ;var Q=C4($),K,q,V,X=Infinity,W;if(Z===1){if(F8.isArrayLike(J)){for(K=0,q=J.length;K<q;K++)if(V=J[K],X===Infinity||$(V,X)<0)X=V;return W=new J.constructor(1),W[0]=X,W}return vZ(J,function(z){if(X===Infinity||$(z,X)<0)X=z}),[X]}if(F8.isArrayLike(J)){if(Z>=J.length)return J.slice().sort($);W=J.slice(0,Z),c6(Q,W);for(K=Z,q=J.length;K<q;K++)if(Q(J[K],W[0])>0)O7(Q,W,J[K]);return W.sort($)}var U=F8.guessLength(J);if(U!==null&&U<Z)Z=U;if(W=new Array(Z),K=0,vZ(J,function(z){if(K<Z)W[K]=z;else{if(K===Z)c6(Q,W);if(Q(z,W[0])>0)O7(Q,W,z)}K++}),W.length>K)W.length=K;return W.sort($)},uB=function($,Z,J){if(arguments.length===2)J=Z,Z=$,$=hZ;var Q=C4($),K,q,V,X=(-Infinity),W;if(Z===1){if(F8.isArrayLike(J)){for(K=0,q=J.length;K<q;K++)if(V=J[K],X===(-Infinity)||$(V,X)>0)X=V;return W=new J.constructor(1),W[0]=X,W}return vZ(J,function(z){if(X===(-Infinity)||$(z,X)>0)X=z}),[X]}if(F8.isArrayLike(J)){if(Z>=J.length)return J.slice().sort(Q);W=J.slice(0,Z),c6($,W);for(K=Z,q=J.length;K<q;K++)if($(J[K],W[0])>0)O7($,W,J[K]);return W.sort(Q)}var U=F8.guessLength(J);if(U!==null&&U<Z)Z=U;if(W=new Array(Z),K=0,vZ(J,function(z){if(K<Z)W[K]=z;else{if(K===Z)c6($,W);if($(z,W[0])>0)O7($,W,z)}K++}),W.length>K)W.length=K;return W.sort(Q)},z0=function($){if(this.clear(),this.comparator=$||hZ,typeof this.comparator!=="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")},SZ=function($){if(this.clear(),this.comparator=$||hZ,typeof this.comparator!=="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=C4(this.comparator)},vZ=C0(),SW=l5(),F8=A$(),hZ=SW.DEFAULT_COMPARATOR,C4=SW.reverseComparator;z0.prototype.clear=function(){this.items=[],this.size=0};z0.prototype.push=function($){return hW(this.comparator,this.items,$),++this.size};z0.prototype.peek=function(){return this.items[0]};z0.prototype.pop=function(){if(this.size!==0)this.size--;return _4(this.comparator,this.items)};z0.prototype.replace=function($){return O7(this.comparator,this.items,$)};z0.prototype.pushpop=function($){return fW(this.comparator,this.items,$)};z0.prototype.consume=function(){return this.size=0,O4(this.comparator,this.items)};z0.prototype.toArray=function(){return O4(this.comparator,this.items.slice())};z0.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:z0,enumerable:!1}),$};if(typeof Symbol!=="undefined")z0.prototype[Symbol.for("nodejs.util.inspect.custom")]=z0.prototype.inspect;SZ.prototype=z0.prototype;z0.from=function($,Z){var J=new z0(Z),Q;if(F8.isArrayLike($))Q=$.slice();else Q=F8.toArray($);return c6(J.comparator,Q),J.items=Q,J.size=Q.length,J};SZ.from=function($,Z){var J=new SZ(Z),Q;if(F8.isArrayLike($))Q=$.slice();else Q=F8.toArray($);return c6(J.comparator,Q),J.items=Q,J.size=Q.length,J};z0.siftUp=n5;z0.siftDown=L4;z0.push=hW;z0.pop=_4;z0.replace=O7;z0.pushpop=fW;z0.heapify=c6;z0.consume=O4;z0.nsmallest=pB;z0.nlargest=uB;z0.MinHeap=z0;z0.MaxHeap=SZ;yW.exports=z0});var I4=E((cd,dW)=>{var F$=function($){if(this.clear(),this.comparator=$||mW,typeof this.comparator!=="function")throw new Error("mnemonist/FibonacciHeap.constructor: given comparator should be a function.")},lB=function($){return{item:$,degree:0}},cW=function($,Z){if(!$.root)$.root=Z;else Z.right=$.root.right,Z.left=$.root,$.root.right.left=Z,$.root.right=Z},pW=function($){var Z=[],J=$,Q=!1;while(!0){if(J===$&&Q)break;else if(J===$)Q=!0;Z.push(J),J=J.right}return Z},uW=function($,Z){if($.root===Z)$.root=Z.right;Z.left.right=Z.right,Z.right.left=Z.left},nB=function($,Z){if(!$.child)$.child=Z;else Z.right=$.child.right,Z.left=$.child,$.child.right.left=Z,$.child.right=Z},oB=function($,Z,J){uW($,Z),Z.left=Z,Z.right=Z,nB(J,Z),J.degree++,Z.parent=J},sB=function($){var Z=new Array($.size),J=pW($.root),Q,K,q,V,X,W;for(Q=0,K=J.length;Q<K;Q++){q=J[Q],X=q.degree;while(Z[X]){if(V=Z[X],$.comparator(q.item,V.item)>0)W=q,q=V,V=W;oB($,V,q),Z[X]=null,X++}Z[X]=q}for(Q=0;Q<$.size;Q++)if(Z[Q]&&$.comparator(Z[Q].item,$.min.item)<=0)$.min=Z[Q]},yZ=function($){if(this.clear(),this.comparator=$||mW,typeof this.comparator!=="function")throw new Error("mnemonist/FibonacciHeap.constructor: given comparator should be a function.");this.comparator=dB(this.comparator)},gW=l5(),xW=C0(),mW=gW.DEFAULT_COMPARATOR,dB=gW.reverseComparator;F$.prototype.clear=function(){this.root=null,this.min=null,this.size=0};F$.prototype.push=function($){var Z=lB($);if(Z.left=Z,Z.right=Z,cW(this,Z),!this.min||this.comparator(Z.item,this.min.item)<=0)this.min=Z;return++this.size};F$.prototype.peek=function(){return this.min?this.min.item:void 0};F$.prototype.pop=function(){if(!this.size)return;var $=this.min;if($.child){var Z=pW($.child),J,Q,K;for(Q=0,K=Z.length;Q<K;Q++)J=Z[Q],cW(this,J),delete J.parent}if(uW(this,$),$===$.right)this.min=null,this.root=null;else this.min=$.right,sB(this);return this.size--,$.item};F$.prototype.inspect=function(){var $={size:this.size};if(this.min&&("item"in this.min))$.top=this.min.item;return Object.defineProperty($,"constructor",{value:F$,enumerable:!1}),$};if(typeof Symbol!=="undefined")F$.prototype[Symbol.for("nodejs.util.inspect.custom")]=F$.prototype.inspect;yZ.prototype=F$.prototype;F$.from=function($,Z){var J=new F$(Z);return xW($,function(Q){J.push(Q)}),J};yZ.from=function($,Z){var J=new yZ(Z);return xW($,function(Q){J.push(Q)}),J};F$.MinFibonacciHeap=F$;F$.MaxFibonacciHeap=yZ;dW.exports=F$});var iW=E((pd,sW)=>{var nW=function($,Z,J){var Q=Z.length,K=[],q=Q,V=-1,X,W=0,U;while(q--)V=Math.max($[Z[q]+J],V);U=V>>24&&32||V>>16&&24||V>>8&&16||8;for(;W<U;W+=4){for(q=16;q--;)K[q]=[];for(q=Q;q--;)K[$[Z[q]+J]>>W&15].push(Z[q]);for(X=0;X<16;X++)for(V=K[X].length;V--;)Z[++q]=K[X][V]}},iB=function($,Z,J,Q){return $[J]-$[Q]||(J%3===2?$[J+1]-$[Q+1]||Z[J+2]-Z[Q+2]:Z[J+1]-Z[Q+1])},R4=function($,Z){var J=[],Q=[],K=2*Z/3|0,q=Z-K,V=K+1>>1,X=K,W=0,U,z=[],H=[];if(Z===1)return[0];while(X--)J[X]=(X*3>>1)+1;for(X=3;X--;)nW($,J,X);W=Q[(J[0]/3|0)+(J[0]%3===1?0:V)]=1;for(X=1;X<K;X++){if($[J[X]]!==$[J[X-1]]||$[J[X]+1]!==$[J[X-1]+1]||$[J[X]+2]!==$[J[X-1]+2])W++;Q[(J[X]/3|0)+(J[X]%3===1?0:V)]=W}if(W<K){Q=R4(Q,K);for(X=K;X--;)J[X]=Q[X]<V?Q[X]*3+1:(Q[X]-V)*3+2}for(X=K;X--;)z[J[X]]=X;z[Z]=-1,z[Z+1]=-2,Q=Z%3===1?[Z-1]:[];for(X=0;X<K;X++)if(J[X]%3===1)Q.push(J[X]-1);nW($,Q,0);for(X=0,W=0,U=0;X<K&&W<q;)H[U++]=iB($,z,J[X],Q[W])<0?J[X++]:Q[W++];while(X<K)H[U++]=J[X++];while(W<q)H[U++]=Q[W++];return H},oW=function($){var Z=$.length,J=Z%3,Q=new Array(Z+J),K,q;if(typeof $!=="string"){var V=Object.create(null);for(q=0;q<Z;q++)if(!V[$[q]])V[$[q]]=!0;var X=Object.create(null),W=Object.keys(V).sort();for(q=0,K=W.length;q<K;q++)X[W[q]]=q+1;for(q=0;q<Z;q++)Q[q]=X[$[q]]}else for(q=0;q<Z;q++)Q[q]=$.charCodeAt(q);for(q=Z;q<Z+J;q++)Q[q]=0;return Q},W6=function($){this.hasArbitrarySequence=typeof $!=="string",this.string=$,this.length=$.length,this.array=R4(oW($),this.length)},U6=function($){if(this.hasArbitrarySequence=typeof $[0]!=="string",this.size=$.length,this.hasArbitrarySequence){this.text=[];for(var Z=0,J=this.size;Z<J;Z++)if(this.text.push.apply(this.text,$[Z]),Z<J-1)this.text.push(lW)}else this.text=$.join(lW);this.firstLength=$[0].length,this.length=this.text.length,this.array=R4(oW(this.text),this.length)},lW="\x01";W6.prototype.toString=function(){return this.array.join(",")};W6.prototype.toJSON=function(){return this.array};W6.prototype.inspect=function(){var $=new Array(this.length);for(var Z=0;Z<this.length;Z++)$[Z]=this.string.slice(this.array[Z]);return Object.defineProperty($,"constructor",{value:W6,enumerable:!1}),$};if(typeof Symbol!=="undefined")W6.prototype[Symbol.for("nodejs.util.inspect.custom")]=W6.prototype.inspect;U6.prototype.longestCommonSubsequence=function(){var $=this.hasArbitrarySequence?[]:"",Z,J,Q,K,q;for(J=1;J<this.length;J++){if(K=this.array[J],q=this.array[J-1],K<this.firstLength&&q<this.firstLength)continue;if(K>this.firstLength&&q>this.firstLength)continue;Z=Math.min(this.length-K,this.length-q);for(Q=0;Q<Z;Q++)if(this.text[K+Q]!==this.text[q+Q]){Z=Q;break}if(Z>$.length)$=this.text.slice(K,K+Z)}return $};U6.prototype.toString=function(){return this.array.join(",")};U6.prototype.toJSON=function(){return this.array};U6.prototype.inspect=function(){var $=new Array(this.length);for(var Z=0;Z<this.length;Z++)$[Z]=this.text.slice(this.array[Z]);return Object.defineProperty($,"constructor",{value:U6,enumerable:!1}),$};if(typeof Symbol!=="undefined")U6.prototype[Symbol.for("nodejs.util.inspect.custom")]=U6.prototype.inspect;W6.GeneralizedSuffixArray=U6;sW.exports=W6});var $U=E((ud,eW)=>{var K8=function($){this.size=0,this.items=new Map,this.inverse=$},v$=function(){this.size=0,this.items=new Map,this.inverse=new K8(this)},aW=function(){this.size=0,this.items.clear(),this.inverse.items.clear()},rW=function($,Z){if(this.items.has($)){var J=this.items.get($);if(J===Z)return this;else this.inverse.items.delete(J)}if(this.inverse.items.has(Z)){var Q=this.inverse.items.get(Z);if(Q===$)return this;else this.items.delete(Q)}return this.items.set($,Z),this.inverse.items.set(Z,$),this.size=this.items.size,this.inverse.size=this.inverse.items.size,this},tW=function($){if(this.items.has($)){var Z=this.items.get($);return this.items.delete($),this.inverse.items.delete(Z),this.size=this.items.size,this.inverse.size=this.inverse.items.size,!0}return!1},aB=C0();v$.prototype.clear=aW;K8.prototype.clear=aW;v$.prototype.set=rW;K8.prototype.set=rW;v$.prototype.delete=tW;K8.prototype.delete=tW;var rB=["has","get","forEach","keys","values","entries"];rB.forEach(function($){v$.prototype[$]=K8.prototype[$]=function(){return Map.prototype[$].apply(this.items,arguments)}});if(typeof Symbol!=="undefined")v$.prototype[Symbol.iterator]=v$.prototype.entries,K8.prototype[Symbol.iterator]=K8.prototype.entries;v$.prototype.inspect=function(){var $={left:this.items,right:this.inverse.items};return Object.defineProperty($,"constructor",{value:v$,enumerable:!1}),$};if(typeof Symbol!=="undefined")v$.prototype[Symbol.for("nodejs.util.inspect.custom")]=v$.prototype.inspect;K8.prototype.inspect=function(){var $={left:this.inverse.items,right:this.items};return Object.defineProperty($,"constructor",{value:K8,enumerable:!1}),$};if(typeof Symbol!=="undefined")K8.prototype[Symbol.for("nodejs.util.inspect.custom")]=K8.prototype.inspect;v$.from=function($){var Z=new v$;return aB($,function(J,Q){Z.set(Q,J)}),Z};eW.exports=v$});var d0=E((dd,ZU)=>{var N8=function($){if(typeof $!=="function")throw new Error("obliterator/iterator: expecting a function!");this.next=$};if(typeof Symbol!=="undefined")N8.prototype[Symbol.iterator]=function(){return this};N8.of=function(){var $=arguments,Z=$.length,J=0;return new N8(function(){if(J>=Z)return{done:!0};return{done:!1,value:$[J++]}})};N8.empty=function(){var $=new N8(function(){return{done:!0}});return $};N8.fromSequence=function($){var Z=0,J=$.length;return new N8(function(){if(Z>=J)return{done:!0};return{done:!1,value:$[Z++]}})};N8.is=function($){if($ instanceof N8)return!0;return typeof $==="object"&&$!==null&&typeof $.next==="function"};ZU.exports=N8});var D4=E((tB)=>{var QU=function($){return $|=$>>1,$|=$>>2,$|=$>>4,$|=$>>8,$|=$>>16,$&~($>>1)},P4=function($){return $|=$>>1,$|=$>>2,$|=$>>4,$&~($>>1)};tB.msb32=QU;tB.msb8=P4;tB.test=function($,Z){return $>>Z&1};tB.criticalBit8=function($,Z){return P4($^Z)};tB.criticalBit8Mask=function($,Z){return~P4($^Z)>>>0&255};tB.testCriticalBit8=function($,Z){return 1+($|Z)>>8};tB.criticalBit32Mask=function($,Z){return~QU($^Z)>>>0&4294967295};tB.popcount=function($){return $-=$>>1&1431655765,$=($&858993459)+($>>2&858993459),$=$+($>>4)&252645135,$+=$>>8,$+=$>>16,$&127};var I7=new Uint8Array(Math.pow(2,8));for(o5=0,JU=I7.length;o5<JU;o5++)I7[o5]=tB.popcount(o5);var o5,JU;tB.table8Popcount=function($){return I7[$&255]+I7[$>>8&255]+I7[$>>16&255]+I7[$>>24&255]}});var WU=E((nd,XU)=>{var f0=function($){this.length=$,this.clear()},VU=d0(),qU=D4();f0.prototype.clear=function(){this.size=0,this.array=new Uint32Array(Math.ceil(this.length/32))};f0.prototype.set=function($,Z){var J=$>>5,Q=$&31,K=this.array[J],q;if(Z===0||Z===!1)q=this.array[J]&=~(1<<Q);else q=this.array[J]|=1<<Q;if(q=q>>>0,q>K)this.size++;else if(q<K)this.size--;return this};f0.prototype.reset=function($){var Z=$>>5,J=$&31,Q=this.array[Z],K;if(K=this.array[Z]&=~(1<<J),K<Q)this.size--;return this};f0.prototype.flip=function($){var Z=$>>5,J=$&31,Q=this.array[Z],K=this.array[Z]^=1<<J;if(K=K>>>0,K>Q)this.size++;else if(K<Q)this.size--;return this};f0.prototype.get=function($){var Z=$>>5,J=$&31;return this.array[Z]>>J&1};f0.prototype.test=function($){return Boolean(this.get($))};f0.prototype.rank=function($){if(this.size===0)return 0;var Z=$>>5,J=$&31,Q=0;for(var K=0;K<Z;K++)Q+=qU.table8Popcount(this.array[K]);var q=this.array[Z]&(1<<J)-1;return Q+=qU.table8Popcount(q),Q};f0.prototype.select=function($){if(this.size===0)return-1;if($>=this.length)return-1;var Z,J=32,Q=0,K=0;for(var q=0,V=this.array.length;q<V;q++){if(Z=this.array[q],Z===0)continue;if(q===V-1)J=this.length%32||32;for(var X=0;X<J;X++,Q++)if(K+=Z>>X&1,K===$)return Q}};f0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;var J=this.length,Q,K,q=32;for(var V=0,X=this.array.length;V<X;V++){if(Q=this.array[V],V===X-1)q=J%32||32;for(var W=0;W<q;W++)K=Q>>W&1,$.call(Z,K,V*32+W)}};f0.prototype.values=function(){var $=this.length,Z=!1,J,Q,K=this.array,q=K.length,V=0,X=-1,W=32;return new VU(function U(){if(!Z){if(V>=q)return{done:!0};if(V===q-1)W=$%32||32;J=K[V++],Z=!0,X=-1}if(X++,X>=W)return Z=!1,U();return Q=J>>X&1,{value:Q}})};f0.prototype.entries=function(){var $=this.length,Z=!1,J,Q,K=this.array,q,V=K.length,X=0,W=-1,U=32;return new VU(function z(){if(!Z){if(X>=V)return{done:!0};if(X===V-1)U=$%32||32;J=K[X++],Z=!0,W=-1}if(W++,q=~-X*32+W,W>=U)return Z=!1,z();return Q=J>>W&1,{value:[q,Q]}})};if(typeof Symbol!=="undefined")f0.prototype[Symbol.iterator]=f0.prototype.values;f0.prototype.inspect=function(){var $=new Uint8Array(this.length);return this.forEach(function(Z,J){$[J]=Z}),Object.defineProperty($,"constructor",{value:f0,enumerable:!1}),$};if(typeof Symbol!=="undefined")f0.prototype[Symbol.for("nodejs.util.inspect.custom")]=f0.prototype.inspect;f0.prototype.toJSON=function(){return Array.from(this.array)};XU.exports=f0});var GU=E((od,HU)=>{var WF=function($){return new Uint32Array(Math.ceil($/32))},L0=function($){var Z=$||0,J=XF;if(typeof $==="object")Z=$.initialLength||$.initialCapacity||0,J=$.policy||J;this.size=0,this.length=Z,this.capacity=Math.ceil(this.length/32)*32,this.policy=J,this.array=WF(this.capacity)},zU=d0(),UU=D4(),XF=function($){return Math.max(1,Math.ceil($*1.5))};L0.prototype.set=function($,Z){if(this.length<$)throw new Error("BitVector.set: index out of bounds.");var J=$>>5,Q=$&31,K=this.array[J],q;if(Z===0||Z===!1)q=this.array[J]&=~(1<<Q);else q=this.array[J]|=1<<Q;if(q=q>>>0,q>K)this.size++;else if(q<K)this.size--;return this};L0.prototype.reset=function($){var Z=$>>5,J=$&31,Q=this.array[Z],K;if(K=this.array[Z]&=~(1<<J),K<Q)this.size--;return this};L0.prototype.flip=function($){var Z=$>>5,J=$&31,Q=this.array[Z],K=this.array[Z]^=1<<J;if(K=K>>>0,K>Q)this.size++;else if(K<Q)this.size--;return this};L0.prototype.applyPolicy=function($){var Z=this.policy($||this.capacity);if(typeof Z!=="number"||Z<0)throw new Error("mnemonist/bit-vector.applyPolicy: policy returned an invalid value (expecting a positive integer).");if(Z<=this.capacity)throw new Error("mnemonist/bit-vector.applyPolicy: policy returned a less or equal capacity to allocate.");return Math.ceil(Z/32)*32};L0.prototype.reallocate=function($){var Z=$;if($=Math.ceil($/32)*32,Z<this.length)this.length=Z;if($===this.capacity)return this;var J=this.array,Q=$/32;if(Q===this.array.length)return this;if(Q>this.array.length)this.array=new Uint32Array(Q),this.array.set(J,0);else this.array=J.slice(0,Q);return this.capacity=$,this};L0.prototype.grow=function($){var Z;if(typeof $==="number"){if(this.capacity>=$)return this;Z=this.capacity;while(Z<$)Z=this.applyPolicy(Z);return this.reallocate(Z),this}return Z=this.applyPolicy(),this.reallocate(Z),this};L0.prototype.resize=function($){if($===this.length)return this;if($<this.length)return this.length=$,this;return this.length=$,this.reallocate($),this};L0.prototype.push=function($){if(this.capacity===this.length)this.grow();if($===0||$===!1)return++this.length;this.size++;var Z=this.length++,J=Z>>5,Q=Z&31;return this.array[J]|=1<<Q,this.length};L0.prototype.pop=function(){if(this.length===0)return;var $=--this.length,Z=$>>5,J=$&31;return this.array[Z]>>J&1};L0.prototype.get=function($){if(this.length<$)return;var Z=$>>5,J=$&31;return this.array[Z]>>J&1};L0.prototype.test=function($){if(this.length<$)return!1;return Boolean(this.get($))};L0.prototype.rank=function($){if(this.size===0)return 0;var Z=$>>5,J=$&31,Q=0;for(var K=0;K<Z;K++)Q+=UU.table8Popcount(this.array[K]);var q=this.array[Z]&(1<<J)-1;return Q+=UU.table8Popcount(q),Q};L0.prototype.select=function($){if(this.size===0)return-1;if($>=this.length)return-1;var Z,J=32,Q=0,K=0;for(var q=0,V=this.array.length;q<V;q++){if(Z=this.array[q],Z===0)continue;if(q===V-1)J=this.length%32||32;for(var X=0;X<J;X++,Q++)if(K+=Z>>X&1,K===$)return Q}};L0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;var J=this.length,Q,K,q=32;for(var V=0,X=this.array.length;V<X;V++){if(Q=this.array[V],V===X-1)q=J%32||32;for(var W=0;W<q;W++)K=Q>>W&1,$.call(Z,K,V*32+W)}};L0.prototype.values=function(){var $=this.length,Z=!1,J,Q,K=this.array,q=K.length,V=0,X=-1,W=32;return new zU(function U(){if(!Z){if(V>=q)return{done:!0};if(V===q-1)W=$%32||32;J=K[V++],Z=!0,X=-1}if(X++,X>=W)return Z=!1,U();return Q=J>>X&1,{value:Q}})};L0.prototype.entries=function(){var $=this.length,Z=!1,J,Q,K=this.array,q,V=K.length,X=0,W=-1,U=32;return new zU(function z(){if(!Z){if(X>=V)return{done:!0};if(X===V-1)U=$%32||32;J=K[X++],Z=!0,W=-1}if(W++,q=~-X*32+W,W>=U)return Z=!1,z();return Q=J>>W&1,{value:[q,Q]}})};if(typeof Symbol!=="undefined")L0.prototype[Symbol.iterator]=L0.prototype.values;L0.prototype.inspect=function(){var $=new Uint8Array(this.length);return this.forEach(function(Z,J){$[J]=Z}),Object.defineProperty($,"constructor",{value:L0,enumerable:!1}),$};if(typeof Symbol!=="undefined")L0.prototype[Symbol.for("nodejs.util.inspect.custom")]=L0.prototype.inspect;L0.prototype.toJSON=function(){return Array.from(this.array.slice(0,(this.length>>5)+1))};HU.exports=L0});var wU=E((sd,YU)=>{var p6=function($,Z){return($&65535)*Z+((($>>>16)*Z&65535)<<16)&4294967295},UF=function($,Z){return($&65535)+(Z>>>16)+((($>>>16)+Z&65535)<<16)&4294967295},A4=function($,Z){return $<<Z|$>>>32-Z};YU.exports=function $(Z,J){var Q=3432918353,K=461845907,q=15,V=13,X=5,W=1801774676,U=Z,z,H,G;for(H=0,G=J.length-4;H<=G;H+=4)z=J[H]|J[H+1]<<8|J[H+2]<<16|J[H+3]<<24,z=p6(z,Q),z=A4(z,q),z=p6(z,K),U^=z,U=A4(U,V),U=p6(U,X),U=UF(U,W);switch(z=0,J.length&3){case 3:z^=J[H+2]<<16;case 2:z^=J[H+1]<<8;case 1:z^=J[H],z=p6(z,Q),z=A4(z,q),z=p6(z,K),U^=z;default:}return U^=J.length,U^=U>>>16,U=p6(U,2246822507),U^=U>>>13,U=p6(U,3266489909),U^=U>>>16,U>>>0}});var NU=E((id,FU)=>{var jU=function($){var Z=new Uint16Array($.length),J,Q;for(J=0,Q=$.length;J<Q;J++)Z[J]=$.charCodeAt(J);return Z},BU=function($,Z,J){var Q=zF(Z*4221880213&4294967295,J);return Q%($*8)},u6=function($){var Z={};if(!$)throw new Error("mnemonist/BloomFilter.constructor: a BloomFilter must be created with a capacity.");if(typeof $==="object")Z=$;else Z.capacity=$;if(typeof Z.capacity!=="number"||Z.capacity<=0)throw new Error("mnemonist/BloomFilter.constructor: `capacity` option should be a positive integer.");if(this.capacity=Z.capacity,this.errorRate=Z.errorRate||YF.errorRate,typeof this.errorRate!=="number"||Z.errorRate<=0)throw new Error("mnemonist/BloomFilter.constructor: `errorRate` option should be a positive float.");this.clear()},zF=wU(),HF=C0(),GF=Math.LN2*Math.LN2,YF={errorRate:0.005};u6.prototype.clear=function(){var $=-1/GF*this.capacity*Math.log(this.errorRate),Z=$/8|0;this.hashFunctions=Z*8/this.capacity*Math.LN2|0,this.data=new Uint8Array(Z);return};u6.prototype.add=function($){var Z=jU($);for(var J=0,Q=this.hashFunctions;J<Q;J++){var K=BU(this.data.length,J,Z),q=1<<(7&K);this.data[K>>3]|=q}return this};u6.prototype.test=function($){var Z=jU($);for(var J=0,Q=this.hashFunctions;J<Q;J++){var K=BU(this.data.length,J,Z);if(!(this.data[K>>3]&1<<(7&K)))return!1}return!0};u6.prototype.toJSON=function(){return this.data};u6.from=function($,Z){if(!Z){if(Z=$.length||$.size,typeof Z!=="number")throw new Error("BloomFilter.from: could not infer the filter\'s capacity. Try passing it as second argument.")}var J=new u6(Z);return HF($,function(Q){J.add(Q)}),J};FU.exports=u6});var LU=E((ad,CU)=>{var q8=function($){if(typeof $!=="function")throw new Error("mnemonist/BKTree.constructor: given `distance` should be a function.");this.distance=$,this.clear()},wF=C0();q8.prototype.add=function($){if(!this.root)return this.root={item:$,children:{}},this.size++,this;var Z=this.root,J;while(!0){if(J=this.distance($,Z.item),!Z.children[J])break;Z=Z.children[J]}return Z.children[J]={item:$,children:{}},this.size++,this};q8.prototype.search=function($,Z){if(!this.root)return[];var J=[],Q=[this.root],K,q,V,X,W;while(Q.length){if(K=Q.pop(),V=this.distance(Z,K.item),V<=$)J.push({item:K.item,distance:V});for(X=V-$,W=V+$+1;X<W;X++)if(q=K.children[X],q)Q.push(q)}return J};q8.prototype.clear=function(){this.size=0,this.root=null};q8.prototype.toJSON=function(){return this.root};q8.prototype.inspect=function(){var $=[],Z=[this.root],J,Q;while(Z.length){if(J=Z.pop(),!J)continue;$.push(J.item);for(Q in J.children)Z.push(J.children[Q])}return Object.defineProperty($,"constructor",{value:q8,enumerable:!1}),$};if(typeof Symbol!=="undefined")q8.prototype[Symbol.for("nodejs.util.inspect.custom")]=q8.prototype.inspect;q8.from=function($,Z){var J=new q8(Z);return wF($,function(Q){J.add(Q)}),J};CU.exports=q8});var k4=E((rd,OU)=>{var M0=function($,Z){if(arguments.length<2)throw new Error("mnemonist/fixed-deque: expecting an Array class and a capacity.");if(typeof Z!=="number"||Z<=0)throw new Error("mnemonist/fixed-deque: `capacity` should be a positive number.");this.ArrayClass=$,this.capacity=Z,this.items=new $(this.capacity),this.clear()},M4=A$(),_U=d0();M0.prototype.clear=function(){this.start=0,this.size=0};M0.prototype.push=function($){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.push: deque capacity ("+this.capacity+") exceeded!");var Z=(this.start+this.size)%this.capacity;return this.items[Z]=$,++this.size};M0.prototype.unshift=function($){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.unshift: deque capacity ("+this.capacity+") exceeded!");var Z=this.start-1;if(this.start===0)Z=this.capacity-1;return this.items[Z]=$,this.start=Z,++this.size};M0.prototype.pop=function(){if(this.size===0)return;const $=(this.start+this.size-1)%this.capacity;return this.size--,this.items[$]};M0.prototype.shift=function(){if(this.size===0)return;var $=this.start;if(this.size--,this.start++,this.start===this.capacity)this.start=0;return this.items[$]};M0.prototype.peekFirst=function(){if(this.size===0)return;return this.items[this.start]};M0.prototype.peekLast=function(){if(this.size===0)return;var $=this.start+this.size-1;if($>this.capacity)$-=this.capacity;return this.items[$]};M0.prototype.get=function($){if(this.size===0)return;if($=this.start+$,$>this.capacity)$-=this.capacity;return this.items[$]};M0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;var J=this.capacity,Q=this.size,K=this.start,q=0;while(q<Q)if($.call(Z,this.items[K],q,this),K++,q++,K===J)K=0};M0.prototype.toArray=function(){var $=this.start+this.size;if($<this.capacity)return this.items.slice(this.start,$);var Z=new this.ArrayClass(this.size),J=this.capacity,Q=this.size,K=this.start,q=0;while(q<Q)if(Z[q]=this.items[K],K++,q++,K===J)K=0;return Z};M0.prototype.values=function(){var $=this.items,Z=this.capacity,J=this.size,Q=this.start,K=0;return new _U(function(){if(K>=J)return{done:!0};var q=$[Q];if(Q++,K++,Q===Z)Q=0;return{value:q,done:!1}})};M0.prototype.entries=function(){var $=this.items,Z=this.capacity,J=this.size,Q=this.start,K=0;return new _U(function(){if(K>=J)return{done:!0};var q=$[Q];if(Q++,Q===Z)Q=0;return{value:[K++,q],done:!1}})};if(typeof Symbol!=="undefined")M0.prototype[Symbol.iterator]=M0.prototype.values;M0.prototype.inspect=function(){var $=this.toArray();return $.type=this.ArrayClass.name,$.capacity=this.capacity,Object.defineProperty($,"constructor",{value:M0,enumerable:!1}),$};if(typeof Symbol!=="undefined")M0.prototype[Symbol.for("nodejs.util.inspect.custom")]=M0.prototype.inspect;M0.from=function($,Z,J){if(arguments.length<3){if(J=M4.guessLength($),typeof J!=="number")throw new Error("mnemonist/fixed-deque.from: could not guess iterable length. Please provide desired capacity as last argument.")}var Q=new M0(Z,J);if(M4.isArrayLike($)){var K,q;for(K=0,q=$.length;K<q;K++)Q.items[K]=$[K];return Q.size=q,Q}return M4.forEach($,function(V){Q.push(V)}),Q};OU.exports=M0});var PU=E((td,RU)=>{var R7=function($,Z){if(arguments.length<2)throw new Error("mnemonist/circular-buffer: expecting an Array class and a capacity.");if(typeof Z!=="number"||Z<=0)throw new Error("mnemonist/circular-buffer: `capacity` should be a positive number.");this.ArrayClass=$,this.capacity=Z,this.items=new $(this.capacity),this.clear()},IU=function($){R7.prototype[$]=T4.prototype[$]},E4=A$(),T4=k4();Object.keys(T4.prototype).forEach(IU);if(typeof Symbol!=="undefined")Object.getOwnPropertySymbols(T4.prototype).forEach(IU);R7.prototype.push=function($){var Z=(this.start+this.size)%this.capacity;if(this.items[Z]=$,this.size===this.capacity)return this.start=(Z+1)%this.capacity,this.size;return++this.size};R7.prototype.unshift=function($){var Z=this.start-1;if(this.start===0)Z=this.capacity-1;if(this.items[Z]=$,this.size===this.capacity)return this.start=Z,this.size;return this.start=Z,++this.size};R7.from=function($,Z,J){if(arguments.length<3){if(J=E4.guessLength($),typeof J!=="number")throw new Error("mnemonist/circular-buffer.from: could not guess iterable length. Please provide desired capacity as last argument.")}var Q=new R7(Z,J);if(E4.isArrayLike($)){var K,q;for(K=0,q=$.length;K<q;K++)Q.items[K]=$[K];return Q.size=q,Q}return E4.forEach($,function(V){Q.push(V)}),Q};RU.exports=R7});var AU=E((ed,DU)=>{var t0=function($){if(typeof $!=="function")throw new Error("mnemonist/DefaultMap.constructor: expecting a function.");this.items=new Map,this.factory=$,this.size=0};t0.prototype.clear=function(){this.items.clear(),this.size=0};t0.prototype.get=function($){var Z=this.items.get($);if(typeof Z==="undefined")Z=this.factory($,this.size),this.items.set($,Z),this.size++;return Z};t0.prototype.peek=function($){return this.items.get($)};t0.prototype.set=function($,Z){return this.items.set($,Z),this.size=this.items.size,this};t0.prototype.has=function($){return this.items.has($)};t0.prototype.delete=function($){var Z=this.items.delete($);return this.size=this.items.size,Z};t0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this,this.items.forEach($,Z)};t0.prototype.entries=function(){return this.items.entries()};t0.prototype.keys=function(){return this.items.keys()};t0.prototype.values=function(){return this.items.values()};if(typeof Symbol!=="undefined")t0.prototype[Symbol.iterator]=t0.prototype.entries;t0.prototype.inspect=function(){return this.items};if(typeof Symbol!=="undefined")t0.prototype[Symbol.for("nodejs.util.inspect.custom")]=t0.prototype.inspect;t0.autoIncrement=function(){var $=0;return function(){return $++}};DU.exports=t0});var kU=E(($l,MU)=>{var C8=function($){if(typeof $!=="function")throw new Error("mnemonist/DefaultWeakMap.constructor: expecting a function.");this.items=new WeakMap,this.factory=$};C8.prototype.clear=function(){this.items=new WeakMap};C8.prototype.get=function($){var Z=this.items.get($);if(typeof Z==="undefined")Z=this.factory($),this.items.set($,Z);return Z};C8.prototype.peek=function($){return this.items.get($)};C8.prototype.set=function($,Z){return this.items.set($,Z),this};C8.prototype.has=function($){return this.items.has($)};C8.prototype.delete=function($){return this.items.delete($)};C8.prototype.inspect=function(){return this.items};if(typeof Symbol!=="undefined")C8.prototype[Symbol.for("nodejs.util.inspect.custom")]=C8.prototype.inspect;MU.exports=C8});var TU=E((Zl,EU)=>{var L8=function($){var Z=b4.getPointerArray($),J=b4.getPointerArray(Math.log2($));this.size=$,this.dimension=$,this.parents=new Z($),this.ranks=new J($);for(var Q=0;Q<$;Q++)this.parents[Q]=Q},b4=B$();L8.prototype.find=function($){var Z=$,J,Q;while(!0){if(J=this.parents[Z],Z===J)break;Z=J}while(!0){if(Q=this.parents[$],Q===Z)break;this.parents[$]=Z,$=Q}return Z};L8.prototype.union=function($,Z){var J=this.find($),Q=this.find(Z);if(J===Q)return this;this.dimension--;var K=this.ranks[$],q=this.ranks[Z];if(K<q)this.parents[J]=Q;else if(K>q)this.parents[Q]=J;else this.parents[Q]=J,this.ranks[J]++;return this};L8.prototype.connected=function($,Z){var J=this.find($);return J===this.find(Z)};L8.prototype.mapping=function(){var $=b4.getPointerArray(this.dimension),Z={},J=new $(this.size),Q=0,K;for(var q=0,V=this.parents.length;q<V;q++)if(K=this.find(q),typeof Z[K]==="undefined")J[q]=Q,Z[K]=Q++;else J[q]=Z[K];return J};L8.prototype.compile=function(){var $={},Z=new Array(this.dimension),J=0,Q;for(var K=0,q=this.parents.length;K<q;K++)if(Q=this.find(K),typeof $[Q]==="undefined")Z[J]=[K],$[Q]=J++;else Z[$[Q]].push(K);return Z};L8.prototype.inspect=function(){var $=this.compile();return Object.defineProperty($,"constructor",{value:L8,enumerable:!1}),$};if(typeof Symbol!=="undefined")L8.prototype[Symbol.for("nodejs.util.inspect.custom")]=L8.prototype.inspect;EU.exports=L8});var gZ=E((Jl,SU)=>{var FF=function($,Z,J,Q){var K=J,q=Q,V=Z[Q],X=2*Q+1,W;while(X<K){if(W=X+1,W<K&&$(Z[X],Z[W])>=0)X=W;Z[Q]=Z[X],Q=X,X=2*Q+1}Z[Q]=V,v4.siftDown($,Z,q,Q)},vU=function($,Z,J,Q){var K=Q,q=K,V=new $(Q),X,W;while(q>0){if(X=J[--q],q!==0)W=J[0],J[0]=X,FF(Z,J,--Q,0),X=W;V[q]=X}return V},_8=function($,Z,J){if(arguments.length===2)J=Z,Z=null;if(this.ArrayClass=$,this.capacity=J,this.items=new $(J),this.clear(),this.comparator=Z||jF,typeof J!=="number"&&J<=0)throw new Error("mnemonist/FixedReverseHeap.constructor: capacity should be a number > 0.");if(typeof this.comparator!=="function")throw new Error("mnemonist/FixedReverseHeap.constructor: given comparator should be a function.");this.comparator=BF(this.comparator)},bU=l5(),v4=fZ(),jF=bU.DEFAULT_COMPARATOR,BF=bU.reverseComparator;_8.prototype.clear=function(){this.size=0};_8.prototype.push=function($){if(this.size<this.capacity)this.items[this.size]=$,v4.siftDown(this.comparator,this.items,0,this.size),this.size++;else if(this.comparator($,this.items[0])>0)v4.replace(this.comparator,this.items,$);return this.size};_8.prototype.peek=function(){return this.items[0]};_8.prototype.consume=function(){var $=vU(this.ArrayClass,this.comparator,this.items,this.size);return this.size=0,$};_8.prototype.toArray=function(){return vU(this.ArrayClass,this.comparator,this.items.slice(0,this.size),this.size)};_8.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:_8,enumerable:!1}),$};if(typeof Symbol!=="undefined")_8.prototype[Symbol.for("nodejs.util.inspect.custom")]=_8.prototype.inspect;SU.exports=_8});var yU=E((Ql,fU)=>{var q$=function($){if(this.items=new Map,this.clear(),Array.isArray($))this.writeHashFunction=$[0],this.readHashFunction=$[1];else this.writeHashFunction=$,this.readHashFunction=$;if(!this.writeHashFunction)this.writeHashFunction=hU;if(!this.readHashFunction)this.readHashFunction=hU;if(typeof this.writeHashFunction!=="function")throw new Error("mnemonist/FuzzyMap.constructor: invalid hash function given.");if(typeof this.readHashFunction!=="function")throw new Error("mnemonist/FuzzyMap.constructor: invalid hash function given.")},NF=C0(),hU=function($){return $};q$.prototype.clear=function(){this.items.clear(),this.size=0};q$.prototype.add=function($){var Z=this.writeHashFunction($);return this.items.set(Z,$),this.size=this.items.size,this};q$.prototype.set=function($,Z){return $=this.writeHashFunction($),this.items.set($,Z),this.size=this.items.size,this};q$.prototype.get=function($){return $=this.readHashFunction($),this.items.get($)};q$.prototype.has=function($){return $=this.readHashFunction($),this.items.has($)};q$.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this,this.items.forEach(function(J){$.call(Z,J,J)})};q$.prototype.values=function(){return this.items.values()};if(typeof Symbol!=="undefined")q$.prototype[Symbol.iterator]=q$.prototype.values;q$.prototype.inspect=function(){var $=Array.from(this.items.values());return Object.defineProperty($,"constructor",{value:q$,enumerable:!1}),$};if(typeof Symbol!=="undefined")q$.prototype[Symbol.for("nodejs.util.inspect.custom")]=q$.prototype.inspect;q$.from=function($,Z,J){var Q=new q$(Z);return NF($,function(K,q){if(J)Q.set(q,K);else Q.add(K)}),Q};fU.exports=q$});var S4=E((Kl,gU)=>{var j0=function($){this.Container=$||Array,this.items=new Map,this.clear(),Object.defineProperty(this.items,"constructor",{value:j0,enumerable:!1})},xZ=d0(),CF=C0();j0.prototype.clear=function(){this.size=0,this.dimension=0,this.items.clear()};j0.prototype.set=function($,Z){var J=this.items.get($),Q;if(!J)this.dimension++,J=new this.Container,this.items.set($,J);if(this.Container===Set){if(Q=J.size,J.add(Z),Q<J.size)this.size++}else J.push(Z),this.size++;return this};j0.prototype.delete=function($){var Z=this.items.get($);if(!Z)return!1;return this.size-=this.Container===Set?Z.size:Z.length,this.dimension--,this.items.delete($),!0};j0.prototype.remove=function($,Z){var J=this.items.get($),Q,K;if(!J)return!1;if(this.Container===Set){if(Q=J.delete(Z),Q)this.size--;if(J.size===0)this.items.delete($),this.dimension--;return Q}else{if(K=J.indexOf(Z),K===-1)return!1;if(this.size--,J.length===1)return this.items.delete($),this.dimension--,!0;return J.splice(K,1),!0}};j0.prototype.has=function($){return this.items.has($)};j0.prototype.get=function($){return this.items.get($)};j0.prototype.multiplicity=function($){var Z=this.items.get($);if(typeof Z==="undefined")return 0;return this.Container===Set?Z.size:Z.length};j0.prototype.count=j0.prototype.multiplicity;j0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;var J;function Q(K){$.call(Z,K,J)}this.items.forEach(function(K,q){J=q,K.forEach(Q)})};j0.prototype.forEachAssociation=function($,Z){Z=arguments.length>1?Z:this,this.items.forEach($,Z)};j0.prototype.keys=function(){return this.items.keys()};j0.prototype.values=function(){var $=this.items.values(),Z=!1,J,Q,K,q;if(this.Container===Set)return new xZ(function V(){if(!Z){if(Q=$.next(),Q.done)return{done:!0};Z=!0,J=Q.value.values()}if(Q=J.next(),Q.done)return Z=!1,V();return{done:!1,value:Q.value}});return new xZ(function V(){if(!Z){if(Q=$.next(),Q.done)return{done:!0};Z=!0,J=Q.value,K=0,q=J.length}if(K>=q)return Z=!1,V();return{done:!1,value:J[K++]}})};j0.prototype.entries=function(){var $=this.items.entries(),Z=!1,J,Q,K,q,V;if(this.Container===Set)return new xZ(function X(){if(!Z){if(Q=$.next(),Q.done)return{done:!0};Z=!0,K=Q.value[0],J=Q.value[1].values()}if(Q=J.next(),Q.done)return Z=!1,X();return{done:!1,value:[K,Q.value]}});return new xZ(function X(){if(!Z){if(Q=$.next(),Q.done)return{done:!0};Z=!0,K=Q.value[0],J=Q.value[1],q=0,V=J.length}if(q>=V)return Z=!1,X();return{done:!1,value:[K,J[q++]]}})};j0.prototype.containers=function(){return this.items.values()};j0.prototype.associations=function(){return this.items.entries()};if(typeof Symbol!=="undefined")j0.prototype[Symbol.iterator]=j0.prototype.entries;j0.prototype.inspect=function(){return this.items};if(typeof Symbol!=="undefined")j0.prototype[Symbol.for("nodejs.util.inspect.custom")]=j0.prototype.inspect;j0.prototype.toJSON=function(){return this.items};j0.from=function($,Z){var J=new j0(Z);return CF($,function(Q,K){J.set(K,Q)}),J};gU.exports=j0});var cU=E((ql,mU)=>{var V$=function($,Z){if(this.items=new LF(Z),this.clear(),Array.isArray($))this.writeHashFunction=$[0],this.readHashFunction=$[1];else this.writeHashFunction=$,this.readHashFunction=$;if(!this.writeHashFunction)this.writeHashFunction=xU;if(!this.readHashFunction)this.readHashFunction=xU;if(typeof this.writeHashFunction!=="function")throw new Error("mnemonist/FuzzyMultiMap.constructor: invalid hash function given.");if(typeof this.readHashFunction!=="function")throw new Error("mnemonist/FuzzyMultiMap.constructor: invalid hash function given.")},LF=S4(),_F=C0(),xU=function($){return $};V$.prototype.clear=function(){this.items.clear(),this.size=0,this.dimension=0};V$.prototype.add=function($){var Z=this.writeHashFunction($);return this.items.set(Z,$),this.size=this.items.size,this.dimension=this.items.dimension,this};V$.prototype.set=function($,Z){return $=this.writeHashFunction($),this.items.set($,Z),this.size=this.items.size,this.dimension=this.items.dimension,this};V$.prototype.get=function($){return $=this.readHashFunction($),this.items.get($)};V$.prototype.has=function($){return $=this.readHashFunction($),this.items.has($)};V$.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this,this.items.forEach(function(J){$.call(Z,J,J)})};V$.prototype.values=function(){return this.items.values()};if(typeof Symbol!=="undefined")V$.prototype[Symbol.iterator]=V$.prototype.values;V$.prototype.inspect=function(){var $=Array.from(this);return Object.defineProperty($,"constructor",{value:V$,enumerable:!1}),$};if(typeof Symbol!=="undefined")V$.prototype[Symbol.for("nodejs.util.inspect.custom")]=V$.prototype.inspect;V$.from=function($,Z,J,Q){if(arguments.length===3){if(typeof J==="boolean")Q=J,J=Array}var K=new V$(Z,J);return _F($,function(q,V){if(Q)K.set(V,q);else K.add(q)}),K};mU.exports=V$});var dU=E((Vl,uU)=>{var OF=function($){return($&$-1)===0},V8=function($,Z){if(arguments.length<1)throw new Error("mnemonist/hashed-array-tree: expecting at least a byte array constructor.");var J=Z||0,Q=pU,K=0;if(typeof Z==="object")J=Z.initialCapacity||0,K=Z.initialLength||0,Q=Z.blockSize||pU;if(!Q||!OF(Q))throw new Error("mnemonist/hashed-array-tree: block size should be a power of two.");var q=Math.max(K,J),V=Math.ceil(q/Q);this.ArrayClass=$,this.length=K,this.capacity=V*Q,this.blockSize=Q,this.offsetMask=Q-1,this.blockMask=Math.log2(Q),this.blocks=new Array(V);for(var X=0;X<V;X++)this.blocks[X]=new this.ArrayClass(this.blockSize)},pU=1024;V8.prototype.set=function($,Z){if(this.length<$)throw new Error("HashedArrayTree("+this.ArrayClass.name+").set: index out of bounds.");var J=$>>this.blockMask,Q=$&this.offsetMask;return this.blocks[J][Q]=Z,this};V8.prototype.get=function($){if(this.length<$)return;var Z=$>>this.blockMask,J=$&this.offsetMask;return this.blocks[Z][J]};V8.prototype.grow=function($){if(typeof $!=="number")$=this.capacity+this.blockSize;if(this.capacity>=$)return this;while(this.capacity<$)this.blocks.push(new this.ArrayClass(this.blockSize)),this.capacity+=this.blockSize;return this};V8.prototype.resize=function($){if($===this.length)return this;if($<this.length)return this.length=$,this;return this.length=$,this.grow($),this};V8.prototype.push=function($){if(this.capacity===this.length)this.grow();var Z=this.length,J=Z>>this.blockMask,Q=Z&this.offsetMask;return this.blocks[J][Q]=$,++this.length};V8.prototype.pop=function(){if(this.length===0)return;var $=this.blocks[this.blocks.length-1],Z=--this.length&this.offsetMask;return $[Z]};V8.prototype.inspect=function(){var $=new this.ArrayClass(this.length),Z;for(var J=0,Q=this.length;J<Q;J++)Z=J>>this.blockMask,$[J]=this.blocks[Z][J&this.offsetMask];return $.type=this.ArrayClass.name,$.items=this.length,$.capacity=this.capacity,$.blockSize=this.blockSize,Object.defineProperty($,"constructor",{value:V8,enumerable:!1}),$};if(typeof Symbol!=="undefined")V8.prototype[Symbol.for("nodejs.util.inspect.custom")]=V8.prototype.inspect;uU.exports=V8});var f4=E((Xl,nU)=>{var y0=function($,Z){if(arguments.length<2)throw new Error("mnemonist/fixed-stack: expecting an Array class and a capacity.");if(typeof Z!=="number"||Z<=0)throw new Error("mnemonist/fixed-stack: `capacity` should be a positive number.");this.capacity=Z,this.ArrayClass=$,this.items=new this.ArrayClass(this.capacity),this.clear()},lU=d0(),h4=A$();y0.prototype.clear=function(){this.size=0};y0.prototype.push=function($){if(this.size===this.capacity)throw new Error("mnemonist/fixed-stack.push: stack capacity ("+this.capacity+") exceeded!");return this.items[this.size++]=$,this.size};y0.prototype.pop=function(){if(this.size===0)return;return this.items[--this.size]};y0.prototype.peek=function(){return this.items[this.size-1]};y0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;for(var J=0,Q=this.items.length;J<Q;J++)$.call(Z,this.items[Q-J-1],J,this)};y0.prototype.toArray=function(){var $=new this.ArrayClass(this.size),Z=this.size-1,J=this.size;while(J--)$[J]=this.items[Z-J];return $};y0.prototype.values=function(){var $=this.items,Z=this.size,J=0;return new lU(function(){if(J>=Z)return{done:!0};var Q=$[Z-J-1];return J++,{value:Q,done:!1}})};y0.prototype.entries=function(){var $=this.items,Z=this.size,J=0;return new lU(function(){if(J>=Z)return{done:!0};var Q=$[Z-J-1];return{value:[J++,Q],done:!1}})};if(typeof Symbol!=="undefined")y0.prototype[Symbol.iterator]=y0.prototype.values;y0.prototype.toString=function(){return this.toArray().join(",")};y0.prototype.toJSON=function(){return this.toArray()};y0.prototype.inspect=function(){var $=this.toArray();return $.type=this.ArrayClass.name,$.capacity=this.capacity,Object.defineProperty($,"constructor",{value:y0,enumerable:!1}),$};if(typeof Symbol!=="undefined")y0.prototype[Symbol.for("nodejs.util.inspect.custom")]=y0.prototype.inspect;y0.from=function($,Z,J){if(arguments.length<3){if(J=h4.guessLength($),typeof J!=="number")throw new Error("mnemonist/fixed-stack.from: could not guess iterable length. Please provide desired capacity as last argument.")}var Q=new y0(Z,J);if(h4.isArrayLike($)){var K,q;for(K=0,q=$.length;K<q;K++)Q.items[K]=$[K];return Q.size=q,Q}return h4.forEach($,function(V){Q.push(V)}),Q};nU.exports=y0});var sU=E((Wl,oU)=>{var y4=function($,Z,J,Q,K,q,V,X){var W=V+(X-V)/2|0,U=~-W,z=-~W,H=J[W];Q[q]=H+1;var G=Z?Z($[H]):$[H][1],Y=q*2+1,w=q*2+2,j=(-Infinity),B=(-Infinity);if(V<=U)j=y4($,Z,J,Q,K,Y,V,U);if(z<=X)B=y4($,Z,J,Q,K,w,z,X);var C=Math.max(G,j,B),N=H;if(C===j)N=K[Q[Y]-1];else if(C===B)N=K[Q[w]-1];return K[H]=N,C},O8=function($,Z){this.size=$.length,this.intervals=$;var J=null,Q=null;if(Array.isArray(Z))J=Z[0],Q=Z[1];var K=$.length,q=RF.getPointerArray(K+1),V=new q(K),X;for(X=1;X<K;X++)V[X]=X;V.sort(function(G,Y){if(G=$[G],Y=$[Y],J)G=J(G),Y=J(Y);else G=G[0],Y=Y[0];if(G<Y)return-1;if(G>Y)return 1;return 0});var W=Math.ceil(Math.log2(K+1)),U=Math.pow(2,W)-1,z=new q(U),H=new q(K);y4($,Q,V,z,H,0,0,K-1),V=null,this.height=W,this.tree=z,this.augmentations=H,this.startGetter=J,this.endGetter=Q,this.stack=new PF(q,this.height)},IF=A$(),RF=B$(),PF=f4();O8.prototype.intervalsContainingPoint=function($){var Z=[],J=this.stack;J.clear(),J.push(0);var Q=this.tree.length,K,q,V,X,W,U,z,H,G;while(J.size){if(K=J.pop(),q=this.tree[K]-1,V=this.intervals[q],X=this.intervals[this.augmentations[q]],z=this.endGetter?this.endGetter(X):X[1],$>z)continue;if(H=K*2+1,H<Q&&this.tree[H]!==0)J.push(H);if(W=this.startGetter?this.startGetter(V):V[0],U=this.endGetter?this.endGetter(V):V[1],$>=W&&$<=U)Z.push(V);if($<W)continue;if(G=K*2+2,G<Q&&this.tree[G]!==0)J.push(G)}return Z};O8.prototype.intervalsOverlappingInterval=function($){var Z=this.startGetter?this.startGetter($):$[0],J=this.endGetter?this.endGetter($):$[1],Q=[],K=this.stack;K.clear(),K.push(0);var q=this.tree.length,V,X,W,U,z,H,G,Y,w;while(K.size){if(V=K.pop(),X=this.tree[V]-1,W=this.intervals[X],U=this.intervals[this.augmentations[X]],G=this.endGetter?this.endGetter(U):U[1],Z>G)continue;if(Y=V*2+1,Y<q&&this.tree[Y]!==0)K.push(Y);if(z=this.startGetter?this.startGetter(W):W[0],H=this.endGetter?this.endGetter(W):W[1],J>=z&&Z<=H)Q.push(W);if(J<z)continue;if(w=V*2+2,w<q&&this.tree[w]!==0)K.push(w)}return Q};O8.prototype.inspect=function(){var $=this.intervals.slice();return Object.defineProperty($,"constructor",{value:O8,enumerable:!1}),$};if(typeof Symbol!=="undefined")O8.prototype[Symbol.for("nodejs.util.inspect.custom")]=O8.prototype.inspect;O8.from=function($,Z){if(IF.isArrayLike($))return new O8($,Z);return new O8(Array.from($),Z)};oU.exports=O8});var g4=E((DF)=>{DF.search=function($,Z,J,Q){var K=0;J=typeof J!=="undefined"?J:0,Q=typeof Q!=="undefined"?Q:$.length,Q--;var q;while(J<=Q)if(K=J+Q>>>1,q=$[K],q>Z)Q=~-K;else if(q<Z)J=-~K;else return K;return-1};DF.searchWithComparator=function($,Z,J){var Q=0,K=0,q=~-Z.length,V;while(K<=q)if(Q=K+q>>>1,V=$(Z[Q],J),V>0)q=~-Q;else if(V<0)K=-~Q;else return Q;return-1};DF.lowerBound=function($,Z,J,Q){var K=0;J=typeof J!=="undefined"?J:0,Q=typeof Q!=="undefined"?Q:$.length;while(J<Q)if(K=J+Q>>>1,Z<=$[K])Q=K;else J=-~K;return J};DF.lowerBoundWithComparator=function($,Z,J){var Q=0,K=0,q=Z.length;while(K<q)if(Q=K+q>>>1,$(J,Z[Q])<=0)q=Q;else K=-~Q;return K};DF.lowerBoundIndices=function($,Z,J,Q,K){var q=0;Q=typeof Q!=="undefined"?Q:0,K=typeof K!=="undefined"?K:$.length;while(Q<K)if(q=Q+K>>>1,J<=$[Z[q]])K=q;else Q=-~q;return Q};DF.upperBound=function($,Z,J,Q){var K=0;J=typeof J!=="undefined"?J:0,Q=typeof Q!=="undefined"?Q:$.length;while(J<Q)if(K=J+Q>>>1,Z>=$[K])J=-~K;else Q=K;return J};DF.upperBoundWithComparator=function($,Z,J){var Q=0,K=0,q=Z.length;while(K<q)if(Q=K+q>>>1,$(J,Z[Q])>=0)K=-~Q;else q=Q;return K}});var $2=E((fF)=>{var aU=function($,Z){if($.length===0)return Z.slice();if(Z.length===0)return $.slice();var J;if($[0]>Z[0])J=$,$=Z,Z=J;var Q=$[$.length-1],K=Z[0];if(Q<=K){if(P7.isTypedArray($))return P7.concat($,Z);return $.concat(Z)}var q=new $.constructor($.length+Z.length),V,X,W;for(V=0,X=$.length;V<X;V++)if(W=$[V],W<=K)q[V]=W;else break;var U=V,z=$.length,H=0,G=Z.length,Y,w;while(U<z&&H<G)if(Y=$[U],w=Z[H],Y<=w)q[V++]=Y,U++;else q[V++]=w,H++;while(U<z)q[V++]=$[U++];while(H<G)q[V++]=Z[H++];return q},rU=function($,Z){if($.length===0)return Z.slice();if(Z.length===0)return $.slice();var J;if($[0]>Z[0])J=$,$=Z,Z=J;var Q=$[$.length-1],K=Z[0];if(Q<K){if(P7.isTypedArray($))return P7.concat($,Z);return $.concat(Z)}var q=new $.constructor,V,X,W;for(V=0,X=$.length;V<X;V++)if(W=$[V],W<K)q.push(W);else break;var U=V,z=$.length,H=0,G=Z.length,Y,w;while(U<z&&H<G)if(Y=$[U],w=Z[H],Y<=w){if(q.length===0||q[q.length-1]!==Y)q.push(Y);U++}else{if(q.length===0||q[q.length-1]!==w)q.push(w);H++}while(U<z)if(Y=$[U++],q.length===0||q[q.length-1]!==Y)q.push(Y);while(H<G)if(w=Z[H++],q.length===0||q[q.length-1]!==w)q.push(w);return q},SF=function($){var Z=0,J=(-Infinity),Q,K,q,V=[];for(K=0,q=$.length;K<q;K++){if(Q=$[K].length,Q===0)continue;if(V.push($[K]),Z+=Q,Q>J)J=Q}if(V.length===0)return new $[0].constructor(0);if(V.length===1)return V[0].slice();if(V.length===2)return aU(V[0],V[1]);$=V;var X=new $[0].constructor(Z),W=P7.getPointerArray(J),U=new W($.length),z=new iU(function(Y,w){if(Y=$[Y][U[Y]],w=$[w][U[w]],Y<w)return-1;if(Y>w)return 1;return 0});for(K=0;K<q;K++)z.push(K);K=0;var H,G;while(z.size)if(H=z.pop(),G=$[H][U[H]++],X[K++]=G,U[H]<$[H].length)z.push(H);return X},hF=function($){var Z=(-Infinity),J,Q,K,q=[];for(Q=0,K=$.length;Q<K;Q++){if(J=$[Q].length,J===0)continue;if(q.push($[Q]),J>Z)Z=J}if(q.length===0)return new $[0].constructor(0);if(q.length===1)return q[0].slice();if(q.length===2)return rU(q[0],q[1]);$=q;var V=new $[0].constructor,X=P7.getPointerArray(Z),W=new X($.length),U=new iU(function(G,Y){if(G=$[G][W[G]],Y=$[Y][W[Y]],G<Y)return-1;if(G>Y)return 1;return 0});for(Q=0;Q<K;Q++)U.push(Q);var z,H;while(U.size){if(z=U.pop(),H=$[z][W[z]++],V.length===0||V[V.length-1]!==H)V.push(H);if(W[z]<$[z].length)U.push(z)}return V},P7=B$(),D7=A$().isArrayLike,d6=g4(),iU=I4();fF.intersectionUniqueArrays=function($,Z){if($.length===0||Z.length===0)return new $.constructor(0);var J;if($[0]>Z[0])J=$,$=Z,Z=J;var Q=$[$.length-1],K=Z[0];if(Q<K)return new $.constructor(0);var q=new $.constructor,V=d6.lowerBound($,K),X=$.length,W=0,U=d6.upperBound(Z,Q),z,H;while(V<X&&W<U)if(z=$[V],H=Z[W],z<H)V=d6.lowerBound($,H,V+1);else if(z>H)W=d6.lowerBound(Z,z,W+1);else q.push(z),V++,W++;return q};fF.kWayIntersectionUniqueArrays=function($){var Z=(-Infinity),J=(-Infinity),Q=Infinity,K,q,V,X,W;for(X=0,W=$.length;X<W;X++){if(V=$[X].length,V===0)return[];if(V>Z)Z=V;if(K=$[X][0],q=$[X][V-1],K>J)J=K;if(q<Q)Q=q}if(J>Q)return[];if(J===Q)return[J];var U,z,H=$[0],G,Y,w,j,B,C,N=J;for(X=1;X<W;X++){U=H,z=$[X],H=new Array,G=0,Y=d6.lowerBound(z,N),w=U.length,j=z.length;while(G<w&&Y<j)if(B=U[G],C=z[Y],B<C)G=d6.lowerBound(U,C,G+1);else if(B>C)Y=d6.lowerBound(z,B,Y+1);else H.push(B),G++,Y++;if(H.length===0)return H;N=H[0]}return H};fF.merge=function(){if(arguments.length===2){if(D7(arguments[0]))return aU(arguments[0],arguments[1])}else if(D7(arguments[0]))return SF(arguments);return null};fF.unionUnique=function(){if(arguments.length===2){if(D7(arguments[0]))return rU(arguments[0],arguments[1])}else if(D7(arguments[0]))return hF(arguments);return null};fF.intersectionUnique=function(){if(arguments.length===2){if(D7(arguments[0]))return fF.intersectionUniqueArrays(arguments[0],arguments[1])}else if(D7(arguments[0]))return fF.kWayIntersectionUniqueArrays(arguments);return null}});var Q2=E((Hl,J2)=>{var Z2=function($){return $},N$=function($){if(this.clear(),Array.isArray($))this.documentTokenizer=$[0],this.queryTokenizer=$[1];else this.documentTokenizer=$,this.queryTokenizer=$;if(!this.documentTokenizer)this.documentTokenizer=Z2;if(!this.queryTokenizer)this.queryTokenizer=Z2;if(typeof this.documentTokenizer!=="function")throw new Error("mnemonist/InvertedIndex.constructor: document tokenizer is not a function.");if(typeof this.queryTokenizer!=="function")throw new Error("mnemonist/InvertedIndex.constructor: query tokenizer is not a function.")},mF=d0(),cF=C0(),pF=$2();N$.prototype.clear=function(){this.items=[],this.mapping=new Map,this.size=0,this.dimension=0};N$.prototype.add=function($){this.size++;var Z=this.items.length;this.items.push($);var J=this.documentTokenizer($);if(!Array.isArray(J))throw new Error("mnemonist/InvertedIndex.add: tokenizer function should return an array of tokens.");var Q=new Set,K,q;for(var V=0,X=J.length;V<X;V++){if(K=J[V],Q.has(K))continue;if(Q.add(K),q=this.mapping.get(K),!q)q=[],this.mapping.set(K,q);q.push(Z)}return this.dimension=this.mapping.size,this};N$.prototype.get=function($){if(!this.size)return[];var Z=this.queryTokenizer($);if(!Array.isArray(Z))throw new Error("mnemonist/InvertedIndex.query: tokenizer function should return an array of tokens.");if(!Z.length)return[];var J=this.mapping.get(Z[0]),Q,K,q;if(typeof J==="undefined"||J.length===0)return[];if(Z.length>1)for(K=1,q=Z.length;K<q;K++){if(Q=this.mapping.get(Z[K]),typeof Q==="undefined"||Q.length===0)return[];J=pF.intersectionUniqueArrays(J,Q)}var V=new Array(J.length);for(K=0,q=V.length;K<q;K++)V[K]=this.items[J[K]];return V};N$.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;for(var J=0,Q=this.documents.length;J<Q;J++)$.call(Z,this.documents[J],J,this)};N$.prototype.documents=function(){var $=this.items,Z=$.length,J=0;return new mF(function(){if(J>=Z)return{done:!0};var Q=$[J++];return{value:Q,done:!1}})};N$.prototype.tokens=function(){return this.mapping.keys()};if(typeof Symbol!=="undefined")N$.prototype[Symbol.iterator]=N$.prototype.documents;N$.prototype.inspect=function(){var $=this.items.slice();return Object.defineProperty($,"constructor",{value:N$,enumerable:!1}),$};if(typeof Symbol!=="undefined")N$.prototype[Symbol.for("nodejs.util.inspect.custom")]=N$.prototype.inspect;N$.from=function($,Z){var J=new N$(Z);return cF($,function(Q){J.add(Q)}),J};J2.exports=N$});var x4=E((lF)=>{var uF=function($,Z,J){var Q,K,q,V,X;l0[0]=Z,A0[0]=J,K=0;while(K>=0)if(q=l0[K],V=A0[K]-1,q<V){Q=$[q];while(q<V){while($[V]>=Q&&q<V)V--;if(q<V)$[q++]=$[V];while($[q]<=Q&&q<V)q++;if(q<V)$[V--]=$[q]}if($[q]=Q,l0[K+1]=q+1,A0[K+1]=A0[K],A0[K++]=q,A0[K]-l0[K]>A0[K-1]-l0[K-1])X=l0[K],l0[K]=l0[K-1],l0[K-1]=X,X=A0[K],A0[K]=A0[K-1],A0[K-1]=X}else K--;return $},dF=function($,Z,J,Q){var K,q,V,X,W,U;l0[0]=J,A0[0]=Q,q=0;while(q>=0)if(V=l0[q],X=A0[q]-1,V<X){W=Z[V],K=$[W];while(V<X){while($[Z[X]]>=K&&V<X)X--;if(V<X)Z[V++]=Z[X];while($[Z[V]]<=K&&V<X)V++;if(V<X)Z[X--]=Z[V]}if(Z[V]=W,l0[q+1]=V+1,A0[q+1]=A0[q],A0[q++]=V,A0[q]-l0[q]>A0[q-1]-l0[q-1])U=l0[q],l0[q]=l0[q-1],l0[q-1]=U,U=A0[q],A0[q]=A0[q-1],A0[q-1]=U}else q--;return Z},l0=new Float64Array(64),A0=new Float64Array(64);lF.inplaceQuickSort=uF;lF.inplaceQuickSortIndices=dF});var W2=E((Yl,X2)=>{var m4=function($,Z,J,Q){var K,q=0,V;for(K=0;K<$;K++)V=Z[K][J]-Q[K],q+=V*V;return q},aF=function($,Z){var J=Z.length,Q=new Array($),K=new Array(J),q,V=mZ.getPointerArray(J),X=new V(J),W,U,z,H=!0;for(W=0;W<$;W++){q=new Float64Array(J);for(U=0;U<J;U++)if(z=Z[U],q[U]=z[1][W],H)K[U]=z[0],X[U]=U;H=!1,Q[W]=q}return{axes:Q,ids:X,labels:K}},V2=function($,Z,J,Q){var K=Q.length,q=mZ.getPointerArray(K+1),V=new q(K),X=new q(K),W=new q(K),U=[[0,0,J.length,-1,0]],z,H,G,Y,w,j,B,C,N=0;while(U.length!==0){if(z=U.pop(),C=z[0],j=z[1],B=z[2],H=z[3],G=z[4],iF(Z[C],J,j,B),K=B-j,Y=j+(K>>>1),w=J[Y],V[N]=w,H>-1)if(G===0)X[H]=N+1;else W[H]=N+1;if(C=(C+1)%$,Y!==j&&Y!==B-1)U.push([C,Y+1,B,N,1]);if(Y!==j)U.push([C,j,Y,N,0]);N++}return{axes:Z,labels:Q,pivots:V,lefts:X,rights:W}},o$=function($,Z){this.dimensions=$,this.visited=0,this.axes=Z.axes,this.labels=Z.labels,this.pivots=Z.pivots,this.lefts=Z.lefts,this.rights=Z.rights,this.size=this.labels.length},sF=A$(),mZ=B$(),K2=l5().createTupleComparator,q2=gZ(),iF=x4().inplaceQuickSortIndices;o$.prototype.nearestNeighbor=function($){var Z=Infinity,J=null,Q=this.dimensions,K=this.axes,q=this.pivots,V=this.lefts,X=this.rights,W=0;function U(z,H){W++;var G=V[H],Y=X[H],w=q[H],j=m4(Q,K,w,$);if(j<Z){if(J=w,Z=j,j===0)return}var B=K[z][w]-$[z];if(z=(z+1)%Q,B>0){if(G!==0)U(z,G-1)}else if(Y!==0)U(z,Y-1);if(B*B<Z){if(B>0){if(Y!==0)U(z,Y-1)}else if(G!==0)U(z,G-1)}}return U(0,0),this.visited=W,this.labels[J]};var rF=K2(3),tF=K2(2);o$.prototype.kNearestNeighbors=function($,Z){if($<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");if($=Math.min($,this.size),$===1)return[this.nearestNeighbor(Z)];var J=new q2(Array,rF,$),Q=this.dimensions,K=this.axes,q=this.pivots,V=this.lefts,X=this.rights,W=0;function U(G,Y){var w=V[Y],j=X[Y],B=q[Y],C=m4(Q,K,B,Z);J.push([C,W++,B]);var N=Z[G],F=K[G][B],L=N-F;if(G=(G+1)%Q,N<F){if(w!==0)U(G,w-1)}else if(j!==0)U(G,j-1);if(L*L<J.peek()[0]||J.size<$){if(N<F){if(j!==0)U(G,j-1)}else if(w!==0)U(G,w-1)}}U(0,0),this.visited=W;var z=J.consume();for(var H=0;H<z.length;H++)z[H]=this.labels[z[H][2]];return z};o$.prototype.linearKNearestNeighbors=function($,Z){if($<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");$=Math.min($,this.size);var J=new q2(Array,tF,$),Q,K,q;for(Q=0,K=this.size;Q<K;Q++)q=m4(this.dimensions,this.axes,this.pivots[Q],Z),J.push([q,Q]);var V=J.consume();for(Q=0;Q<V.length;Q++)V[Q]=this.labels[this.pivots[V[Q][1]]];return V};o$.prototype.inspect=function(){var $=new Map;$.dimensions=this.dimensions,Object.defineProperty($,"constructor",{value:o$,enumerable:!1});var Z,J,Q;for(Z=0;Z<this.size;Z++){Q=new Array(this.dimensions);for(J=0;J<this.dimensions;J++)Q[J]=this.axes[J][Z];$.set(this.labels[Z],Q)}return $};if(typeof Symbol!=="undefined")o$.prototype[Symbol.for("nodejs.util.inspect.custom")]=o$.prototype.inspect;o$.from=function($,Z){var J=sF.toArray($),Q=aF(Z,J),K=V2(Z,Q.axes,Q.ids,Q.labels);return new o$(Z,K)};o$.fromAxes=function($,Z){if(!Z)Z=mZ.indices($[0].length);var J=$.length,Q=V2($.length,$,mZ.indices(Z.length),Z);return new o$(J,Q)};X2.exports=o$});var H2=E((wl,z2)=>{var R0=function(){this.clear()},U2=d0(),eF=C0();R0.prototype.clear=function(){this.head=null,this.tail=null,this.size=0};R0.prototype.first=function(){return this.head?this.head.item:void 0};R0.prototype.peek=R0.prototype.first;R0.prototype.last=function(){return this.tail?this.tail.item:void 0};R0.prototype.push=function($){var Z={item:$,next:null};if(!this.head)this.head=Z,this.tail=Z;else this.tail.next=Z,this.tail=Z;return this.size++,this.size};R0.prototype.unshift=function($){var Z={item:$,next:null};if(!this.head)this.head=Z,this.tail=Z;else{if(!this.head.next)this.tail=this.head;Z.next=this.head,this.head=Z}return this.size++,this.size};R0.prototype.shift=function(){if(!this.size)return;var $=this.head;return this.head=$.next,this.size--,$.item};R0.prototype.forEach=function($,Z){if(!this.size)return;Z=arguments.length>1?Z:this;var J=this.head,Q=0;while(J)$.call(Z,J.item,Q,this),J=J.next,Q++};R0.prototype.toArray=function(){if(!this.size)return[];var $=new Array(this.size);for(var Z=0,J=this.size,Q=this.head;Z<J;Z++)$[Z]=Q.item,Q=Q.next;return $};R0.prototype.values=function(){var $=this.head;return new U2(function(){if(!$)return{done:!0};var Z=$.item;return $=$.next,{value:Z,done:!1}})};R0.prototype.entries=function(){var $=this.head,Z=0;return new U2(function(){if(!$)return{done:!0};var J=$.item;return $=$.next,Z++,{value:[Z-1,J],done:!1}})};if(typeof Symbol!=="undefined")R0.prototype[Symbol.iterator]=R0.prototype.values;R0.prototype.toString=function(){return this.toArray().join(",")};R0.prototype.toJSON=function(){return this.toArray()};R0.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:R0,enumerable:!1}),$};if(typeof Symbol!=="undefined")R0.prototype[Symbol.for("nodejs.util.inspect.custom")]=R0.prototype.inspect;R0.from=function($){var Z=new R0;return eF($,function(J){Z.push(J)}),Z};z2.exports=R0});var cZ=E((jl,G2)=>{var h0=function($,Z,J){if(arguments.length<2)J=$,$=null,Z=null;if(this.capacity=J,typeof this.capacity!=="number"||this.capacity<=0)throw new Error("mnemonist/lru-cache: capacity should be positive number.");else if(!isFinite(this.capacity)||Math.floor(this.capacity)!==this.capacity)throw new Error("mnemonist/lru-cache: capacity should be a finite positive integer.");var Q=ZN.getPointerArray(J);this.forward=new Q(J),this.backward=new Q(J),this.K=typeof $==="function"?new $(J):new Array(J),this.V=typeof Z==="function"?new Z(J):new Array(J),this.size=0,this.head=0,this.tail=0,this.items={}},c4=d0(),$N=C0(),ZN=B$(),JN=A$();h0.prototype.clear=function(){this.size=0,this.head=0,this.tail=0,this.items={}};h0.prototype.splayOnTop=function($){var Z=this.head;if(this.head===$)return this;var J=this.backward[$],Q=this.forward[$];if(this.tail===$)this.tail=J;else this.backward[Q]=J;return this.forward[J]=Q,this.backward[Z]=$,this.head=$,this.forward[$]=Z,this};h0.prototype.set=function($,Z){var J=this.items[$];if(typeof J!=="undefined"){this.splayOnTop(J),this.V[J]=Z;return}if(this.size<this.capacity)J=this.size++;else J=this.tail,this.tail=this.backward[J],delete this.items[this.K[J]];this.items[$]=J,this.K[J]=$,this.V[J]=Z,this.forward[J]=this.head,this.backward[this.head]=J,this.head=J};h0.prototype.setpop=function($,Z){var J=null,Q=null,K=this.items[$];if(typeof K!=="undefined")return this.splayOnTop(K),J=this.V[K],this.V[K]=Z,{evicted:!1,key:$,value:J};if(this.size<this.capacity)K=this.size++;else K=this.tail,this.tail=this.backward[K],J=this.V[K],Q=this.K[K],delete this.items[this.K[K]];if(this.items[$]=K,this.K[K]=$,this.V[K]=Z,this.forward[K]=this.head,this.backward[this.head]=K,this.head=K,Q)return{evicted:!0,key:Q,value:J};else return null};h0.prototype.has=function($){return $ in this.items};h0.prototype.get=function($){var Z=this.items[$];if(typeof Z==="undefined")return;return this.splayOnTop(Z),this.V[Z]};h0.prototype.peek=function($){var Z=this.items[$];if(typeof Z==="undefined")return;return this.V[Z]};h0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;var J=0,Q=this.size,K=this.head,q=this.K,V=this.V,X=this.forward;while(J<Q)$.call(Z,V[K],q[K],this),K=X[K],J++};h0.prototype.keys=function(){var $=0,Z=this.size,J=this.head,Q=this.K,K=this.forward;return new c4(function(){if($>=Z)return{done:!0};var q=Q[J];if($++,$<Z)J=K[J];return{done:!1,value:q}})};h0.prototype.values=function(){var $=0,Z=this.size,J=this.head,Q=this.V,K=this.forward;return new c4(function(){if($>=Z)return{done:!0};var q=Q[J];if($++,$<Z)J=K[J];return{done:!1,value:q}})};h0.prototype.entries=function(){var $=0,Z=this.size,J=this.head,Q=this.K,K=this.V,q=this.forward;return new c4(function(){if($>=Z)return{done:!0};var V=Q[J],X=K[J];if($++,$<Z)J=q[J];return{done:!1,value:[V,X]}})};if(typeof Symbol!=="undefined")h0.prototype[Symbol.iterator]=h0.prototype.entries;h0.prototype.inspect=function(){var $=new Map,Z=this.entries(),J;while(J=Z.next(),!J.done)$.set(J.value[0],J.value[1]);return Object.defineProperty($,"constructor",{value:h0,enumerable:!1}),$};if(typeof Symbol!=="undefined")h0.prototype[Symbol.for("nodejs.util.inspect.custom")]=h0.prototype.inspect;h0.from=function($,Z,J,Q){if(arguments.length<2){if(Q=JN.guessLength($),typeof Q!=="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else if(arguments.length===2)Q=Z,Z=null,J=null;var K=new h0(Z,J,Q);return $N($,function(q,V){K.set(V,q)}),K};G2.exports=h0});var w2=E((Bl,Y2)=>{var I8=function($,Z,J){if(arguments.length<2)A7.call(this,$);else A7.call(this,$,Z,J);var Q=KN.getPointerArray(this.capacity);this.deleted=new Q(this.capacity),this.deletedSize=0},A7=cZ(),QN=C0(),KN=B$(),qN=A$();for(p4 in A7.prototype)I8.prototype[p4]=A7.prototype[p4];var p4;if(typeof Symbol!=="undefined")I8.prototype[Symbol.iterator]=A7.prototype[Symbol.iterator];I8.prototype.clear=function(){A7.prototype.clear.call(this),this.deletedSize=0};I8.prototype.set=function($,Z){var J=this.items[$];if(typeof J!=="undefined"){this.splayOnTop(J),this.V[J]=Z;return}if(this.size<this.capacity){if(this.deletedSize>0)J=this.deleted[--this.deletedSize];else J=this.size;this.size++}else J=this.tail,this.tail=this.backward[J],delete this.items[this.K[J]];this.items[$]=J,this.K[J]=$,this.V[J]=Z,this.forward[J]=this.head,this.backward[this.head]=J,this.head=J};I8.prototype.setpop=function($,Z){var J=null,Q=null,K=this.items[$];if(typeof K!=="undefined")return this.splayOnTop(K),J=this.V[K],this.V[K]=Z,{evicted:!1,key:$,value:J};if(this.size<this.capacity){if(this.deletedSize>0)K=this.deleted[--this.deletedSize];else K=this.size;this.size++}else K=this.tail,this.tail=this.backward[K],J=this.V[K],Q=this.K[K],delete this.items[this.K[K]];if(this.items[$]=K,this.K[K]=$,this.V[K]=Z,this.forward[K]=this.head,this.backward[this.head]=K,this.head=K,Q)return{evicted:!0,key:Q,value:J};else return null};I8.prototype.delete=function($){var Z=this.items[$];if(typeof Z==="undefined")return!1;if(delete this.items[$],this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,!0;var J=this.backward[Z],Q=this.forward[Z];if(this.head===Z)this.head=Q;if(this.tail===Z)this.tail=J;return this.forward[J]=Q,this.backward[Q]=J,this.size--,this.deleted[this.deletedSize++]=Z,!0};I8.prototype.remove=function($,Z=void 0){var J=this.items[$];if(typeof J==="undefined")return Z;var Q=this.V[J];if(delete this.items[$],this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,Q;var K=this.backward[J],q=this.forward[J];if(this.head===J)this.head=q;if(this.tail===J)this.tail=K;return this.forward[K]=q,this.backward[q]=K,this.size--,this.deleted[this.deletedSize++]=J,Q};I8.from=function($,Z,J,Q){if(arguments.length<2){if(Q=qN.guessLength($),typeof Q!=="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else if(arguments.length===2)Q=Z,Z=null,J=null;var K=new I8(Z,J,Q);return QN($,function(q,V){K.set(V,q)}),K};Y2.exports=I8});var u4=E((Fl,j2)=>{var e0=function($,Z,J){if(arguments.length<2)J=$,$=null,Z=null;if(this.capacity=J,typeof this.capacity!=="number"||this.capacity<=0)throw new Error("mnemonist/lru-map: capacity should be positive number.");else if(!isFinite(this.capacity)||Math.floor(this.capacity)!==this.capacity)throw new Error("mnemonist/lru-map: capacity should be a finite positive integer.");var Q=XN.getPointerArray(J);this.forward=new Q(J),this.backward=new Q(J),this.K=typeof $==="function"?new $(J):new Array(J),this.V=typeof Z==="function"?new Z(J):new Array(J),this.size=0,this.head=0,this.tail=0,this.items=new Map},M7=cZ(),VN=C0(),XN=B$(),WN=A$();e0.prototype.clear=function(){this.size=0,this.head=0,this.tail=0,this.items.clear()};e0.prototype.set=function($,Z){var J=this.items.get($);if(typeof J!=="undefined"){this.splayOnTop(J),this.V[J]=Z;return}if(this.size<this.capacity)J=this.size++;else J=this.tail,this.tail=this.backward[J],this.items.delete(this.K[J]);this.items.set($,J),this.K[J]=$,this.V[J]=Z,this.forward[J]=this.head,this.backward[this.head]=J,this.head=J};e0.prototype.setpop=function($,Z){var J=null,Q=null,K=this.items.get($);if(typeof K!=="undefined")return this.splayOnTop(K),J=this.V[K],this.V[K]=Z,{evicted:!1,key:$,value:J};if(this.size<this.capacity)K=this.size++;else K=this.tail,this.tail=this.backward[K],J=this.V[K],Q=this.K[K],this.items.delete(this.K[K]);if(this.items.set($,K),this.K[K]=$,this.V[K]=Z,this.forward[K]=this.head,this.backward[this.head]=K,this.head=K,Q)return{evicted:!0,key:Q,value:J};else return null};e0.prototype.has=function($){return this.items.has($)};e0.prototype.get=function($){var Z=this.items.get($);if(typeof Z==="undefined")return;return this.splayOnTop(Z),this.V[Z]};e0.prototype.peek=function($){var Z=this.items.get($);if(typeof Z==="undefined")return;return this.V[Z]};e0.prototype.splayOnTop=M7.prototype.splayOnTop;e0.prototype.forEach=M7.prototype.forEach;e0.prototype.keys=M7.prototype.keys;e0.prototype.values=M7.prototype.values;e0.prototype.entries=M7.prototype.entries;if(typeof Symbol!=="undefined")e0.prototype[Symbol.iterator]=e0.prototype.entries;e0.prototype.inspect=M7.prototype.inspect;e0.from=function($,Z,J,Q){if(arguments.length<2){if(Q=WN.guessLength($),typeof Q!=="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else if(arguments.length===2)Q=Z,Z=null,J=null;var K=new e0(Z,J,Q);return VN($,function(q,V){K.set(V,q)}),K};j2.exports=e0});var F2=E((Nl,B2)=>{var R8=function($,Z,J){if(arguments.length<2)k7.call(this,$);else k7.call(this,$,Z,J);var Q=zN.getPointerArray(this.capacity);this.deleted=new Q(this.capacity),this.deletedSize=0},k7=u4(),UN=C0(),zN=B$(),HN=A$();for(d4 in k7.prototype)R8.prototype[d4]=k7.prototype[d4];var d4;if(typeof Symbol!=="undefined")R8.prototype[Symbol.iterator]=k7.prototype[Symbol.iterator];R8.prototype.clear=function(){k7.prototype.clear.call(this),this.deletedSize=0};R8.prototype.set=function($,Z){var J=this.items.get($);if(typeof J!=="undefined"){this.splayOnTop(J),this.V[J]=Z;return}if(this.size<this.capacity){if(this.deletedSize>0)J=this.deleted[--this.deletedSize];else J=this.size;this.size++}else J=this.tail,this.tail=this.backward[J],this.items.delete(this.K[J]);this.items.set($,J),this.K[J]=$,this.V[J]=Z,this.forward[J]=this.head,this.backward[this.head]=J,this.head=J};R8.prototype.setpop=function($,Z){var J=null,Q=null,K=this.items.get($);if(typeof K!=="undefined")return this.splayOnTop(K),J=this.V[K],this.V[K]=Z,{evicted:!1,key:$,value:J};if(this.size<this.capacity){if(this.deletedSize>0)K=this.deleted[--this.deletedSize];else K=this.size;this.size++}else K=this.tail,this.tail=this.backward[K],J=this.V[K],Q=this.K[K],this.items.delete(this.K[K]);if(this.items.set($,K),this.K[K]=$,this.V[K]=Z,this.forward[K]=this.head,this.backward[this.head]=K,this.head=K,Q)return{evicted:!0,key:Q,value:J};else return null};R8.prototype.delete=function($){var Z=this.items.get($);if(typeof Z==="undefined")return!1;if(this.items.delete($),this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,!0;var J=this.backward[Z],Q=this.forward[Z];if(this.head===Z)this.head=Q;if(this.tail===Z)this.tail=J;return this.forward[J]=Q,this.backward[Q]=J,this.size--,this.deleted[this.deletedSize++]=Z,!0};R8.prototype.remove=function($,Z=void 0){var J=this.items.get($);if(typeof J==="undefined")return Z;var Q=this.V[J];if(this.items.delete($),this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,Q;var K=this.backward[J],q=this.forward[J];if(this.head===J)this.head=q;if(this.tail===J)this.tail=K;return this.forward[K]=q,this.backward[q]=K,this.size--,this.deleted[this.deletedSize++]=J,Q};R8.from=function($,Z,J,Q){if(arguments.length<2){if(Q=HN.guessLength($),typeof Q!=="number")throw new Error("mnemonist/lru-map.from: could not guess iterable length. Please provide desired capacity as last argument.")}else if(arguments.length===2)Q=Z,Z=null,J=null;var K=new R8(Z,J,Q);return UN($,function(q,V){K.set(V,q)}),K};B2.exports=R8});var C2=E((Cl,N2)=>{var X0=function(){this.items=new Map,Object.defineProperty(this.items,"constructor",{value:X0,enumerable:!1}),this.clear()},GN=d0(),YN=C0(),wN=gZ(),jN=function($,Z){if($[1]>Z[1])return-1;if($[1]<Z[1])return 1;return 0};X0.prototype.clear=function(){this.size=0,this.dimension=0,this.items.clear()};X0.prototype.add=function($,Z){if(Z===0)return this;if(Z<0)return this.remove($,-Z);if(Z=Z||1,typeof Z!=="number")throw new Error("mnemonist/multi-set.add: given count should be a number.");this.size+=Z;const J=this.items.get($);if(J===void 0)this.dimension++;else Z+=J;return this.items.set($,Z),this};X0.prototype.set=function($,Z){var J;if(typeof Z!=="number")throw new Error("mnemonist/multi-set.set: given count should be a number.");if(Z<=0){if(J=this.items.get($),typeof J!=="undefined")this.size-=J,this.dimension--;return this.items.delete($),this}if(Z=Z||1,J=this.items.get($),typeof J==="number")this.items.set($,J+Z);else this.dimension++,this.items.set($,Z);return this.size+=Z,this};X0.prototype.has=function($){return this.items.has($)};X0.prototype.delete=function($){var Z=this.items.get($);if(Z===0)return!1;return this.size-=Z,this.dimension--,this.items.delete($),!0};X0.prototype.remove=function($,Z){if(Z===0)return;if(Z<0)return this.add($,-Z);if(Z=Z||1,typeof Z!=="number")throw new Error("mnemonist/multi-set.remove: given count should be a number.");var J=this.items.get($);if(typeof J==="undefined")return;var Q=Math.max(0,J-Z);if(Q===0)this.items.delete($),this.size-=J,this.dimension--;else this.items.set($,Q),this.size-=Z;return};X0.prototype.edit=function($,Z){var J=this.multiplicity($);if(J===0)return;var Q=this.multiplicity(Z);return this.items.set(Z,J+Q),this.items.delete($),this};X0.prototype.multiplicity=function($){var Z=this.items.get($);if(typeof Z==="undefined")return 0;return Z};X0.prototype.get=X0.prototype.multiplicity;X0.prototype.count=X0.prototype.multiplicity;X0.prototype.frequency=function($){if(this.size===0)return 0;var Z=this.multiplicity($);return Z/this.size};X0.prototype.top=function($){if(typeof $!=="number"||$<=0)throw new Error("mnemonist/multi-set.top: n must be a number > 0.");var Z=new wN(Array,jN,$),J=this.items.entries(),Q;while(Q=J.next(),!Q.done)Z.push(Q.value);return Z.consume()};X0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;var J;this.items.forEach(function(Q,K){for(J=0;J<Q;J++)$.call(Z,K,K)})};X0.prototype.forEachMultiplicity=function($,Z){Z=arguments.length>1?Z:this,this.items.forEach($,Z)};X0.prototype.keys=function(){return this.items.keys()};X0.prototype.values=function(){var $=this.items.entries(),Z=!1,J,Q,K,q;return new GN(function V(){if(!Z){if(J=$.next(),J.done)return{done:!0};Z=!0,Q=J.value[0],K=J.value[1],q=0}if(q>=K)return Z=!1,V();return q++,{done:!1,value:Q}})};X0.prototype.multiplicities=function(){return this.items.entries()};if(typeof Symbol!=="undefined")X0.prototype[Symbol.iterator]=X0.prototype.values;X0.prototype.inspect=function(){return this.items};if(typeof Symbol!=="undefined")X0.prototype[Symbol.for("nodejs.util.inspect.custom")]=X0.prototype.inspect;X0.prototype.toJSON=function(){return this.items};X0.from=function($){var Z=new X0;return YN($,function(J){Z.add(J)}),Z};X0.isSubset=function($,Z){var J=$.multiplicities(),Q,K,q;if($===Z)return!0;if($.dimension>Z.dimension)return!1;while(Q=J.next(),!Q.done)if(K=Q.value[0],q=Q.value[1],Z.multiplicity(K)<q)return!1;return!0};X0.isSuperset=function($,Z){return X0.isSubset(Z,$)};N2.exports=X0});var P2=E((Ll,R2)=>{var NN=function($,Z,J){return((Math.pow($,2)-Math.pow(Math.abs(Z-J),2))/2|0)+$+1},CN=function($,Z){var J=0;for(var Q=0,K=Z+1;Q<K;Q++)J+=NN($,Z,Q);return J},LN=function($,Z){if($.length>Z.length)return-1;if($.length<Z.length)return 1;if($<Z)return-1;if($>Z)return 1;return 0},L2=function($,Z){var J=$+1,Q=Z/J|0,K=Q+1,q,V,X=Z-Q*J,W=J-X,U=new Array($+1);for(q=0;q<W;q++)U[q]=[q*Q,Q];var z=(q-1)*Q+Q;for(V=0;V<X;V++)U[q+V]=[z+V*K,K];return U},_2=function($,Z){var J=Z.length,Q=$+1,K=J/Q|0,q=K+1,V,X,W,U=J-K*Q,z=Q-U,H=new Array($+1);for(X=0;X<z;X++)V=X*K,H[X]=Z.slice(V,V+K);var G=(X-1)*K+K;for(W=0;W<U;W++)V=G+W*q,H[X+W]=Z.slice(V,V+q);return H},_N=function($,Z,J){if(Z===0)return 0;var Q=J.length,K=$+1,q=Q/K|0,V=q+1,X=Q-q*K,W=K-X;if(Z<=W-1)return Z*q;var U=Z-W;return W*q+U*V},O2=function($,Z,J,Q,K,q){var V=K-J,X=K+J,W=$-J,U=K+Z-W,z=K+Z+W,H=Q-q;return[Math.max(0,V,U),Math.min(X,z,H)]},I2=function($,Z,J,Q,K,q){var V=Z.length,X=V-J,W=O2($,X,Q,V,K,q),U=W[0],z=W[1],H="",G=[],Y,w,j;for(w=U,j=z+1;w<j;w++){if(Y=Z.slice(w,w+q),Y===H)continue;G.push(Y),H=Y}return G},k0=function($,Z){if(typeof $!=="function")throw new Error("mnemonist/passjoin-index: `levenshtein` should be a function returning edit distance between two strings.");if(typeof Z!=="number"||Z<1)throw new Error("mnemonist/passjoin-index: `k` should be a number > 0");this.levenshtein=$,this.k=Z,this.clear()},BN=d0(),FN=C0();k0.prototype.clear=function(){this.size=0,this.strings=[],this.invertedIndices={}};k0.prototype.add=function($){var Z=$.length,J=this.size;this.strings.push($),this.size++;var Q=_2(this.k,$),K=this.invertedIndices[Z];if(typeof K==="undefined")K={},this.invertedIndices[Z]=K;var q,V,X,W,U;for(W=0,U=Q.length;W<U;W++)if(q=Q[W],X=q+W,V=K[X],typeof V==="undefined")V=[J],K[X]=V;else V.push(J);return this};k0.prototype.search=function($){var Z=$.length,J=this.k,Q=new Set,K,q,V,X,W,U,z,H,G,Y,w,j,B,C,N;for(H=Math.max(0,Z-J),G=Z+J+1;H<G;H++){var F=this.invertedIndices[H];if(typeof F==="undefined")continue;z=L2(J,H);for(Y=0,w=z.length;Y<w;Y++){if(V=z[Y][0],X=z[Y][1],U=I2(J,$,H,Y,V,X),!U.length)U=[""];for(j=0,B=U.length;j<B;j++){if(W=U[j]+Y,K=F[W],typeof K==="undefined")continue;for(C=0,N=K.length;C<N;C++)if(q=this.strings[K[C]],Z<=J&&H<=J||!Q.has(q)&&this.levenshtein($,q)<=J)Q.add(q)}}}return Q};k0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;for(var J=0,Q=this.strings.length;J<Q;J++)$.call(Z,this.strings[J],J,this)};k0.prototype.values=function(){var $=this.strings,Z=$.length,J=0;return new BN(function(){if(J>=Z)return{done:!0};var Q=$[J];return J++,{value:Q,done:!1}})};if(typeof Symbol!=="undefined")k0.prototype[Symbol.iterator]=k0.prototype.values;k0.prototype.inspect=function(){var $=this.strings.slice();return Object.defineProperty($,"constructor",{value:k0,enumerable:!1}),$};if(typeof Symbol!=="undefined")k0.prototype[Symbol.for("nodejs.util.inspect.custom")]=k0.prototype.inspect;k0.from=function($,Z,J){var Q=new k0(Z,J);return FN($,function(K){Q.add(K)}),Q};k0.countKeys=CN;k0.comparator=LN;k0.partition=L2;k0.segments=_2;k0.segmentPos=_N;k0.multiMatchAwareInterval=O2;k0.multiMatchAwareSubstrings=I2;R2.exports=k0});var M2=E((_l,A2)=>{var E0=function(){this.clear()},D2=d0(),ON=C0();E0.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};E0.prototype.enqueue=function($){return this.items.push($),++this.size};E0.prototype.dequeue=function(){if(!this.size)return;var $=this.items[this.offset];if(++this.offset*2>=this.items.length)this.items=this.items.slice(this.offset),this.offset=0;return this.size--,$};E0.prototype.peek=function(){if(!this.size)return;return this.items[this.offset]};E0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;for(var J=this.offset,Q=0,K=this.items.length;J<K;J++,Q++)$.call(Z,this.items[J],Q,this)};E0.prototype.toArray=function(){return this.items.slice(this.offset)};E0.prototype.values=function(){var $=this.items,Z=this.offset;return new D2(function(){if(Z>=$.length)return{done:!0};var J=$[Z];return Z++,{value:J,done:!1}})};E0.prototype.entries=function(){var $=this.items,Z=this.offset,J=0;return new D2(function(){if(Z>=$.length)return{done:!0};var Q=$[Z];return Z++,{value:[J++,Q],done:!1}})};if(typeof Symbol!=="undefined")E0.prototype[Symbol.iterator]=E0.prototype.values;E0.prototype.toString=function(){return this.toArray().join(",")};E0.prototype.toJSON=function(){return this.toArray()};E0.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:E0,enumerable:!1}),$};if(typeof Symbol!=="undefined")E0.prototype[Symbol.for("nodejs.util.inspect.custom")]=E0.prototype.inspect;E0.from=function($){var Z=new E0;return ON($,function(J){Z.enqueue(J)}),Z};E0.of=function(){return E0.from(arguments)};A2.exports=E0});var T2=E((Ol,E2)=>{var T0=function(){this.clear()},k2=d0(),IN=C0();T0.prototype.clear=function(){this.items=[],this.size=0};T0.prototype.push=function($){return this.items.push($),++this.size};T0.prototype.pop=function(){if(this.size===0)return;return this.size--,this.items.pop()};T0.prototype.peek=function(){return this.items[this.size-1]};T0.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;for(var J=0,Q=this.items.length;J<Q;J++)$.call(Z,this.items[Q-J-1],J,this)};T0.prototype.toArray=function(){var $=new Array(this.size),Z=this.size-1,J=this.size;while(J--)$[J]=this.items[Z-J];return $};T0.prototype.values=function(){var $=this.items,Z=$.length,J=0;return new k2(function(){if(J>=Z)return{done:!0};var Q=$[Z-J-1];return J++,{value:Q,done:!1}})};T0.prototype.entries=function(){var $=this.items,Z=$.length,J=0;return new k2(function(){if(J>=Z)return{done:!0};var Q=$[Z-J-1];return{value:[J++,Q],done:!1}})};if(typeof Symbol!=="undefined")T0.prototype[Symbol.iterator]=T0.prototype.values;T0.prototype.toString=function(){return this.toArray().join(",")};T0.prototype.toJSON=function(){return this.toArray()};T0.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:T0,enumerable:!1}),$};if(typeof Symbol!=="undefined")T0.prototype[Symbol.for("nodejs.util.inspect.custom")]=T0.prototype.inspect;T0.from=function($){var Z=new T0;return IN($,function(J){Z.push(J)}),Z};T0.of=function(){return T0.from(arguments)};E2.exports=T0});var v2=E((RN)=>{RN.intersection=function(){if(arguments.length<2)throw new Error("mnemonist/Set.intersection: needs at least two arguments.");var $=new Set,Z=Infinity,J=null,Q,K,q=arguments.length;for(K=0;K<q;K++){if(Q=arguments[K],Q.size===0)return $;if(Q.size<Z)Z=Q.size,J=Q}var V=J.values(),X,W,U,z;while(X=V.next(),!X.done){W=X.value,U=!0;for(K=0;K<q;K++){if(z=arguments[K],z===J)continue;if(!z.has(W)){U=!1;break}}if(U)$.add(W)}return $};RN.union=function(){if(arguments.length<2)throw new Error("mnemonist/Set.union: needs at least two arguments.");var $=new Set,Z,J=arguments.length,Q,K;for(Z=0;Z<J;Z++){Q=arguments[Z].values();while(K=Q.next(),!K.done)$.add(K.value)}return $};RN.difference=function($,Z){if(!$.size)return new Set;if(!Z.size)return new Set($);var J=new Set,Q=$.values(),K;while(K=Q.next(),!K.done)if(!Z.has(K.value))J.add(K.value);return J};RN.symmetricDifference=function($,Z){var J=new Set,Q=$.values(),K;while(K=Q.next(),!K.done)if(!Z.has(K.value))J.add(K.value);Q=Z.values();while(K=Q.next(),!K.done)if(!$.has(K.value))J.add(K.value);return J};RN.isSubset=function($,Z){var J=$.values(),Q;if($===Z)return!0;if($.size>Z.size)return!1;while(Q=J.next(),!Q.done)if(!Z.has(Q.value))return!1;return!0};RN.isSuperset=function($,Z){return RN.isSubset(Z,$)};RN.add=function($,Z){var J=Z.values(),Q;while(Q=J.next(),!Q.done)$.add(Q.value);return};RN.subtract=function($,Z){var J=Z.values(),Q;while(Q=J.next(),!Q.done)$.delete(Q.value);return};RN.intersect=function($,Z){var J=$.values(),Q;while(Q=J.next(),!Q.done)if(!Z.has(Q.value))$.delete(Q.value);return};RN.disjunct=function($,Z){var J=$.values(),Q,K=[];while(Q=J.next(),!Q.done)if(Z.has(Q.value))K.push(Q.value);J=Z.values();while(Q=J.next(),!Q.done)if(!$.has(Q.value))$.add(Q.value);for(var q=0,V=K.length;q<V;q++)$.delete(K[q]);return};RN.intersectionSize=function($,Z){var J;if($.size>Z.size)J=$,$=Z,Z=J;if($.size===0)return 0;if($===Z)return $.size;var Q=$.values(),K,q=0;while(K=Q.next(),!K.done)if(Z.has(K.value))q++;return q};RN.unionSize=function($,Z){var J=RN.intersectionSize($,Z);return $.size+Z.size-J};RN.jaccard=function($,Z){var J=RN.intersectionSize($,Z);if(J===0)return 0;var Q=$.size+Z.size-J;return J/Q};RN.overlap=function($,Z){var J=RN.intersectionSize($,Z);if(J===0)return 0;return J/Math.min($.size,Z.size)}});var h2=E((Rl,S2)=>{var S$=function($){var Z=gN($);this.start=0,this.size=0,this.capacity=$,this.dense=new Z($),this.sparse=new Z($)},yN=d0(),gN=B$().getPointerArray;S$.prototype.clear=function(){this.start=0,this.size=0};S$.prototype.has=function($){if(this.size===0)return!1;var Z=this.sparse[$],J=Z<this.capacity&&(Z>=this.start&&Z<this.start+this.size)||Z<(this.start+this.size)%this.capacity;return J&&this.dense[Z]===$};S$.prototype.enqueue=function($){var Z=this.sparse[$];if(this.size!==0){var J=Z<this.capacity&&(Z>=this.start&&Z<this.start+this.size)||Z<(this.start+this.size)%this.capacity;if(J&&this.dense[Z]===$)return this}return Z=(this.start+this.size)%this.capacity,this.dense[Z]=$,this.sparse[$]=Z,this.size++,this};S$.prototype.dequeue=function(){if(this.size===0)return;var $=this.start;if(this.size--,this.start++,this.start===this.capacity)this.start=0;var Z=this.dense[$];return this.sparse[Z]=this.capacity,Z};S$.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;var J=this.capacity,Q=this.size,K=this.start,q=0;while(q<Q)if($.call(Z,this.dense[K],q,this),K++,q++,K===J)K=0};S$.prototype.values=function(){var $=this.dense,Z=this.capacity,J=this.size,Q=this.start,K=0;return new yN(function(){if(K>=J)return{done:!0};var q=$[Q];if(Q++,K++,Q===Z)Q=0;return{value:q,done:!1}})};if(typeof Symbol!=="undefined")S$.prototype[Symbol.iterator]=S$.prototype.values;S$.prototype.inspect=function(){var $=[];return this.forEach(function(Z){$.push(Z)}),Object.defineProperty($,"constructor",{value:S$,enumerable:!1}),$.capacity=this.capacity,$};if(typeof Symbol!=="undefined")S$.prototype[Symbol.for("nodejs.util.inspect.custom")]=S$.prototype.inspect;S2.exports=S$});var y2=E((Pl,f2)=>{var X$=function($,Z){if(arguments.length<2)Z=$,$=Array;var J=xN(Z);this.size=0,this.length=Z,this.dense=new J(Z),this.sparse=new J(Z),this.vals=new $(Z)},l4=d0(),xN=B$().getPointerArray;X$.prototype.clear=function(){this.size=0};X$.prototype.has=function($){var Z=this.sparse[$];return Z<this.size&&this.dense[Z]===$};X$.prototype.get=function($){var Z=this.sparse[$];if(Z<this.size&&this.dense[Z]===$)return this.vals[Z];return};X$.prototype.set=function($,Z){var J=this.sparse[$];if(J<this.size&&this.dense[J]===$)return this.vals[J]=Z,this;return this.dense[this.size]=$,this.sparse[$]=this.size,this.vals[this.size]=Z,this.size++,this};X$.prototype.delete=function($){var Z=this.sparse[$];if(Z>=this.size||this.dense[Z]!==$)return!1;return Z=this.dense[this.size-1],this.dense[this.sparse[$]]=Z,this.sparse[Z]=this.sparse[$],this.size--,!0};X$.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;for(var J=0;J<this.size;J++)$.call(Z,this.vals[J],this.dense[J])};X$.prototype.keys=function(){var $=this.size,Z=this.dense,J=0;return new l4(function(){if(J<$){var Q=Z[J];return J++,{value:Q}}return{done:!0}})};X$.prototype.values=function(){var $=this.size,Z=this.vals,J=0;return new l4(function(){if(J<$){var Q=Z[J];return J++,{value:Q}}return{done:!0}})};X$.prototype.entries=function(){var $=this.size,Z=this.dense,J=this.vals,Q=0;return new l4(function(){if(Q<$){var K=[Z[Q],J[Q]];return Q++,{value:K}}return{done:!0}})};if(typeof Symbol!=="undefined")X$.prototype[Symbol.iterator]=X$.prototype.entries;X$.prototype.inspect=function(){var $=new Map;for(var Z=0;Z<this.size;Z++)$.set(this.dense[Z],this.vals[Z]);if(Object.defineProperty($,"constructor",{value:X$,enumerable:!1}),$.length=this.length,this.vals.constructor!==Array)$.type=this.vals.constructor.name;return $};if(typeof Symbol!=="undefined")X$.prototype[Symbol.for("nodejs.util.inspect.custom")]=X$.prototype.inspect;f2.exports=X$});var x2=E((Dl,g2)=>{var h$=function($){var Z=cN($);this.size=0,this.length=$,this.dense=new Z($),this.sparse=new Z($)},mN=d0(),cN=B$().getPointerArray;h$.prototype.clear=function(){this.size=0};h$.prototype.has=function($){var Z=this.sparse[$];return Z<this.size&&this.dense[Z]===$};h$.prototype.add=function($){var Z=this.sparse[$];if(Z<this.size&&this.dense[Z]===$)return this;return this.dense[this.size]=$,this.sparse[$]=this.size,this.size++,this};h$.prototype.delete=function($){var Z=this.sparse[$];if(Z>=this.size||this.dense[Z]!==$)return!1;return Z=this.dense[this.size-1],this.dense[this.sparse[$]]=Z,this.sparse[Z]=this.sparse[$],this.size--,!0};h$.prototype.forEach=function($,Z){Z=arguments.length>1?Z:this;var J;for(var Q=0;Q<this.size;Q++)J=this.dense[Q],$.call(Z,J,J)};h$.prototype.values=function(){var $=this.size,Z=this.dense,J=0;return new mN(function(){if(J<$){var Q=Z[J];return J++,{value:Q}}return{done:!0}})};if(typeof Symbol!=="undefined")h$.prototype[Symbol.iterator]=h$.prototype.values;h$.prototype.inspect=function(){var $=new Set;for(var Z=0;Z<this.size;Z++)$.add(this.dense[Z]);return Object.defineProperty($,"constructor",{value:h$,enumerable:!1}),$.length=this.length,$};if(typeof Symbol!=="undefined")h$.prototype[Symbol.for("nodejs.util.inspect.custom")]=h$.prototype.inspect;g2.exports=h$});var d2=E((Al,u2)=>{var uZ=function($){var Z=new Set;if(typeof $==="number")Z.add($);return{suggestions:Z,count:0}},m2=function($,Z,J){return{term:$||"",distance:Z||0,count:J||0}},p2=function($,Z,J,Q){Q=Q||new Set,Z++;var K,q=$.length,V;if(q>1){for(V=0;V<q;V++)if(K=$.substring(0,V)+$.substring(V+1),!Q.has(K)){if(Q.add(K),Z<J)p2(K,Z,J,Q)}}return Q},oN=function($,Z,J,Q,K,q){var V=J.suggestions.values().next().value;if(Z<2&&J.suggestions.size>0&&$[V].length-q.length>Q.length-q.length)J.suggestions=new Set,J.count=0;if(Z===2||!J.suggestions.size||$[V].length-q.length>=Q.length-q.length)J.suggestions.add(K)},c2=function($,Z){var J=$.length,Q=Z.length,K=[[]],q=J+Q,V=new Map,X,W,U;K[0][0]=q;for(X=0;X<=J;X++){if(!K[X+1])K[X+1]=[];K[X+1][1]=X,K[X+1][0]=q}for(U=0;U<=Q;U++)K[1][U+1]=U,K[0][U+1]=q;var z=$+Z,H;for(X=0,W=z.length;X<W;X++)if(H=z[X],!V.has(H))V.set(H,0);for(X=1;X<=J;X++){var G=0;for(U=1;U<=Q;U++){var Y=V.get(Z[U-1]),w=G;if($[X-1]===Z[U-1])K[X+1][U+1]=K[X][U],G=U;else K[X+1][U+1]=Math.min(K[X][U],K[X+1][U],K[X][U+1])+1;K[X+1][U+1]=Math.min(K[X+1][U+1],K[Y][w]+(X-Y-1)+1+(U-w-1))}V.set($[X-1],X)}return K[J+1][Q+1]},sN=function($,Z,J,Q,K,q){var V=q.length;if(V-Q>K)return[];var X=[q],W=new Set,U=new Set,z=[],H,G;while(X.length>0){if(H=X.shift(),J<2&&z.length>0&&V-H.length>z[0].distance)break;if(G=$[H],G!==void 0){if(typeof G==="number")G=uZ(G);if(G.count>0&&!U.has(H)){U.add(H);var Y=m2(H,V-H.length,G.count);if(z.push(Y),J<2&&V-H.length===0)break}G.suggestions.forEach((C)=>{var N=Z[C];if(U.has(N))return;U.add(N);var F=0;if(q!==N)if(N.length===H.length)F=V-H.length;else if(V===H.length)F=N.length-H.length;else{var L=0,k=0,o=N.length;while(L<o&&L<V&&N[L]===q[L])L++;while(k<o-L&&k<V&&N[o-k-1]===q[V-k-1])k++;if(L>0||k>0)F=c2(N.substr(L,o-L-k),q.substr(L,V-L-k));else F=c2(N,q)}if(J<2&&z.length>0&&z[0].distance>F)z=[];if(J<2&&z.length>0&&F>z[0].distance)return;if(F<=Q){var O=$[N];if(O!==void 0)z.push(m2(N,F,O.count))}})}if(V-H.length<Q){if(J<2&&z.length>0&&V-H.length>=z[0].distance)continue;for(var w=0,j=H.length;w<j;w++){var B=H.substring(0,w)+H.substring(w+1);if(!W.has(B))W.add(B),X.push(B)}}}if(J===0)return z.slice(0,1);return z},P8=function($){if($=$||{},this.clear(),this.maxDistance=typeof $.maxDistance==="number"?$.maxDistance:uN,this.verbosity=typeof $.verbosity==="number"?$.verbosity:dN,typeof this.maxDistance!=="number"||this.maxDistance<=0)throw Error("mnemonist/SymSpell.constructor: invalid `maxDistance` option. Should be a integer greater than 0.");if(!lN.has(this.verbosity))throw Error("mnemonist/SymSpell.constructor: invalid `verbosity` option. Should be either 0, 1 or 2.")},pN=C0(),uN=2,dN=2,lN=new Set([0,1,2]),nN={0:"Returns only the top suggestion",1:"Returns suggestions with the smallest edit distance",2:"Returns every suggestion (no early termination)"};P8.prototype.clear=function(){this.size=0,this.dictionary=Object.create(null),this.maxLength=0,this.words=[]};P8.prototype.add=function($){var Z=this.dictionary[$];if(Z!==void 0){if(typeof Z==="number")Z=uZ(Z),this.dictionary[$]=Z;Z.count++}else if(Z=uZ(),Z.count++,this.dictionary[$]=Z,$.length>this.maxLength)this.maxLength=$.length;if(Z.count===1){var J=this.words.length;this.words.push($);var Q=p2($,0,this.maxDistance);Q.forEach((K)=>{var q=this.dictionary[K];if(q!==void 0){if(typeof q==="number")q=uZ(q),this.dictionary[K]=q;if(!q.suggestions.has(J))oN(this.words,this.verbosity,q,$,J,K)}else this.dictionary[K]=J})}return this.size++,this};P8.prototype.search=function($){return sN(this.dictionary,this.words,this.verbosity,this.maxDistance,this.maxLength,$)};P8.prototype.inspect=function(){var $=[];$.size=this.size,$.maxDistance=this.maxDistance,$.verbosity=this.verbosity,$.behavior=nN[this.verbosity];for(var Z in this.dictionary)if(typeof this.dictionary[Z]==="object"&&this.dictionary[Z].count)$.push([Z,this.dictionary[Z].count]);return Object.defineProperty($,"constructor",{value:P8,enumerable:!1}),$};if(typeof Symbol!=="undefined")P8.prototype[Symbol.for("nodejs.util.inspect.custom")]=P8.prototype.inspect;P8.from=function($,Z){var J=new P8(Z);return pN($,function(Q){J.add(Q)}),J};u2.exports=P8});var n4=E((Ml,l2)=>{var P0=function($){this.mode=$===Array?"array":"string",this.clear()},iN=C0(),E7=d0(),n0=String.fromCharCode(0);P0.prototype.clear=function(){this.root={},this.size=0};P0.prototype.set=function($,Z){var J=this.root,Q;for(var K=0,q=$.length;K<q;K++)Q=$[K],J=J[Q]||(J[Q]={});if(!(n0 in J))this.size++;return J[n0]=Z,this};P0.prototype.update=function($,Z){var J=this.root,Q;for(var K=0,q=$.length;K<q;K++)Q=$[K],J=J[Q]||(J[Q]={});if(!(n0 in J))this.size++;return J[n0]=Z(J[n0]),this};P0.prototype.get=function($){var Z=this.root,J,Q,K;for(Q=0,K=$.length;Q<K;Q++)if(J=$[Q],Z=Z[J],typeof Z==="undefined")return;if(!(n0 in Z))return;return Z[n0]};P0.prototype.delete=function($){var Z=this.root,J=null,Q=null,K,q,V,X;for(V=0,X=$.length;V<X;V++){if(q=$[V],K=Z,Z=Z[q],typeof Z==="undefined")return!1;if(J!==null){if(Object.keys(Z).length>1)J=null,Q=null}else if(Object.keys(Z).length<2)J=K,Q=q}if(!(n0 in Z))return!1;if(this.size--,J)delete J[Q];else delete Z[n0];return!0};P0.prototype.has=function($){var Z=this.root,J;for(var Q=0,K=$.length;Q<K;Q++)if(J=$[Q],Z=Z[J],typeof Z==="undefined")return!1;return n0 in Z};P0.prototype.find=function($){var Z=typeof $==="string",J=this.root,Q=[],K,q,V;for(q=0,V=$.length;q<V;q++)if(K=$[q],J=J[K],typeof J==="undefined")return Q;var X=[J],W=[$],U;while(X.length){$=W.pop(),J=X.pop();for(U in J){if(U===n0){Q.push([$,J[n0]]);continue}X.push(J[U]),W.push(Z?$+U:$.concat(U))}}return Q};P0.prototype.values=function($){var Z=this.root,J=[],Q,K,q;if($){for(K=0,q=$.length;K<q;K++)if(Q=$[K],Z=Z[Q],typeof Z==="undefined")return E7.empty()}return J.push(Z),new E7(function(){var V,X=!1,W;while(J.length){V=J.pop();for(W in V){if(W===n0){X=!0;continue}J.push(V[W])}if(X)return{done:!1,value:V[n0]}}return{done:!0}})};P0.prototype.prefixes=function($){var Z=this.root,J=[],Q=[],K,q,V,X=this.mode==="string";if($){for(q=0,V=$.length;q<V;q++)if(K=$[q],Z=Z[K],typeof Z==="undefined")return E7.empty()}else $=X?"":[];return J.push(Z),Q.push($),new E7(function(){var W,U,z=!1,H;while(J.length){W=J.pop(),U=Q.pop();for(H in W){if(H===n0){z=!0;continue}J.push(W[H]),Q.push(X?U+H:U.concat(H))}if(z)return{done:!1,value:U}}return{done:!0}})};P0.prototype.keys=P0.prototype.prefixes;P0.prototype.entries=function($){var Z=this.root,J=[],Q=[],K,q,V,X=this.mode==="string";if($){for(q=0,V=$.length;q<V;q++)if(K=$[q],Z=Z[K],typeof Z==="undefined")return E7.empty()}else $=X?"":[];return J.push(Z),Q.push($),new E7(function(){var W,U,z=!1,H;while(J.length){W=J.pop(),U=Q.pop();for(H in W){if(H===n0){z=!0;continue}J.push(W[H]),Q.push(X?U+H:U.concat(H))}if(z)return{done:!1,value:[U,W[n0]]}}return{done:!0}})};if(typeof Symbol!=="undefined")P0.prototype[Symbol.iterator]=P0.prototype.entries;P0.prototype.inspect=function(){var $=new Array(this.size),Z=this.entries(),J,Q=0;while(J=Z.next(),!J.done)$[Q++]=J.value;return Object.defineProperty($,"constructor",{value:P0,enumerable:!1}),$};if(typeof Symbol!=="undefined")P0.prototype[Symbol.for("nodejs.util.inspect.custom")]=P0.prototype.inspect;P0.prototype.toJSON=function(){return this.root};P0.from=function($){var Z=new P0;return iN($,function(J,Q){Z.set(Q,J)}),Z};P0.SENTINEL=n0;l2.exports=P0});var s2=E((kl,o2)=>{var o0=function($){this.mode=$===Array?"array":"string",this.clear()},aN=C0(),n2=n4(),dZ=String.fromCharCode(0);for(o4 in n2.prototype)o0.prototype[o4]=n2.prototype[o4];var o4;delete o0.prototype.set;delete o0.prototype.get;delete o0.prototype.values;delete o0.prototype.entries;o0.prototype.add=function($){var Z=this.root,J;for(var Q=0,K=$.length;Q<K;Q++)J=$[Q],Z=Z[J]||(Z[J]={});if(!(dZ in Z))this.size++;return Z[dZ]=!0,this};o0.prototype.find=function($){var Z=typeof $==="string",J=this.root,Q=[],K,q,V;for(q=0,V=$.length;q<V;q++)if(K=$[q],J=J[K],typeof J==="undefined")return Q;var X=[J],W=[$],U;while(X.length){$=W.pop(),J=X.pop();for(U in J){if(U===dZ){Q.push($);continue}X.push(J[U]),W.push(Z?$+U:$.concat(U))}}return Q};if(typeof Symbol!=="undefined")o0.prototype[Symbol.iterator]=o0.prototype.keys;o0.prototype.inspect=function(){var $=new Set,Z=this.keys(),J;while(J=Z.next(),!J.done)$.add(J.value);return Object.defineProperty($,"constructor",{value:o0,enumerable:!1}),$};if(typeof Symbol!=="undefined")o0.prototype[Symbol.for("nodejs.util.inspect.custom")]=o0.prototype.inspect;o0.prototype.toJSON=function(){return this.root};o0.from=function($){var Z=new o0;return aN($,function(J){Z.add(J)}),Z};o0.SENTINEL=dZ;o2.exports=o0});var t2=E((El,r2)=>{var q0=function($,Z){if(arguments.length<1)throw new Error("mnemonist/vector: expecting at least a byte array constructor.");var J=Z||0,Q=eN,K=0,q=!1;if(typeof Z==="object")J=Z.initialCapacity||0,K=Z.initialLength||0,Q=Z.policy||Q,q=Z.factory===!0;this.factory=q?$:null,this.ArrayClass=$,this.length=K,this.capacity=Math.max(K,J),this.policy=Q,this.array=new $(this.capacity)},D8=function($){var Z=function(Q){q0.call(this,$,Q)};for(var J in q0.prototype)if(q0.prototype.hasOwnProperty(J))Z.prototype[J]=q0.prototype[J];if(Z.from=function(Q,K){return q0.from(Q,$,K)},typeof Symbol!=="undefined")Z.prototype[Symbol.iterator]=Z.prototype.values;return Z},i2=d0(),rN=C0(),tN=A$(),a2=B$(),eN=function($){return Math.max(1,Math.ceil($*1.5))},$C=function($){var Z=a2.getPointerArray($);return new Z($)};q0.prototype.set=function($,Z){if(this.length<$)throw new Error("Vector("+this.ArrayClass.name+").set: index out of bounds.");return this.array[$]=Z,this};q0.prototype.get=function($){if(this.length<$)return;return this.array[$]};q0.prototype.applyPolicy=function($){var Z=this.policy($||this.capacity);if(typeof Z!=="number"||Z<0)throw new Error("mnemonist/vector.applyPolicy: policy returned an invalid value (expecting a positive integer).");if(Z<=this.capacity)throw new Error("mnemonist/vector.applyPolicy: policy returned a less or equal capacity to allocate.");return Z};q0.prototype.reallocate=function($){if($===this.capacity)return this;var Z=this.array;if($<this.length)this.length=$;if($>this.capacity){if(this.factory===null)this.array=new this.ArrayClass($);else this.array=this.factory($);if(a2.isTypedArray(this.array))this.array.set(Z,0);else for(var J=0,Q=this.length;J<Q;J++)this.array[J]=Z[J]}else this.array=Z.slice(0,$);return this.capacity=$,this};q0.prototype.grow=function($){var Z;if(typeof $==="number"){if(this.capacity>=$)return this;Z=this.capacity;while(Z<$)Z=this.applyPolicy(Z);return this.reallocate(Z),this}return Z=this.applyPolicy(),this.reallocate(Z),this};q0.prototype.resize=function($){if($===this.length)return this;if($<this.length)return this.length=$,this;return this.length=$,this.reallocate($),this};q0.prototype.push=function($){if(this.capacity===this.length)this.grow();return this.array[this.length++]=$,this.length};q0.prototype.pop=function(){if(this.length===0)return;return this.array[--this.length]};q0.prototype.values=function(){var $=this.array,Z=this.length,J=0;return new i2(function(){if(J>=Z)return{done:!0};var Q=$[J];return J++,{value:Q,done:!1}})};q0.prototype.entries=function(){var $=this.array,Z=this.length,J=0;return new i2(function(){if(J>=Z)return{done:!0};var Q=$[J];return{value:[J++,Q],done:!1}})};if(typeof Symbol!=="undefined")q0.prototype[Symbol.iterator]=q0.prototype.values;q0.prototype.inspect=function(){var $=this.array.slice(0,this.length);return $.type=this.array.constructor.name,$.items=this.length,$.capacity=this.capacity,Object.defineProperty($,"constructor",{value:q0,enumerable:!1}),$};if(typeof Symbol!=="undefined")q0.prototype[Symbol.for("nodejs.util.inspect.custom")]=q0.prototype.inspect;q0.from=function($,Z,J){if(arguments.length<3){if(J=tN.guessLength($),typeof J!=="number")throw new Error("mnemonist/vector.from: could not guess iterable length. Please provide desired capacity as last argument.")}var Q=new q0(Z,J);return rN($,function(K){Q.push(K)}),Q};q0.Int8Vector=D8(Int8Array);q0.Uint8Vector=D8(Uint8Array);q0.Uint8ClampedVector=D8(Uint8ClampedArray);q0.Int16Vector=D8(Int16Array);q0.Uint16Vector=D8(Uint16Array);q0.Int32Vector=D8(Int32Array);q0.Uint32Vector=D8(Uint32Array);q0.Float32Vector=D8(Float32Array);q0.Float64Vector=D8(Float64Array);q0.PointerVector=D8($C);r2.exports=q0});var $z=E((Tl,e2)=>{var XC=function($,Z){if($.distance<Z.distance)return 1;if($.distance>Z.distance)return-1;return 0},WC=function($,Z,J){var Q=J.length,K=VC(Q),q=0,V=new K(Q),X=new K(Q),W=new K(Q),U=new Float64Array(Q),z=[0,0,Q],H=new Float64Array(Q),G,Y,w,j,B,C,N,F,L;while(z.length){if(B=z.pop(),j=z.pop(),G=z.pop(),Y=J[B-1],B--,L=B-j,V[G]=Y,L===0)continue;if(L===1){N=$(Z[Y],Z[J[j]]),U[G]=N,q++,W[G]=q,V[q]=J[j];continue}for(F=j;F<B;F++)H[J[F]]=$(Z[Y],Z[J[F]]);if(QC(H,J,j,B),w=j+L/2-1,w===(w|0))N=(H[J[w]]+H[J[w+1]])/2;else N=H[J[Math.ceil(w)]];if(U[G]=N,C=KC(H,J,N,j,B),B-C>0)q++,W[G]=q,z.push(q,C,B);if(C-j>0)q++,X[G]=q,z.push(q,j,C)}return{nodes:V,lefts:X,rights:W,mus:U}},u8=function($,Z){if(typeof $!=="function")throw new Error("mnemonist/VPTree.constructor: given `distance` must be a function.");if(!Z)throw new Error("mnemonist/VPTree.constructor: you must provide items to the tree. A VPTree cannot be updated after its creation.");this.distance=$,this.heap=new qC(XC),this.D=0;var J=ZC.toArrayWithIndices(Z);this.items=J[0];var Q=J[1];this.size=Q.length;var K=WC($,this.items,Q);this.nodes=K.nodes,this.lefts=K.lefts,this.rights=K.rights,this.mus=K.mus},ZC=A$(),JC=B$(),QC=x4().inplaceQuickSortIndices,KC=g4().lowerBoundIndices,qC=fZ(),VC=JC.getPointerArray;u8.prototype.nearestNeighbors=function($,Z){var J=this.heap,Q=[0],K=Infinity,q,V,X,W,U,z,H;this.D=0;while(Q.length){if(q=Q.pop(),V=this.nodes[q],X=this.items[V],H=this.distance(X,Z),this.D++,H<K){if(J.push({distance:H,item:X}),J.size>$)J.pop();if(J.size>=$)K=J.peek().distance}if(W=this.lefts[q],U=this.rights[q],!W&&!U)continue;if(z=this.mus[q],H<z){if(W&&H<z+K)Q.push(W);if(U&&H>=z-K)Q.push(U)}else{if(U&&H>=z-K)Q.push(U);if(W&&H<z+K)Q.push(W)}}var G=new Array(J.size);for(var Y=J.size-1;Y>=0;Y--)G[Y]=J.pop();return G};u8.prototype.neighbors=function($,Z){var J=[],Q=[0],K,q,V,X,W,U,z;this.D=0;while(Q.length){if(K=Q.pop(),q=this.nodes[K],V=this.items[q],z=this.distance(V,Z),this.D++,z<=$)J.push({distance:z,item:V});if(X=this.lefts[K],W=this.rights[K],!X&&!W)continue;if(U=this.mus[K],z<U){if(X&&z<U+$)Q.push(X);if(W&&z>=U-$)Q.push(W)}else{if(W&&z>=U-$)Q.push(W);if(X&&z<U+$)Q.push(X)}}return J};u8.prototype.inspect=function(){var $=this.items.slice();return Object.defineProperty($,"constructor",{value:u8,enumerable:!1}),$};if(typeof Symbol!=="undefined")u8.prototype[Symbol.for("nodejs.util.inspect.custom")]=u8.prototype.inspect;u8.from=function($,Z){return new u8(Z,$)};e2.exports=u8});var Qz=E((bl,Jz)=>{var s4=fZ(),i4=I4(),Zz=iW();Jz.exports={BiMap:$U(),BitSet:WU(),BitVector:GU(),BloomFilter:NU(),BKTree:LU(),CircularBuffer:PU(),DefaultMap:AU(),DefaultWeakMap:kU(),FixedDeque:k4(),StaticDisjointSet:TU(),FibonacciHeap:i4,MinFibonacciHeap:i4.MinFibonacciHeap,MaxFibonacciHeap:i4.MaxFibonacciHeap,FixedReverseHeap:gZ(),FuzzyMap:yU(),FuzzyMultiMap:cU(),HashedArrayTree:dU(),Heap:s4,MinHeap:s4.MinHeap,MaxHeap:s4.MaxHeap,StaticIntervalTree:sU(),InvertedIndex:Q2(),KDTree:W2(),LinkedList:H2(),LRUCache:cZ(),LRUCacheWithDelete:w2(),LRUMap:u4(),LRUMapWithDelete:F2(),MultiMap:S4(),MultiSet:C2(),PassjoinIndex:P2(),Queue:M2(),FixedStack:f4(),Stack:T2(),SuffixArray:Zz,GeneralizedSuffixArray:Zz.GeneralizedSuffixArray,Set:v2(),SparseQueueSet:h2(),SparseMap:y2(),SparseSet:x2(),SymSpell:d2(),Trie:s2(),TrieMap:n4(),Vector:t2(),VPTree:$z()}});var qz=l6(H9(),1);function WJ($,Z,J){var Q=window,K="application/octet-stream",q=J||K,V=$,X=!Z&&!J&&V,W=document.createElement("a"),U=function(L){return String(L)},z=Q.Blob||Q.MozBlob||Q.WebKitBlob||U,H=Z||"download",G,Y;if(z=z.call?z.bind(Q):Blob,X&&X.length<2048){if(H=X.split("/").pop().split("?")[0],W.href=X,W.href.indexOf(X)!==-1){var w=new XMLHttpRequest;return w.open("GET",X,!0),w.responseType="blob",w.onload=function(L){WJ(L.target.response,H,K)},setTimeout(function(){w.send()},0),w}}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(V))if(V.length>2096103.424&&z!==U)V=N(V),q=V.type||K;else return navigator.msSaveBlob?navigator.msSaveBlob(N(V),H):F(V);else if(/([\x80-\xff])/.test(V)){var j=0,B=new Uint8Array(V.length),C=B.length;for(j;j<C;++j)B[j]=V.charCodeAt(j);V=new z([B],{type:q})}G=V instanceof z?V:new z([V],{type:q});function N(L){var k=L.split(/[:;,]/),o=k[1],O=L.indexOf("charset")>0?3:2,h=k[O]=="base64"?atob:decodeURIComponent,c=h(k.pop()),S=c.length,M=0,y=new Uint8Array(S);for(M;M<S;++M)y[M]=c.charCodeAt(M);return new z([y],{type:o})}function F(L,k){if("download"in W)return W.href=L,W.setAttribute("download",H),W.className="download-js-link",W.innerHTML="downloading...",W.style.display="none",W.addEventListener("click",function(O){O.stopPropagation(),this.removeEventListener("click",arguments.callee)}),document.body.appendChild(W),setTimeout(function(){if(W.click(),document.body.removeChild(W),k===!0)setTimeout(function(){Q.URL.revokeObjectURL(W.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)){if(/^data:/.test(L))L="data:"+L.replace(/^data:([\w\/\-\+]+)/,K);if(!window.open(L)){if(confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page."))location.href=L}return!0}var o=document.createElement("iframe");if(document.body.appendChild(o),!k&&/^data:/.test(L))L="data:"+L.replace(/^data:([\w\/\-\+]+)/,K);o.src=L,setTimeout(function(){document.body.removeChild(o)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(G,H);if(Q.URL)F(Q.URL.createObjectURL(G),!0);else{if(typeof G==="string"||G.constructor===U)try{return F("data:"+q+";base64,"+Q.btoa(G))}catch(L){return F("data:"+q+","+encodeURIComponent(G))}Y=new FileReader,Y.onload=function(L){F(this.result)},Y.readAsDataURL(G)}return!0}class x0{static poecdn="http://web.poecdn.com/";static DATA_URI="data";static SKILL_TREES_URI=`${x0.DATA_URI}/skill-trees`;static getKeyByValue($,Z){return Object.keys($).find((J)=>{return $[J]===Z})}static NotUndefined($){return $!==void 0}static NotNullOrWhiteSpace($){return $!==void 0&&$!==null&&$.trim()!==""}static Download($,Z,J){return WJ($,Z,J)}}var _;(function(U){U[U["None"]=0]="None";U[U["Active"]=1<<0]="Active";U[U["Hovered"]=1<<1]="Hovered";U[U["Pathing"]=1<<2]="Pathing";U[U["Highlighted"]=1<<3]="Highlighted";U[U["Compared"]=1<<4]="Compared";U[U["Moved"]=1<<5]="Moved";U[U["Desired"]=1<<6]="Desired";U[U["UnDesired"]=1<<7]="UnDesired"})(_||(_={}));var E8;(function(J){J[J["Line"]=0]="Line";J[J["Arc"]=1]="Arc"})(E8||(E8={}));class UJ{id;activeEffectImage;activeIcon;ascendancyName;classStartIndex;expansionJewel;flavourText;grantedDexterity;grantedIntelligence;grantedPassivePoints;grantedStrength;group;icon;in;inactiveIcon;isAscendancyStart;isBlighted;isJewelSocket;isKeystone;isMastery;isMultipleChoice;isMultipleChoiceOption;isNotable;isProxy;isWormhole;masteryEffects;name;orbit;orbitIndex;out;recipe;reminderText;skill;stats;state;nodeGroup;orbitAngles;orbitRadii;scale;arc;x;y;isRegular2;isRegular1;targetSize;hoverText=null;patch;distance;constructor($,Z,J,Q,K,q,V){this.id=$,this.activeEffectImage=Z.activeEffectImage||"",this.activeIcon=Z.activeIcon||"",this.ascendancyName=Z.ascendancyName||"",this.classStartIndex=Z.classStartIndex,this.expansionJewel=Z.expansionJewel,this.flavourText=Z.flavourText||[],this.grantedDexterity=Z.grantedDexterity||0,this.grantedIntelligence=Z.grantedIntelligence||0,this.grantedPassivePoints=Z.grantedPassivePoints||0,this.grantedStrength=Z.grantedStrength||0,this.group=Z.group,this.icon=Z.icon,this.in=Z.in,this.inactiveIcon=Z.inactiveIcon||"",this.isAscendancyStart=Z.isAscendancyStart||!1,this.isBlighted=Z.isBlighted,this.isJewelSocket=Z.isJewelSocket,this.isKeystone=Z.isKeystone||!1,this.isMastery=Z.isMastery||!1,this.isMultipleChoice=Z.isMultipleChoice||!1,this.isMultipleChoiceOption=Z.isMultipleChoiceOption||!1,this.isNotable=Z.isNotable||!1,this.isProxy=Z.isProxy||!1,this.isWormhole=Z.isWormhole||!1,this.masteryEffects=Z.masteryEffects||[],this.name=Z.name,this.orbit=Z.orbit,this.orbitIndex=Z.orbitIndex,this.out=Z.out,this.recipe=Z.recipe||[],this.reminderText=Z.reminderText||[],this.skill=Z.skill,this.stats=Z.stats,this.distance=Z.distance,this.state=_.None,this.nodeGroup=J,this.orbitAngles=K,this.orbitRadii=Q,this.scale=q,this.arc=this.getArc(this.orbitIndex),this.x=this.getX(this.arc),this.y=this.getY(this.arc),this.isRegular2=!this.isKeystone&&!this.isNotable&&!this.isJewelSocket&&!this.isMastery&&!this.isWormhole,this.isRegular1=this.isRegular2&&(this.grantedStrength>0||this.grantedDexterity>0||this.grantedIntelligence>0)&&this.stats.filter(x0.NotNullOrWhiteSpace).length===1,this.targetSize=this.getTargetSize(),this.patch=V}getArc=($)=>this.orbitAngles[this.orbit]!==void 0&&this.orbitAngles[this.orbit].length>$?this.orbitAngles[this.orbit][$]:0;getX=($)=>this.orbitRadii.length>this.orbit&&this.nodeGroup!==void 0?this.nodeGroup.x*this.scale-this.orbitRadii[this.orbit]*this.scale*Math.sin(-$):0;getY=($)=>this.orbitRadii.length>this.orbit&&this.nodeGroup!==void 0?this.nodeGroup.y*this.scale-this.orbitRadii[this.orbit]*this.scale*Math.cos(-$):0;getTargetSize=()=>{if(this.isRegular1||this.isRegular2)return{width:Math.floor(70*this.scale),height:Math.floor(70*this.scale)};if(this.isNotable||this.isJewelSocket||this.isMastery)return{width:Math.floor(100*this.scale),height:Math.floor(100*this.scale)};if(this.isKeystone||this.isWormhole)return{width:Math.floor(138*this.scale),height:Math.floor(140*this.scale)};return{width:0,height:0}};is=($)=>{return(this.state&$)===$};_add=($)=>{this.state|=$};_remove=($)=>{this.state&=~$};GetId=()=>{return`${this.id}`};GetIcon=()=>{if(this.isMastery){if(this.is(_.Active)&&this.activeIcon)return this.activeIcon;if(this.inactiveIcon)return this.inactiveIcon}else if(this.isWormhole)return"Wormhole";return this.icon};GetDrawType=($)=>{if(this.is(_.Active)||this.is(_.Hovered)){if(this.expansionJewel!==void 0||this.isProxy||this.nodeGroup?.isProxy)return"Active";if(this.isWormhole&&this.is(_.Hovered))return"Highlight";return"Allocated"}else if($.filter((Z)=>Z&&Z.is(_.Active)).length>0)return"CanAllocate";else if(this.ascendancyName!==""||this.expansionJewel!==void 0||this.isProxy||this.nodeGroup?.isProxy)return"Normal";return"Unallocated"};GetFrameAssetKey=($)=>{const Z=this.GetDrawType($);if(this.isAscendancyStart)return"AscendancyMiddle";else if(this.isJewelSocket){if(this.expansionJewel!==void 0||this.isProxy||this.nodeGroup?.isProxy)return`JewelSocketAlt${Z}`;if(this.name==="Charm Socket")return`CharmFrame${Z}`;return`JewelFrame${Z}`}else if(this.isKeystone)return`KeystoneFrame${Z}`;else if(this.isNotable&&this.ascendancyName===""){if(this.isBlighted)return`BlightedNotableFrame${Z}`;return`NotableFrame${Z}`}else if(this.isNotable&&this.ascendancyName!=="")return`AscendancyFrameLarge${Z}`;else if(this.isMastery)return null;else if(this.ascendancyName!=="")return`AscendancyFrameSmall${Z}`;else if(this.isWormhole)return`WormholeFrame${Z}`;switch(Z){case"Normal":case"Unallocated":return"PSSkillFrame";case"CanAllocate":return"PSSkillFrameHighlighted";case"Active":case"Allocated":return"PSSkillFrameActive";default:return null}};GetSpriteSheetKey=()=>{const $=this.is(_.Active)?"Active":"Inactive";if(this.isKeystone)return`keystone${$}`;else if(this.isNotable)return`notable${$}`;else if(this.isMastery)if(this.activeEffectImage!=="")if(this.is(_.Active))return"masteryActiveSelected";else if(this.is(_.Hovered)||this.is(_.Pathing))return"masteryConnected";else return"masteryInactive";else if(this.is(_.Active)||this.is(_.Hovered))return"masteryConnected";else return"mastery";else if(this.isWormhole)return`wormhole${$}`;return`normal${$}`};GetConnectionType=($)=>{return this.is(_.Active)&&$.is(_.Active)?"Active":this.is(_.Active)||$.is(_.Active)||this.is(_.Pathing)&&$.is(_.Pathing)?"Intermediate":"Normal"}}class zJ{classes;characterAttributes;PSSCentreInnerRadius;skillsPerOrbit;orbitRadii;classesToName;classIdToName;constructor($){this.classes=$.classes,this.characterAttributes=$.characterAttributes,this.PSSCentreInnerRadius=$.PSSCentreInnerRadius,this.skillsPerOrbit=$.skillsPerOrbit,this.orbitRadii=$.orbitRadii,this.classesToName={StrClass:"Marauder",DexClass:"Ranger",IntClass:"Witch",StrDexClass:"Duelist",StrIntClass:"Templar",DexIntClass:"Shadow",StrDexIntClass:"Scion"},this.classIdToName={0:"Scion",1:"Marauder",2:"Ranger",3:"Witch",4:"Duelist",5:"Templar",6:"Shadow"}}}var d8=l6(H9(),1);class L${static v3_22_0=new d8.SemVer("3.22.0");static v3_22_0_atlas=new d8.SemVer("3.22.0-atlas");static v3_23_0=new d8.SemVer("3.23.0");static v3_23_0_atlas=new d8.SemVer("3.23.0-atlas");static v3_24_0=new d8.SemVer("3.24.0");static v3_24_0_standard=new d8.SemVer("3.24.0-standard");static v3_24_0_atlas=new d8.SemVer("3.24.0-atlas")}class HJ{_cells;_bounds;_dimensions;_queryIds;constructor($,Z){const[J,Q]=Z;this._cells=[...Array(J)].map((K)=>[...Array(Q)].map((q)=>null)),this._dimensions=Z,this._bounds=$,this._queryIds=0}getCellIndex=($)=>{const Z=this.sat(($.x-this._bounds[0][0])/(this._bounds[1][0]-this._bounds[0][0])),J=this.sat(($.y-this._bounds[0][1])/(this._bounds[1][1]-this._bounds[0][1])),Q=Math.floor(Z*(this._dimensions[0]-1)),K=Math.floor(J*(this._dimensions[1]-1));return[Q,K]};add=($,Z,J)=>{const Q={id:$,position:Z,dimensions:J,_cells:{min:null,max:null,nodes:null},_queryId:-1},K=Q.position.x,q=Q.position.y,V=Q.dimensions.width,X=Q.dimensions.height,W=this.getCellIndex({x:K-V/2,y:q-X/2}),U=this.getCellIndex({x:K+V/2,y:q+X/2}),z=new Array;for(let H=W[0],G=U[0];H<=G;++H){z.push([]);for(let Y=W[1],w=U[1];Y<=w;++Y){const j=H-W[0],B={next:null,prev:null,client:Q};if(z[j].push(B),B.next=this._cells[H][Y],this._cells[H][Y]!==null)this._cells[H][Y].prev=B;this._cells[H][Y]=B}}Q._cells.min=W,Q._cells.max=U,Q._cells.nodes=z};find=($,Z)=>{const{x:J,y:Q}=$,K=Z.width,q=Z.height,V=this.getCellIndex({x:J-K/2,y:Q-q/2}),X=this.getCellIndex({x:J+K/2,y:Q+q/2}),W=new Array,U=this._queryIds++;for(let z=V[0],H=X[0];z<=H;++z)for(let G=V[1],Y=X[1];G<=Y;++G){let w=this._cells[z][G];while(w){const j=w.client;if(w=w.next,j._queryId!=U)j._queryId=U,W.push(j.id)}}return W};sat=($)=>{return Math.min(Math.max($,0),1)}}class GJ{tree;patch;version;masteryEffects;classes;alternate_ascendancies;groups;root;nodes;min_x;min_y;max_x;max_y;desired_min_x;desired_min_y;desired_max_x;desired_max_y;imageZoomLevels;sprites;constants;points;jewelSlots;extraImages;width;height;maxZoomLevel;scale;classStartNodes;ascendancyNodes;nodesInState={[_.None]:new Array,[_.Active]:new Array,[_.Hovered]:new Array,[_.Pathing]:new Array,[_.Highlighted]:new Array,[_.Compared]:new Array,[_.Moved]:new Array,[_.Desired]:new Array,[_.UnDesired]:new Array};grid;constructor($,Z){this.tree=$.tree||"Default",this.patch=Z,this.version=4,$.version=this.version,this.masteryEffects=[],this.jewelSlots=$.jewelSlots,this.extraImages=$.extraImages,this.groups=$.groups,this.root=$.nodes.root,this.extraImages=$.extraImages,this.min_x=$.min_x,this.max_x=$.max_x,this.min_y=$.min_y,this.max_y=$.max_y,this.desired_min_x=1e5,this.desired_max_x=-1e5,this.desired_min_y=1e5,this.desired_max_y=-1e5,this.imageZoomLevels=$.imageZoomLevels,this.constants=new zJ($.constants),this.points=$.points||{totalPoints:121,ascendancyPoints:8},this.width=Math.abs(this.min_x)+Math.abs(this.max_x),this.height=Math.abs(this.min_y)+Math.abs(this.max_y),this.maxZoomLevel=$.imageZoomLevels.length-1,this.scale=$.imageZoomLevels[this.maxZoomLevel],this.sprites=$.sprites,this.classes=$.classes||[],this.alternate_ascendancies=$.alternate_ascendancies||[],this.root.id="root",delete $.nodes.root;const J=1450;if(this.classes.length>0){const K={};for(let q in $.nodes){const V=$.nodes[q],X=`${V.group||0}`;if(V.isAscendancyStart&&K[X]===void 0){let W=void 0;for(let w of V.out)if($.nodes[w].classStartIndex!==void 0)W=$.nodes[w];for(let w of V.in)if($.nodes[w].classStartIndex!==void 0)W=$.nodes[w];if(W===void 0)continue;let U=0;if(W.classStartIndex!==void 0){const w=this.classes[W.classStartIndex].ascendancies;for(let j in w)if(V.ascendancyName&&w[j].id.toLowerCase().includes(V.ascendancyName.toLowerCase())){U=+j-1;break}}const z=100;let H=0,G=0;const Y=this.groups[W.group||0];if(Y.x>-z&&Y.x<z&&(Y.y>-z&&Y.y<z)){if(H=this.min_x*0.65,G=this.max_y*0.95,this.patch.compare(L$.v3_22_0)>=0)H=this.min_x*0.85,G=this.max_y*0.85}else if(Y.x>-z&&Y.x<z)H=Y.x+Math.sign(Y.x)*U*J,G=Math.sign(Y.y)>0?this.max_y*1.05:this.min_y;else if(H=Y.x<0?this.min_x*0.8:this.max_x,G=Y.y+Math.sign(Y.y)*(U+1)*J,this.patch.compare(L$.v3_22_0)>=0)H=Y.x<0?this.min_x*1.05:this.max_x;K[X]=!0;for(let w in $.nodes){const j=$.nodes[w],B=`${j.group||0}`;if(K[B]===void 0&&j.ascendancyName===V.ascendancyName){const C=this.groups[X].x-this.groups[B].x,N=this.groups[X].y-this.groups[B].y;this.groups[B].x=H-C,this.groups[B].y=G-N,K[B]=!0}}this.groups[X].x=H,this.groups[X].y=G}}}if(this.alternate_ascendancies.length>0){const K={};for(let q in $.nodes){const V=$.nodes[q],X=`${V.group||0}`;if(!V.isAscendancyStart||K[X]!==void 0)continue;let W=-1;for(let G in this.alternate_ascendancies)if(this.alternate_ascendancies[G].id===V.ascendancyName){W=+G;break}if(W===-1)continue;const U=W-1,z=this.max_x*0.8+U*-J*0.75,H=this.max_y*0.9+U*J*0.75;K[X]=!0;for(let G in $.nodes){const Y=$.nodes[G],w=`${Y.group||0}`;if(K[w]===void 0&&Y.ascendancyName===V.ascendancyName){const j=this.groups[X].x-this.groups[w].x,B=this.groups[X].y-this.groups[w].y;this.groups[w].x=z-j,this.groups[w].y=H-B,K[w]=!0}}this.groups[X].x=z,this.groups[X].y=H}}this.grid=new HJ([[this.min_x,this.min_y],[this.max_x,this.max_y]],[100,100]),this.nodes={},this.classStartNodes={},this.ascendancyNodes={};const Q=this.getOrbitAngles($.constants.skillsPerOrbit);for(let K in $.nodes){const q=$.nodes[K].group||0,V=new UJ(K,$.nodes[K],this.groups[q],$.constants.orbitRadii,Q,this.scale,this.patch);if(this.root.out.indexOf(K)>=0){if(V.classStartIndex===void 0&&V.ascendancyName==="")V.classStartIndex=this.root.out.indexOf(K);if(V.ascendancyName!=="")V.isAscendancyStart=!0}if(this.nodes[K]=V,V.classStartIndex===this.getDefaultStartNode())this.addState(V,_.Active),this.addState(V,_.Desired);if(V.ascendancyName!=="")this.ascendancyNodes[K]=V;if(V.classStartIndex!==void 0)this.classStartNodes[K]=V;if(this.shouldAddToGrid(V))this.grid.add(V.id,{x:V.x,y:V.y},V.targetSize)}}getDefaultStartNode=()=>{if(this.tree.slice(0,5)==="Atlas")return 0;return 3};shouldAddToGrid=($)=>{return $.group!==void 0&&$.classStartIndex===void 0};getOrbitAngles=($)=>{const Z={};for(let K in $){const q=$[K];if(Z[K]=[],q===16)Z[K]=[0,30,45,60,90,120,135,150,180,210,225,240,270,300,315,330];else if(q===40)Z[K]=[0,10,20,30,40,45,50,60,70,80,90,100,110,120,130,135,140,150,160,170,180,190,200,210,220,225,230,240,250,260,270,280,290,300,310,315,320,330,340,350];else for(let V=0;V<q;V++)Z[K].push(360*V/q)}const J={},Q=Math.PI/180;for(let K in Z){const q=Z[K];J[K]=[];for(let V of q)J[K].push(V*Q)}return J};getStartClass=()=>{for(let $ in this.classStartNodes)if(this.nodes[$].is(_.Active))return this.nodes[$].classStartIndex||0;for(let $ in this.classStartNodes)return this.addState(this.nodes[$],_.Active),this.addState(this.nodes[$],_.Desired),this.nodes[$].classStartIndex||0;return 0};getAscendancyClass=()=>{if(this.classes===void 0||this.classes.length===0)return 0;for(let $ in this.ascendancyNodes)if(this.nodes[$].isAscendancyStart&&this.nodes[$].is(_.Active))for(let Z in this.classes){const J=this.classes[Z].ascendancies;if(J===void 0)continue;for(let Q in J)if(J[Q].id===this.nodes[$].ascendancyName)return+Q+1}return 0};getWildwoodAscendancyClass=()=>{if(this.alternate_ascendancies===void 0||this.alternate_ascendancies.length===0)return 0;for(let $ in this.ascendancyNodes)if(this.nodes[$].isAscendancyStart&&this.nodes[$].is(_.Active)){for(let Z in this.alternate_ascendancies)if(this.alternate_ascendancies[Z].id===this.nodes[$].ascendancyName)return+Z+1}return 0};isWildwoodAscendancyClass=($)=>{if($.ascendancyName==="")return!1;for(let Z of this.alternate_ascendancies)if($.ascendancyName===Z.id)return!0;return!1};getMasteryForGroup=($)=>{if($===void 0||$.nodes===void 0)return null;for(let Z of $.nodes){const J=this.nodes[Z];if(!J.isMastery)continue;return J}return null};getSkilledNodes=()=>this.getNodes(_.Active);getDesiredNodes=()=>this.getNodes(_.Desired);getUndesiredNodes=()=>this.getNodes(_.UnDesired);getClassStartNodes=()=>this.classStartNodes;getHoveredNodes=()=>{const $={};for(let Z in this.getNodes(_.Hovered))$[Z]=this.nodes[Z];for(let Z in this.getNodes(_.Pathing))$[Z]=this.nodes[Z];return $};getNodes=($)=>{const Z={};for(let J of this.nodesInState[$])if(this.nodes[J].is($))Z[J]=this.nodes[J];return Z};getNodesInRange=($,Z,J)=>{const Q=[];for(let K in this.nodes){const q=this.nodes[K];if(q.isMastery)continue;const V=Math.abs(q.x-$),X=Math.abs(q.y-Z);if(V*V+X*X<J*J&&Math.abs(q.y-Z)<J)Q.push(q)}return Q};getNodeAtPoint=($)=>{const Z=this.grid.find($,{width:0,height:0});if(Z.length===0)return null;let J=null,Q=null;for(let K of Z){const q=this.nodes[K],V=this.inRange(q,$);if(V===null)continue;if(Q===null||V<Q)J=q,Q=V}return J};inRange=($,Z)=>{const J=$.targetSize,Q=J.width*J.height*this.scale,K=this.getDistance($,Z);return K<Q?K:null};getDistance=($,Z)=>{const J={x:$.x-Z.x,y:$.y-Z.y};return J.x*J.x+J.y*J.y};addState=($,Z)=>this.addStateById($.GetId(),Z);addStateById=($,Z)=>{if(this.nodes[$]===void 0)return;if(this.nodes[$].is(Z))return;if(Z===_.Desired)this.desired_min_x=this.nodes[$].x<this.desired_min_x?this.nodes[$].x:this.desired_min_x,this.desired_min_y=this.nodes[$].y<this.desired_min_y?this.nodes[$].y:this.desired_min_y,this.desired_max_x=this.nodes[$].x>this.desired_max_x?this.nodes[$].x:this.desired_max_x,this.desired_max_y=this.nodes[$].y>this.desired_max_y?this.nodes[$].y:this.desired_max_y;this.nodes[$]._add(Z),this.nodesInState[Z].push($)};removeState=($,Z)=>this.removeStateById($.GetId(),Z);removeStateById=($,Z)=>{if(this.nodes[$]===void 0)return;if(!this.nodes[$].is(Z))return;if(this.nodes[$]._remove(Z),this.nodesInState[Z].splice(this.nodesInState[Z].indexOf($),1),Z===_.Desired){this.desired_min_x=1e5,this.desired_max_x=-1e5,this.desired_min_y=1e5,this.desired_max_y=-1e5;for(let J of Object.values(this.getNodes(Z)))this.desired_min_x=J.x<this.desired_min_x?J.x:this.desired_min_x,this.desired_min_y=J.y<this.desired_min_y?J.y:this.desired_min_y,this.desired_max_x=J.x>this.desired_max_x?J.x:this.desired_max_x,this.desired_max_y=J.y>this.desired_max_y?J.y:this.desired_max_y}};clearState=($)=>{for(let Z in this.getNodes($))if(this.nodes[Z]._remove($),$===_.Hovered)this.nodes[Z].hoverText=null;this.nodesInState[$]=new Array};hasSprite=($,Z)=>{return this.sprites[$]&&(this.sprites[$][this.scale.toString()]&&this.sprites[$][this.scale.toString()].coords[Z]!==void 0||this.sprites[$]["1"]&&this.sprites[$]["1"].coords[Z]!==void 0)}}class d7{events={};on=($,Z)=>{if(this.events[$]===void 0)this.events[$]=new Array;this.events[$].push(Z)};off=($,Z)=>{if(this.events[$]===void 0||this.events[$].indexOf(Z)===-1)return;this.events[$].splice(this.events[$].indexOf(Z),1)};fire($,Z){if(this.events[$]===void 0)return;for(let J of this.events[$])setTimeout(()=>J(Z),0)}}class x{static controls=new d7;static skill_tree=new d7;static node=new d7;static viewport=new d7}var M$=(($)=>($[$.WEBGL_LEGACY=0]="WEBGL_LEGACY",$[$.WEBGL=1]="WEBGL",$[$.WEBGL2=2]="WEBGL2",$))(M$||{}),YJ=(($)=>($[$.UNKNOWN=0]="UNKNOWN",$[$.WEBGL=1]="WEBGL",$[$.CANVAS=2]="CANVAS",$))(YJ||{}),G9=(($)=>($[$.COLOR=16384]="COLOR",$[$.DEPTH=256]="DEPTH",$[$.STENCIL=1024]="STENCIL",$))(G9||{}),a=(($)=>($[$.NORMAL=0]="NORMAL",$[$.ADD=1]="ADD",$[$.MULTIPLY=2]="MULTIPLY",$[$.SCREEN=3]="SCREEN",$[$.OVERLAY=4]="OVERLAY",$[$.DARKEN=5]="DARKEN",$[$.LIGHTEN=6]="LIGHTEN",$[$.COLOR_DODGE=7]="COLOR_DODGE",$[$.COLOR_BURN=8]="COLOR_BURN",$[$.HARD_LIGHT=9]="HARD_LIGHT",$[$.SOFT_LIGHT=10]="SOFT_LIGHT",$[$.DIFFERENCE=11]="DIFFERENCE",$[$.EXCLUSION=12]="EXCLUSION",$[$.HUE=13]="HUE",$[$.SATURATION=14]="SATURATION",$[$.COLOR=15]="COLOR",$[$.LUMINOSITY=16]="LUMINOSITY",$[$.NORMAL_NPM=17]="NORMAL_NPM",$[$.ADD_NPM=18]="ADD_NPM",$[$.SCREEN_NPM=19]="SCREEN_NPM",$[$.NONE=20]="NONE",$[$.SRC_OVER=0]="SRC_OVER",$[$.SRC_IN=21]="SRC_IN",$[$.SRC_OUT=22]="SRC_OUT",$[$.SRC_ATOP=23]="SRC_ATOP",$[$.DST_OVER=24]="DST_OVER",$[$.DST_IN=25]="DST_IN",$[$.DST_OUT=26]="DST_OUT",$[$.DST_ATOP=27]="DST_ATOP",$[$.ERASE=26]="ERASE",$[$.SUBTRACT=28]="SUBTRACT",$[$.XOR=29]="XOR",$))(a||{}),_$=(($)=>($[$.POINTS=0]="POINTS",$[$.LINES=1]="LINES",$[$.LINE_LOOP=2]="LINE_LOOP",$[$.LINE_STRIP=3]="LINE_STRIP",$[$.TRIANGLES=4]="TRIANGLES",$[$.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",$[$.TRIANGLE_FAN=6]="TRIANGLE_FAN",$))(_$||{}),v=(($)=>($[$.RGBA=6408]="RGBA",$[$.RGB=6407]="RGB",$[$.RG=33319]="RG",$[$.RED=6403]="RED",$[$.RGBA_INTEGER=36249]="RGBA_INTEGER",$[$.RGB_INTEGER=36248]="RGB_INTEGER",$[$.RG_INTEGER=33320]="RG_INTEGER",$[$.RED_INTEGER=36244]="RED_INTEGER",$[$.ALPHA=6406]="ALPHA",$[$.LUMINANCE=6409]="LUMINANCE",$[$.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",$[$.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",$[$.DEPTH_STENCIL=34041]="DEPTH_STENCIL",$))(v||{}),T8=(($)=>($[$.TEXTURE_2D=3553]="TEXTURE_2D",$[$.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",$[$.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",$[$.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",$[$.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",$[$.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",$[$.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",$))(T8||{}),d=(($)=>($[$.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",$[$.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",$[$.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",$[$.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",$[$.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",$[$.UNSIGNED_INT=5125]="UNSIGNED_INT",$[$.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",$[$.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",$[$.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",$[$.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",$[$.BYTE=5120]="BYTE",$[$.SHORT=5122]="SHORT",$[$.INT=5124]="INT",$[$.FLOAT=5126]="FLOAT",$[$.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",$[$.HALF_FLOAT=36193]="HALF_FLOAT",$))(d||{}),p=(($)=>($[$.FLOAT=0]="FLOAT",$[$.INT=1]="INT",$[$.UINT=2]="UINT",$))(p||{}),O$=(($)=>($[$.NEAREST=0]="NEAREST",$[$.LINEAR=1]="LINEAR",$))(O$||{}),z$=(($)=>($[$.CLAMP=33071]="CLAMP",$[$.REPEAT=10497]="REPEAT",$[$.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",$))(z$||{}),s0=(($)=>($[$.OFF=0]="OFF",$[$.POW2=1]="POW2",$[$.ON=2]="ON",$[$.ON_MANUAL=3]="ON_MANUAL",$))(s0||{}),_0=(($)=>($[$.NPM=0]="NPM",$[$.UNPACK=1]="UNPACK",$[$.PMA=2]="PMA",$[$.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",$[$.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",$[$.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",$))(_0||{}),k$=(($)=>($[$.NO=0]="NO",$[$.YES=1]="YES",$[$.AUTO=2]="AUTO",$[$.BLEND=0]="BLEND",$[$.CLEAR=1]="CLEAR",$[$.BLIT=2]="BLIT",$))(k$||{}),Y9=(($)=>($[$.AUTO=0]="AUTO",$[$.MANUAL=1]="MANUAL",$))(Y9||{}),H$=(($)=>($.LOW="lowp",$.MEDIUM="mediump",$.HIGH="highp",$))(H$||{}),D0=(($)=>($[$.NONE=0]="NONE",$[$.SCISSOR=1]="SCISSOR",$[$.STENCIL=2]="STENCIL",$[$.SPRITE=3]="SPRITE",$[$.COLOR=4]="COLOR",$))(D0||{});var U0=(($)=>($[$.NONE=0]="NONE",$[$.LOW=2]="LOW",$[$.MEDIUM=4]="MEDIUM",$[$.HIGH=8]="HIGH",$))(U0||{}),I$=(($)=>($[$.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",$[$.ARRAY_BUFFER=34962]="ARRAY_BUFFER",$[$.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",$))(I$||{});var wJ={createCanvas:($,Z)=>{const J=document.createElement("canvas");return J.width=$,J.height=Z,J},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:($,Z)=>fetch($,Z),parseXML:($)=>new DOMParser().parseFromString($,"text/xml")};var R={ADAPTER:wJ,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var WY=function($){return function(Z){return Z.test($)}},jJ=/iPhone/i,Oq=/iPod/i,Iq=/iPad/i,Rq=/\biOS-universal(?:.+)Mac\b/i,BJ=/\bAndroid(?:.+)Mobile\b/i,Pq=/Android/i,a6=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,w9=/Silk/i,b8=/Windows Phone/i,Dq=/\bWindows(?:.+)ARM\b/i,Aq=/BlackBerry/i,Mq=/BB10/i,kq=/Opera Mini/i,Eq=/\b(CriOS|Chrome)(?:.+)Mobile/i,Tq=/Mobile(?:.+)Firefox\b/i,bq=function($){return typeof $!=="undefined"&&$.platform==="MacIntel"&&typeof $.maxTouchPoints==="number"&&$.maxTouchPoints>1&&typeof MSStream==="undefined"};function l7($){var Z={userAgent:"",platform:"",maxTouchPoints:0};if(!$&&typeof navigator!=="undefined")Z={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};else if(typeof $==="string")Z.userAgent=$;else if($&&$.userAgent)Z={userAgent:$.userAgent,platform:$.platform,maxTouchPoints:$.maxTouchPoints||0};var J=Z.userAgent,Q=J.split("[FBAN");if(typeof Q[1]!=="undefined")J=Q[0];if(Q=J.split("Twitter"),typeof Q[1]!=="undefined")J=Q[0];var K=WY(J),q={apple:{phone:K(jJ)&&!K(b8),ipod:K(Oq),tablet:!K(jJ)&&(K(Iq)||bq(Z))&&!K(b8),universal:K(Rq),device:(K(jJ)||K(Oq)||K(Iq)||K(Rq)||bq(Z))&&!K(b8)},amazon:{phone:K(a6),tablet:!K(a6)&&K(w9),device:K(a6)||K(w9)},android:{phone:!K(b8)&&K(a6)||!K(b8)&&K(BJ),tablet:!K(b8)&&!K(a6)&&!K(BJ)&&(K(w9)||K(Pq)),device:!K(b8)&&(K(a6)||K(w9)||K(BJ)||K(Pq))||K(/\bokhttp\b/i)},windows:{phone:K(b8),tablet:K(Dq),device:K(b8)||K(Dq)},other:{blackberry:K(Aq),blackberry10:K(Mq),opera:K(kq),firefox:K(Tq),chrome:K(Eq),device:K(Aq)||K(Mq)||K(kq)||K(Tq)||K(Eq)},any:!1,phone:!1,tablet:!1};return q.any=q.apple.device||q.android.device||q.windows.device||q.other.device,q.phone=q.apple.phone||q.android.phone||q.windows.phone,q.tablet=q.apple.tablet||q.android.tablet||q.windows.tablet,q}var UY=l7.default??l7,g$=UY(globalThis.navigator);var T={};Yz(T,{url:()=>{{return oq}},uid:()=>{{return X8}},trimCanvas:()=>{{return IV}},string2hex:()=>{{return zV}},skipHello:()=>{{return iq}},sign:()=>{{return NV}},sayHello:()=>{{return aq}},rgb2hex:()=>{{return HV}},removeItems:()=>{{return R9}},premultiplyTintToRgba:()=>{{return jV}},premultiplyTint:()=>{{return wV}},premultiplyRgba:()=>{{return YV}},premultiplyBlendMode:()=>{{return e7}},path:()=>{{return AJ}},nextPow2:()=>{{return n8}},log2:()=>{{return Z5}},isWebGLSupported:()=>{{return _9}},isPow2:()=>{{return $5}},isMobile:()=>{{return g$}},interleaveTypedArrays:()=>{{return FV}},hex2string:()=>{{return UV}},hex2rgb:()=>{{return WV}},getResolutionOfUrl:()=>{{return K5}},getCanvasBoundingBox:()=>{{return P9}},getBufferType:()=>{{return l8}},earcut:()=>{{return PV.default}},determineCrossOrigin:()=>{{return D9}},detectVideoAlphaMode:()=>{{return sq}},destroyTextureCache:()=>{{return CV}},deprecation:()=>{{return t}},decomposeDataUri:()=>{{return RV}},createIndicesForQuads:()=>{{return BV}},correctBlendMode:()=>{{return GV}},clearTextureCache:()=>{{return LV}},TextureCache:()=>{{return c0}},ProgramCache:()=>{{return Q5}},EventEmitter:()=>{{return o8.default}},DATA_URI:()=>{{return I9}},CanvasRenderTarget:()=>{{return yJ}},BoundingBox:()=>{{return J5}},BaseTextureCache:()=>{{return Y$}}});R.RETINA_PREFIX=/@([0-9\.]+)x/;R.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var o8=l6(Sq(),1),PV=l6(xq(),1);var DJ=function($){return typeof $=="string"},uq=function($){return typeof $=="object"&&$!==null},L9=function($){return $===null},MY=function($){return $==null},a$=function(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null},a7=function($,Z,J){if($&&uq($)&&$ instanceof a$)return $;var Q=new a$;return Q.parse($,Z,J),Q},dq=function($){return DJ($)&&($=a7($)),$ instanceof a$?$.format():a$.prototype.format.call($)},lq=function($,Z){return a7($,!1,!0).resolve(Z)};var{URL:AY,URLSearchParams:xL,[Symbol.for("Bun.lazy")]:OJ}=globalThis,kY=/^([a-z0-9.+-]+:)/i,EY=/:[0-9]*$/,TY=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,bY=["<",">",'"',"`"," ","\r",`
`,"	"],vY=["{","}","|","\\","^","`"].concat(bY),IJ=["'"].concat(vY),mq=["%","/","?",";","#"].concat(IJ),cq=["/","?","#"],SY=255,pq=/^[+a-z0-9A-Z_-]{0,63}$/,hY=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,fY={javascript:!0,"javascript:":!0},RJ={javascript:!0,"javascript:":!0},t6={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},PJ={parse($){var Z=decodeURIComponent;return($+"").replace(/\+/g," ").split("&").filter(Boolean).reduce(function(J,Q,K){var q=Q.split("="),V=Z(q[0]||""),X=Z(q[1]||""),W=J[V];return J[V]=W===void 0?X:[].concat(W,X),J},{})},stringify($){var Z=encodeURIComponent;return Object.keys($||{}).reduce(function(J,Q){return[].concat($[Q]).forEach(function(K){J.push(Z(Q)+"="+Z(K))}),J},[]).join("&").replace(/\s/g,"+")}};a$.prototype.parse=function($,Z,J){if(!DJ($))throw new TypeError("Parameter 'url' must be a string, not "+typeof $);var Q=$.indexOf("?"),K=Q!==-1&&Q<$.indexOf("#")?"?":"#",q=$.split(K),V=/\\/g;q[0]=q[0].replace(V,"/"),$=q.join(K);var X=$;if(X=X.trim(),!J&&$.split("#").length===1){var W=TY.exec(X);if(W)return this.path=X,this.href=X,this.pathname=W[1],W[2]?(this.search=W[2],Z?this.query=PJ.parse(this.search.substr(1)):this.query=this.search.substr(1)):Z&&(this.search="",this.query={}),this}var U=kY.exec(X);if(U){U=U[0];var z=U.toLowerCase();this.protocol=z,X=X.substr(U.length)}if(J||U||X.match(/^\/\/[^@\/]+@[^@\/]+/)){var H=X.substr(0,2)==="//";H&&!(U&&RJ[U])&&(X=X.substr(2),this.slashes=!0)}if(!RJ[U]&&(H||U&&!t6[U])){for(var G=-1,Y=0;Y<cq.length;Y++){var w=X.indexOf(cq[Y]);w!==-1&&(G===-1||w<G)&&(G=w)}var j,B;G===-1?B=X.lastIndexOf("@"):B=X.lastIndexOf("@",G),B!==-1&&(j=X.slice(0,B),X=X.slice(B+1),this.auth=decodeURIComponent(j)),G=-1;for(var Y=0;Y<mq.length;Y++){var w=X.indexOf(mq[Y]);w!==-1&&(G===-1||w<G)&&(G=w)}G===-1&&(G=X.length),this.host=X.slice(0,G),X=X.slice(G),this.parseHost(),this.hostname=this.hostname||"";var C=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!C)for(var N=this.hostname.split(/\./),Y=0,F=N.length;Y<F;Y++){var L=N[Y];if(!!L&&!L.match(pq)){for(var k="",o=0,O=L.length;o<O;o++)L.charCodeAt(o)>127?k+="x":k+=L[o];if(!k.match(pq)){var h=N.slice(0,Y),c=N.slice(Y+1),S=L.match(hY);S&&(h.push(S[1]),c.unshift(S[2])),c.length&&(X="/"+c.join(".")+X),this.hostname=h.join(".");break}}}this.hostname.length>SY?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=new AY(`https://${this.hostname}`).hostname);var M=this.port?":"+this.port:"",y=this.hostname||"";this.host=y+M,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),X[0]!=="/"&&(X="/"+X))}if(!fY[z])for(var Y=0,F=IJ.length;Y<F;Y++){var A=IJ[Y];if(X.indexOf(A)!==-1){var b=encodeURIComponent(A);b===A&&(b=escape(A)),X=X.split(A).join(b)}}var $0=X.indexOf("#");$0!==-1&&(this.hash=X.substr($0),X=X.slice(0,$0));var Q0=X.indexOf("?");if(Q0!==-1?(this.search=X.substr(Q0),this.query=X.substr(Q0+1),Z&&(this.query=PJ.parse(this.query)),X=X.slice(0,Q0)):Z&&(this.search="",this.query={}),X&&(this.pathname=X),t6[z]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",l=this.search||"";this.path=M+l}return this.href=this.format(),this};a$.prototype.format=function(){var $=this.auth||"";$&&($=encodeURIComponent($),$=$.replace(/%3A/i,":"),$+="@");var Z=this.protocol||"",J=this.pathname||"",Q=this.hash||"",K=!1,q="";this.host?K=$+this.host:this.hostname&&(K=$+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(K+=":"+this.port)),this.query&&uq(this.query)&&Object.keys(this.query).length&&(q=PJ.stringify(this.query));var V=this.search||q&&"?"+q||"";return Z&&Z.substr(-1)!==":"&&(Z+=":"),this.slashes||(!Z||t6[Z])&&K!==!1?(K="//"+(K||""),J&&J.charAt(0)!=="/"&&(J="/"+J)):K||(K=""),Q&&Q.charAt(0)!=="#"&&(Q="#"+Q),V&&V.charAt(0)!=="?"&&(V="?"+V),J=J.replace(/[?#]/g,function(X){return encodeURIComponent(X)}),V=V.replace("#","%23"),Z+K+J+V+Q};a$.prototype.resolve=function($){return this.resolveObject(a7($,!1,!0)).format()};a$.prototype.resolveObject=function($){if(DJ($)){var Z=new a$;Z.parse($,!1,!0),$=Z}for(var J=new a$,Q=Object.keys(this),K=0;K<Q.length;K++){var q=Q[K];J[q]=this[q]}if(J.hash=$.hash,$.href==="")return J.href=J.format(),J;if($.slashes&&!$.protocol){for(var V=Object.keys($),X=0;X<V.length;X++){var W=V[X];W!=="protocol"&&(J[W]=$[W])}return t6[J.protocol]&&J.hostname&&!J.pathname&&(J.path=J.pathname="/"),J.href=J.format(),J}if($.protocol&&$.protocol!==J.protocol){if(!t6[$.protocol]){for(var U=Object.keys($),z=0;z<U.length;z++){var H=U[z];J[H]=$[H]}return J.href=J.format(),J}if(J.protocol=$.protocol,!$.host&&!RJ[$.protocol]){for(var F=($.pathname||"").split("/");F.length&&!($.host=F.shift()););$.host||($.host=""),$.hostname||($.hostname=""),F[0]!==""&&F.unshift(""),F.length<2&&F.unshift(""),J.pathname=F.join("/")}else J.pathname=$.pathname;if(J.search=$.search,J.query=$.query,J.host=$.host||"",J.auth=$.auth,J.hostname=$.hostname||$.host,J.port=$.port,J.pathname||J.search){var G=J.pathname||"",Y=J.search||"";J.path=G+Y}return J.slashes=J.slashes||$.slashes,J.href=J.format(),J}var w=J.pathname&&J.pathname.charAt(0)==="/",j=$.host||$.pathname&&$.pathname.charAt(0)==="/",B=j||w||J.host&&$.pathname,C=B,N=J.pathname&&J.pathname.split("/")||[],F=$.pathname&&$.pathname.split("/")||[],L=J.protocol&&!t6[J.protocol];if(L&&(J.hostname="",J.port=null,J.host&&(N[0]===""?N[0]=J.host:N.unshift(J.host)),J.host="",$.protocol&&($.hostname=null,$.port=null,$.host&&(F[0]===""?F[0]=$.host:F.unshift($.host)),$.host=null),B=B&&(F[0]===""||N[0]==="")),j)J.host=$.host||$.host===""?$.host:J.host,J.hostname=$.hostname||$.hostname===""?$.hostname:J.hostname,J.search=$.search,J.query=$.query,N=F;else if(F.length)N||(N=[]),N.pop(),N=N.concat(F),J.search=$.search,J.query=$.query;else if(!MY($.search)){if(L){J.hostname=J.host=N.shift();var k=J.host&&J.host.indexOf("@")>0?J.host.split("@"):!1;k&&(J.auth=k.shift(),J.host=J.hostname=k.shift())}return J.search=$.search,J.query=$.query,(!L9(J.pathname)||!L9(J.search))&&(J.path=(J.pathname?J.pathname:"")+(J.search?J.search:"")),J.href=J.format(),J}if(!N.length)return J.pathname=null,J.search?J.path="/"+J.search:J.path=null,J.href=J.format(),J;for(var o=N.slice(-1)[0],O=(J.host||$.host||N.length>1)&&(o==="."||o==="..")||o==="",h=0,c=N.length;c>=0;c--)o=N[c],o==="."?N.splice(c,1):o===".."?(N.splice(c,1),h++):h&&(N.splice(c,1),h--);if(!B&&!C)for(;h--;h)N.unshift("..");B&&N[0]!==""&&(!N[0]||N[0].charAt(0)!=="/")&&N.unshift(""),O&&N.join("/").substr(-1)!=="/"&&N.push("");var S=N[0]===""||N[0]&&N[0].charAt(0)==="/";if(L){J.hostname=J.host=S?"":N.length?N.shift():"";var k=J.host&&J.host.indexOf("@")>0?J.host.split("@"):!1;k&&(J.auth=k.shift(),J.host=J.hostname=k.shift())}return B=B||J.host&&N.length,B&&!S&&N.unshift(""),N.length?J.pathname=N.join("/"):(J.pathname=null,J.path=null),(!L9(J.pathname)||!L9(J.search))&&(J.path=(J.pathname?J.pathname:"")+(J.search?J.search:"")),J.auth=$.auth||J.auth,J.slashes=J.slashes||$.slashes,J.href=J.format(),J};a$.prototype.parseHost=function(){var $=this.host,Z=EY.exec($);Z&&(Z=Z[0],Z!==":"&&(this.port=Z.substr(1)),$=$.substr(0,$.length-Z.length)),$&&(this.hostname=$)};var yY,gY;OJ&&(yY=OJ("pathToFileURL"),gY=OJ("fileURLToPath"));var t=function($,Z,J=3){if(nq[Z])return;let Q=new Error().stack;typeof Q>"u"?console.warn("PixiJS Deprecation Warning: ",`${Z}
Deprecated since v${$}`):(Q=Q.split(`
`).splice(J).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${Z}
Deprecated since v${$}`),console.warn(Q),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${Z}
Deprecated since v${$}`),console.warn(Q))),nq[Z]=!0},nq={};var oq={get parse(){return t("7.3.0","utils.url.parse is deprecated, use native URL API instead."),a7},get format(){return t("7.3.0","utils.url.format is deprecated, use native URL API instead."),dq},get resolve(){return t("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),lq}};var r$=function($){if(typeof $!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify($)}`)},r7=function($){return $.split("?")[0].split("#")[0]},xY=function($){return $.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},mY=function($,Z,J){return $.replace(new RegExp(xY(Z),"g"),J)},cY=function($,Z){let J="",Q=0,K=-1,q=0,V=-1;for(let X=0;X<=$.length;++X){if(X<$.length)V=$.charCodeAt(X);else{if(V===47)break;V=47}if(V===47){if(!(K===X-1||q===1))if(K!==X-1&&q===2){if(J.length<2||Q!==2||J.charCodeAt(J.length-1)!==46||J.charCodeAt(J.length-2)!==46){if(J.length>2){const W=J.lastIndexOf("/");if(W!==J.length-1){W===-1?(J="",Q=0):(J=J.slice(0,W),Q=J.length-1-J.lastIndexOf("/")),K=X,q=0;continue}}else if(J.length===2||J.length===1){J="",Q=0,K=X,q=0;continue}}Z&&(J.length>0?J+="/..":J="..",Q=2)}else J.length>0?J+=`/${$.slice(K+1,X)}`:J=$.slice(K+1,X),Q=X-K-1;K=X,q=0}else V===46&&q!==-1?++q:q=-1}return J},AJ={toPosix($){return mY($,"\\","/")},isUrl($){return/^https?:/.test(this.toPosix($))},isDataUrl($){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test($)},isBlobUrl($){return $.startsWith("blob:")},hasProtocol($){return/^[^/:]+:/.test(this.toPosix($))},getProtocol($){r$($),$=this.toPosix($);const Z=/^file:\/\/\//.exec($);if(Z)return Z[0];const J=/^[^/:]+:\/{0,2}/.exec($);return J?J[0]:""},toAbsolute($,Z,J){if(r$($),this.isDataUrl($)||this.isBlobUrl($))return $;const Q=r7(this.toPosix(Z??R.ADAPTER.getBaseUrl())),K=r7(this.toPosix(J??this.rootname(Q)));return $=this.toPosix($),$.startsWith("/")?AJ.join(K,$.slice(1)):this.isAbsolute($)?$:this.join(Q,$)},normalize($){if(r$($),$.length===0)return".";if(this.isDataUrl($)||this.isBlobUrl($))return $;$=this.toPosix($);let Z="";const J=$.startsWith("/");this.hasProtocol($)&&(Z=this.rootname($),$=$.slice(Z.length));const Q=$.endsWith("/");return $=cY($,!1),$.length>0&&Q&&($+="/"),J?`/${$}`:Z+$},isAbsolute($){return r$($),$=this.toPosix($),this.hasProtocol($)?!0:$.startsWith("/")},join(...$){if($.length===0)return".";let Z;for(let J=0;J<$.length;++J){const Q=$[J];if(r$(Q),Q.length>0)if(Z===void 0)Z=Q;else{const K=$[J-1]??"";this.extname(K)?Z+=`/../${Q}`:Z+=`/${Q}`}}return Z===void 0?".":this.normalize(Z)},dirname($){if(r$($),$.length===0)return".";$=this.toPosix($);let Z=$.charCodeAt(0);const J=Z===47;let Q=-1,K=!0;const q=this.getProtocol($),V=$;$=$.slice(q.length);for(let X=$.length-1;X>=1;--X)if(Z=$.charCodeAt(X),Z===47){if(!K){Q=X;break}}else K=!1;return Q===-1?J?"/":this.isUrl(V)?q+$:q:J&&Q===1?"//":q+$.slice(0,Q)},rootname($){r$($),$=this.toPosix($);let Z="";if($.startsWith("/")?Z="/":Z=this.getProtocol($),this.isUrl($)){const J=$.indexOf("/",Z.length);J!==-1?Z=$.slice(0,J):Z=$,Z.endsWith("/")||(Z+="/")}return Z},basename($,Z){r$($),Z&&r$(Z),$=r7(this.toPosix($));let J=0,Q=-1,K=!0,q;if(Z!==void 0&&Z.length>0&&Z.length<=$.length){if(Z.length===$.length&&Z===$)return"";let V=Z.length-1,X=-1;for(q=$.length-1;q>=0;--q){const W=$.charCodeAt(q);if(W===47){if(!K){J=q+1;break}}else X===-1&&(K=!1,X=q+1),V>=0&&(W===Z.charCodeAt(V)?--V===-1&&(Q=q):(V=-1,Q=X))}return J===Q?Q=X:Q===-1&&(Q=$.length),$.slice(J,Q)}for(q=$.length-1;q>=0;--q)if($.charCodeAt(q)===47){if(!K){J=q+1;break}}else Q===-1&&(K=!1,Q=q+1);return Q===-1?"":$.slice(J,Q)},extname($){r$($),$=r7(this.toPosix($));let Z=-1,J=0,Q=-1,K=!0,q=0;for(let V=$.length-1;V>=0;--V){const X=$.charCodeAt(V);if(X===47){if(!K){J=V+1;break}continue}Q===-1&&(K=!1,Q=V+1),X===46?Z===-1?Z=V:q!==1&&(q=1):Z!==-1&&(q=-1)}return Z===-1||Q===-1||q===0||q===1&&Z===Q-1&&Z===J+1?"":$.slice(Z,Q)},parse($){r$($);const Z={root:"",dir:"",base:"",ext:"",name:""};if($.length===0)return Z;$=r7(this.toPosix($));let J=$.charCodeAt(0);const Q=this.isAbsolute($);let K;const q="";Z.root=this.rootname($),Q||this.hasProtocol($)?K=1:K=0;let V=-1,X=0,W=-1,U=!0,z=$.length-1,H=0;for(;z>=K;--z){if(J=$.charCodeAt(z),J===47){if(!U){X=z+1;break}continue}W===-1&&(U=!1,W=z+1),J===46?V===-1?V=z:H!==1&&(H=1):V!==-1&&(H=-1)}return V===-1||W===-1||H===0||H===1&&V===W-1&&V===X+1?W!==-1&&(X===0&&Q?Z.base=Z.name=$.slice(1,W):Z.base=Z.name=$.slice(X,W)):(X===0&&Q?(Z.name=$.slice(1,V),Z.base=$.slice(1,W)):(Z.name=$.slice(X,V),Z.base=$.slice(X,W)),Z.ext=$.slice(V,W)),Z.dir=this.dirname($),q&&(Z.dir=q+Z.dir),Z},sep:"/",delimiter:":"};async function sq(){return MJ??(MJ=(async()=>{const $=document.createElement("canvas").getContext("webgl");if(!$)return _0.UNPACK;const Z=await new Promise((q)=>{const V=document.createElement("video");V.onloadeddata=()=>q(V),V.onerror=()=>q(null),V.autoplay=!1,V.crossOrigin="anonymous",V.preload="auto",V.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",V.load()});if(!Z)return _0.UNPACK;const J=$.createTexture();$.bindTexture($.TEXTURE_2D,J);const Q=$.createFramebuffer();$.bindFramebuffer($.FRAMEBUFFER,Q),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,J,0),$.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),$.pixelStorei($.UNPACK_COLORSPACE_CONVERSION_WEBGL,$.NONE),$.texImage2D($.TEXTURE_2D,0,$.RGBA,$.RGBA,$.UNSIGNED_BYTE,Z);const K=new Uint8Array(4);return $.readPixels(0,0,1,1,$.RGBA,$.UNSIGNED_BYTE,K),$.deleteFramebuffer(Q),$.deleteTexture(J),$.getExtension("WEBGL_lose_context")?.loseContext(),K[0]<=K[3]?_0.PMA:_0.UNPACK})()),MJ}var MJ;var iq=function(){t("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")},aq=function(){t("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)};var _9=function(){return typeof kJ>"u"&&(kJ=function(){const $={stencil:!0,failIfMajorPerformanceCaveat:R.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!R.ADAPTER.getWebGLRenderingContext())return!1;const Z=R.ADAPTER.createCanvas();let J=Z.getContext("webgl",$)||Z.getContext("experimental-webgl",$);const Q=!!J?.getContextAttributes()?.stencil;if(J){const K=J.getExtension("WEBGL_lose_context");K&&K.loseContext()}return J=null,Q}catch{return!1}}()),kJ},kJ;var pY={grad:0.9,turn:360,rad:360/(2*Math.PI)},v8=function($){return typeof $=="string"?$.length>0:typeof $=="number"},m0=function($,Z,J){return Z===void 0&&(Z=0),J===void 0&&(J=Math.pow(10,Z)),Math.round(J*$)/J+0},x$=function($,Z,J){return Z===void 0&&(Z=0),J===void 0&&(J=1),$>J?J:$>Z?$:Z},KV=function($){return($=isFinite($)?$%360:0)>0?$:$+360},rq=function($){return{r:x$($.r,0,255),g:x$($.g,0,255),b:x$($.b,0,255),a:x$($.a)}},EJ=function($){return{r:m0($.r),g:m0($.g),b:m0($.b),a:m0($.a,3)}},uY=/^#([0-9a-f]{3,8})$/i,O9=function($){var Z=$.toString(16);return Z.length<2?"0"+Z:Z},qV=function($){var{r:Z,g:J,b:Q,a:K}=$,q=Math.max(Z,J,Q),V=q-Math.min(Z,J,Q),X=V?q===Z?(J-Q)/V:q===J?2+(Q-Z)/V:4+(Z-J)/V:0;return{h:60*(X<0?X+6:X),s:q?V/q*100:0,v:q/255*100,a:K}},VV=function($){var{h:Z,s:J,v:Q,a:K}=$;Z=Z/360*6,J/=100,Q/=100;var q=Math.floor(Z),V=Q*(1-J),X=Q*(1-(Z-q)*J),W=Q*(1-(1-Z+q)*J),U=q%6;return{r:255*[Q,X,V,V,W,Q][U],g:255*[W,Q,Q,X,V,V][U],b:255*[V,V,W,Q,Q,X][U],a:K}},tq=function($){return{h:KV($.h),s:x$($.s,0,100),l:x$($.l,0,100),a:x$($.a)}},eq=function($){return{h:m0($.h),s:m0($.s),l:m0($.l),a:m0($.a,3)}},$V=function($){return VV((J=(Z=$).s,{h:Z.h,s:(J*=((Q=Z.l)<50?Q:100-Q)/100)>0?2*J/(Q+J)*100:0,v:Q+J,a:Z.a}));var Z,J,Q},t7=function($){return{h:(Z=qV($)).h,s:(K=(200-(J=Z.s))*(Q=Z.v)/100)>0&&K<200?J*Q/100/(K<=100?K:200-K)*100:0,l:K/2,a:Z.a};var Z,J,Q,K},dY=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,lY=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,nY=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,oY=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,vJ={string:[[function($){var Z=uY.exec($);return Z?($=Z[1]).length<=4?{r:parseInt($[0]+$[0],16),g:parseInt($[1]+$[1],16),b:parseInt($[2]+$[2],16),a:$.length===4?m0(parseInt($[3]+$[3],16)/255,2):1}:$.length===6||$.length===8?{r:parseInt($.substr(0,2),16),g:parseInt($.substr(2,2),16),b:parseInt($.substr(4,2),16),a:$.length===8?m0(parseInt($.substr(6,2),16)/255,2):1}:null:null},"hex"],[function($){var Z=nY.exec($)||oY.exec($);return Z?Z[2]!==Z[4]||Z[4]!==Z[6]?null:rq({r:Number(Z[1])/(Z[2]?0.39215686274509803:1),g:Number(Z[3])/(Z[4]?0.39215686274509803:1),b:Number(Z[5])/(Z[6]?0.39215686274509803:1),a:Z[7]===void 0?1:Number(Z[7])/(Z[8]?100:1)}):null},"rgb"],[function($){var Z=dY.exec($)||lY.exec($);if(!Z)return null;var J,Q,K=tq({h:(J=Z[1],Q=Z[2],Q===void 0&&(Q="deg"),Number(J)*(pY[Q]||1)),s:Number(Z[3]),l:Number(Z[4]),a:Z[5]===void 0?1:Number(Z[5])/(Z[6]?100:1)});return $V(K)},"hsl"]],object:[[function($){var{r:Z,g:J,b:Q,a:K}=$,q=K===void 0?1:K;return v8(Z)&&v8(J)&&v8(Q)?rq({r:Number(Z),g:Number(J),b:Number(Q),a:Number(q)}):null},"rgb"],[function($){var{h:Z,s:J,l:Q,a:K}=$,q=K===void 0?1:K;if(!v8(Z)||!v8(J)||!v8(Q))return null;var V=tq({h:Number(Z),s:Number(J),l:Number(Q),a:Number(q)});return $V(V)},"hsl"],[function($){var{h:Z,s:J,v:Q,a:K}=$,q=K===void 0?1:K;if(!v8(Z)||!v8(J)||!v8(Q))return null;var V=function(X){return{h:KV(X.h),s:x$(X.s,0,100),v:x$(X.v,0,100),a:x$(X.a)}}({h:Number(Z),s:Number(J),v:Number(Q),a:Number(q)});return VV(V)},"hsv"]]},ZV=function($,Z){for(var J=0;J<Z.length;J++){var Q=Z[J][0]($);if(Q)return[Q,Z[J][1]]}return[null,void 0]},sY=function($){return typeof $=="string"?ZV($.trim(),vJ.string):typeof $=="object"&&$!==null?ZV($,vJ.object):[null,void 0]};var TJ=function($,Z){var J=t7($);return{h:J.h,s:x$(J.s+100*Z,0,100),l:J.l,a:J.a}},bJ=function($){return(299*$.r+587*$.g+114*$.b)/1000/255},JV=function($,Z){var J=t7($);return{h:J.h,s:J.s,l:x$(J.l+100*Z,0,100),a:J.a}},SJ=function(){function $(Z){this.parsed=sY(Z)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return $.prototype.isValid=function(){return this.parsed!==null},$.prototype.brightness=function(){return m0(bJ(this.rgba),2)},$.prototype.isDark=function(){return bJ(this.rgba)<0.5},$.prototype.isLight=function(){return bJ(this.rgba)>=0.5},$.prototype.toHex=function(){return Z=EJ(this.rgba),J=Z.r,Q=Z.g,K=Z.b,V=(q=Z.a)<1?O9(m0(255*q)):"","#"+O9(J)+O9(Q)+O9(K)+V;var Z,J,Q,K,q,V},$.prototype.toRgb=function(){return EJ(this.rgba)},$.prototype.toRgbString=function(){return Z=EJ(this.rgba),J=Z.r,Q=Z.g,K=Z.b,(q=Z.a)<1?"rgba("+J+", "+Q+", "+K+", "+q+")":"rgb("+J+", "+Q+", "+K+")";var Z,J,Q,K,q},$.prototype.toHsl=function(){return eq(t7(this.rgba))},$.prototype.toHslString=function(){return Z=eq(t7(this.rgba)),J=Z.h,Q=Z.s,K=Z.l,(q=Z.a)<1?"hsla("+J+", "+Q+"%, "+K+"%, "+q+")":"hsl("+J+", "+Q+"%, "+K+"%)";var Z,J,Q,K,q},$.prototype.toHsv=function(){return Z=qV(this.rgba),{h:m0(Z.h),s:m0(Z.s),v:m0(Z.v),a:m0(Z.a,3)};var Z},$.prototype.invert=function(){return t$({r:255-(Z=this.rgba).r,g:255-Z.g,b:255-Z.b,a:Z.a});var Z},$.prototype.saturate=function(Z){return Z===void 0&&(Z=0.1),t$(TJ(this.rgba,Z))},$.prototype.desaturate=function(Z){return Z===void 0&&(Z=0.1),t$(TJ(this.rgba,-Z))},$.prototype.grayscale=function(){return t$(TJ(this.rgba,-1))},$.prototype.lighten=function(Z){return Z===void 0&&(Z=0.1),t$(JV(this.rgba,Z))},$.prototype.darken=function(Z){return Z===void 0&&(Z=0.1),t$(JV(this.rgba,-Z))},$.prototype.rotate=function(Z){return Z===void 0&&(Z=15),this.hue(this.hue()+Z)},$.prototype.alpha=function(Z){return typeof Z=="number"?t$({r:(J=this.rgba).r,g:J.g,b:J.b,a:Z}):m0(this.rgba.a,3);var J},$.prototype.hue=function(Z){var J=t7(this.rgba);return typeof Z=="number"?t$({h:Z,s:J.s,l:J.l,a:J.a}):m0(J.h)},$.prototype.isEqual=function(Z){return this.toHex()===t$(Z).toHex()},$}(),t$=function($){return $ instanceof SJ?$:new SJ($)},QV=[],XV=function($){$.forEach(function(Z){QV.indexOf(Z)<0&&(Z(SJ,vJ),QV.push(Z))})};function hJ($,Z){var J={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},Q={};for(var K in J)Q[J[K]]=K;var q={};$.prototype.toName=function(V){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var X,W,U=Q[this.toHex()];if(U)return U;if(V==null?void 0:V.closest){var z=this.toRgb(),H=Infinity,G="black";if(!q.length)for(var Y in J)q[Y]=new $(J[Y]).toRgb();for(var w in J){var j=(X=z,W=q[w],Math.pow(X.r-W.r,2)+Math.pow(X.g-W.g,2)+Math.pow(X.b-W.b,2));j<H&&(H=j,G=w)}return G}},Z.string.push([function(V){var X=V.toLowerCase(),W=X==="transparent"?"#0000":J[X];return W?new $(W).toRgb():null},"name"])}XV([hJ]);var e6=class ${constructor(Z=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=Z}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(Z){return this.value=Z,this}set value(Z){if(Z instanceof $)this._value=this.cloneSource(Z._value),this._int=Z._int,this._components.set(Z._components);else{if(Z===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,Z))&&(this.normalize(Z),this._value=this.cloneSource(Z))}}get value(){return this._value}cloneSource(Z){return typeof Z=="string"||typeof Z=="number"||Z instanceof Number||Z===null?Z:Array.isArray(Z)||ArrayBuffer.isView(Z)?Z.slice(0):typeof Z=="object"&&Z!==null?{...Z}:Z}isSourceEqual(Z,J){const Q=typeof Z;if(Q!==typeof J)return!1;if(Q==="number"||Q==="string"||Z instanceof Number)return Z===J;if(Array.isArray(Z)&&Array.isArray(J)||ArrayBuffer.isView(Z)&&ArrayBuffer.isView(J))return Z.length!==J.length?!1:Z.every((K,q)=>K===J[q]);if(Z!==null&&J!==null){const K=Object.keys(Z),q=Object.keys(J);return K.length!==q.length?!1:K.every((V)=>Z[V]===J[V])}return Z===J}toRgba(){const[Z,J,Q,K]=this._components;return{r:Z,g:J,b:Q,a:K}}toRgb(){const[Z,J,Q]=this._components;return{r:Z,g:J,b:Q}}toRgbaString(){const[Z,J,Q]=this.toUint8RgbArray();return`rgba(${Z},${J},${Q},${this.alpha})`}toUint8RgbArray(Z){const[J,Q,K]=this._components;return Z=Z??[],Z[0]=Math.round(J*255),Z[1]=Math.round(Q*255),Z[2]=Math.round(K*255),Z}toRgbArray(Z){Z=Z??[];const[J,Q,K]=this._components;return Z[0]=J,Z[1]=Q,Z[2]=K,Z}toNumber(){return this._int}toLittleEndianNumber(){const Z=this._int;return(Z>>16)+(Z&65280)+((Z&255)<<16)}multiply(Z){const[J,Q,K,q]=$.temp.setValue(Z)._components;return this._components[0]*=J,this._components[1]*=Q,this._components[2]*=K,this._components[3]*=q,this.refreshInt(),this._value=null,this}premultiply(Z,J=!0){return J&&(this._components[0]*=Z,this._components[1]*=Z,this._components[2]*=Z),this._components[3]=Z,this.refreshInt(),this._value=null,this}toPremultiplied(Z,J=!0){if(Z===1)return(255<<24)+this._int;if(Z===0)return J?0:this._int;let Q=this._int>>16&255,K=this._int>>8&255,q=this._int&255;return J&&(Q=Q*Z+0.5|0,K=K*Z+0.5|0,q=q*Z+0.5|0),(Z*255<<24)+(Q<<16)+(K<<8)+q}toHex(){const Z=this._int.toString(16);return`#${"000000".substring(0,6-Z.length)+Z}`}toHexa(){const Z=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-Z.length)+Z}setAlpha(Z){return this._components[3]=this._clamp(Z),this}round(Z){const[J,Q,K]=this._components;return this._components[0]=Math.round(J*Z)/Z,this._components[1]=Math.round(Q*Z)/Z,this._components[2]=Math.round(K*Z)/Z,this.refreshInt(),this._value=null,this}toArray(Z){Z=Z??[];const[J,Q,K,q]=this._components;return Z[0]=J,Z[1]=Q,Z[2]=K,Z[3]=q,Z}normalize(Z){let J,Q,K,q;if((typeof Z=="number"||Z instanceof Number)&&Z>=0&&Z<=16777215){const V=Z;J=(V>>16&255)/255,Q=(V>>8&255)/255,K=(V&255)/255,q=1}else if((Array.isArray(Z)||Z instanceof Float32Array)&&Z.length>=3&&Z.length<=4)Z=this._clamp(Z),[J,Q,K,q=1]=Z;else if((Z instanceof Uint8Array||Z instanceof Uint8ClampedArray)&&Z.length>=3&&Z.length<=4)Z=this._clamp(Z,0,255),[J,Q,K,q=255]=Z,J/=255,Q/=255,K/=255,q/=255;else if(typeof Z=="string"||typeof Z=="object"){if(typeof Z=="string"){const X=$.HEX_PATTERN.exec(Z);X&&(Z=`#${X[2]}`)}const V=t$(Z);V.isValid()&&({r:J,g:Q,b:K,a:q}=V.rgba,J/=255,Q/=255,K/=255)}if(J!==void 0)this._components[0]=J,this._components[1]=Q,this._components[2]=K,this._components[3]=q,this.refreshInt();else throw new Error(`Unable to convert color ${Z}`)}refreshInt(){this._clamp(this._components);const[Z,J,Q]=this._components;this._int=(Z*255<<16)+(J*255<<8)+(Q*255|0)}_clamp(Z,J=0,Q=1){return typeof Z=="number"?Math.min(Math.max(Z,J),Q):(Z.forEach((K,q)=>{Z[q]=Math.min(Math.max(K,J),Q)}),Z)}};e6.shared=new e6,e6.temp=new e6,e6.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;var e=e6;var WV=function($,Z=[]){return t("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),e.shared.setValue($).toRgbArray(Z)},UV=function($){return t("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),e.shared.setValue($).toHex()},zV=function($){return t("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),e.shared.setValue($).toNumber()},HV=function($){return t("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),e.shared.setValue($).toNumber()};var iY=function(){const $=[],Z=[];for(let Q=0;Q<32;Q++)$[Q]=Q,Z[Q]=Q;$[a.NORMAL_NPM]=a.NORMAL,$[a.ADD_NPM]=a.ADD,$[a.SCREEN_NPM]=a.SCREEN,Z[a.NORMAL]=a.NORMAL_NPM,Z[a.ADD]=a.ADD_NPM,Z[a.SCREEN]=a.SCREEN_NPM;const J=[];return J.push(Z),J.push($),J},GV=function($,Z){return e7[Z?1:0][$]},YV=function($,Z,J,Q=!0){return t("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),e.shared.setValue($).premultiply(Z,Q).toArray(J??new Float32Array(4))},wV=function($,Z){return t("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),e.shared.setValue($).toPremultiplied(Z)},jV=function($,Z,J,Q=!0){return t("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),e.shared.setValue($).premultiply(Z,Q).toArray(J??new Float32Array(4))},e7=iY();var I9=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;var BV=function($,Z=null){const J=$*6;if(Z=Z||new Uint16Array(J),Z.length!==J)throw new Error(`Out buffer length is incorrect, got ${Z.length} and expected ${J}`);for(let Q=0,K=0;Q<J;Q+=6,K+=4)Z[Q+0]=K+0,Z[Q+1]=K+1,Z[Q+2]=K+2,Z[Q+3]=K+0,Z[Q+4]=K+2,Z[Q+5]=K+3;return Z};var l8=function($){if($.BYTES_PER_ELEMENT===4)return $ instanceof Float32Array?"Float32Array":$ instanceof Uint32Array?"Uint32Array":"Int32Array";if($.BYTES_PER_ELEMENT===2){if($ instanceof Uint16Array)return"Uint16Array"}else if($.BYTES_PER_ELEMENT===1&&$ instanceof Uint8Array)return"Uint8Array";return null};var FV=function($,Z){let J=0,Q=0;const K={};for(let W=0;W<$.length;W++)Q+=Z[W],J+=$[W].length;const q=new ArrayBuffer(J*4);let V=null,X=0;for(let W=0;W<$.length;W++){const U=Z[W],z=$[W],H=l8(z);K[H]||(K[H]=new aY[H](q)),V=K[H];for(let G=0;G<z.length;G++){const Y=(G/U|0)*Q+X,w=G%U;V[Y+w]=z[G]}X+=U}return new Float32Array(q)},aY={Float32Array,Uint32Array,Int32Array,Uint8Array};var n8=function($){return $+=$===0?1:0,--$,$|=$>>>1,$|=$>>>2,$|=$>>>4,$|=$>>>8,$|=$>>>16,$+1},$5=function($){return!($&$-1)&&!!$},Z5=function($){let Z=($>65535?1:0)<<4;$>>>=Z;let J=($>255?1:0)<<3;return $>>>=J,Z|=J,J=($>15?1:0)<<2,$>>>=J,Z|=J,J=($>3?1:0)<<1,$>>>=J,Z|=J,Z|$>>1};var R9=function($,Z,J){const Q=$.length;let K;if(Z>=Q||J===0)return;J=Z+J>Q?Q-Z:J;const q=Q-J;for(K=Z;K<q;++K)$[K]=$[K+J];$.length=q};var NV=function($){return $===0?0:$<0?-1:1};var X8=function(){return++rY},rY=0;var fJ=class{constructor($,Z,J,Q){this.left=$,this.top=Z,this.right=J,this.bottom=Q}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};fJ.EMPTY=new fJ(0,0,0,0);var J5=fJ;var CV=function(){let $;for($ in c0)c0[$].destroy();for($ in Y$)Y$[$].destroy()},LV=function(){let $;for($ in c0)delete c0[$];for($ in Y$)delete Y$[$]},Q5={},c0=Object.create(null),Y$=Object.create(null);class yJ{constructor($,Z,J){this._canvas=R.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=J||R.RESOLUTION,this.resize($,Z)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize($,Z){this._checkDestroyed(),this._canvas.width=Math.round($*this.resolution),this._canvas.height=Math.round(Z*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width($){this._checkDestroyed(),this._canvas.width=Math.round($)}get height(){return this._checkDestroyed(),this._canvas.height}set height($){this._checkDestroyed(),this._canvas.height=Math.round($)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}var _V=function($,Z,J){for(let Q=0,K=4*J*Z;Q<Z;++Q,K+=4)if($[K+3]!==0)return!1;return!0},OV=function($,Z,J,Q,K){const q=4*Z;for(let V=Q,X=Q*q+4*J;V<=K;++V,X+=q)if($[X+3]!==0)return!1;return!0},P9=function($){const{width:Z,height:J}=$,Q=$.getContext("2d",{willReadFrequently:!0});if(Q===null)throw new TypeError("Failed to get canvas 2D context");const K=Q.getImageData(0,0,Z,J).data;let q=0,V=0,X=Z-1,W=J-1;for(;V<J&&_V(K,Z,V);)++V;if(V===J)return J5.EMPTY;for(;_V(K,Z,W);)--W;for(;OV(K,Z,q,V,W);)++q;for(;OV(K,Z,X,V,W);)--X;return++X,++W,new J5(q,V,X,W)};var IV=function($){const Z=P9($),{width:J,height:Q}=Z;let K=null;if(!Z.isEmpty()){const q=$.getContext("2d");if(q===null)throw new TypeError("Failed to get canvas 2D context");K=q.getImageData(Z.left,Z.top,J,Q)}return{width:J,height:Q,data:K}};var RV=function($){const Z=I9.exec($);if(Z)return{mediaType:Z[1]?Z[1].toLowerCase():void 0,subType:Z[2]?Z[2].toLowerCase():void 0,charset:Z[3]?Z[3].toLowerCase():void 0,encoding:Z[4]?Z[4].toLowerCase():void 0,data:Z[5]}};var D9=function($,Z=globalThis.location){if($.startsWith("data:"))return"";Z=Z||globalThis.location;const J=new URL($,document.baseURI);return J.hostname!==Z.hostname||J.port!==Z.port||J.protocol!==Z.protocol?"anonymous":""};var K5=function($,Z=1){const J=R.RETINA_PREFIX?.exec($);return J?parseFloat(J[1]):Z};var I=(($)=>($.Renderer="renderer",$.Application="application",$.RendererSystem="renderer-webgl-system",$.RendererPlugin="renderer-webgl-plugin",$.CanvasRendererSystem="renderer-canvas-system",$.CanvasRendererPlugin="renderer-canvas-plugin",$.Asset="asset",$.LoadParser="load-parser",$.ResolveParser="resolve-parser",$.CacheParser="cache-parser",$.DetectionParser="detection-parser",$))(I||{}),gJ=($)=>{if(typeof $=="function"||typeof $=="object"&&$.extension){if(!$.extension)throw new Error("Extension class must have an extension object");$={...typeof $.extension!="object"?{type:$.extension}:$.extension,ref:$}}if(typeof $=="object")$={...$};else throw new Error("Invalid extension type");return typeof $.type=="string"&&($.type=[$.type]),$},DV=($,Z)=>gJ($).priority??Z,P={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...$){return $.map(gJ).forEach((Z)=>{Z.type.forEach((J)=>this._removeHandlers[J]?.(Z))}),this},add(...$){return $.map(gJ).forEach((Z)=>{Z.type.forEach((J)=>{const Q=this._addHandlers,K=this._queue;Q[J]?Q[J](Z):(K[J]=K[J]||[],K[J].push(Z))})}),this},handle($,Z,J){const Q=this._addHandlers,K=this._removeHandlers;if(Q[$]||K[$])throw new Error(`Extension type ${$} already has a handler`);Q[$]=Z,K[$]=J;const q=this._queue;return q[$]&&(q[$].forEach((V)=>Z(V)),delete q[$]),this},handleByMap($,Z){return this.handle($,(J)=>{Z[J.name]=J.ref},(J)=>{delete Z[J.name]})},handleByList($,Z,J=-1){return this.handle($,(Q)=>{Z.includes(Q.ref)||(Z.push(Q.ref),Z.sort((K,q)=>DV(q,J)-DV(K,J)))},(Q)=>{const K=Z.indexOf(Q.ref);K!==-1&&Z.splice(K,1)})}};class C6{constructor($){typeof $=="number"?this.rawBinaryData=new ArrayBuffer($):$ instanceof Uint8Array?this.rawBinaryData=$.buffer:this.rawBinaryData=$,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view($){return this[`${$}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf($){switch($){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${$} isn't a valid view type`)}}}var eY=function($){let Z="";for(let J=0;J<$;++J)J>0&&(Z+=`
else `),J<$-1&&(Z+=`if(test == ${J}.0){}`);return Z},A9=function($,Z){if($===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const J=Z.createShader(Z.FRAGMENT_SHADER);for(;;){const Q=tY.replace(/%forloop%/gi,eY($));if(Z.shaderSource(J,Q),Z.compileShader(J),!Z.getShaderParameter(J,Z.COMPILE_STATUS))$=$/2|0;else break}return $},tY=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);var xJ=0,mJ=1,cJ=2,pJ=3,uJ=4,dJ=5;class p0{constructor(){this.data=0,this.blendMode=a.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<xJ)}set blend($){!!(this.data&1<<xJ)!==$&&(this.data^=1<<xJ)}get offsets(){return!!(this.data&1<<mJ)}set offsets($){!!(this.data&1<<mJ)!==$&&(this.data^=1<<mJ)}get culling(){return!!(this.data&1<<cJ)}set culling($){!!(this.data&1<<cJ)!==$&&(this.data^=1<<cJ)}get depthTest(){return!!(this.data&1<<pJ)}set depthTest($){!!(this.data&1<<pJ)!==$&&(this.data^=1<<pJ)}get depthMask(){return!!(this.data&1<<dJ)}set depthMask($){!!(this.data&1<<dJ)!==$&&(this.data^=1<<dJ)}get clockwiseFrontFace(){return!!(this.data&1<<uJ)}set clockwiseFrontFace($){!!(this.data&1<<uJ)!==$&&(this.data^=1<<uJ)}get blendMode(){return this._blendMode}set blendMode($){this.blend=$!==a.NONE,this._blendMode=$}get polygonOffset(){return this._polygonOffset}set polygonOffset($){this.offsets=!!$,this._polygonOffset=$}static for2d(){const $=new p0;return $.depthTest=!1,$.blend=!0,$}}p0.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};var $7=function($,Z){if(!$)return null;let J="";if(typeof $=="string"){const Q=/\.(\w{3,4})(?:$|\?|#)/i.exec($);Q&&(J=Q[1].toLowerCase())}for(let Q=q5.length-1;Q>=0;--Q){const K=q5[Q];if(K.test&&K.test($,J))return new K($,Z)}throw new Error("Unrecognized source type to auto-detect Resource")},q5=[];class v0{constructor($){this.items=[],this._name=$,this._aliasCount=0}emit($,Z,J,Q,K,q,V,X){if(arguments.length>8)throw new Error("max arguments reached");const{name:W,items:U}=this;this._aliasCount++;for(let z=0,H=U.length;z<H;z++)U[z][W]($,Z,J,Q,K,q,V,X);return U===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add($){return $[this._name]&&(this.ensureNonAliasedItems(),this.remove($),this.items.push($)),this}remove($){const Z=this.items.indexOf($);return Z!==-1&&(this.ensureNonAliasedItems(),this.items.splice(Z,1)),this}contains($){return this.items.includes($)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(v0.prototype,{dispatch:{value:v0.prototype.emit},run:{value:v0.prototype.emit}});class m${constructor($=0,Z=0){this._width=$,this._height=Z,this.destroyed=!1,this.internal=!1,this.onResize=new v0("setRealSize"),this.onUpdate=new v0("update"),this.onError=new v0("onError")}bind($){this.onResize.add($),this.onUpdate.add($),this.onError.add($),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind($){this.onResize.remove($),this.onUpdate.remove($),this.onError.remove($)}resize($,Z){($!==this._width||Z!==this._height)&&(this._width=$,this._height=Z,this.onResize.emit($,Z))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style($,Z,J){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test($,Z){return!1}}class W8 extends m${constructor($,Z){const{width:J,height:Q}=Z||{};if(!J||!Q)throw new Error("BufferResource width or height invalid");super(J,Q),this.data=$,this.unpackAlignment=Z.unpackAlignment??4}upload($,Z,J){const Q=$.gl;Q.pixelStorei(Q.UNPACK_ALIGNMENT,this.unpackAlignment),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z.alphaMode===_0.UNPACK);const{realWidth:K,realHeight:q}=Z;return J.width===K&&J.height===q?Q.texSubImage2D(Z.target,0,0,0,K,q,Z.format,J.type,this.data):(J.width=K,J.height=q,Q.texImage2D(Z.target,0,J.internalFormat,K,q,0,Z.format,J.type,this.data)),!0}dispose(){this.data=null}static test($){return $===null||$ instanceof Int8Array||$ instanceof Uint8Array||$ instanceof Uint8ClampedArray||$ instanceof Int16Array||$ instanceof Uint16Array||$ instanceof Int32Array||$ instanceof Uint32Array||$ instanceof Float32Array}}var $w={scaleMode:O$.NEAREST,alphaMode:_0.NPM},lJ=class $ extends o8.default{constructor(Z=null,J=null){super(),J=Object.assign({},$.defaultOptions,J);const{alphaMode:Q,mipmap:K,anisotropicLevel:q,scaleMode:V,width:X,height:W,wrapMode:U,format:z,type:H,target:G,resolution:Y,resourceOptions:w}=J;Z&&!(Z instanceof m$)&&(Z=$7(Z,w),Z.internal=!0),this.resolution=Y||R.RESOLUTION,this.width=Math.round((X||0)*this.resolution)/this.resolution,this.height=Math.round((W||0)*this.resolution)/this.resolution,this._mipmap=K,this.anisotropicLevel=q,this._wrapMode=U,this._scaleMode=V,this.format=z,this.type=H,this.target=G,this.alphaMode=Q,this.uid=X8(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=X>0&&W>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(Z)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(Z){this._mipmap!==Z&&(this._mipmap=Z,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(Z){this._scaleMode!==Z&&(this._scaleMode=Z,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(Z){this._wrapMode!==Z&&(this._wrapMode=Z,this.dirtyStyleId++)}setStyle(Z,J){let Q;return Z!==void 0&&Z!==this.scaleMode&&(this.scaleMode=Z,Q=!0),J!==void 0&&J!==this.mipmap&&(this.mipmap=J,Q=!0),Q&&this.dirtyStyleId++,this}setSize(Z,J,Q){return Q=Q||this.resolution,this.setRealSize(Z*Q,J*Q,Q)}setRealSize(Z,J,Q){return this.resolution=Q||this.resolution,this.width=Math.round(Z)/this.resolution,this.height=Math.round(J)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=$5(this.realWidth)&&$5(this.realHeight)}setResolution(Z){const J=this.resolution;return J===Z?this:(this.resolution=Z,this.valid&&(this.width=Math.round(this.width*J)/Z,this.height=Math.round(this.height*J)/Z,this.emit("update",this)),this._refreshPOT(),this)}setResource(Z){if(this.resource===Z)return this;if(this.resource)throw new Error("Resource can be set only once");return Z.bind(this),this.resource=Z,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(Z){this.emit("error",this,Z)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Y$[this.cacheId],delete c0[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),$.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(Z,J,Q=R.STRICT_TEXTURE_CACHE){const K=typeof Z=="string";let q=null;if(K)q=Z;else{if(!Z._pixiId){const X=J?.pixiIdPrefix||"pixiid";Z._pixiId=`${X}_${X8()}`}q=Z._pixiId}let V=Y$[q];if(K&&Q&&!V)throw new Error(`The cacheId "${q}" does not exist in BaseTextureCache.`);return V||(V=new $(Z,J),V.cacheId=q,$.addToCache(V,q)),V}static fromBuffer(Z,J,Q,K){Z=Z||new Float32Array(J*Q*4);const q=new W8(Z,{width:J,height:Q,...K?.resourceOptions});let V,X;return Z instanceof Float32Array?(V=v.RGBA,X=d.FLOAT):Z instanceof Int32Array?(V=v.RGBA_INTEGER,X=d.INT):Z instanceof Uint32Array?(V=v.RGBA_INTEGER,X=d.UNSIGNED_INT):Z instanceof Int16Array?(V=v.RGBA_INTEGER,X=d.SHORT):Z instanceof Uint16Array?(V=v.RGBA_INTEGER,X=d.UNSIGNED_SHORT):Z instanceof Int8Array?(V=v.RGBA,X=d.BYTE):(V=v.RGBA,X=d.UNSIGNED_BYTE),q.internal=!0,new $(q,Object.assign({},$w,{type:X,format:V},K))}static addToCache(Z,J){J&&(Z.textureCacheIds.includes(J)||Z.textureCacheIds.push(J),Y$[J]&&Y$[J]!==Z&&console.warn(`BaseTexture added to the cache with an id [${J}] that already had an entry`),Y$[J]=Z)}static removeFromCache(Z){if(typeof Z=="string"){const J=Y$[Z];if(J){const Q=J.textureCacheIds.indexOf(Z);return Q>-1&&J.textureCacheIds.splice(Q,1),delete Y$[Z],J}}else if(Z?.textureCacheIds){for(let J=0;J<Z.textureCacheIds.length;++J)delete Y$[Z.textureCacheIds[J]];return Z.textureCacheIds.length=0,Z}return null}};lJ.defaultOptions={mipmap:s0.POW2,anisotropicLevel:0,scaleMode:O$.LINEAR,wrapMode:z$.CLAMP,alphaMode:_0.UNPACK,target:T8.TEXTURE_2D,format:v.RGBA,type:d.UNSIGNED_BYTE},lJ._globalBatch=0;var n=lJ;class L6{constructor(){this.texArray=null,this.blend=0,this.type=_$.TRIANGLES,this.start=0,this.size=0,this.data=null}}var Zw=0;class H0{constructor($,Z=!0,J=!1){this.data=$||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=J,this.static=Z,this.id=Zw++,this.disposeRunner=new v0("disposeBuffer")}update($){$ instanceof Array&&($=new Float32Array($)),this.data=$||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index($){this.type=$?I$.ELEMENT_ARRAY_BUFFER:I$.ARRAY_BUFFER}get index(){return this.type===I$.ELEMENT_ARRAY_BUFFER}static from($){return $ instanceof Array&&($=new Float32Array($)),new H0($)}}class Z7{constructor($,Z=0,J=!1,Q=d.FLOAT,K,q,V,X=1){this.buffer=$,this.size=Z,this.normalized=J,this.type=Q,this.stride=K,this.start=q,this.instance=V,this.divisor=X}destroy(){this.buffer=null}static from($,Z,J,Q,K){return new Z7($,Z,J,Q,K)}}var AV=function($,Z){let J=0,Q=0;const K={};for(let W=0;W<$.length;W++)Q+=Z[W],J+=$[W].length;const q=new ArrayBuffer(J*4);let V=null,X=0;for(let W=0;W<$.length;W++){const U=Z[W],z=$[W],H=l8(z);K[H]||(K[H]=new Jw[H](q)),V=K[H];for(let G=0;G<z.length;G++){const Y=(G/U|0)*Q+X,w=G%U;V[Y+w]=z[G]}X+=U}return new Float32Array(q)},Jw={Float32Array,Uint32Array,Int32Array,Uint8Array};var MV={5126:4,5123:2,5121:1},Qw=0,Kw={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class R${constructor($=[],Z={}){this.buffers=$,this.indexBuffer=null,this.attributes=Z,this.glVertexArrayObjects={},this.id=Qw++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new v0("disposeGeometry"),this.refCount=0}addAttribute($,Z,J=0,Q=!1,K,q,V,X=!1){if(!Z)throw new Error("You must pass a buffer when creating an attribute");Z instanceof H0||(Z instanceof Array&&(Z=new Float32Array(Z)),Z=new H0(Z));const W=$.split("|");if(W.length>1){for(let z=0;z<W.length;z++)this.addAttribute(W[z],Z,J,Q,K);return this}let U=this.buffers.indexOf(Z);return U===-1&&(this.buffers.push(Z),U=this.buffers.length-1),this.attributes[$]=new Z7(U,J,Q,K,q,V,X),this.instanced=this.instanced||X,this}getAttribute($){return this.attributes[$]}getBuffer($){return this.buffers[this.getAttribute($).buffer]}addIndex($){return $ instanceof H0||($ instanceof Array&&($=new Uint16Array($)),$=new H0($)),$.type=I$.ELEMENT_ARRAY_BUFFER,this.indexBuffer=$,this.buffers.includes($)||this.buffers.push($),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const $=[],Z=[],J=new H0;let Q;for(Q in this.attributes){const K=this.attributes[Q],q=this.buffers[K.buffer];$.push(q.data),Z.push(K.size*MV[K.type]/4),K.buffer=0}for(J.data=AV($,Z),Q=0;Q<this.buffers.length;Q++)this.buffers[Q]!==this.indexBuffer&&this.buffers[Q].destroy();return this.buffers=[J],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let $ in this.attributes){const Z=this.attributes[$];return this.buffers[Z.buffer].data.length/(Z.stride/4||Z.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const $=new R$;for(let Z=0;Z<this.buffers.length;Z++)$.buffers[Z]=new H0(this.buffers[Z].data.slice(0));for(let Z in this.attributes){const J=this.attributes[Z];$.attributes[Z]=new Z7(J.buffer,J.size,J.normalized,J.type,J.stride,J.start,J.instance)}return this.indexBuffer&&($.indexBuffer=$.buffers[this.buffers.indexOf(this.indexBuffer)],$.indexBuffer.type=I$.ELEMENT_ARRAY_BUFFER),$}static merge($){const Z=new R$,J=[],Q=[],K=[];let q;for(let V=0;V<$.length;V++){q=$[V];for(let X=0;X<q.buffers.length;X++)Q[X]=Q[X]||0,Q[X]+=q.buffers[X].data.length,K[X]=0}for(let V=0;V<q.buffers.length;V++)J[V]=new Kw[l8(q.buffers[V].data)](Q[V]),Z.buffers[V]=new H0(J[V]);for(let V=0;V<$.length;V++){q=$[V];for(let X=0;X<q.buffers.length;X++)J[X].set(q.buffers[X].data,K[X]),K[X]+=q.buffers[X].data.length}if(Z.attributes=q.attributes,q.indexBuffer){Z.indexBuffer=Z.buffers[q.buffers.indexOf(q.indexBuffer)],Z.indexBuffer.type=I$.ELEMENT_ARRAY_BUFFER;let V=0,X=0,W=0,U=0;for(let z=0;z<q.buffers.length;z++)if(q.buffers[z]!==q.indexBuffer){U=z;break}for(let z in q.attributes){const H=q.attributes[z];(H.buffer|0)===U&&(X+=H.size*MV[H.type]/4)}for(let z=0;z<$.length;z++){const H=$[z].indexBuffer.data;for(let G=0;G<H.length;G++)Z.indexBuffer.data[G+W]+=V;V+=$[z].buffers[U].data.length/X,W+=H.length}}return Z}}class J7 extends R${constructor($=!1){super(),this._buffer=new H0(null,$,!1),this._indexBuffer=new H0(null,$,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,d.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,d.FLOAT).addAttribute("aColor",this._buffer,4,!0,d.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,d.FLOAT).addIndex(this._indexBuffer)}}var s8=Math.PI*2,nJ=180/Math.PI,oJ=Math.PI/180,G0=(($)=>($[$.POLY=0]="POLY",$[$.RECT=1]="RECT",$[$.CIRC=2]="CIRC",$[$.ELIP=3]="ELIP",$[$.RREC=4]="RREC",$))(G0||{});class u{constructor($=0,Z=0){this.x=0,this.y=0,this.x=$,this.y=Z}clone(){return new u(this.x,this.y)}copyFrom($){return this.set($.x,$.y),this}copyTo($){return $.set(this.x,this.y),$}equals($){return $.x===this.x&&$.y===this.y}set($=0,Z=$){return this.x=$,this.y=Z,this}}u.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};var M9=[new u,new u,new u,new u];class m{constructor($=0,Z=0,J=0,Q=0){this.x=Number($),this.y=Number(Z),this.width=Number(J),this.height=Number(Q),this.type=G0.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new m(0,0,0,0)}clone(){return new m(this.x,this.y,this.width,this.height)}copyFrom($){return this.x=$.x,this.y=$.y,this.width=$.width,this.height=$.height,this}copyTo($){return $.x=this.x,$.y=this.y,$.width=this.width,$.height=this.height,$}contains($,Z){return this.width<=0||this.height<=0?!1:$>=this.x&&$<this.x+this.width&&Z>=this.y&&Z<this.y+this.height}intersects($,Z){if(!Z){const O=this.x<$.x?$.x:this.x;if((this.right>$.right?$.right:this.right)<=O)return!1;const h=this.y<$.y?$.y:this.y;return(this.bottom>$.bottom?$.bottom:this.bottom)>h}const J=this.left,Q=this.right,K=this.top,q=this.bottom;if(Q<=J||q<=K)return!1;const V=M9[0].set($.left,$.top),X=M9[1].set($.left,$.bottom),W=M9[2].set($.right,$.top),U=M9[3].set($.right,$.bottom);if(W.x<=V.x||X.y<=V.y)return!1;const z=Math.sign(Z.a*Z.d-Z.b*Z.c);if(z===0||(Z.apply(V,V),Z.apply(X,X),Z.apply(W,W),Z.apply(U,U),Math.max(V.x,X.x,W.x,U.x)<=J||Math.min(V.x,X.x,W.x,U.x)>=Q||Math.max(V.y,X.y,W.y,U.y)<=K||Math.min(V.y,X.y,W.y,U.y)>=q))return!1;const H=z*(X.y-V.y),G=z*(V.x-X.x),Y=H*J+G*K,w=H*Q+G*K,j=H*J+G*q,B=H*Q+G*q;if(Math.max(Y,w,j,B)<=H*V.x+G*V.y||Math.min(Y,w,j,B)>=H*U.x+G*U.y)return!1;const C=z*(V.y-W.y),N=z*(W.x-V.x),F=C*J+N*K,L=C*Q+N*K,k=C*J+N*q,o=C*Q+N*q;return!(Math.max(F,L,k,o)<=C*V.x+N*V.y||Math.min(F,L,k,o)>=C*U.x+N*U.y)}pad($=0,Z=$){return this.x-=$,this.y-=Z,this.width+=$*2,this.height+=Z*2,this}fit($){const Z=Math.max(this.x,$.x),J=Math.min(this.x+this.width,$.x+$.width),Q=Math.max(this.y,$.y),K=Math.min(this.y+this.height,$.y+$.height);return this.x=Z,this.width=Math.max(J-Z,0),this.y=Q,this.height=Math.max(K-Q,0),this}ceil($=1,Z=0.001){const J=Math.ceil((this.x+this.width-Z)*$)/$,Q=Math.ceil((this.y+this.height-Z)*$)/$;return this.x=Math.floor((this.x+Z)*$)/$,this.y=Math.floor((this.y+Z)*$)/$,this.width=J-this.x,this.height=Q-this.y,this}enlarge($){const Z=Math.min(this.x,$.x),J=Math.max(this.x+this.width,$.x+$.width),Q=Math.min(this.y,$.y),K=Math.max(this.y+this.height,$.y+$.height);return this.x=Z,this.width=J-Z,this.y=Q,this.height=K-Q,this}}m.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Q7{constructor($=0,Z=0,J=0){this.x=$,this.y=Z,this.radius=J,this.type=G0.CIRC}clone(){return new Q7(this.x,this.y,this.radius)}contains($,Z){if(this.radius<=0)return!1;const J=this.radius*this.radius;let Q=this.x-$,K=this.y-Z;return Q*=Q,K*=K,Q+K<=J}getBounds(){return new m(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Q7.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class K7{constructor($=0,Z=0,J=0,Q=0){this.x=$,this.y=Z,this.width=J,this.height=Q,this.type=G0.ELIP}clone(){return new K7(this.x,this.y,this.width,this.height)}contains($,Z){if(this.width<=0||this.height<=0)return!1;let J=($-this.x)/this.width,Q=(Z-this.y)/this.height;return J*=J,Q*=Q,J+Q<=1}getBounds(){return new m(this.x-this.width,this.y-this.height,this.width,this.height)}}K7.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class U8{constructor(...$){let Z=Array.isArray($[0])?$[0]:$;if(typeof Z[0]!="number"){const J=[];for(let Q=0,K=Z.length;Q<K;Q++)J.push(Z[Q].x,Z[Q].y);Z=J}this.points=Z,this.type=G0.POLY,this.closeStroke=!0}clone(){const $=this.points.slice(),Z=new U8($);return Z.closeStroke=this.closeStroke,Z}contains($,Z){let J=!1;const Q=this.points.length/2;for(let K=0,q=Q-1;K<Q;q=K++){const V=this.points[K*2],X=this.points[K*2+1],W=this.points[q*2],U=this.points[q*2+1];X>Z!=U>Z&&$<(W-V)*((Z-X)/(U-X))+V&&(J=!J)}return J}}U8.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce(($,Z)=>`${$}, ${Z}`,"")}]`};class q7{constructor($=0,Z=0,J=0,Q=0,K=20){this.x=$,this.y=Z,this.width=J,this.height=Q,this.radius=K,this.type=G0.RREC}clone(){return new q7(this.x,this.y,this.width,this.height,this.radius)}contains($,Z){if(this.width<=0||this.height<=0)return!1;if($>=this.x&&$<=this.x+this.width&&Z>=this.y&&Z<=this.y+this.height){const J=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(Z>=this.y+J&&Z<=this.y+this.height-J||$>=this.x+J&&$<=this.x+this.width-J)return!0;let Q=$-(this.x+J),K=Z-(this.y+J);const q=J*J;if(Q*Q+K*K<=q||(Q=$-(this.x+this.width-J),Q*Q+K*K<=q)||(K=Z-(this.y+this.height-J),Q*Q+K*K<=q)||(Q=$-(this.x+J),Q*Q+K*K<=q))return!0}return!1}}q7.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Z0{constructor($=1,Z=0,J=0,Q=1,K=0,q=0){this.array=null,this.a=$,this.b=Z,this.c=J,this.d=Q,this.tx=K,this.ty=q}fromArray($){this.a=$[0],this.b=$[1],this.c=$[3],this.d=$[4],this.tx=$[2],this.ty=$[5]}set($,Z,J,Q,K,q){return this.a=$,this.b=Z,this.c=J,this.d=Q,this.tx=K,this.ty=q,this}toArray($,Z){this.array||(this.array=new Float32Array(9));const J=Z||this.array;return $?(J[0]=this.a,J[1]=this.b,J[2]=0,J[3]=this.c,J[4]=this.d,J[5]=0,J[6]=this.tx,J[7]=this.ty,J[8]=1):(J[0]=this.a,J[1]=this.c,J[2]=this.tx,J[3]=this.b,J[4]=this.d,J[5]=this.ty,J[6]=0,J[7]=0,J[8]=1),J}apply($,Z){Z=Z||new u;const{x:J,y:Q}=$;return Z.x=this.a*J+this.c*Q+this.tx,Z.y=this.b*J+this.d*Q+this.ty,Z}applyInverse($,Z){Z=Z||new u;const J=1/(this.a*this.d+this.c*-this.b),Q=$.x,K=$.y;return Z.x=this.d*J*Q+-this.c*J*K+(this.ty*this.c-this.tx*this.d)*J,Z.y=this.a*J*K+-this.b*J*Q+(-this.ty*this.a+this.tx*this.b)*J,Z}translate($,Z){return this.tx+=$,this.ty+=Z,this}scale($,Z){return this.a*=$,this.d*=Z,this.c*=$,this.b*=Z,this.tx*=$,this.ty*=Z,this}rotate($){const Z=Math.cos($),J=Math.sin($),Q=this.a,K=this.c,q=this.tx;return this.a=Q*Z-this.b*J,this.b=Q*J+this.b*Z,this.c=K*Z-this.d*J,this.d=K*J+this.d*Z,this.tx=q*Z-this.ty*J,this.ty=q*J+this.ty*Z,this}append($){const Z=this.a,J=this.b,Q=this.c,K=this.d;return this.a=$.a*Z+$.b*Q,this.b=$.a*J+$.b*K,this.c=$.c*Z+$.d*Q,this.d=$.c*J+$.d*K,this.tx=$.tx*Z+$.ty*Q+this.tx,this.ty=$.tx*J+$.ty*K+this.ty,this}setTransform($,Z,J,Q,K,q,V,X,W){return this.a=Math.cos(V+W)*K,this.b=Math.sin(V+W)*K,this.c=-Math.sin(V-X)*q,this.d=Math.cos(V-X)*q,this.tx=$-(J*this.a+Q*this.c),this.ty=Z-(J*this.b+Q*this.d),this}prepend($){const Z=this.tx;if($.a!==1||$.b!==0||$.c!==0||$.d!==1){const J=this.a,Q=this.c;this.a=J*$.a+this.b*$.c,this.b=J*$.b+this.b*$.d,this.c=Q*$.a+this.d*$.c,this.d=Q*$.b+this.d*$.d}return this.tx=Z*$.a+this.ty*$.c+$.tx,this.ty=Z*$.b+this.ty*$.d+$.ty,this}decompose($){const Z=this.a,J=this.b,Q=this.c,K=this.d,q=$.pivot,V=-Math.atan2(-Q,K),X=Math.atan2(J,Z),W=Math.abs(V+X);return W<0.00001||Math.abs(s8-W)<0.00001?($.rotation=X,$.skew.x=$.skew.y=0):($.rotation=0,$.skew.x=V,$.skew.y=X),$.scale.x=Math.sqrt(Z*Z+J*J),$.scale.y=Math.sqrt(Q*Q+K*K),$.position.x=this.tx+(q.x*Z+q.y*Q),$.position.y=this.ty+(q.x*J+q.y*K),$}invert(){const $=this.a,Z=this.b,J=this.c,Q=this.d,K=this.tx,q=$*Q-Z*J;return this.a=Q/q,this.b=-Z/q,this.c=-J/q,this.d=$/q,this.tx=(J*this.ty-Q*K)/q,this.ty=-($*this.ty-Z*K)/q,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const $=new Z0;return $.a=this.a,$.b=this.b,$.c=this.c,$.d=this.d,$.tx=this.tx,$.ty=this.ty,$}copyTo($){return $.a=this.a,$.b=this.b,$.c=this.c,$.d=this.d,$.tx=this.tx,$.ty=this.ty,$}copyFrom($){return this.a=$.a,this.b=$.b,this.c=$.c,this.d=$.d,this.tx=$.tx,this.ty=$.ty,this}static get IDENTITY(){return new Z0}static get TEMP_MATRIX(){return new Z0}}Z0.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};var qw=function(){for(let $=0;$<16;$++){const Z=[];sJ.push(Z);for(let J=0;J<16;J++){const Q=k9(_6[$]*_6[J]+I6[$]*O6[J]),K=k9(O6[$]*_6[J]+R6[$]*O6[J]),q=k9(_6[$]*I6[J]+I6[$]*R6[J]),V=k9(O6[$]*I6[J]+R6[$]*R6[J]);for(let X=0;X<16;X++)if(_6[X]===Q&&O6[X]===K&&I6[X]===q&&R6[X]===V){Z.push(X);break}}}for(let $=0;$<16;$++){const Z=new Z0;Z.set(_6[$],O6[$],I6[$],R6[$],0,0),kV.push(Z)}},_6=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],O6=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],I6=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],R6=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],sJ=[],kV=[],k9=Math.sign;qw();var F0={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:($)=>_6[$],uY:($)=>O6[$],vX:($)=>I6[$],vY:($)=>R6[$],inv:($)=>$&8?$&15:-$&7,add:($,Z)=>sJ[$][Z],sub:($,Z)=>sJ[$][F0.inv(Z)],rotate180:($)=>$^4,isVertical:($)=>($&3)===2,byDirection:($,Z)=>Math.abs($)*2<=Math.abs(Z)?Z>=0?F0.S:F0.N:Math.abs(Z)*2<=Math.abs($)?$>0?F0.E:F0.W:Z>0?$>0?F0.SE:F0.SW:$>0?F0.NE:F0.NW,matrixAppendRotationInv:($,Z,J=0,Q=0)=>{const K=kV[F0.inv(Z)];K.tx=J,K.ty=Q,$.append(K)}};class E${constructor($,Z,J=0,Q=0){this._x=J,this._y=Q,this.cb=$,this.scope=Z}clone($=this.cb,Z=this.scope){return new E$($,Z,this._x,this._y)}set($=0,Z=$){return(this._x!==$||this._y!==Z)&&(this._x=$,this._y=Z,this.cb.call(this.scope)),this}copyFrom($){return(this._x!==$.x||this._y!==$.y)&&(this._x=$.x,this._y=$.y,this.cb.call(this.scope)),this}copyTo($){return $.set(this._x,this._y),$}equals($){return $.x===this._x&&$.y===this._y}get x(){return this._x}set x($){this._x!==$&&(this._x=$,this.cb.call(this.scope))}get y(){return this._y}set y($){this._y!==$&&(this._y=$,this.cb.call(this.scope))}}E$.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};var iJ=class{constructor(){this.worldTransform=new Z0,this.localTransform=new Z0,this.position=new E$(this.onChange,this,0,0),this.scale=new E$(this.onChange,this,1,1),this.pivot=new E$(this.onChange,this,0,0),this.skew=new E$(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const $=this.localTransform;this._localID!==this._currentLocalID&&($.a=this._cx*this.scale.x,$.b=this._sx*this.scale.x,$.c=this._cy*this.scale.y,$.d=this._sy*this.scale.y,$.tx=this.position.x-(this.pivot.x*$.a+this.pivot.y*$.c),$.ty=this.position.y-(this.pivot.x*$.b+this.pivot.y*$.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform($){const Z=this.localTransform;if(this._localID!==this._currentLocalID&&(Z.a=this._cx*this.scale.x,Z.b=this._sx*this.scale.x,Z.c=this._cy*this.scale.y,Z.d=this._sy*this.scale.y,Z.tx=this.position.x-(this.pivot.x*Z.a+this.pivot.y*Z.c),Z.ty=this.position.y-(this.pivot.x*Z.b+this.pivot.y*Z.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==$._worldID){const J=$.worldTransform,Q=this.worldTransform;Q.a=Z.a*J.a+Z.b*J.c,Q.b=Z.a*J.b+Z.b*J.d,Q.c=Z.c*J.a+Z.d*J.c,Q.d=Z.c*J.b+Z.d*J.d,Q.tx=Z.tx*J.a+Z.ty*J.c+J.tx,Q.ty=Z.tx*J.b+Z.ty*J.d+J.ty,this._parentID=$._worldID,this._worldID++}}setFromMatrix($){$.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation($){this._rotation!==$&&(this._rotation=$,this.updateSkew())}};iJ.IDENTITY=new iJ;var i8=iJ;i8.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var EV=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var TV=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;var E9=function($,Z,J){const Q=$.createShader(Z);return $.shaderSource(Q,J),$.compileShader(Q),Q};var aJ=function($){const Z=new Array($);for(let J=0;J<Z.length;J++)Z[J]=!1;return Z},V5=function($,Z){switch($){case"float":return 0;case"vec2":return new Float32Array(2*Z);case"vec3":return new Float32Array(3*Z);case"vec4":return new Float32Array(4*Z);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*Z);case"ivec3":return new Int32Array(3*Z);case"ivec4":return new Int32Array(4*Z);case"uvec2":return new Uint32Array(2*Z);case"uvec3":return new Uint32Array(3*Z);case"uvec4":return new Uint32Array(4*Z);case"bool":return!1;case"bvec2":return aJ(2*Z);case"bvec3":return aJ(3*Z);case"bvec4":return aJ(4*Z);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null};var z8=[{test:($)=>$.type==="float"&&$.size===1&&!$.isArray,code:($)=>`
            if(uv["${$}"] !== ud["${$}"].value)
            {
                ud["${$}"].value = uv["${$}"]
                gl.uniform1f(ud["${$}"].location, uv["${$}"])
            }
            `},{test:($,Z)=>($.type==="sampler2D"||$.type==="samplerCube"||$.type==="sampler2DArray")&&$.size===1&&!$.isArray&&(Z==null||Z.castToBaseTexture!==void 0),code:($)=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${$}"], t);

            if(ud["${$}"].value !== t)
            {
                ud["${$}"].value = t;
                gl.uniform1i(ud["${$}"].location, t);
; // eslint-disable-line max-len
            }`},{test:($,Z)=>$.type==="mat3"&&$.size===1&&!$.isArray&&Z.a!==void 0,code:($)=>`
            gl.uniformMatrix3fv(ud["${$}"].location, false, uv["${$}"].toArray(true));
            `,codeUbo:($)=>`
                var ${$}_matrix = uv.${$}.toArray(true);

                data[offset] = ${$}_matrix[0];
                data[offset+1] = ${$}_matrix[1];
                data[offset+2] = ${$}_matrix[2];
        
                data[offset + 4] = ${$}_matrix[3];
                data[offset + 5] = ${$}_matrix[4];
                data[offset + 6] = ${$}_matrix[5];
        
                data[offset + 8] = ${$}_matrix[6];
                data[offset + 9] = ${$}_matrix[7];
                data[offset + 10] = ${$}_matrix[8];
            `},{test:($,Z)=>$.type==="vec2"&&$.size===1&&!$.isArray&&Z.x!==void 0,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${$}"].location, v.x, v.y);
                }`,codeUbo:($)=>`
                v = uv.${$};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:($)=>$.type==="vec2"&&$.size===1&&!$.isArray,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${$}"].location, v[0], v[1]);
                }
            `},{test:($,Z)=>$.type==="vec4"&&$.size===1&&!$.isArray&&Z.width!==void 0,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${$}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:($)=>`
                    v = uv.${$};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:($,Z)=>$.type==="vec4"&&$.size===1&&!$.isArray&&Z.red!==void 0,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${$}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:($)=>`
                    v = uv.${$};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:($,Z)=>$.type==="vec3"&&$.size===1&&!$.isArray&&Z.red!==void 0,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${$}"].location, v.red, v.green, v.blue)
                }`,codeUbo:($)=>`
                    v = uv.${$};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:($)=>$.type==="vec4"&&$.size===1&&!$.isArray,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${$}"].location, v[0], v[1], v[2], v[3])
                }`}];var rJ=function($,Z){const J=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let Q in $.uniforms){const K=Z[Q];if(!K){$.uniforms[Q]?.group===!0&&($.uniforms[Q].ubo?J.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${Q}, '${Q}');
                    `):J.push(`
                        renderer.shader.syncUniformGroup(uv.${Q}, syncData);
                    `));continue}const q=$.uniforms[Q];let V=!1;for(let X=0;X<z8.length;X++)if(z8[X].test(K,q)){J.push(z8[X].code(Q,q)),V=!0;break}if(!V){const X=(K.size===1&&!K.isArray?Vw:Xw)[K.type].replace("location",`ud["${Q}"].location`);J.push(`
            cu = ud["${Q}"];
            cv = cu.value;
            v = uv["${Q}"];
            ${X};`)}}return new Function("ud","uv","renderer","syncData",J.join(`
`))},Vw={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},Xw={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var b9=function(){if(T9===bV||T9?.isContextLost()){const $=R.ADAPTER.createCanvas();let Z;R.PREFER_ENV>=M$.WEBGL2&&(Z=$.getContext("webgl2",{})),Z||(Z=$.getContext("webgl",{})||$.getContext("experimental-webgl",{}),Z?Z.getExtension("WEBGL_draw_buffers"):Z=null),T9=Z}return T9},bV={},T9=bV;var tJ=function(){if(!v9){v9=H$.MEDIUM;const $=b9();if($&&$.getShaderPrecisionFormat){const Z=$.getShaderPrecisionFormat($.FRAGMENT_SHADER,$.HIGH_FLOAT);Z&&(v9=Z.precision?H$.HIGH:H$.MEDIUM)}}return v9},v9;var vV=function($,Z){const J=$.getShaderSource(Z).split(`
`).map((U,z)=>`${z}: ${U}`),Q=$.getShaderInfoLog(Z),K=Q.split(`
`),q={},V=K.map((U)=>parseFloat(U.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter((U)=>U&&!q[U]?(q[U]=!0,!0):!1),X=[""];V.forEach((U)=>{J[U-1]=`%c${J[U-1]}%c`,X.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const W=J.join(`
`);X[0]=W,console.error(Q),console.groupCollapsed("click to view full shader code"),console.warn(...X),console.groupEnd()},eJ=function($,Z,J,Q){$.getProgramParameter(Z,$.LINK_STATUS)||($.getShaderParameter(J,$.COMPILE_STATUS)||vV($,J),$.getShaderParameter(Q,$.COMPILE_STATUS)||vV($,Q),console.error("PixiJS Error: Could not initialize shader."),$.getProgramInfoLog(Z)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",$.getProgramInfoLog(Z)))};var X5=function($){return Ww[$]},Ww={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var W5=function($,Z){if(!S9){const J=Object.keys(SV);S9={};for(let Q=0;Q<J.length;++Q){const K=J[Q];S9[$[K]]=SV[K]}}return S9[Z]},S9=null,SV={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};var h9=function($,Z,J){if($.substring(0,9)!=="precision"){let Q=Z;return Z===H$.HIGH&&J!==H$.HIGH&&(Q=H$.MEDIUM),`precision ${Q} float;
${$}`}else if(J!==H$.HIGH&&$.substring(0,15)==="precision highp")return $.replace("precision highp","precision mediump");return $};var f9=function(){if(typeof U5=="boolean")return U5;try{U5=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{U5=!1}return U5},U5;var Uw=0,y9={},$1=class ${constructor(Z,J,Q="pixi-shader",K={}){this.extra={},this.id=Uw++,this.vertexSrc=Z||$.defaultVertexSrc,this.fragmentSrc=J||$.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=K,this.vertexSrc.substring(0,8)!=="#version"&&(Q=Q.replace(/\s+/g,"-"),y9[Q]?(y9[Q]++,Q+=`-${y9[Q]}`):y9[Q]=1,this.vertexSrc=`#define SHADER_NAME ${Q}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${Q}
${this.fragmentSrc}`,this.vertexSrc=h9(this.vertexSrc,$.defaultVertexPrecision,H$.HIGH),this.fragmentSrc=h9(this.fragmentSrc,$.defaultFragmentPrecision,tJ())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return TV}static get defaultFragmentSrc(){return EV}static from(Z,J,Q){const K=Z+J;let q=Q5[K];return q||(Q5[K]=q=new $(Z,J,Q)),q}};$1.defaultVertexPrecision=H$.HIGH,$1.defaultFragmentPrecision=g$.apple.device?H$.HIGH:H$.MEDIUM;var J$=$1;var zw=0;class i0{constructor($,Z,J){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=zw++,this.static=!!Z,this.ubo=!!J,$ instanceof H0?(this.buffer=$,this.buffer.type=I$.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=$,this.ubo&&(this.buffer=new H0(new Float32Array(1)),this.buffer.type=I$.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add($,Z,J){if(!this.ubo)this.uniforms[$]=new i0(Z,J);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from($,Z,J){return new i0($,Z,J)}static uboFrom($,Z){return new i0($,Z??!0,!0)}}class a0{constructor($,Z){this.uniformBindCount=0,this.program=$,Z?Z instanceof i0?this.uniformGroup=Z:this.uniformGroup=new i0(Z):this.uniformGroup=new i0({}),this.disposeRunner=new v0("disposeShader")}checkUniformExists($,Z){if(Z.uniforms[$])return!0;for(let J in Z.uniforms){const Q=Z.uniforms[J];if(Q.group===!0&&this.checkUniformExists($,Q))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from($,Z,J){const Q=J$.from($,Z);return new a0(Q,J)}}class g9{constructor($,Z){if(this.vertexSrc=$,this.fragTemplate=Z,this.programCache={},this.defaultGroupCache={},!Z.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!Z.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader($){if(!this.programCache[$]){const J=new Int32Array($);for(let K=0;K<$;K++)J[K]=K;this.defaultGroupCache[$]=i0.from({uSamplers:J},!0);let Q=this.fragTemplate;Q=Q.replace(/%count%/gi,`${$}`),Q=Q.replace(/%forloop%/gi,this.generateSampleSrc($)),this.programCache[$]=new J$(this.vertexSrc,Q)}const Z={tint:new Float32Array([1,1,1,1]),translationMatrix:new Z0,default:this.defaultGroupCache[$]};return new a0(this.programCache[$],Z)}generateSampleSrc($){let Z="";Z+=`
`,Z+=`
`;for(let J=0;J<$;J++)J>0&&(Z+=`
else `),J<$-1&&(Z+=`if(vTextureId < ${J}.5)`),Z+=`
{`,Z+=`
	color = texture2D(uSamplers[${J}], vTextureCoord);`,Z+=`
}`;return Z+=`
`,Z+=`
`,Z}}class P6{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let $=0;$<this.count;$++)this.elements[$]=null;this.count=0}}var hV=function(){return!g$.apple.device};var fV=function($){let Z=!0;const J=R.ADAPTER.getNavigator();if(g$.tablet||g$.phone){if(g$.apple.device){const Q=J.userAgent.match(/OS (\d+)_(\d+)?/);Q&&parseInt(Q[1],10)<11&&(Z=!1)}if(g$.android.device){const Q=J.userAgent.match(/Android\s([0-9.]*)/);Q&&parseInt(Q[1],10)<7&&(Z=!1)}}return Z?$:4};class H8{constructor($){this.renderer=$}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render($){}}var yV=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var gV=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var z5=class $ extends H8{constructor(Z){super(Z),this.setShaderGenerator(),this.geometryClass=J7,this.vertexSize=6,this.state=p0.for2d(),this.size=$.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),Z.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??fV(32),this._defaultMaxTextures}static set defaultMaxTextures(Z){this._defaultMaxTextures=Z}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??hV(),this._canUploadSameBuffer}static set canUploadSameBuffer(Z){this._canUploadSameBuffer=Z}get MAX_TEXTURES(){return t("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return gV}static get defaultFragmentTemplate(){return yV}setShaderGenerator({vertex:Z=$.defaultVertexSrc,fragment:J=$.defaultFragmentTemplate}={}){this.shaderGenerator=new g9(Z,J)}contextChange(){const Z=this.renderer.gl;R.PREFER_ENV===M$.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(Z.getParameter(Z.MAX_TEXTURE_IMAGE_UNITS),$.defaultMaxTextures),this.maxTextures=A9(this.maxTextures,Z)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let J=0;J<this._packedGeometryPoolSize;J++)this._packedGeometries[J]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:Z,_textureArrayPool:J}=$,Q=this.size/4,K=Math.floor(Q/this.maxTextures)+1;for(;Z.length<Q;)Z.push(new L6);for(;J.length<K;)J.push(new P6);for(let q=0;q<this.maxTextures;q++)this._tempBoundTextures[q]=null}onPrerender(){this._flushId=0}render(Z){Z._texture.valid&&(this._vertexCount+Z.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=Z.vertexData.length/2,this._indexCount+=Z.indices.length,this._bufferedTextures[this._bufferSize]=Z._texture.baseTexture,this._bufferedElements[this._bufferSize++]=Z)}buildTexturesAndDrawCalls(){const{_bufferedTextures:Z,maxTextures:J}=this,Q=$._textureArrayPool,K=this.renderer.batch,q=this._tempBoundTextures,V=this.renderer.textureGC.count;let X=++n._globalBatch,W=0,U=Q[0],z=0;K.copyBoundTextures(q,J);for(let H=0;H<this._bufferSize;++H){const G=Z[H];Z[H]=null,G._batchEnabled!==X&&(U.count>=J&&(K.boundArray(U,q,X,J),this.buildDrawCalls(U,z,H),z=H,U=Q[++W],++X),G._batchEnabled=X,G.touched=V,U.elements[U.count++]=G)}U.count>0&&(K.boundArray(U,q,X,J),this.buildDrawCalls(U,z,this._bufferSize),++W,++X);for(let H=0;H<q.length;H++)q[H]=null;n._globalBatch=X}buildDrawCalls(Z,J,Q){const{_bufferedElements:K,_attributeBuffer:q,_indexBuffer:V,vertexSize:X}=this,W=$._drawCallPool;let U=this._dcIndex,z=this._aIndex,H=this._iIndex,G=W[U];G.start=this._iIndex,G.texArray=Z;for(let Y=J;Y<Q;++Y){const w=K[Y],j=w._texture.baseTexture,B=e7[j.alphaMode?1:0][w.blendMode];K[Y]=null,J<Y&&G.blend!==B&&(G.size=H-G.start,J=Y,G=W[++U],G.texArray=Z,G.start=H),this.packInterleavedGeometry(w,q,V,z,H),z+=w.vertexData.length/2*X,H+=w.indices.length,G.blend=B}J<Q&&(G.size=H-G.start,++U),this._dcIndex=U,this._aIndex=z,this._iIndex=H}bindAndClearTexArray(Z){const J=this.renderer.texture;for(let Q=0;Q<Z.count;Q++)J.bind(Z.elements[Q],Z.ids[Q]),Z.elements[Q]=null;Z.count=0}updateGeometry(){const{_packedGeometries:Z,_attributeBuffer:J,_indexBuffer:Q}=this;$.canUploadSameBuffer?(Z[this._flushId]._buffer.update(J.rawBinaryData),Z[this._flushId]._indexBuffer.update(Q),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,Z[this._flushId]=new this.geometryClass),Z[this._flushId]._buffer.update(J.rawBinaryData),Z[this._flushId]._indexBuffer.update(Q),this.renderer.geometry.bind(Z[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const Z=this._dcIndex,{gl:J,state:Q}=this.renderer,K=$._drawCallPool;let q=null;for(let V=0;V<Z;V++){const{texArray:X,type:W,size:U,start:z,blend:H}=K[V];q!==X&&(q=X,this.bindAndClearTexArray(X)),this.state.blendMode=H,Q.set(this.state),J.drawElements(W,U,J.UNSIGNED_SHORT,z*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),$.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let Z=0;Z<this._packedGeometryPoolSize;Z++)this._packedGeometries[Z]&&this._packedGeometries[Z].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(Z){const J=n8(Math.ceil(Z/8)),Q=Z5(J),K=J*8;this._aBuffers.length<=Q&&(this._iBuffers.length=Q+1);let q=this._aBuffers[K];return q||(this._aBuffers[K]=q=new C6(K*this.vertexSize*4)),q}getIndexBuffer(Z){const J=n8(Math.ceil(Z/12)),Q=Z5(J),K=J*12;this._iBuffers.length<=Q&&(this._iBuffers.length=Q+1);let q=this._iBuffers[Q];return q||(this._iBuffers[Q]=q=new Uint16Array(K)),q}packInterleavedGeometry(Z,J,Q,K,q){const{uint32View:V,float32View:X}=J,W=K/this.vertexSize,U=Z.uvs,z=Z.indices,H=Z.vertexData,G=Z._texture.baseTexture._batchLocation,Y=Math.min(Z.worldAlpha,1),w=e.shared.setValue(Z._tintRGB).toPremultiplied(Y,Z._texture.baseTexture.alphaMode>0);for(let j=0;j<H.length;j+=2)X[K++]=H[j],X[K++]=H[j+1],X[K++]=U[j],X[K++]=U[j+1],V[K++]=w,X[K++]=G;for(let j=0;j<z.length;j++)Q[q++]=W+z[j]}};z5.defaultBatchSize=4096,z5.extension={name:"batch",type:I.RendererPlugin},z5._drawCallPool=[],z5._textureArrayPool=[];var S8=z5;P.add(S8);var xV=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var mV=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var Z1=class $ extends a0{constructor(Z,J,Q){const K=J$.from(Z||$.defaultVertexSrc,J||$.defaultFragmentSrc);super(K,Q),this.padding=0,this.resolution=$.defaultResolution,this.multisample=$.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new p0}apply(Z,J,Q,K,q){Z.applyFilter(this,J,Q,K)}get blendMode(){return this.state.blendMode}set blendMode(Z){this.state.blendMode=Z}get resolution(){return this._resolution}set resolution(Z){this._resolution=Z}static get defaultVertexSrc(){return mV}static get defaultFragmentSrc(){return xV}};Z1.defaultResolution=1,Z1.defaultMultisample=U0.NONE;var w0=Z1;class a8{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new e(0),this.alpha=1}init($){this.clearBeforeRender=$.clearBeforeRender;const{backgroundColor:Z,background:J,backgroundAlpha:Q}=$,K=J??Z;K!==void 0&&(this.color=K),this.alpha=Q}get color(){return this._backgroundColor.value}set color($){this._backgroundColor.setValue($)}get alpha(){return this._backgroundColor.alpha}set alpha($){this._backgroundColor.setAlpha($)}get backgroundColor(){return this._backgroundColor}destroy(){}}a8.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},a8.extension={type:[I.RendererSystem,I.CanvasRendererSystem],name:"background"};P.add(a8);class H5{constructor($){this.renderer=$,this.emptyRenderer=new H8($),this.currentRenderer=this.emptyRenderer}setObjectRenderer($){this.currentRenderer!==$&&(this.currentRenderer.stop(),this.currentRenderer=$,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures($,Z){const{boundTextures:J}=this.renderer.texture;for(let Q=Z-1;Q>=0;--Q)$[Q]=J[Q]||null,$[Q]&&($[Q]._batchLocation=Q)}boundArray($,Z,J,Q){const{elements:K,ids:q,count:V}=$;let X=0;for(let W=0;W<V;W++){const U=K[W],z=U._batchLocation;if(z>=0&&z<Q&&Z[z]===U){q[W]=z;continue}for(;X<Q;){const H=Z[X];if(H&&H._batchEnabled===J&&H._batchLocation===X){X++;continue}q[W]=X,U._batchLocation=X,Z[X]=U;break}}}destroy(){this.renderer=null}}H5.extension={type:I.RendererSystem,name:"batch"};P.add(H5);var cV=0;class r8{constructor($){this.renderer=$,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange($){this.gl=$,this.renderer.gl=$,this.renderer.CONTEXT_UID=cV++}init($){if($.context)this.initFromContext($.context);else{const Z=this.renderer.background.alpha<1,J=$.premultipliedAlpha;this.preserveDrawingBuffer=$.preserveDrawingBuffer,this.useContextAlpha=$.useContextAlpha,this.powerPreference=$.powerPreference,this.initFromOptions({alpha:Z,premultipliedAlpha:J,antialias:$.antialias,stencil:!0,preserveDrawingBuffer:$.preserveDrawingBuffer,powerPreference:$.powerPreference})}}initFromContext($){this.gl=$,this.validateContext($),this.renderer.gl=$,this.renderer.CONTEXT_UID=cV++,this.renderer.runners.contextChange.emit($);const Z=this.renderer.view;Z.addEventListener!==void 0&&(Z.addEventListener("webglcontextlost",this.handleContextLost,!1),Z.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions($){const Z=this.createContext(this.renderer.view,$);this.initFromContext(Z)}createContext($,Z){let J;if(R.PREFER_ENV>=M$.WEBGL2&&(J=$.getContext("webgl2",Z)),J)this.webGLVersion=2;else if(this.webGLVersion=1,J=$.getContext("webgl",Z)||$.getContext("experimental-webgl",Z),!J)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=J,this.getExtensions(),this.gl}getExtensions(){const{gl:$}=this,Z={loseContext:$.getExtension("WEBGL_lose_context"),anisotropicFiltering:$.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:$.getExtension("OES_texture_float_linear"),s3tc:$.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:$.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:$.getExtension("WEBGL_compressed_texture_etc"),etc1:$.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:$.getExtension("WEBGL_compressed_texture_pvrtc")||$.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:$.getExtension("WEBGL_compressed_texture_atc"),astc:$.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,Z,{drawBuffers:$.getExtension("WEBGL_draw_buffers"),depthTexture:$.getExtension("WEBGL_depth_texture"),vertexArrayObject:$.getExtension("OES_vertex_array_object")||$.getExtension("MOZ_OES_vertex_array_object")||$.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:$.getExtension("OES_element_index_uint"),floatTexture:$.getExtension("OES_texture_float"),floatTextureLinear:$.getExtension("OES_texture_float_linear"),textureHalfFloat:$.getExtension("OES_texture_half_float"),textureHalfFloatLinear:$.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,Z,{colorBufferFloat:$.getExtension("EXT_color_buffer_float")})}handleContextLost($){$.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const $=this.renderer.view;this.renderer=null,$.removeEventListener!==void 0&&($.removeEventListener("webglcontextlost",this.handleContextLost),$.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext($){const Z=$.getContextAttributes(),J=("WebGL2RenderingContext"in globalThis)&&$ instanceof globalThis.WebGL2RenderingContext;J&&(this.webGLVersion=2),Z&&!Z.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const Q=J||!!$.getExtension("OES_element_index_uint");this.supports.uint32Indices=Q,Q||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}r8.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},r8.extension={type:I.RendererSystem,name:"context"};P.add(r8);class D6{constructor($,Z){if(this.width=Math.round($),this.height=Math.round(Z),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new v0("disposeFramebuffer"),this.multisample=U0.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture($=0,Z){return this.colorTextures[$]=Z||new n(null,{scaleMode:O$.NEAREST,resolution:1,mipmap:s0.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture($){return this.depthTexture=$||new n(null,{scaleMode:O$.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:s0.OFF,format:v.DEPTH_COMPONENT,type:d.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize($,Z){if($=Math.round($),Z=Math.round(Z),!$||!Z)throw new Error("Framebuffer width and height must not be zero");if(!($===this.width&&Z===this.height)){this.width=$,this.height=Z,this.dirtyId++,this.dirtySize++;for(let J=0;J<this.colorTextures.length;J++){const Q=this.colorTextures[J],K=Q.resolution;Q.setSize($/K,Z/K)}if(this.depthTexture){const J=this.depthTexture.resolution;this.depthTexture.setSize($/J,Z/J)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class V7 extends n{constructor($={}){if(typeof $=="number"){const Z=arguments[0],J=arguments[1],Q=arguments[2],K=arguments[3];$={width:Z,height:J,scaleMode:Q,resolution:K}}$.width=$.width??100,$.height=$.height??100,$.multisample??($.multisample=U0.NONE),super(null,$),this.mipmap=s0.OFF,this.valid=!0,this._clear=new e([0,0,0,0]),this.framebuffer=new D6(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=$.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor($){this._clear.setValue($)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample($){this.framebuffer.multisample=$}resize($,Z){this.framebuffer.resize($*this.resolution,Z*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Q$ extends m${constructor($){const Z=$,J=Z.naturalWidth||Z.videoWidth||Z.width,Q=Z.naturalHeight||Z.videoHeight||Z.height;super(J,Q),this.source=$,this.noSubImage=!1}static crossOrigin($,Z,J){J===void 0&&!Z.startsWith("data:")?$.crossOrigin=D9(Z):J!==!1&&($.crossOrigin=typeof J=="string"?J:"anonymous")}upload($,Z,J,Q){const K=$.gl,q=Z.realWidth,V=Z.realHeight;if(Q=Q||this.source,typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement){if(!Q.complete||Q.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&Q instanceof HTMLVideoElement&&Q.readyState<=1)return!1;return K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z.alphaMode===_0.UNPACK),!this.noSubImage&&Z.target===K.TEXTURE_2D&&J.width===q&&J.height===V?K.texSubImage2D(K.TEXTURE_2D,0,0,0,Z.format,J.type,Q):(J.width=q,J.height=V,K.texImage2D(Z.target,0,J.internalFormat,Z.format,J.type,Q)),!0}update(){if(this.destroyed)return;const $=this.source,Z=$.naturalWidth||$.videoWidth||$.width,J=$.naturalHeight||$.videoHeight||$.height;this.resize(Z,J),super.update()}dispose(){this.source=null}}class X7 extends Q${constructor($,Z){if(Z=Z||{},typeof $=="string"){const J=new Image;Q$.crossOrigin(J,$,Z.crossorigin),J.src=$,$=J}super($),!$.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=$.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(Z.createBitmap??R.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof Z.alphaMode=="number"?Z.alphaMode:null,this.bitmap=null,this._load=null,Z.autoLoad!==!1&&this.load()}load($){return this._load?this._load:($!==void 0&&(this.createBitmap=$),this._load=new Promise((Z,J)=>{const Q=this.source;this.url=Q.src;const K=()=>{this.destroyed||(Q.onload=null,Q.onerror=null,this.update(),this._load=null,this.createBitmap?Z(this.process()):Z(this))};Q.complete&&Q.src?K():(Q.onload=K,Q.onerror=(q)=>{J(q),this.onError.emit(q)})}),this._load)}process(){const $=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const Z=globalThis.createImageBitmap,J=!$.crossOrigin||$.crossOrigin==="anonymous";return this._process=fetch($.src,{mode:J?"cors":"no-cors"}).then((Q)=>Q.blob()).then((Q)=>Z(Q,0,0,$.width,$.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===_0.UNPACK?"premultiply":"none"})).then((Q)=>this.destroyed?Promise.reject():(this.bitmap=Q,this.update(),this._process=null,Promise.resolve(this))),this._process}upload($,Z,J){if(typeof this.alphaMode=="number"&&(Z.alphaMode=this.alphaMode),!this.createBitmap)return super.upload($,Z,J);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload($,Z,J,this.bitmap),!this.preserveBitmap){let Q=!0;const K=Z._glTextures;for(let q in K){const V=K[q];if(V!==J&&V.dirtyId!==Z.dirtyId){Q=!1;break}}Q&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test($){return typeof HTMLImageElement<"u"&&(typeof $=="string"||$ instanceof HTMLImageElement)}}class W7{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set($,Z,J){const{width:Q,height:K}=Z;if(J){const q=$.width/2/Q,V=$.height/2/K,X=$.x/Q+q,W=$.y/K+V;J=F0.add(J,F0.NW),this.x0=X+q*F0.uX(J),this.y0=W+V*F0.uY(J),J=F0.add(J,2),this.x1=X+q*F0.uX(J),this.y1=W+V*F0.uY(J),J=F0.add(J,2),this.x2=X+q*F0.uX(J),this.y2=W+V*F0.uY(J),J=F0.add(J,2),this.x3=X+q*F0.uX(J),this.y3=W+V*F0.uY(J)}else this.x0=$.x/Q,this.y0=$.y/K,this.x1=($.x+$.width)/Q,this.y1=$.y/K,this.x2=($.x+$.width)/Q,this.y2=($.y+$.height)/K,this.x3=$.x/Q,this.y3=($.y+$.height)/K;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}W7.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};var x9=function($){$.destroy=function(){},$.on=function(){},$.once=function(){},$.emit=function(){}},pV=new W7;class f extends o8.default{constructor($,Z,J,Q,K,q,V){if(super(),this.noFrame=!1,Z||(this.noFrame=!0,Z=new m(0,0,1,1)),$ instanceof f&&($=$.baseTexture),this.baseTexture=$,this._frame=Z,this.trim=Q,this.valid=!1,this.destroyed=!1,this._uvs=pV,this.uvMatrix=null,this.orig=J||Z,this._rotate=Number(K||0),K===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=q?new u(q.x,q.y):new u(0,0),this.defaultBorders=V,this._updateID=0,this.textureCacheIds=[],$.valid?this.noFrame?$.valid&&this.onBaseTextureUpdated($):this.frame=Z:$.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&$.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated($){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=$.width,this._frame.height=$.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy($){if(this.baseTexture){if($){const{resource:Z}=this.baseTexture;Z?.url&&c0[Z.url]&&f.removeFromCache(Z.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,f.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){const $=this._frame.clone(),Z=this._frame===this.orig?$:this.orig.clone(),J=new f(this.baseTexture,!this.noFrame&&$,Z,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(J._frame=$),J}updateUvs(){this._uvs===pV&&(this._uvs=new W7),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from($,Z={},J=R.STRICT_TEXTURE_CACHE){const Q=typeof $=="string";let K=null;if(Q)K=$;else if($ instanceof n){if(!$.cacheId){const V=Z?.pixiIdPrefix||"pixiid";$.cacheId=`${V}-${X8()}`,n.addToCache($,$.cacheId)}K=$.cacheId}else{if(!$._pixiId){const V=Z?.pixiIdPrefix||"pixiid";$._pixiId=`${V}_${X8()}`}K=$._pixiId}let q=c0[K];if(Q&&J&&!q)throw new Error(`The cacheId "${K}" does not exist in TextureCache.`);return!q&&!($ instanceof n)?(Z.resolution||(Z.resolution=K5($)),q=new f(new n($,Z)),q.baseTexture.cacheId=K,n.addToCache(q.baseTexture,K),f.addToCache(q,K)):!q&&$ instanceof n&&(q=new f($),f.addToCache(q,K)),q}static fromURL($,Z){const J=Object.assign({autoLoad:!1},Z?.resourceOptions),Q=f.from($,Object.assign({resourceOptions:J},Z),!1),K=Q.baseTexture.resource;return Q.baseTexture.valid?Promise.resolve(Q):K.load().then(()=>Promise.resolve(Q))}static fromBuffer($,Z,J,Q){return new f(n.fromBuffer($,Z,J,Q))}static fromLoader($,Z,J,Q){const K=new n($,Object.assign({scaleMode:n.defaultOptions.scaleMode,resolution:K5(Z)},Q)),{resource:q}=K;q instanceof X7&&(q.url=Z);const V=new f(K);return J||(J=Z),n.addToCache(V.baseTexture,J),f.addToCache(V,J),J!==Z&&(n.addToCache(V.baseTexture,Z),f.addToCache(V,Z)),V.baseTexture.valid?Promise.resolve(V):new Promise((X)=>{V.baseTexture.once("loaded",()=>X(V))})}static addToCache($,Z){Z&&($.textureCacheIds.includes(Z)||$.textureCacheIds.push(Z),c0[Z]&&c0[Z]!==$&&console.warn(`Texture added to the cache with an id [${Z}] that already had an entry`),c0[Z]=$)}static removeFromCache($){if(typeof $=="string"){const Z=c0[$];if(Z){const J=Z.textureCacheIds.indexOf($);return J>-1&&Z.textureCacheIds.splice(J,1),delete c0[$],Z}}else if($?.textureCacheIds){for(let Z=0;Z<$.textureCacheIds.length;++Z)c0[$.textureCacheIds[Z]]===$&&delete c0[$.textureCacheIds[Z]];return $.textureCacheIds.length=0,$}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame($){this._frame=$,this.noFrame=!1;const{x:Z,y:J,width:Q,height:K}=$,q=Z+Q>this.baseTexture.width,V=J+K>this.baseTexture.height;if(q||V){const X=q&&V?"and":"or",W=`X: ${Z} + ${Q} = ${Z+Q} > ${this.baseTexture.width}`,U=`Y: ${J} + ${K} = ${J+K} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${W} ${X} ${U}`)}this.valid=Q&&K&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=$),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate($){this._rotate=$,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return f._EMPTY||(f._EMPTY=new f(new n),x9(f._EMPTY),x9(f._EMPTY.baseTexture)),f._EMPTY}static get WHITE(){if(!f._WHITE){const $=R.ADAPTER.createCanvas(16,16),Z=$.getContext("2d");$.width=16,$.height=16,Z.fillStyle="white",Z.fillRect(0,0,16,16),f._WHITE=new f(n.from($)),x9(f._WHITE),x9(f._WHITE.baseTexture)}return f._WHITE}}class c$ extends f{constructor($,Z){super($,Z),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample($){this.framebuffer.multisample=$}resize($,Z,J=!0){const Q=this.baseTexture.resolution,K=Math.round($*Q)/Q,q=Math.round(Z*Q)/Q;this.valid=K>0&&q>0,this._frame.width=this.orig.width=K,this._frame.height=this.orig.height=q,J&&this.baseTexture.resize(K,q),this.updateUvs()}setResolution($){const{baseTexture:Z}=this;Z.resolution!==$&&(Z.setResolution($),this.resize(Z.width,Z.height,!1))}static create($){return new c$(new V7($))}}class G5{constructor($){this.texturePool={},this.textureOptions=$||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture($,Z,J=U0.NONE){const Q=new V7(Object.assign({width:$,height:Z,resolution:1,multisample:J},this.textureOptions));return new c$(Q)}getOptimalTexture($,Z,J=1,Q=U0.NONE){let K;$=Math.max(Math.ceil($*J-0.000001),1),Z=Math.max(Math.ceil(Z*J-0.000001),1),!this.enableFullScreen||$!==this._pixelsWidth||Z!==this._pixelsHeight?($=n8($),Z=n8(Z),K=(($&65535)<<16|Z&65535)>>>0,Q>1&&(K+=Q*4294967296)):K=Q>1?-Q:-1,this.texturePool[K]||(this.texturePool[K]=[]);let q=this.texturePool[K].pop();return q||(q=this.createTexture($,Z,Q)),q.filterPoolKey=K,q.setResolution(J),q}getFilterTexture($,Z,J){const Q=this.getOptimalTexture($.width,$.height,Z||$.resolution,J||U0.NONE);return Q.filterFrame=$.filterFrame,Q}returnTexture($){const Z=$.filterPoolKey;$.filterFrame=null,this.texturePool[Z].push($)}returnFilterTexture($){this.returnTexture($)}clear($){if($=$!==!1,$)for(let Z in this.texturePool){const J=this.texturePool[Z];if(J)for(let Q=0;Q<J.length;Q++)J[Q].destroy(!0)}this.texturePool={}}setScreenSize($){if(!($.width===this._pixelsWidth&&$.height===this._pixelsHeight)){this.enableFullScreen=$.width>0&&$.height>0;for(let Z in this.texturePool){if(!(Number(Z)<0))continue;const J=this.texturePool[Z];if(J)for(let Q=0;Q<J.length;Q++)J[Q].destroy(!0);this.texturePool[Z]=[]}this._pixelsWidth=$.width,this._pixelsHeight=$.height}}}G5.SCREEN_KEY=-1;class m9 extends R${constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class U7 extends R${constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new H0(this.vertices),this.uvBuffer=new H0(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map($,Z){let J=0,Q=0;return this.uvs[0]=J,this.uvs[1]=Q,this.uvs[2]=J+Z.width/$.width,this.uvs[3]=Q,this.uvs[4]=J+Z.width/$.width,this.uvs[5]=Q+Z.height/$.height,this.uvs[6]=J,this.uvs[7]=Q+Z.height/$.height,J=Z.x,Q=Z.y,this.vertices[0]=J,this.vertices[1]=Q,this.vertices[2]=J+Z.width,this.vertices[3]=Q,this.vertices[4]=J+Z.width,this.vertices[5]=Q+Z.height,this.vertices[6]=J,this.vertices[7]=Q+Z.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class c9{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=U0.NONE,this.sourceFrame=new m,this.destinationFrame=new m,this.bindingSourceFrame=new m,this.bindingDestinationFrame=new m,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}var p9=[new u,new u,new u,new u],J1=new Z0;class Y5{constructor($){this.renderer=$,this.defaultFilterStack=[{}],this.texturePool=new G5,this.statePool=[],this.quad=new m9,this.quadUv=new U7,this.tempRect=new m,this.activeState={},this.globalUniforms=new i0({outputFrame:new m,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push($,Z){const J=this.renderer,Q=this.defaultFilterStack,K=this.statePool.pop()||new c9,q=J.renderTexture;let V,X;if(q.current){const j=q.current;V=j.resolution,X=j.multisample}else V=J.resolution,X=J.multisample;let W=Z[0].resolution||V,U=Z[0].multisample??X,z=Z[0].padding,H=Z[0].autoFit,G=Z[0].legacy??!0;for(let j=1;j<Z.length;j++){const B=Z[j];W=Math.min(W,B.resolution||V),U=Math.min(U,B.multisample??X),z=this.useMaxPadding?Math.max(z,B.padding):z+B.padding,H=H&&B.autoFit,G=G||(B.legacy??!0)}Q.length===1&&(this.defaultFilterStack[0].renderTexture=q.current),Q.push(K),K.resolution=W,K.multisample=U,K.legacy=G,K.target=$,K.sourceFrame.copyFrom($.filterArea||$.getBounds(!0)),K.sourceFrame.pad(z);const Y=this.tempRect.copyFrom(q.sourceFrame);J.projection.transform&&this.transformAABB(J1.copyFrom(J.projection.transform).invert(),Y),H?(K.sourceFrame.fit(Y),(K.sourceFrame.width<=0||K.sourceFrame.height<=0)&&(K.sourceFrame.width=0,K.sourceFrame.height=0)):K.sourceFrame.intersects(Y)||(K.sourceFrame.width=0,K.sourceFrame.height=0),this.roundFrame(K.sourceFrame,q.current?q.current.resolution:J.resolution,q.sourceFrame,q.destinationFrame,J.projection.transform),K.renderTexture=this.getOptimalFilterTexture(K.sourceFrame.width,K.sourceFrame.height,W,U),K.filters=Z,K.destinationFrame.width=K.renderTexture.width,K.destinationFrame.height=K.renderTexture.height;const w=this.tempRect;w.x=0,w.y=0,w.width=K.sourceFrame.width,w.height=K.sourceFrame.height,K.renderTexture.filterFrame=K.sourceFrame,K.bindingSourceFrame.copyFrom(q.sourceFrame),K.bindingDestinationFrame.copyFrom(q.destinationFrame),K.transform=J.projection.transform,J.projection.transform=null,q.bind(K.renderTexture,K.sourceFrame,w),J.framebuffer.clear(0,0,0,0)}pop(){const $=this.defaultFilterStack,Z=$.pop(),J=Z.filters;this.activeState=Z;const Q=this.globalUniforms.uniforms;Q.outputFrame=Z.sourceFrame,Q.resolution=Z.resolution;const{inputSize:K,inputPixel:q,inputClamp:V}=Q;if(K[0]=Z.destinationFrame.width,K[1]=Z.destinationFrame.height,K[2]=1/K[0],K[3]=1/K[1],q[0]=Math.round(K[0]*Z.resolution),q[1]=Math.round(K[1]*Z.resolution),q[2]=1/q[0],q[3]=1/q[1],V[0]=0.5*q[2],V[1]=0.5*q[3],V[2]=Z.sourceFrame.width*K[2]-0.5*q[2],V[3]=Z.sourceFrame.height*K[3]-0.5*q[3],Z.legacy){const W=Q.filterArea;W[0]=Z.destinationFrame.width,W[1]=Z.destinationFrame.height,W[2]=Z.sourceFrame.x,W[3]=Z.sourceFrame.y,Q.filterClamp=Q.inputClamp}this.globalUniforms.update();const X=$[$.length-1];if(this.renderer.framebuffer.blit(),J.length===1)J[0].apply(this,Z.renderTexture,X.renderTexture,k$.BLEND,Z),this.returnFilterTexture(Z.renderTexture);else{let W=Z.renderTexture,U=this.getOptimalFilterTexture(W.width,W.height,Z.resolution);U.filterFrame=W.filterFrame;let z=0;for(z=0;z<J.length-1;++z){z===1&&Z.multisample>1&&(U=this.getOptimalFilterTexture(W.width,W.height,Z.resolution),U.filterFrame=W.filterFrame),J[z].apply(this,W,U,k$.CLEAR,Z);const H=W;W=U,U=H}J[z].apply(this,W,X.renderTexture,k$.BLEND,Z),z>1&&Z.multisample>1&&this.returnFilterTexture(Z.renderTexture),this.returnFilterTexture(W),this.returnFilterTexture(U)}Z.clear(),this.statePool.push(Z)}bindAndClear($,Z=k$.CLEAR){const{renderTexture:J,state:Q}=this.renderer;if($===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,$?.filterFrame){const q=this.tempRect;q.x=0,q.y=0,q.width=$.filterFrame.width,q.height=$.filterFrame.height,J.bind($,$.filterFrame,q)}else $!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?J.bind($):this.renderer.renderTexture.bind($,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const K=Q.stateId&1||this.forceClear;(Z===k$.CLEAR||Z===k$.BLIT&&K)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter($,Z,J,Q){const K=this.renderer;K.state.set($.state),this.bindAndClear(J,Q),$.uniforms.uSampler=Z,$.uniforms.filterGlobals=this.globalUniforms,K.shader.bind($),$.legacy=!!$.program.attributeData.aTextureCoord,$.legacy?(this.quadUv.map(Z._frame,Z.filterFrame),K.geometry.bind(this.quadUv),K.geometry.draw(_$.TRIANGLES)):(K.geometry.bind(this.quad),K.geometry.draw(_$.TRIANGLE_STRIP))}calculateSpriteMatrix($,Z){const{sourceFrame:J,destinationFrame:Q}=this.activeState,{orig:K}=Z._texture,q=$.set(Q.width,0,0,Q.height,J.x,J.y),V=Z.worldTransform.copyTo(Z0.TEMP_MATRIX);return V.invert(),q.prepend(V),q.scale(1/K.width,1/K.height),q.translate(Z.anchor.x,Z.anchor.y),q}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture($,Z,J=1,Q=U0.NONE){return this.texturePool.getOptimalTexture($,Z,J,Q)}getFilterTexture($,Z,J){if(typeof $=="number"){const K=$;$=Z,Z=K}$=$||this.activeState.renderTexture;const Q=this.texturePool.getOptimalTexture($.width,$.height,Z||$.resolution,J||U0.NONE);return Q.filterFrame=$.filterFrame,Q}returnFilterTexture($){this.texturePool.returnTexture($)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB($,Z){const J=p9[0],Q=p9[1],K=p9[2],q=p9[3];J.set(Z.left,Z.top),Q.set(Z.left,Z.bottom),K.set(Z.right,Z.top),q.set(Z.right,Z.bottom),$.apply(J,J),$.apply(Q,Q),$.apply(K,K),$.apply(q,q);const V=Math.min(J.x,Q.x,K.x,q.x),X=Math.min(J.y,Q.y,K.y,q.y),W=Math.max(J.x,Q.x,K.x,q.x),U=Math.max(J.y,Q.y,K.y,q.y);Z.x=V,Z.y=X,Z.width=W-V,Z.height=U-X}roundFrame($,Z,J,Q,K){if(!($.width<=0||$.height<=0||J.width<=0||J.height<=0)){if(K){const{a:q,b:V,c:X,d:W}=K;if((Math.abs(V)>0.0001||Math.abs(X)>0.0001)&&(Math.abs(q)>0.0001||Math.abs(W)>0.0001))return}K=K?J1.copyFrom(K):J1.identity(),K.translate(-J.x,-J.y).scale(Q.width/J.width,Q.height/J.height).translate(Q.x,Q.y),this.transformAABB(K,$),$.ceil(Z),this.transformAABB(K.invert(),$)}}}Y5.extension={type:I.RendererSystem,name:"filter"};P.add(Y5);class u9{constructor($){this.framebuffer=$,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=U0.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}var Hw=new m;class w5{constructor($){this.renderer=$,this.managedFramebuffers=[],this.unknownFramebuffer=new D6(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const $=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new m,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let Z=this.renderer.context.extensions.drawBuffers,J=this.renderer.context.extensions.depthTexture;R.PREFER_ENV===M$.WEBGL_LEGACY&&(Z=null,J=null),Z?$.drawBuffers=(Q)=>Z.drawBuffersWEBGL(Q):(this.hasMRT=!1,$.drawBuffers=()=>{}),J||(this.writeDepthTexture=!1)}else this.msaaSamples=$.getInternalformatParameter($.RENDERBUFFER,$.RGBA8,$.SAMPLES)}bind($,Z,J=0){const{gl:Q}=this;if($){const K=$.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer($);this.current!==$&&(this.current=$,Q.bindFramebuffer(Q.FRAMEBUFFER,K.framebuffer)),K.mipLevel!==J&&($.dirtyId++,$.dirtyFormat++,K.mipLevel=J),K.dirtyId!==$.dirtyId&&(K.dirtyId=$.dirtyId,K.dirtyFormat!==$.dirtyFormat?(K.dirtyFormat=$.dirtyFormat,K.dirtySize=$.dirtySize,this.updateFramebuffer($,J)):K.dirtySize!==$.dirtySize&&(K.dirtySize=$.dirtySize,this.resizeFramebuffer($)));for(let q=0;q<$.colorTextures.length;q++){const V=$.colorTextures[q];this.renderer.texture.unbind(V.parentTextureArray||V)}if($.depthTexture&&this.renderer.texture.unbind($.depthTexture),Z){const q=Z.width>>J,V=Z.height>>J,X=q/Z.width;this.setViewport(Z.x*X,Z.y*X,q,V)}else{const q=$.width>>J,V=$.height>>J;this.setViewport(0,0,q,V)}}else this.current&&(this.current=null,Q.bindFramebuffer(Q.FRAMEBUFFER,null)),Z?this.setViewport(Z.x,Z.y,Z.width,Z.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport($,Z,J,Q){const K=this.viewport;$=Math.round($),Z=Math.round(Z),J=Math.round(J),Q=Math.round(Q),(K.width!==J||K.height!==Q||K.x!==$||K.y!==Z)&&(K.x=$,K.y=Z,K.width=J,K.height=Q,this.gl.viewport($,Z,J,Q))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear($,Z,J,Q,K=G9.COLOR|G9.DEPTH){const{gl:q}=this;q.clearColor($,Z,J,Q),q.clear(K)}initFramebuffer($){const{gl:Z}=this,J=new u9(Z.createFramebuffer());return J.multisample=this.detectSamples($.multisample),$.glFramebuffers[this.CONTEXT_UID]=J,this.managedFramebuffers.push($),$.disposeRunner.add(this),J}resizeFramebuffer($){const{gl:Z}=this,J=$.glFramebuffers[this.CONTEXT_UID];if(J.stencil){Z.bindRenderbuffer(Z.RENDERBUFFER,J.stencil);let q;this.renderer.context.webGLVersion===1?q=Z.DEPTH_STENCIL:$.depth&&$.stencil?q=Z.DEPTH24_STENCIL8:$.depth?q=Z.DEPTH_COMPONENT24:q=Z.STENCIL_INDEX8,J.msaaBuffer?Z.renderbufferStorageMultisample(Z.RENDERBUFFER,J.multisample,q,$.width,$.height):Z.renderbufferStorage(Z.RENDERBUFFER,q,$.width,$.height)}const Q=$.colorTextures;let K=Q.length;Z.drawBuffers||(K=Math.min(K,1));for(let q=0;q<K;q++){const V=Q[q],X=V.parentTextureArray||V;this.renderer.texture.bind(X,0),q===0&&J.msaaBuffer&&(Z.bindRenderbuffer(Z.RENDERBUFFER,J.msaaBuffer),Z.renderbufferStorageMultisample(Z.RENDERBUFFER,J.multisample,X._glTextures[this.CONTEXT_UID].internalFormat,$.width,$.height))}$.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind($.depthTexture,0)}updateFramebuffer($,Z){const{gl:J}=this,Q=$.glFramebuffers[this.CONTEXT_UID],K=$.colorTextures;let q=K.length;J.drawBuffers||(q=Math.min(q,1)),Q.multisample>1&&this.canMultisampleFramebuffer($)?Q.msaaBuffer=Q.msaaBuffer||J.createRenderbuffer():Q.msaaBuffer&&(J.deleteRenderbuffer(Q.msaaBuffer),Q.msaaBuffer=null,Q.blitFramebuffer&&(Q.blitFramebuffer.dispose(),Q.blitFramebuffer=null));const V=[];for(let X=0;X<q;X++){const W=K[X],U=W.parentTextureArray||W;this.renderer.texture.bind(U,0),X===0&&Q.msaaBuffer?(J.bindRenderbuffer(J.RENDERBUFFER,Q.msaaBuffer),J.renderbufferStorageMultisample(J.RENDERBUFFER,Q.multisample,U._glTextures[this.CONTEXT_UID].internalFormat,$.width,$.height),J.framebufferRenderbuffer(J.FRAMEBUFFER,J.COLOR_ATTACHMENT0,J.RENDERBUFFER,Q.msaaBuffer)):(J.framebufferTexture2D(J.FRAMEBUFFER,J.COLOR_ATTACHMENT0+X,W.target,U._glTextures[this.CONTEXT_UID].texture,Z),V.push(J.COLOR_ATTACHMENT0+X))}if(V.length>1&&J.drawBuffers(V),$.depthTexture&&this.writeDepthTexture){const X=$.depthTexture;this.renderer.texture.bind(X,0),J.framebufferTexture2D(J.FRAMEBUFFER,J.DEPTH_ATTACHMENT,J.TEXTURE_2D,X._glTextures[this.CONTEXT_UID].texture,Z)}if(($.stencil||$.depth)&&!($.depthTexture&&this.writeDepthTexture)){Q.stencil=Q.stencil||J.createRenderbuffer();let X,W;this.renderer.context.webGLVersion===1?(X=J.DEPTH_STENCIL_ATTACHMENT,W=J.DEPTH_STENCIL):$.depth&&$.stencil?(X=J.DEPTH_STENCIL_ATTACHMENT,W=J.DEPTH24_STENCIL8):$.depth?(X=J.DEPTH_ATTACHMENT,W=J.DEPTH_COMPONENT24):(X=J.STENCIL_ATTACHMENT,W=J.STENCIL_INDEX8),J.bindRenderbuffer(J.RENDERBUFFER,Q.stencil),Q.msaaBuffer?J.renderbufferStorageMultisample(J.RENDERBUFFER,Q.multisample,W,$.width,$.height):J.renderbufferStorage(J.RENDERBUFFER,W,$.width,$.height),J.framebufferRenderbuffer(J.FRAMEBUFFER,X,J.RENDERBUFFER,Q.stencil)}else Q.stencil&&(J.deleteRenderbuffer(Q.stencil),Q.stencil=null)}canMultisampleFramebuffer($){return this.renderer.context.webGLVersion!==1&&$.colorTextures.length<=1&&!$.depthTexture}detectSamples($){const{msaaSamples:Z}=this;let J=U0.NONE;if($<=1||Z===null)return J;for(let Q=0;Q<Z.length;Q++)if(Z[Q]<=$){J=Z[Q];break}return J===1&&(J=U0.NONE),J}blit($,Z,J){const{current:Q,renderer:K,gl:q,CONTEXT_UID:V}=this;if(K.context.webGLVersion!==2||!Q)return;const X=Q.glFramebuffers[V];if(!X)return;if(!$){if(!X.msaaBuffer)return;const U=Q.colorTextures[0];if(!U)return;X.blitFramebuffer||(X.blitFramebuffer=new D6(Q.width,Q.height),X.blitFramebuffer.addColorTexture(0,U)),$=X.blitFramebuffer,$.colorTextures[0]!==U&&($.colorTextures[0]=U,$.dirtyId++,$.dirtyFormat++),($.width!==Q.width||$.height!==Q.height)&&($.width=Q.width,$.height=Q.height,$.dirtyId++,$.dirtySize++)}Z||(Z=Hw,Z.width=Q.width,Z.height=Q.height),J||(J=Z);const W=Z.width===J.width&&Z.height===J.height;this.bind($),q.bindFramebuffer(q.READ_FRAMEBUFFER,X.framebuffer),q.blitFramebuffer(Z.left,Z.top,Z.right,Z.bottom,J.left,J.top,J.right,J.bottom,q.COLOR_BUFFER_BIT,W?q.NEAREST:q.LINEAR),q.bindFramebuffer(q.READ_FRAMEBUFFER,$.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer($,Z){const J=$.glFramebuffers[this.CONTEXT_UID],Q=this.gl;if(!J)return;delete $.glFramebuffers[this.CONTEXT_UID];const K=this.managedFramebuffers.indexOf($);K>=0&&this.managedFramebuffers.splice(K,1),$.disposeRunner.remove(this),Z||(Q.deleteFramebuffer(J.framebuffer),J.msaaBuffer&&Q.deleteRenderbuffer(J.msaaBuffer),J.stencil&&Q.deleteRenderbuffer(J.stencil)),J.blitFramebuffer&&this.disposeFramebuffer(J.blitFramebuffer,Z)}disposeAll($){const Z=this.managedFramebuffers;this.managedFramebuffers=[];for(let J=0;J<Z.length;J++)this.disposeFramebuffer(Z[J],$)}forceStencil(){const $=this.current;if(!$)return;const Z=$.glFramebuffers[this.CONTEXT_UID];if(!Z||Z.stencil&&$.stencil)return;$.stencil=!0;const{width:J,height:Q}=$,K=this.gl,q=Z.stencil=K.createRenderbuffer();K.bindRenderbuffer(K.RENDERBUFFER,q);let V,X;this.renderer.context.webGLVersion===1?(V=K.DEPTH_STENCIL_ATTACHMENT,X=K.DEPTH_STENCIL):$.depth?(V=K.DEPTH_STENCIL_ATTACHMENT,X=K.DEPTH24_STENCIL8):(V=K.STENCIL_ATTACHMENT,X=K.STENCIL_INDEX8),Z.msaaBuffer?K.renderbufferStorageMultisample(K.RENDERBUFFER,Z.multisample,X,J,Q):K.renderbufferStorage(K.RENDERBUFFER,X,J,Q),K.framebufferRenderbuffer(K.FRAMEBUFFER,V,K.RENDERBUFFER,q)}reset(){this.current=this.unknownFramebuffer,this.viewport=new m}destroy(){this.renderer=null}}w5.extension={type:I.RendererSystem,name:"framebuffer"};P.add(w5);var Q1={5126:4,5123:2,5121:1};class j5{constructor($){this.renderer=$,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const $=this.gl=this.renderer.gl,Z=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,Z.webGLVersion!==2){let J=this.renderer.context.extensions.vertexArrayObject;R.PREFER_ENV===M$.WEBGL_LEGACY&&(J=null),J?($.createVertexArray=()=>J.createVertexArrayOES(),$.bindVertexArray=(Q)=>J.bindVertexArrayOES(Q),$.deleteVertexArray=(Q)=>J.deleteVertexArrayOES(Q)):(this.hasVao=!1,$.createVertexArray=()=>null,$.bindVertexArray=()=>null,$.deleteVertexArray=()=>null)}if(Z.webGLVersion!==2){const J=$.getExtension("ANGLE_instanced_arrays");J?($.vertexAttribDivisor=(Q,K)=>J.vertexAttribDivisorANGLE(Q,K),$.drawElementsInstanced=(Q,K,q,V,X)=>J.drawElementsInstancedANGLE(Q,K,q,V,X),$.drawArraysInstanced=(Q,K,q,V)=>J.drawArraysInstancedANGLE(Q,K,q,V)):this.hasInstance=!1}this.canUseUInt32ElementIndex=Z.webGLVersion===2||!!Z.extensions.uint32ElementIndex}bind($,Z){Z=Z||this.renderer.shader.shader;const{gl:J}=this;let Q=$.glVertexArrayObjects[this.CONTEXT_UID],K=!1;Q||(this.managedGeometries[$.id]=$,$.disposeRunner.add(this),$.glVertexArrayObjects[this.CONTEXT_UID]=Q={},K=!0);const q=Q[Z.program.id]||this.initGeometryVao($,Z,K);this._activeGeometry=$,this._activeVao!==q&&(this._activeVao=q,this.hasVao?J.bindVertexArray(q):this.activateVao($,Z.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const $=this._activeGeometry,Z=this.renderer.buffer;for(let J=0;J<$.buffers.length;J++){const Q=$.buffers[J];Z.update(Q)}}checkCompatibility($,Z){const J=$.attributes,Q=Z.attributeData;for(let K in Q)if(!J[K])throw new Error(`shader and geometry incompatible, geometry missing the "${K}" attribute`)}getSignature($,Z){const J=$.attributes,Q=Z.attributeData,K=["g",$.id];for(let q in J)Q[q]&&K.push(q,Q[q].location);return K.join("-")}initGeometryVao($,Z,J=!0){const Q=this.gl,K=this.CONTEXT_UID,q=this.renderer.buffer,V=Z.program;V.glPrograms[K]||this.renderer.shader.generateProgram(Z),this.checkCompatibility($,V);const X=this.getSignature($,V),W=$.glVertexArrayObjects[this.CONTEXT_UID];let U=W[X];if(U)return W[V.id]=U,U;const{buffers:z,attributes:H}=$,G={},Y={};for(let w in z)G[w]=0,Y[w]=0;for(let w in H)!H[w].size&&V.attributeData[w]?H[w].size=V.attributeData[w].size:H[w].size||console.warn(`PIXI Geometry attribute '${w}' size cannot be determined (likely the bound shader does not have the attribute)`),G[H[w].buffer]+=H[w].size*Q1[H[w].type];for(let w in H){const j=H[w],B=j.size;j.stride===void 0&&(G[j.buffer]===B*Q1[j.type]?j.stride=0:j.stride=G[j.buffer]),j.start===void 0&&(j.start=Y[j.buffer],Y[j.buffer]+=B*Q1[j.type])}U=Q.createVertexArray(),Q.bindVertexArray(U);for(let w=0;w<z.length;w++){const j=z[w];q.bind(j),J&&j._glBuffers[K].refCount++}return this.activateVao($,V),W[V.id]=U,W[X]=U,Q.bindVertexArray(null),q.unbind(I$.ARRAY_BUFFER),U}disposeGeometry($,Z){if(!this.managedGeometries[$.id])return;delete this.managedGeometries[$.id];const J=$.glVertexArrayObjects[this.CONTEXT_UID],Q=this.gl,K=$.buffers,q=this.renderer?.buffer;if($.disposeRunner.remove(this),!!J){if(q)for(let V=0;V<K.length;V++){const X=K[V]._glBuffers[this.CONTEXT_UID];X&&(X.refCount--,X.refCount===0&&!Z&&q.dispose(K[V],Z))}if(!Z){for(let V in J)if(V[0]==="g"){const X=J[V];this._activeVao===X&&this.unbind(),Q.deleteVertexArray(X)}}delete $.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll($){const Z=Object.keys(this.managedGeometries);for(let J=0;J<Z.length;J++)this.disposeGeometry(this.managedGeometries[Z[J]],$)}activateVao($,Z){const J=this.gl,Q=this.CONTEXT_UID,K=this.renderer.buffer,q=$.buffers,V=$.attributes;$.indexBuffer&&K.bind($.indexBuffer);let X=null;for(let W in V){const U=V[W],z=q[U.buffer],H=z._glBuffers[Q];if(Z.attributeData[W]){X!==H&&(K.bind(z),X=H);const G=Z.attributeData[W].location;if(J.enableVertexAttribArray(G),J.vertexAttribPointer(G,U.size,U.type||J.FLOAT,U.normalized,U.stride,U.start),U.instance)if(this.hasInstance)J.vertexAttribDivisor(G,U.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw($,Z,J,Q){const{gl:K}=this,q=this._activeGeometry;if(q.indexBuffer){const V=q.indexBuffer.data.BYTES_PER_ELEMENT,X=V===2?K.UNSIGNED_SHORT:K.UNSIGNED_INT;V===2||V===4&&this.canUseUInt32ElementIndex?q.instanced?K.drawElementsInstanced($,Z||q.indexBuffer.data.length,X,(J||0)*V,Q||1):K.drawElements($,Z||q.indexBuffer.data.length,X,(J||0)*V):console.warn("unsupported index buffer type: uint32")}else q.instanced?K.drawArraysInstanced($,J,Z||q.getSize(),Q||1):K.drawArrays($,J,Z||q.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}j5.extension={type:I.RendererSystem,name:"geometry"};P.add(j5);var uV=new Z0;class t8{constructor($,Z){this._texture=$,this.mapCoord=new Z0,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof Z>"u"?0.5:Z,this.isSimple=!1}get texture(){return this._texture}set texture($){this._texture=$,this._textureID=-1}multiplyUvs($,Z){Z===void 0&&(Z=$);const J=this.mapCoord;for(let Q=0;Q<$.length;Q+=2){const K=$[Q],q=$[Q+1];Z[Q]=K*J.a+q*J.c+J.tx,Z[Q+1]=K*J.b+q*J.d+J.ty}return Z}update($){const Z=this._texture;if(!Z||!Z.valid||!$&&this._textureID===Z._updateID)return!1;this._textureID=Z._updateID,this._updateID++;const J=Z._uvs;this.mapCoord.set(J.x1-J.x0,J.y1-J.y0,J.x3-J.x0,J.y3-J.y0,J.x0,J.y0);const{orig:Q,trim:K}=Z;K&&(uV.set(Q.width/K.width,0,0,Q.height/K.height,-K.x/K.width,-K.y/K.height),this.mapCoord.append(uV));const q=Z.baseTexture,V=this.uClampFrame,X=this.clampMargin/q.resolution,W=this.clampOffset;return V[0]=(Z._frame.x+X+W)/q.width,V[1]=(Z._frame.y+X+W)/q.height,V[2]=(Z._frame.x+Z._frame.width-X+W)/q.width,V[3]=(Z._frame.y+Z._frame.height-X+W)/q.height,this.uClampOffset[0]=W/q.realWidth,this.uClampOffset[1]=W/q.realHeight,this.isSimple=Z._frame.width===q.width&&Z._frame.height===q.height&&Z.rotate===0,!0}}var dV=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var lV=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class d9 extends w0{constructor($,Z,J){let Q=null;typeof $!="string"&&Z===void 0&&J===void 0&&(Q=$,$=void 0,Z=void 0,J=void 0),super($||lV,Z||dV,J),this.maskSprite=Q,this.maskMatrix=new Z0}get maskSprite(){return this._maskSprite}set maskSprite($){this._maskSprite=$,this._maskSprite&&(this._maskSprite.renderable=!1)}apply($,Z,J,Q){const K=this._maskSprite,q=K._texture;q.valid&&(q.uvMatrix||(q.uvMatrix=new t8(q,0)),q.uvMatrix.update(),this.uniforms.npmAlpha=q.baseTexture.alphaMode?0:1,this.uniforms.mask=q,this.uniforms.otherMatrix=$.calculateSpriteMatrix(this.maskMatrix,K).prepend(q.uvMatrix.mapCoord),this.uniforms.alpha=K.worldAlpha,this.uniforms.maskClamp=q.uvMatrix.uClampFrame,$.applyFilter(this,Z,J,Q))}}class l9{constructor($=null){this.type=D0.NONE,this.autoDetect=!0,this.maskObject=$||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=w0.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter($){$?this._filters?this._filters[0]=$:this._filters=[$]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=D0.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset($){$?(this._stencilCounter=$._stencilCounter,this._scissorCounter=$._scissorCounter,this._scissorRect=$._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class B5{constructor($){this.renderer=$,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack($){this.maskStack=$,this.renderer.scissor.setMaskStack($),this.renderer.stencil.setMaskStack($)}push($,Z){let J=Z;if(!J.isMaskData){const K=this.maskDataPool.pop()||new l9;K.pooled=!0,K.maskObject=Z,J=K}const Q=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(J.copyCountersOrReset(Q),J._colorMask=Q?Q._colorMask:15,J.autoDetect&&this.detect(J),J._target=$,J.type!==D0.SPRITE&&this.maskStack.push(J),J.enabled)switch(J.type){case D0.SCISSOR:this.renderer.scissor.push(J);break;case D0.STENCIL:this.renderer.stencil.push(J);break;case D0.SPRITE:J.copyCountersOrReset(null),this.pushSpriteMask(J);break;case D0.COLOR:this.pushColorMask(J);break;default:break}J.type===D0.SPRITE&&this.maskStack.push(J)}pop($){const Z=this.maskStack.pop();if(!(!Z||Z._target!==$)){if(Z.enabled)switch(Z.type){case D0.SCISSOR:this.renderer.scissor.pop(Z);break;case D0.STENCIL:this.renderer.stencil.pop(Z.maskObject);break;case D0.SPRITE:this.popSpriteMask(Z);break;case D0.COLOR:this.popColorMask(Z);break;default:break}if(Z.reset(),Z.pooled&&this.maskDataPool.push(Z),this.maskStack.length!==0){const J=this.maskStack[this.maskStack.length-1];J.type===D0.SPRITE&&J._filters&&(J._filters[0].maskSprite=J.maskObject)}}}detect($){const Z=$.maskObject;Z?Z.isSprite?$.type=D0.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor($)?$.type=D0.SCISSOR:$.type=D0.STENCIL:$.type=D0.COLOR}pushSpriteMask($){const{maskObject:Z}=$,J=$._target;let Q=$._filters;Q||(Q=this.alphaMaskPool[this.alphaMaskIndex],Q||(Q=this.alphaMaskPool[this.alphaMaskIndex]=[new d9])),Q[0].resolution=$.resolution,Q[0].multisample=$.multisample,Q[0].maskSprite=Z;const K=J.filterArea;J.filterArea=Z.getBounds(!0),this.renderer.filter.push(J,Q),J.filterArea=K,$._filters||this.alphaMaskIndex++}popSpriteMask($){this.renderer.filter.pop(),$._filters?$._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask($){const Z=$._colorMask,J=$._colorMask=Z&$.colorMask;J!==Z&&this.renderer.gl.colorMask((J&1)!==0,(J&2)!==0,(J&4)!==0,(J&8)!==0)}popColorMask($){const Z=$._colorMask,J=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;J!==Z&&this.renderer.gl.colorMask((J&1)!==0,(J&2)!==0,(J&4)!==0,(J&8)!==0)}destroy(){this.renderer=null}}B5.extension={type:I.RendererSystem,name:"mask"};P.add(B5);class F5{constructor($){this.renderer=$,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack($){const{gl:Z}=this.renderer,J=this.getStackLength();this.maskStack=$;const Q=this.getStackLength();Q!==J&&(Q===0?Z.disable(this.glConst):(Z.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}var nV=new Z0,oV=[],sV=class $ extends F5{constructor(Z){super(Z),this.glConst=R.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const Z=this.maskStack[this.maskStack.length-1];return Z?Z._scissorCounter:0}calcScissorRect(Z){if(Z._scissorRectLocal)return;const J=Z._scissorRect,{maskObject:Q}=Z,{renderer:K}=this,q=K.renderTexture,V=Q.getBounds(!0,oV.pop()??new m);this.roundFrameToPixels(V,q.current?q.current.resolution:K.resolution,q.sourceFrame,q.destinationFrame,K.projection.transform),J&&V.fit(J),Z._scissorRectLocal=V}static isMatrixRotated(Z){if(!Z)return!1;const{a:J,b:Q,c:K,d:q}=Z;return(Math.abs(Q)>0.0001||Math.abs(K)>0.0001)&&(Math.abs(J)>0.0001||Math.abs(q)>0.0001)}testScissor(Z){const{maskObject:J}=Z;if(!J.isFastRect||!J.isFastRect()||$.isMatrixRotated(J.worldTransform)||$.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(Z);const Q=Z._scissorRectLocal;return Q.width>0&&Q.height>0}roundFrameToPixels(Z,J,Q,K,q){$.isMatrixRotated(q)||(q=q?nV.copyFrom(q):nV.identity(),q.translate(-Q.x,-Q.y).scale(K.width/Q.width,K.height/Q.height).translate(K.x,K.y),this.renderer.filter.transformAABB(q,Z),Z.fit(K),Z.x=Math.round(Z.x*J),Z.y=Math.round(Z.y*J),Z.width=Math.round(Z.width*J),Z.height=Math.round(Z.height*J))}push(Z){Z._scissorRectLocal||this.calcScissorRect(Z);const{gl:J}=this.renderer;Z._scissorRect||J.enable(J.SCISSOR_TEST),Z._scissorCounter++,Z._scissorRect=Z._scissorRectLocal,this._useCurrent()}pop(Z){const{gl:J}=this.renderer;Z&&oV.push(Z._scissorRectLocal),this.getStackLength()>0?this._useCurrent():J.disable(J.SCISSOR_TEST)}_useCurrent(){const Z=this.maskStack[this.maskStack.length-1]._scissorRect;let J;this.renderer.renderTexture.current?J=Z.y:J=this.renderer.height-Z.height-Z.y,this.renderer.gl.scissor(Z.x,J,Z.width,Z.height)}};sV.extension={type:I.RendererSystem,name:"scissor"};var K1=sV;P.add(K1);class N5 extends F5{constructor($){super($),this.glConst=R.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const $=this.maskStack[this.maskStack.length-1];return $?$._stencilCounter:0}push($){const Z=$.maskObject,{gl:J}=this.renderer,Q=$._stencilCounter;Q===0&&(this.renderer.framebuffer.forceStencil(),J.clearStencil(0),J.clear(J.STENCIL_BUFFER_BIT),J.enable(J.STENCIL_TEST)),$._stencilCounter++;const K=$._colorMask;K!==0&&($._colorMask=0,J.colorMask(!1,!1,!1,!1)),J.stencilFunc(J.EQUAL,Q,4294967295),J.stencilOp(J.KEEP,J.KEEP,J.INCR),Z.renderable=!0,Z.render(this.renderer),this.renderer.batch.flush(),Z.renderable=!1,K!==0&&($._colorMask=K,J.colorMask((K&1)!==0,(K&2)!==0,(K&4)!==0,(K&8)!==0)),this._useCurrent()}pop($){const Z=this.renderer.gl;if(this.getStackLength()===0)Z.disable(Z.STENCIL_TEST);else{const J=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,Q=J?J._colorMask:15;Q!==0&&(J._colorMask=0,Z.colorMask(!1,!1,!1,!1)),Z.stencilOp(Z.KEEP,Z.KEEP,Z.DECR),$.renderable=!0,$.render(this.renderer),this.renderer.batch.flush(),$.renderable=!1,Q!==0&&(J._colorMask=Q,Z.colorMask((Q&1)!==0,(Q&2)!==0,(Q&4)!==0,(Q&8)!==0)),this._useCurrent()}}_useCurrent(){const $=this.renderer.gl;$.stencilFunc($.EQUAL,this.getStackLength(),4294967295),$.stencilOp($.KEEP,$.KEEP,$.KEEP)}}N5.extension={type:I.RendererSystem,name:"stencil"};P.add(N5);class C5{constructor($){this.renderer=$,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return t("7.0.0","renderer.plugins.extract has moved to renderer.extract"),$.extract}},prepare:{enumerable:!1,get(){return t("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),$.prepare}},interaction:{enumerable:!1,get(){return t("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),$.events}}})}init(){const $=this.rendererPlugins;for(let Z in $)this.plugins[Z]=new $[Z](this.renderer)}destroy(){for(let $ in this.plugins)this.plugins[$].destroy(),this.plugins[$]=null}}C5.extension={type:[I.RendererSystem,I.CanvasRendererSystem],name:"_plugin"};P.add(C5);class L5{constructor($){this.renderer=$,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Z0,this.transform=null}update($,Z,J,Q){this.destinationFrame=$||this.destinationFrame||this.defaultFrame,this.sourceFrame=Z||this.sourceFrame||$,this.calculateProjection(this.destinationFrame,this.sourceFrame,J,Q),this.transform&&this.projectionMatrix.append(this.transform);const K=this.renderer;K.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,K.globalUniforms.update(),K.shader.shader&&K.shader.syncUniformGroup(K.shader.shader.uniforms.globals)}calculateProjection($,Z,J,Q){const K=this.projectionMatrix,q=Q?-1:1;K.identity(),K.a=1/Z.width*2,K.d=q*(1/Z.height*2),K.tx=-1-Z.x*K.a,K.ty=-q-Z.y*K.d}setTransform($){}destroy(){this.renderer=null}}L5.extension={type:I.RendererSystem,name:"projection"};P.add(L5);var Gw=new i8,iV=new m;class _5{constructor($){this.renderer=$,this._tempMatrix=new Z0}generateTexture($,Z){const{region:J,...Q}=Z||{},K=J?.copyTo(iV)||$.getLocalBounds(iV,!0),q=Q.resolution||this.renderer.resolution;K.width=Math.max(K.width,1/q),K.height=Math.max(K.height,1/q),Q.width=K.width,Q.height=K.height,Q.resolution=q,Q.multisample??(Q.multisample=this.renderer.multisample);const V=c$.create(Q);this._tempMatrix.tx=-K.x,this._tempMatrix.ty=-K.y;const X=$.transform;return $.transform=Gw,this.renderer.render($,{renderTexture:V,transform:this._tempMatrix,skipUpdateTransform:!!$.parent,blit:!0}),$.transform=X,V}destroy(){}}_5.extension={type:[I.RendererSystem,I.CanvasRendererSystem],name:"textureGenerator"};P.add(_5);var A6=new m,O5=new m;class I5{constructor($){this.renderer=$,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new m,this.destinationFrame=new m,this.viewportFrame=new m}contextChange(){const $=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!($&&$.alpha&&$.premultipliedAlpha)}bind($=null,Z,J){const Q=this.renderer;this.current=$;let K,q,V;$?(K=$.baseTexture,V=K.resolution,Z||(A6.width=$.frame.width,A6.height=$.frame.height,Z=A6),J||(O5.x=$.frame.x,O5.y=$.frame.y,O5.width=Z.width,O5.height=Z.height,J=O5),q=K.framebuffer):(V=Q.resolution,Z||(A6.width=Q._view.screen.width,A6.height=Q._view.screen.height,Z=A6),J||(J=A6,J.width=Z.width,J.height=Z.height));const X=this.viewportFrame;X.x=J.x*V,X.y=J.y*V,X.width=J.width*V,X.height=J.height*V,$||(X.y=Q.view.height-(X.y+X.height)),X.ceil(),this.renderer.framebuffer.bind(q,X),this.renderer.projection.update(J,Z,V,!q),$?this.renderer.mask.setMaskStack(K.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(Z),this.destinationFrame.copyFrom(J)}clear($,Z){const J=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,Q=e.shared.setValue($||J);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&Q.premultiply(Q.alpha);const K=this.destinationFrame,q=this.current?this.current.baseTexture:this.renderer._view.screen,V=K.width!==q.width||K.height!==q.height;if(V){let{x:X,y:W,width:U,height:z}=this.viewportFrame;X=Math.round(X),W=Math.round(W),U=Math.round(U),z=Math.round(z),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(X,W,U,z)}this.renderer.framebuffer.clear(Q.red,Q.green,Q.blue,Q.alpha,Z),V&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}I5.extension={type:I.RendererSystem,name:"renderTexture"};P.add(I5);class n9{constructor($,Z){this.program=$,this.uniformData=Z,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}var aV=function($,Z){const J={},Q=Z.getProgramParameter($,Z.ACTIVE_ATTRIBUTES);for(let K=0;K<Q;K++){const q=Z.getActiveAttrib($,K);if(q.name.startsWith("gl_"))continue;const V=W5(Z,q.type),X={type:V,name:q.name,size:X5(V),location:Z.getAttribLocation($,q.name)};J[q.name]=X}return J};var rV=function($,Z){const J={},Q=Z.getProgramParameter($,Z.ACTIVE_UNIFORMS);for(let K=0;K<Q;K++){const q=Z.getActiveUniform($,K),V=q.name.replace(/\[.*?\]$/,""),X=!!q.name.match(/\[.*?\]$/),W=W5(Z,q.type);J[V]={name:V,index:K,type:W,size:q.size,isArray:X,value:V5(W,q.size)}}return J};var q1=function($,Z){const J=E9($,$.VERTEX_SHADER,Z.vertexSrc),Q=E9($,$.FRAGMENT_SHADER,Z.fragmentSrc),K=$.createProgram();$.attachShader(K,J),$.attachShader(K,Q);const q=Z.extra?.transformFeedbackVaryings;if(q&&(typeof $.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):$.transformFeedbackVaryings(K,q.names,q.bufferMode==="separate"?$.SEPARATE_ATTRIBS:$.INTERLEAVED_ATTRIBS)),$.linkProgram(K),$.getProgramParameter(K,$.LINK_STATUS)||eJ($,K,J,Q),Z.attributeData=aV(K,$),Z.uniformData=rV(K,$),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(Z.vertexSrc)){const X=Object.keys(Z.attributeData);X.sort((W,U)=>W>U?1:-1);for(let W=0;W<X.length;W++)Z.attributeData[X[W]].location=W,$.bindAttribLocation(K,W,X[W]);$.linkProgram(K)}$.deleteShader(J),$.deleteShader(Q);const V={};for(let X in Z.uniformData){const W=Z.uniformData[X];V[X]={location:$.getUniformLocation(K,X),value:V5(W.type,W.size)}}return new n9(K,V)};var Yw=function($,Z,J,Q,K){J.buffer.update(K)},eV=function($){const Z=$.map((q)=>({data:q,offset:0,dataLen:0,dirty:0}));let J=0,Q=0,K=0;for(let q=0;q<Z.length;q++){const V=Z[q];if(J=tV[V.data.type],V.data.size>1&&(J=Math.max(J,16)*V.data.size),V.dataLen=J,Q%J!==0&&Q<16){const X=Q%J%16;Q+=X,K+=X}Q+J>16?(K=Math.ceil(K/16)*16,V.offset=K,K+=J,Q=J):(V.offset=K,Q+=J,K+=J)}return K=Math.ceil(K/16)*16,{uboElements:Z,size:K}},$X=function($,Z){const J=[];for(let Q in $)Z[Q]&&J.push(Z[Q]);return J.sort((Q,K)=>Q.index-K.index),J},V1=function($,Z){if(!$.autoManage)return{size:0,syncFunc:Yw};const J=$X($.uniforms,Z),{uboElements:Q,size:K}=eV(J),q=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let V=0;V<Q.length;V++){const X=Q[V],W=$.uniforms[X.data.name],U=X.data.name;let z=!1;for(let H=0;H<z8.length;H++){const G=z8[H];if(G.codeUbo&&G.test(X.data,W)){q.push(`offset = ${X.offset/4};`,z8[H].codeUbo(X.data.name,W)),z=!0;break}}if(!z)if(X.data.size>1){const H=X5(X.data.type),G=Math.max(tV[X.data.type]/16,1),Y=H/G,w=(4-Y%4)%4;q.push(`
                cv = ud.${U}.value;
                v = uv.${U};
                offset = ${X.offset/4};

                t = 0;

                for(var i=0; i < ${X.data.size*G}; i++)
                {
                    for(var j = 0; j < ${Y}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${w};
                }

                `)}else{const H=ww[X.data.type];q.push(`
                cv = ud.${U}.value;
                v = uv.${U};
                offset = ${X.offset/4};
                ${H};
                `)}}return q.push(`
       renderer.buffer.update(buffer);
    `),{size:K,syncFunc:new Function("ud","uv","renderer","syncData","buffer",q.join(`
`))}},ww={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},tV={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};var jw=0,o9={textureCount:0,uboCount:0};class R5{constructor($){this.destroyed=!1,this.renderer=$,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=jw++}systemCheck(){if(!f9())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange($){this.gl=$,this.reset()}bind($,Z){$.disposeRunner.add(this),$.uniforms.globals=this.renderer.globalUniforms;const J=$.program,Q=J.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram($);return this.shader=$,this.program!==J&&(this.program=J,this.gl.useProgram(Q.program)),Z||(o9.textureCount=0,o9.uboCount=0,this.syncUniformGroup($.uniformGroup,o9)),Q}setUniforms($){const Z=this.shader.program,J=Z.glPrograms[this.renderer.CONTEXT_UID];Z.syncUniforms(J.uniformData,$,this.renderer)}syncUniformGroup($,Z){const J=this.getGlProgram();(!$.static||$.dirtyId!==J.uniformDirtyGroups[$.id])&&(J.uniformDirtyGroups[$.id]=$.dirtyId,this.syncUniforms($,J,Z))}syncUniforms($,Z,J){($.syncUniforms[this.shader.program.id]||this.createSyncGroups($))(Z.uniformData,$.uniforms,this.renderer,J)}createSyncGroups($){const Z=this.getSignature($,this.shader.program.uniformData,"u");return this.cache[Z]||(this.cache[Z]=rJ($,this.shader.program.uniformData)),$.syncUniforms[this.shader.program.id]=this.cache[Z],$.syncUniforms[this.shader.program.id]}syncUniformBufferGroup($,Z){const J=this.getGlProgram();if(!$.static||$.dirtyId!==0||!J.uniformGroups[$.id]){$.dirtyId=0;const Q=J.uniformGroups[$.id]||this.createSyncBufferGroup($,J,Z);$.buffer.update(),Q(J.uniformData,$.uniforms,this.renderer,o9,$.buffer)}this.renderer.buffer.bindBufferBase($.buffer,J.uniformBufferBindings[Z])}createSyncBufferGroup($,Z,J){const{gl:Q}=this.renderer;this.renderer.buffer.bind($.buffer);const K=this.gl.getUniformBlockIndex(Z.program,J);Z.uniformBufferBindings[J]=this.shader.uniformBindCount,Q.uniformBlockBinding(Z.program,K,this.shader.uniformBindCount),this.shader.uniformBindCount++;const q=this.getSignature($,this.shader.program.uniformData,"ubo");let V=this._uboCache[q];if(V||(V=this._uboCache[q]=V1($,this.shader.program.uniformData)),$.autoManage){const X=new Float32Array(V.size/4);$.buffer.update(X)}return Z.uniformGroups[$.id]=V.syncFunc,Z.uniformGroups[$.id]}getSignature($,Z,J){const Q=$.uniforms,K=[`${J}-`];for(let q in Q)K.push(q),Z[q]&&K.push(Z[q].type);return K.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram($){const Z=this.gl,J=$.program,Q=q1(Z,J);return J.glPrograms[this.renderer.CONTEXT_UID]=Q,Q}reset(){this.program=null,this.shader=null}disposeShader($){this.shader===$&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}R5.extension={type:I.RendererSystem,name:"shader"};P.add(R5);class e8{constructor($){this.renderer=$}run($){const{renderer:Z}=this;Z.runners.init.emit(Z.options),$.hello&&console.log(`PixiJS 7.3.2 - ${Z.rendererLogId} - https://pixijs.com`),Z.resize(Z.screen.width,Z.screen.height)}destroy(){}}e8.defaultOptions={hello:!1},e8.extension={type:[I.RendererSystem,I.CanvasRendererSystem],name:"startup"};P.add(e8);var ZX=function($,Z=[]){return Z[a.NORMAL]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.ADD]=[$.ONE,$.ONE],Z[a.MULTIPLY]=[$.DST_COLOR,$.ONE_MINUS_SRC_ALPHA,$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.SCREEN]=[$.ONE,$.ONE_MINUS_SRC_COLOR,$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.OVERLAY]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.DARKEN]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.LIGHTEN]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.COLOR_DODGE]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.COLOR_BURN]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.HARD_LIGHT]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.SOFT_LIGHT]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.DIFFERENCE]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.EXCLUSION]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.HUE]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.SATURATION]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.COLOR]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.LUMINOSITY]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.NONE]=[0,0],Z[a.NORMAL_NPM]=[$.SRC_ALPHA,$.ONE_MINUS_SRC_ALPHA,$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.ADD_NPM]=[$.SRC_ALPHA,$.ONE,$.ONE,$.ONE],Z[a.SCREEN_NPM]=[$.SRC_ALPHA,$.ONE_MINUS_SRC_COLOR,$.ONE,$.ONE_MINUS_SRC_ALPHA],Z[a.SRC_IN]=[$.DST_ALPHA,$.ZERO],Z[a.SRC_OUT]=[$.ONE_MINUS_DST_ALPHA,$.ZERO],Z[a.SRC_ATOP]=[$.DST_ALPHA,$.ONE_MINUS_SRC_ALPHA],Z[a.DST_OVER]=[$.ONE_MINUS_DST_ALPHA,$.ONE],Z[a.DST_IN]=[$.ZERO,$.SRC_ALPHA],Z[a.DST_OUT]=[$.ZERO,$.ONE_MINUS_SRC_ALPHA],Z[a.DST_ATOP]=[$.ONE_MINUS_DST_ALPHA,$.SRC_ALPHA],Z[a.XOR]=[$.ONE_MINUS_DST_ALPHA,$.ONE_MINUS_SRC_ALPHA],Z[a.SUBTRACT]=[$.ONE,$.ONE,$.ONE,$.ONE,$.FUNC_REVERSE_SUBTRACT,$.FUNC_ADD],Z};var Bw=0,Fw=1,Nw=2,Cw=3,Lw=4,_w=5,JX=class ${constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=a.NONE,this._blendEq=!1,this.map=[],this.map[Bw]=this.setBlend,this.map[Fw]=this.setOffset,this.map[Nw]=this.setCullFace,this.map[Cw]=this.setDepthTest,this.map[Lw]=this.setFrontFace,this.map[_w]=this.setDepthMask,this.checks=[],this.defaultState=new p0,this.defaultState.blend=!0}contextChange(Z){this.gl=Z,this.blendModes=ZX(Z),this.set(this.defaultState),this.reset()}set(Z){if(Z=Z||this.defaultState,this.stateId!==Z.data){let J=this.stateId^Z.data,Q=0;for(;J;)J&1&&this.map[Q].call(this,!!(Z.data&1<<Q)),J=J>>1,Q++;this.stateId=Z.data}for(let J=0;J<this.checks.length;J++)this.checks[J](this,Z)}forceState(Z){Z=Z||this.defaultState;for(let J=0;J<this.map.length;J++)this.map[J].call(this,!!(Z.data&1<<J));for(let J=0;J<this.checks.length;J++)this.checks[J](this,Z);this.stateId=Z.data}setBlend(Z){this.updateCheck($.checkBlendMode,Z),this.gl[Z?"enable":"disable"](this.gl.BLEND)}setOffset(Z){this.updateCheck($.checkPolygonOffset,Z),this.gl[Z?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(Z){this.gl[Z?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(Z){this.gl.depthMask(Z)}setCullFace(Z){this.gl[Z?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(Z){this.gl.frontFace(this.gl[Z?"CW":"CCW"])}setBlendMode(Z){if(Z===this.blendMode)return;this.blendMode=Z;const J=this.blendModes[Z],Q=this.gl;J.length===2?Q.blendFunc(J[0],J[1]):Q.blendFuncSeparate(J[0],J[1],J[2],J[3]),J.length===6?(this._blendEq=!0,Q.blendEquationSeparate(J[4],J[5])):this._blendEq&&(this._blendEq=!1,Q.blendEquationSeparate(Q.FUNC_ADD,Q.FUNC_ADD))}setPolygonOffset(Z,J){this.gl.polygonOffset(Z,J)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(Z,J){const Q=this.checks.indexOf(Z);J&&Q===-1?this.checks.push(Z):!J&&Q!==-1&&this.checks.splice(Q,1)}static checkBlendMode(Z,J){Z.setBlendMode(J.blendMode)}static checkPolygonOffset(Z,J){Z.setPolygonOffset(1,J.polygonOffset)}destroy(){this.gl=null}};JX.extension={type:I.RendererSystem,name:"state"};var X1=JX;P.add(X1);class P5 extends o8.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup($){this.addRunners(...$.runners);const Z=($.priority??[]).filter((Q)=>$.systems[Q]),J=[...Z,...Object.keys($.systems).filter((Q)=>!Z.includes(Q))];for(let Q of J)this.addSystem($.systems[Q],Q)}addRunners(...$){$.forEach((Z)=>{this.runners[Z]=new v0(Z)})}addSystem($,Z){const J=new $(this);if(this[Z])throw new Error(`Whoops! The name "${Z}" is already in use`);this[Z]=J,this._systemsHash[Z]=J;for(let Q in this.runners)this.runners[Q].add(J);return this}emitWithCustomOptions($,Z){const J=Object.keys(this._systemsHash);$.items.forEach((Q)=>{const K=J.find((q)=>this._systemsHash[q]===Q);Q[$.name](Z[K])})}destroy(){Object.values(this.runners).forEach(($)=>{$.destroy()}),this._systemsHash={}}}var D5=class ${constructor(Z){this.renderer=Z,this.count=0,this.checkCount=0,this.maxIdle=$.defaultMaxIdle,this.checkCountMax=$.defaultCheckCountMax,this.mode=$.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Y9.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const Z=this.renderer.texture,J=Z.managedTextures;let Q=!1;for(let K=0;K<J.length;K++){const q=J[K];q.resource&&this.count-q.touched>this.maxIdle&&(Z.destroyTexture(q,!0),J[K]=null,Q=!0)}if(Q){let K=0;for(let q=0;q<J.length;q++)J[q]!==null&&(J[K++]=J[q]);J.length=K}}unload(Z){const J=this.renderer.texture,Q=Z._texture;Q&&!Q.framebuffer&&J.destroyTexture(Q);for(let K=Z.children.length-1;K>=0;K--)this.unload(Z.children[K])}destroy(){this.renderer=null}};D5.defaultMode=Y9.AUTO,D5.defaultMaxIdle=3600,D5.defaultCheckCountMax=600,D5.extension={type:I.RendererSystem,name:"textureGC"};var G8=D5;P.add(G8);class z7{constructor($){this.texture=$,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=d.UNSIGNED_BYTE,this.internalFormat=v.RGBA,this.samplerType=0}}var QX=function($){let Z;return("WebGL2RenderingContext"in globalThis)&&$ instanceof globalThis.WebGL2RenderingContext?Z={[$.RGB]:p.FLOAT,[$.RGBA]:p.FLOAT,[$.ALPHA]:p.FLOAT,[$.LUMINANCE]:p.FLOAT,[$.LUMINANCE_ALPHA]:p.FLOAT,[$.R8]:p.FLOAT,[$.R8_SNORM]:p.FLOAT,[$.RG8]:p.FLOAT,[$.RG8_SNORM]:p.FLOAT,[$.RGB8]:p.FLOAT,[$.RGB8_SNORM]:p.FLOAT,[$.RGB565]:p.FLOAT,[$.RGBA4]:p.FLOAT,[$.RGB5_A1]:p.FLOAT,[$.RGBA8]:p.FLOAT,[$.RGBA8_SNORM]:p.FLOAT,[$.RGB10_A2]:p.FLOAT,[$.RGB10_A2UI]:p.FLOAT,[$.SRGB8]:p.FLOAT,[$.SRGB8_ALPHA8]:p.FLOAT,[$.R16F]:p.FLOAT,[$.RG16F]:p.FLOAT,[$.RGB16F]:p.FLOAT,[$.RGBA16F]:p.FLOAT,[$.R32F]:p.FLOAT,[$.RG32F]:p.FLOAT,[$.RGB32F]:p.FLOAT,[$.RGBA32F]:p.FLOAT,[$.R11F_G11F_B10F]:p.FLOAT,[$.RGB9_E5]:p.FLOAT,[$.R8I]:p.INT,[$.R8UI]:p.UINT,[$.R16I]:p.INT,[$.R16UI]:p.UINT,[$.R32I]:p.INT,[$.R32UI]:p.UINT,[$.RG8I]:p.INT,[$.RG8UI]:p.UINT,[$.RG16I]:p.INT,[$.RG16UI]:p.UINT,[$.RG32I]:p.INT,[$.RG32UI]:p.UINT,[$.RGB8I]:p.INT,[$.RGB8UI]:p.UINT,[$.RGB16I]:p.INT,[$.RGB16UI]:p.UINT,[$.RGB32I]:p.INT,[$.RGB32UI]:p.UINT,[$.RGBA8I]:p.INT,[$.RGBA8UI]:p.UINT,[$.RGBA16I]:p.INT,[$.RGBA16UI]:p.UINT,[$.RGBA32I]:p.INT,[$.RGBA32UI]:p.UINT,[$.DEPTH_COMPONENT16]:p.FLOAT,[$.DEPTH_COMPONENT24]:p.FLOAT,[$.DEPTH_COMPONENT32F]:p.FLOAT,[$.DEPTH_STENCIL]:p.FLOAT,[$.DEPTH24_STENCIL8]:p.FLOAT,[$.DEPTH32F_STENCIL8]:p.FLOAT}:Z={[$.RGB]:p.FLOAT,[$.RGBA]:p.FLOAT,[$.ALPHA]:p.FLOAT,[$.LUMINANCE]:p.FLOAT,[$.LUMINANCE_ALPHA]:p.FLOAT,[$.DEPTH_STENCIL]:p.FLOAT},Z};var KX=function($){let Z;return("WebGL2RenderingContext"in globalThis)&&$ instanceof globalThis.WebGL2RenderingContext?Z={[d.UNSIGNED_BYTE]:{[v.RGBA]:$.RGBA8,[v.RGB]:$.RGB8,[v.RG]:$.RG8,[v.RED]:$.R8,[v.RGBA_INTEGER]:$.RGBA8UI,[v.RGB_INTEGER]:$.RGB8UI,[v.RG_INTEGER]:$.RG8UI,[v.RED_INTEGER]:$.R8UI,[v.ALPHA]:$.ALPHA,[v.LUMINANCE]:$.LUMINANCE,[v.LUMINANCE_ALPHA]:$.LUMINANCE_ALPHA},[d.BYTE]:{[v.RGBA]:$.RGBA8_SNORM,[v.RGB]:$.RGB8_SNORM,[v.RG]:$.RG8_SNORM,[v.RED]:$.R8_SNORM,[v.RGBA_INTEGER]:$.RGBA8I,[v.RGB_INTEGER]:$.RGB8I,[v.RG_INTEGER]:$.RG8I,[v.RED_INTEGER]:$.R8I},[d.UNSIGNED_SHORT]:{[v.RGBA_INTEGER]:$.RGBA16UI,[v.RGB_INTEGER]:$.RGB16UI,[v.RG_INTEGER]:$.RG16UI,[v.RED_INTEGER]:$.R16UI,[v.DEPTH_COMPONENT]:$.DEPTH_COMPONENT16},[d.SHORT]:{[v.RGBA_INTEGER]:$.RGBA16I,[v.RGB_INTEGER]:$.RGB16I,[v.RG_INTEGER]:$.RG16I,[v.RED_INTEGER]:$.R16I},[d.UNSIGNED_INT]:{[v.RGBA_INTEGER]:$.RGBA32UI,[v.RGB_INTEGER]:$.RGB32UI,[v.RG_INTEGER]:$.RG32UI,[v.RED_INTEGER]:$.R32UI,[v.DEPTH_COMPONENT]:$.DEPTH_COMPONENT24},[d.INT]:{[v.RGBA_INTEGER]:$.RGBA32I,[v.RGB_INTEGER]:$.RGB32I,[v.RG_INTEGER]:$.RG32I,[v.RED_INTEGER]:$.R32I},[d.FLOAT]:{[v.RGBA]:$.RGBA32F,[v.RGB]:$.RGB32F,[v.RG]:$.RG32F,[v.RED]:$.R32F,[v.DEPTH_COMPONENT]:$.DEPTH_COMPONENT32F},[d.HALF_FLOAT]:{[v.RGBA]:$.RGBA16F,[v.RGB]:$.RGB16F,[v.RG]:$.RG16F,[v.RED]:$.R16F},[d.UNSIGNED_SHORT_5_6_5]:{[v.RGB]:$.RGB565},[d.UNSIGNED_SHORT_4_4_4_4]:{[v.RGBA]:$.RGBA4},[d.UNSIGNED_SHORT_5_5_5_1]:{[v.RGBA]:$.RGB5_A1},[d.UNSIGNED_INT_2_10_10_10_REV]:{[v.RGBA]:$.RGB10_A2,[v.RGBA_INTEGER]:$.RGB10_A2UI},[d.UNSIGNED_INT_10F_11F_11F_REV]:{[v.RGB]:$.R11F_G11F_B10F},[d.UNSIGNED_INT_5_9_9_9_REV]:{[v.RGB]:$.RGB9_E5},[d.UNSIGNED_INT_24_8]:{[v.DEPTH_STENCIL]:$.DEPTH24_STENCIL8},[d.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[v.DEPTH_STENCIL]:$.DEPTH32F_STENCIL8}}:Z={[d.UNSIGNED_BYTE]:{[v.RGBA]:$.RGBA,[v.RGB]:$.RGB,[v.ALPHA]:$.ALPHA,[v.LUMINANCE]:$.LUMINANCE,[v.LUMINANCE_ALPHA]:$.LUMINANCE_ALPHA},[d.UNSIGNED_SHORT_5_6_5]:{[v.RGB]:$.RGB},[d.UNSIGNED_SHORT_4_4_4_4]:{[v.RGBA]:$.RGBA},[d.UNSIGNED_SHORT_5_5_5_1]:{[v.RGBA]:$.RGBA}},Z};class A5{constructor($){this.renderer=$,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new n,this.hasIntegerTextures=!1}contextChange(){const $=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=KX($),this.samplerTypes=QX($);const Z=$.getParameter($.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=Z;for(let Q=0;Q<Z;Q++)this.boundTextures[Q]=null;this.emptyTextures={};const J=new z7($.createTexture());$.bindTexture($.TEXTURE_2D,J.texture),$.texImage2D($.TEXTURE_2D,0,$.RGBA,1,1,0,$.RGBA,$.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[$.TEXTURE_2D]=J,this.emptyTextures[$.TEXTURE_CUBE_MAP]=new z7($.createTexture()),$.bindTexture($.TEXTURE_CUBE_MAP,this.emptyTextures[$.TEXTURE_CUBE_MAP].texture);for(let Q=0;Q<6;Q++)$.texImage2D($.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,$.RGBA,1,1,0,$.RGBA,$.UNSIGNED_BYTE,null);$.texParameteri($.TEXTURE_CUBE_MAP,$.TEXTURE_MAG_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_CUBE_MAP,$.TEXTURE_MIN_FILTER,$.LINEAR);for(let Q=0;Q<this.boundTextures.length;Q++)this.bind(null,Q)}bind($,Z=0){const{gl:J}=this;if($=$?.castToBaseTexture(),$?.valid&&!$.parentTextureArray){$.touched=this.renderer.textureGC.count;const Q=$._glTextures[this.CONTEXT_UID]||this.initTexture($);this.boundTextures[Z]!==$&&(this.currentLocation!==Z&&(this.currentLocation=Z,J.activeTexture(J.TEXTURE0+Z)),J.bindTexture($.target,Q.texture)),Q.dirtyId!==$.dirtyId?(this.currentLocation!==Z&&(this.currentLocation=Z,J.activeTexture(J.TEXTURE0+Z)),this.updateTexture($)):Q.dirtyStyleId!==$.dirtyStyleId&&this.updateTextureStyle($),this.boundTextures[Z]=$}else this.currentLocation!==Z&&(this.currentLocation=Z,J.activeTexture(J.TEXTURE0+Z)),J.bindTexture(J.TEXTURE_2D,this.emptyTextures[J.TEXTURE_2D].texture),this.boundTextures[Z]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let $=0;$<this.boundTextures.length;$++)this.boundTextures[$]=this.unknownTexture}unbind($){const{gl:Z,boundTextures:J}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let Q=0;Q<J.length;Q++)J[Q]===this.unknownTexture&&this.bind(null,Q)}for(let Q=0;Q<J.length;Q++)J[Q]===$&&(this.currentLocation!==Q&&(Z.activeTexture(Z.TEXTURE0+Q),this.currentLocation=Q),Z.bindTexture($.target,this.emptyTextures[$.target].texture),J[Q]=null)}ensureSamplerType($){const{boundTextures:Z,hasIntegerTextures:J,CONTEXT_UID:Q}=this;if(J)for(let K=$-1;K>=0;--K){const q=Z[K];q&&q._glTextures[Q].samplerType!==p.FLOAT&&this.renderer.texture.unbind(q)}}initTexture($){const Z=new z7(this.gl.createTexture());return Z.dirtyId=-1,$._glTextures[this.CONTEXT_UID]=Z,this.managedTextures.push($),$.on("dispose",this.destroyTexture,this),Z}initTextureType($,Z){Z.internalFormat=this.internalFormats[$.type]?.[$.format]??$.format,Z.samplerType=this.samplerTypes[Z.internalFormat]??p.FLOAT,this.webGLVersion===2&&$.type===d.HALF_FLOAT?Z.type=this.gl.HALF_FLOAT:Z.type=$.type}updateTexture($){const Z=$._glTextures[this.CONTEXT_UID];if(!Z)return;const J=this.renderer;if(this.initTextureType($,Z),$.resource?.upload(J,$,Z))Z.samplerType!==p.FLOAT&&(this.hasIntegerTextures=!0);else{const{realWidth:Q,realHeight:K}=$,q=J.gl;(Z.width!==Q||Z.height!==K||Z.dirtyId<0)&&(Z.width=Q,Z.height=K,q.texImage2D($.target,0,Z.internalFormat,Q,K,0,$.format,Z.type,null))}$.dirtyStyleId!==Z.dirtyStyleId&&this.updateTextureStyle($),Z.dirtyId=$.dirtyId}destroyTexture($,Z){const{gl:J}=this;if($=$.castToBaseTexture(),$._glTextures[this.CONTEXT_UID]&&(this.unbind($),J.deleteTexture($._glTextures[this.CONTEXT_UID].texture),$.off("dispose",this.destroyTexture,this),delete $._glTextures[this.CONTEXT_UID],!Z)){const Q=this.managedTextures.indexOf($);Q!==-1&&R9(this.managedTextures,Q,1)}}updateTextureStyle($){const Z=$._glTextures[this.CONTEXT_UID];Z&&(($.mipmap===s0.POW2||this.webGLVersion!==2)&&!$.isPowerOfTwo?Z.mipmap=!1:Z.mipmap=$.mipmap>=1,this.webGLVersion!==2&&!$.isPowerOfTwo?Z.wrapMode=z$.CLAMP:Z.wrapMode=$.wrapMode,$.resource?.style(this.renderer,$,Z)||this.setStyle($,Z),Z.dirtyStyleId=$.dirtyStyleId)}setStyle($,Z){const J=this.gl;if(Z.mipmap&&$.mipmap!==s0.ON_MANUAL&&J.generateMipmap($.target),J.texParameteri($.target,J.TEXTURE_WRAP_S,Z.wrapMode),J.texParameteri($.target,J.TEXTURE_WRAP_T,Z.wrapMode),Z.mipmap){J.texParameteri($.target,J.TEXTURE_MIN_FILTER,$.scaleMode===O$.LINEAR?J.LINEAR_MIPMAP_LINEAR:J.NEAREST_MIPMAP_NEAREST);const Q=this.renderer.context.extensions.anisotropicFiltering;if(Q&&$.anisotropicLevel>0&&$.scaleMode===O$.LINEAR){const K=Math.min($.anisotropicLevel,J.getParameter(Q.MAX_TEXTURE_MAX_ANISOTROPY_EXT));J.texParameterf($.target,Q.TEXTURE_MAX_ANISOTROPY_EXT,K)}}else J.texParameteri($.target,J.TEXTURE_MIN_FILTER,$.scaleMode===O$.LINEAR?J.LINEAR:J.NEAREST);J.texParameteri($.target,J.TEXTURE_MAG_FILTER,$.scaleMode===O$.LINEAR?J.LINEAR:J.NEAREST)}destroy(){this.renderer=null}}A5.extension={type:I.RendererSystem,name:"texture"};P.add(A5);class M5{constructor($){this.renderer=$}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind($){const{gl:Z,CONTEXT_UID:J}=this,Q=$._glTransformFeedbacks[J]||this.createGLTransformFeedback($);Z.bindTransformFeedback(Z.TRANSFORM_FEEDBACK,Q)}unbind(){const{gl:$}=this;$.bindTransformFeedback($.TRANSFORM_FEEDBACK,null)}beginTransformFeedback($,Z){const{gl:J,renderer:Q}=this;Z&&Q.shader.bind(Z),J.beginTransformFeedback($)}endTransformFeedback(){const{gl:$}=this;$.endTransformFeedback()}createGLTransformFeedback($){const{gl:Z,renderer:J,CONTEXT_UID:Q}=this,K=Z.createTransformFeedback();$._glTransformFeedbacks[Q]=K,Z.bindTransformFeedback(Z.TRANSFORM_FEEDBACK,K);for(let q=0;q<$.buffers.length;q++){const V=$.buffers[q];V&&(J.buffer.update(V),V._glBuffers[Q].refCount++,Z.bindBufferBase(Z.TRANSFORM_FEEDBACK_BUFFER,q,V._glBuffers[Q].buffer||null))}return Z.bindTransformFeedback(Z.TRANSFORM_FEEDBACK,null),$.disposeRunner.add(this),K}disposeTransformFeedback($,Z){const J=$._glTransformFeedbacks[this.CONTEXT_UID],Q=this.gl;$.disposeRunner.remove(this);const K=this.renderer.buffer;if(K)for(let q=0;q<$.buffers.length;q++){const V=$.buffers[q];if(!V)continue;const X=V._glBuffers[this.CONTEXT_UID];X&&(X.refCount--,X.refCount===0&&!Z&&K.dispose(V,Z))}J&&(Z||Q.deleteTransformFeedback(J),delete $._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}M5.extension={type:I.RendererSystem,name:"transformFeedback"};P.add(M5);class $6{constructor($){this.renderer=$}init($){this.screen=new m(0,0,$.width,$.height),this.element=$.view||R.ADAPTER.createCanvas(),this.resolution=$.resolution||R.RESOLUTION,this.autoDensity=!!$.autoDensity}resizeView($,Z){this.element.width=Math.round($*this.resolution),this.element.height=Math.round(Z*this.resolution);const J=this.element.width/this.resolution,Q=this.element.height/this.resolution;this.screen.width=J,this.screen.height=Q,this.autoDensity&&(this.element.style.width=`${J}px`,this.element.style.height=`${Q}px`),this.renderer.emit("resize",J,Q),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy($){$&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}$6.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},$6.extension={type:[I.RendererSystem,I.CanvasRendererSystem],name:"_view"};P.add($6);R.PREFER_ENV=M$.WEBGL2;R.STRICT_TEXTURE_CACHE=!1;R.RENDER_OPTIONS={...r8.defaultOptions,...a8.defaultOptions,...$6.defaultOptions,...e8.defaultOptions};Object.defineProperties(R,{WRAP_MODE:{get(){return n.defaultOptions.wrapMode},set($){t("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),n.defaultOptions.wrapMode=$}},SCALE_MODE:{get(){return n.defaultOptions.scaleMode},set($){t("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),n.defaultOptions.scaleMode=$}},MIPMAP_TEXTURES:{get(){return n.defaultOptions.mipmap},set($){t("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),n.defaultOptions.mipmap=$}},ANISOTROPIC_LEVEL:{get(){return n.defaultOptions.anisotropicLevel},set($){t("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),n.defaultOptions.anisotropicLevel=$}},FILTER_RESOLUTION:{get(){return t("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),w0.defaultResolution},set($){w0.defaultResolution=$}},FILTER_MULTISAMPLE:{get(){return t("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),w0.defaultMultisample},set($){w0.defaultMultisample=$}},SPRITE_MAX_TEXTURES:{get(){return S8.defaultMaxTextures},set($){t("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),S8.defaultMaxTextures=$}},SPRITE_BATCH_SIZE:{get(){return S8.defaultBatchSize},set($){t("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),S8.defaultBatchSize=$}},CAN_UPLOAD_SAME_BUFFER:{get(){return S8.canUploadSameBuffer},set($){t("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),S8.canUploadSameBuffer=$}},GC_MODE:{get(){return G8.defaultMode},set($){t("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),G8.defaultMode=$}},GC_MAX_IDLE:{get(){return G8.defaultMaxIdle},set($){t("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),G8.defaultMaxIdle=$}},GC_MAX_CHECK_COUNT:{get(){return G8.defaultCheckCountMax},set($){t("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),G8.defaultCheckCountMax=$}},PRECISION_VERTEX:{get(){return J$.defaultVertexPrecision},set($){t("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),J$.defaultVertexPrecision=$}},PRECISION_FRAGMENT:{get(){return J$.defaultFragmentPrecision},set($){t("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),J$.defaultFragmentPrecision=$}}});var T$=(($)=>($[$.INTERACTION=50]="INTERACTION",$[$.HIGH=25]="HIGH",$[$.NORMAL=0]="NORMAL",$[$.LOW=-25]="LOW",$[$.UTILITY=-50]="UTILITY",$))(T$||{});class k5{constructor($,Z=null,J=0,Q=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=$,this.context=Z,this.priority=J,this.once=Q}match($,Z=null){return this.fn===$&&this.context===Z}emit($){this.fn&&(this.context?this.fn.call(this.context,$):this.fn($));const Z=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),Z}connect($){this.previous=$,$.next&&($.next.previous=this),this.next=$.next,$.next=this}destroy($=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const Z=this.next;return this.next=$?null:Z,this.previous=null,Z}}var qX=class ${constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new k5(null,null,Infinity),this.deltaMS=1/$.targetFPMS,this.elapsedMS=1/$.targetFPMS,this._tick=(Z)=>{this._requestId=null,this.started&&(this.update(Z),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(Z,J,Q=T$.NORMAL){return this._addListener(new k5(Z,J,Q))}addOnce(Z,J,Q=T$.NORMAL){return this._addListener(new k5(Z,J,Q,!0))}_addListener(Z){let J=this._head.next,Q=this._head;if(!J)Z.connect(Q);else{for(;J;){if(Z.priority>J.priority){Z.connect(Q);break}Q=J,J=J.next}Z.previous||Z.connect(Q)}return this._startIfPossible(),this}remove(Z,J){let Q=this._head.next;for(;Q;)Q.match(Z,J)?Q=Q.destroy():Q=Q.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let Z=0,J=this._head;for(;J=J.next;)Z++;return Z}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let Z=this._head.next;for(;Z;)Z=Z.destroy(!0);this._head.destroy(),this._head=null}}update(Z=performance.now()){let J;if(Z>this.lastTime){if(J=this.elapsedMS=Z-this.lastTime,J>this._maxElapsedMS&&(J=this._maxElapsedMS),J*=this.speed,this._minElapsedMS){const q=Z-this._lastFrame|0;if(q<this._minElapsedMS)return;this._lastFrame=Z-q%this._minElapsedMS}this.deltaMS=J,this.deltaTime=this.deltaMS*$.targetFPMS;const Q=this._head;let K=Q.next;for(;K;)K=K.emit(this.deltaTime);Q.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=Z}get FPS(){return 1000/this.elapsedMS}get minFPS(){return 1000/this._maxElapsedMS}set minFPS(Z){const J=Math.min(this.maxFPS,Z),Q=Math.min(Math.max(0,J)/1000,$.targetFPMS);this._maxElapsedMS=1/Q}get maxFPS(){return this._minElapsedMS?Math.round(1000/this._minElapsedMS):0}set maxFPS(Z){if(Z===0)this._minElapsedMS=0;else{const J=Math.max(this.minFPS,Z);this._minElapsedMS=1/(J/1000)}}static get shared(){if(!$._shared){const Z=$._shared=new $;Z.autoStart=!0,Z._protected=!0}return $._shared}static get system(){if(!$._system){const Z=$._system=new $;Z.autoStart=!0,Z._protected=!0}return $._system}};qX.targetFPMS=0.06;var N0=qX;Object.defineProperties(R,{TARGET_FPMS:{get(){return N0.targetFPMS},set($){t("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),N0.targetFPMS=$}}});class s9{static init($){$=Object.assign({autoStart:!0,sharedTicker:!1},$),Object.defineProperty(this,"ticker",{set(Z){this._ticker&&this._ticker.remove(this.render,this),this._ticker=Z,Z&&Z.add(this.render,this,T$.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=$.sharedTicker?N0.shared:new N0,$.autoStart&&this.start()}static destroy(){if(this._ticker){const $=this._ticker;this.ticker=null,$.destroy()}}}s9.extension=I.Application;P.add(s9);var W1=function($){for(let Z of VX)if(Z.test($))return new Z($);throw new Error("Unable to auto-detect a suitable renderer.")},VX=[];P.handleByList(I.Renderer,VX);var XX=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`;var WX=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var U1=XX,E5=WX;class i9{constructor($){this.renderer=$}contextChange($){let Z;if(this.renderer.context.webGLVersion===1){const J=$.getParameter($.FRAMEBUFFER_BINDING);$.bindFramebuffer($.FRAMEBUFFER,null),Z=$.getParameter($.SAMPLES),$.bindFramebuffer($.FRAMEBUFFER,J)}else{const J=$.getParameter($.DRAW_FRAMEBUFFER_BINDING);$.bindFramebuffer($.DRAW_FRAMEBUFFER,null),Z=$.getParameter($.SAMPLES),$.bindFramebuffer($.DRAW_FRAMEBUFFER,J)}Z>=U0.HIGH?this.multisample=U0.HIGH:Z>=U0.MEDIUM?this.multisample=U0.MEDIUM:Z>=U0.LOW?this.multisample=U0.LOW:this.multisample=U0.NONE}destroy(){}}i9.extension={type:I.RendererSystem,name:"_multisample"};P.add(i9);class z1{constructor($){this.buffer=$||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class a9{constructor($){this.renderer=$,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind($){const{gl:Z,CONTEXT_UID:J}=this,Q=$._glBuffers[J]||this.createGLBuffer($);Z.bindBuffer($.type,Q.buffer)}unbind($){const{gl:Z}=this;Z.bindBuffer($,null)}bindBufferBase($,Z){const{gl:J,CONTEXT_UID:Q}=this;if(this.boundBufferBases[Z]!==$){const K=$._glBuffers[Q]||this.createGLBuffer($);this.boundBufferBases[Z]=$,J.bindBufferBase(J.UNIFORM_BUFFER,Z,K.buffer)}}bindBufferRange($,Z,J){const{gl:Q,CONTEXT_UID:K}=this;J=J||0;const q=$._glBuffers[K]||this.createGLBuffer($);Q.bindBufferRange(Q.UNIFORM_BUFFER,Z||0,q.buffer,J*256,256)}update($){const{gl:Z,CONTEXT_UID:J}=this,Q=$._glBuffers[J]||this.createGLBuffer($);if($._updateID!==Q.updateID)if(Q.updateID=$._updateID,Z.bindBuffer($.type,Q.buffer),Q.byteLength>=$.data.byteLength)Z.bufferSubData($.type,0,$.data);else{const K=$.static?Z.STATIC_DRAW:Z.DYNAMIC_DRAW;Q.byteLength=$.data.byteLength,Z.bufferData($.type,$.data,K)}}dispose($,Z){if(!this.managedBuffers[$.id])return;delete this.managedBuffers[$.id];const J=$._glBuffers[this.CONTEXT_UID],Q=this.gl;$.disposeRunner.remove(this),J&&(Z||Q.deleteBuffer(J.buffer),delete $._glBuffers[this.CONTEXT_UID])}disposeAll($){const Z=Object.keys(this.managedBuffers);for(let J=0;J<Z.length;J++)this.dispose(this.managedBuffers[Z[J]],$)}createGLBuffer($){const{CONTEXT_UID:Z,gl:J}=this;return $._glBuffers[Z]=new z1(J.createBuffer()),this.managedBuffers[$.id]=$,$.disposeRunner.add(this),$._glBuffers[Z]}}a9.extension={type:I.RendererSystem,name:"buffer"};P.add(a9);class r9{constructor($){this.renderer=$}render($,Z){const J=this.renderer;let Q,K,q,V;if(Z&&(Q=Z.renderTexture,K=Z.clear,q=Z.transform,V=Z.skipUpdateTransform),this.renderingToScreen=!Q,J.runners.prerender.emit(),J.emit("prerender"),J.projection.transform=q,!J.context.isLost){if(Q||(this.lastObjectRendered=$),!V){const X=$.enableTempParent();$.updateTransform(),$.disableTempParent(X)}J.renderTexture.bind(Q),J.batch.currentRenderer.start(),(K??J.background.clearBeforeRender)&&J.renderTexture.clear(),$.render(J),J.batch.currentRenderer.flush(),Q&&(Z.blit&&J.framebuffer.blit(),Q.baseTexture.update()),J.runners.postrender.emit(),J.projection.transform=null,J.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}r9.extension={type:I.RendererSystem,name:"objectRenderer"};P.add(r9);var t9=class $ extends P5{constructor(Z){super(),this.type=YJ.WEBGL,Z=Object.assign({},R.RENDER_OPTIONS,Z),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new i0({projectionMatrix:new Z0},!0);const J={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:$.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(J),("useContextAlpha"in Z)&&(t("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),Z.premultipliedAlpha=Z.useContextAlpha&&Z.useContextAlpha!=="notMultiplied",Z.backgroundAlpha=Z.useContextAlpha===!1?1:Z.backgroundAlpha),this._plugin.rendererPlugins=$.__plugins,this.options=Z,this.startup.run(this.options)}static test(Z){return Z?.forceCanvas?!1:_9()}render(Z,J){this.objectRenderer.render(Z,J)}resize(Z,J){this._view.resizeView(Z,J)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(Z=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:Z}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(Z){this._view.resolution=Z,this.runners.resolutionChange.emit(Z)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return t("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return t("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return t("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return t("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(Z){t("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=Z}get backgroundAlpha(){return t("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(Z){t("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=Z}get powerPreference(){return t("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(Z,J){return this.textureGenerator.generateTexture(Z,J)}};t9.extension={type:I.Renderer,priority:1},t9.__plugins={},t9.__systems={};var e9=t9;P.handleByMap(I.RendererPlugin,e9.__plugins);P.handleByMap(I.RendererSystem,e9.__systems);P.add(e9);class M6 extends m${constructor($,Z){const{width:J,height:Q}=Z||{};super(J,Q),this.items=[],this.itemDirtyIds=[];for(let K=0;K<$;K++){const q=new n;this.items.push(q),this.itemDirtyIds.push(-2)}this.length=$,this._load=null,this.baseTexture=null}initFromArray($,Z){for(let J=0;J<this.length;J++)$[J]&&($[J].castToBaseTexture?this.addBaseTextureAt($[J].castToBaseTexture(),J):$[J]instanceof m$?this.addResourceAt($[J],J):this.addResourceAt($7($[J],Z),J))}dispose(){for(let $=0,Z=this.length;$<Z;$++)this.items[$].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt($,Z){if(!this.items[Z])throw new Error(`Index ${Z} is out of bounds`);return $.valid&&!this.valid&&this.resize($.width,$.height),this.items[Z].setResource($),this}bind($){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind($);for(let Z=0;Z<this.length;Z++)this.items[Z].parentTextureArray=$,this.items[Z].on("update",$.update,$)}unbind($){super.unbind($);for(let Z=0;Z<this.length;Z++)this.items[Z].parentTextureArray=null,this.items[Z].off("update",$.update,$)}load(){if(this._load)return this._load;const $=this.items.map((Z)=>Z.resource).filter((Z)=>Z).map((Z)=>Z.load());return this._load=Promise.all($).then(()=>{const{realWidth:Z,realHeight:J}=this.items[0];return this.resize(Z,J),this.update(),Promise.resolve(this)}),this._load}}class $Z extends M6{constructor($,Z){const{width:J,height:Q}=Z||{};let K,q;Array.isArray($)?(K=$,q=$.length):q=$,super(q,{width:J,height:Q}),K&&this.initFromArray(K,Z)}addBaseTextureAt($,Z){if($.resource)this.addResourceAt($.resource,Z);else throw new Error("ArrayResource does not support RenderTexture");return this}bind($){super.bind($),$.target=T8.TEXTURE_2D_ARRAY}upload($,Z,J){const{length:Q,itemDirtyIds:K,items:q}=this,{gl:V}=$;J.dirtyId<0&&V.texImage3D(V.TEXTURE_2D_ARRAY,0,J.internalFormat,this._width,this._height,Q,0,Z.format,J.type,null);for(let X=0;X<Q;X++){const W=q[X];K[X]<W.dirtyId&&(K[X]=W.dirtyId,W.valid&&V.texSubImage3D(V.TEXTURE_2D_ARRAY,0,0,0,X,W.resource.width,W.resource.height,1,Z.format,J.type,W.resource.source))}return!0}}class ZZ extends Q${constructor($){super($)}static test($){const{OffscreenCanvas:Z}=globalThis;return Z&&$ instanceof Z?!0:globalThis.HTMLCanvasElement&&$ instanceof HTMLCanvasElement}}var UX=class $ extends M6{constructor(Z,J){const{width:Q,height:K,autoLoad:q,linkBaseTexture:V}=J||{};if(Z&&Z.length!==$.SIDES)throw new Error(`Invalid length. Got ${Z.length}, expected 6`);super(6,{width:Q,height:K});for(let X=0;X<$.SIDES;X++)this.items[X].target=T8.TEXTURE_CUBE_MAP_POSITIVE_X+X;this.linkBaseTexture=V!==!1,Z&&this.initFromArray(Z,J),q!==!1&&this.load()}bind(Z){super.bind(Z),Z.target=T8.TEXTURE_CUBE_MAP}addBaseTextureAt(Z,J,Q){if(Q===void 0&&(Q=this.linkBaseTexture),!this.items[J])throw new Error(`Index ${J} is out of bounds`);if(!this.linkBaseTexture||Z.parentTextureArray||Object.keys(Z._glTextures).length>0)if(Z.resource)this.addResourceAt(Z.resource,J);else throw new Error("CubeResource does not support copying of renderTexture.");else Z.target=T8.TEXTURE_CUBE_MAP_POSITIVE_X+J,Z.parentTextureArray=this.baseTexture,this.items[J]=Z;return Z.valid&&!this.valid&&this.resize(Z.realWidth,Z.realHeight),this.items[J]=Z,this}upload(Z,J,Q){const K=this.itemDirtyIds;for(let q=0;q<$.SIDES;q++){const V=this.items[q];(K[q]<V.dirtyId||Q.dirtyId<J.dirtyId)&&(V.valid&&V.resource?(V.resource.upload(Z,V,Q),K[q]=V.dirtyId):K[q]<-1&&(Z.gl.texImage2D(V.target,0,Q.internalFormat,J.realWidth,J.realHeight,0,J.format,Q.type,null),K[q]=-1))}return!0}static test(Z){return Array.isArray(Z)&&Z.length===$.SIDES}};UX.SIDES=6;var H1=UX;class Z6 extends Q${constructor($,Z){Z=Z||{};let J,Q,K;typeof $=="string"?(J=Z6.EMPTY,Q=$,K=!0):(J=$,Q=null,K=!1),super(J),this.url=Q,this.crossOrigin=Z.crossOrigin??!0,this.alphaMode=typeof Z.alphaMode=="number"?Z.alphaMode:null,this.ownsImageBitmap=Z.ownsImageBitmap??K,this._load=null,Z.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async($,Z)=>{if(this.url===null){$(this);return}try{const J=await R.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const Q=await J.blob();if(this.destroyed)return;const K=await createImageBitmap(Q,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===_0.UNPACK?"premultiply":"none"});if(this.destroyed){K.close();return}this.source=K,this.update(),$(this)}catch(J){if(this.destroyed)return;Z(J),this.onError.emit(J)}}),this._load)}upload($,Z,J){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(Z.alphaMode=this.alphaMode),super.upload($,Z,J)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test($){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof $=="string"||$ instanceof ImageBitmap)}static get EMPTY(){return Z6._EMPTY=Z6._EMPTY??R.ADAPTER.createCanvas(0,0),Z6._EMPTY}}var G1=class $ extends Q${constructor(Z,J){J=J||{},super(R.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=Z,this.scale=J.scale||1,this._overrideWidth=J.width,this._overrideHeight=J.height,this._resolve=null,this._crossorigin=J.crossorigin,this._load=null,J.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise((Z)=>{if(this._resolve=()=>{this.update(),Z(this)},$.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const Z=new Image;Q$.crossOrigin(Z,this.svg,this._crossorigin),Z.src=this.svg,Z.onerror=(J)=>{this._resolve&&(Z.onerror=null,this.onError.emit(J))},Z.onload=()=>{if(!this._resolve)return;const{width:J,height:Q}=Z;if(!J||!Q)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let K=J*this.scale,q=Q*this.scale;(this._overrideWidth||this._overrideHeight)&&(K=this._overrideWidth||this._overrideHeight/Q*J,q=this._overrideHeight||this._overrideWidth/J*Q),K=Math.round(K),q=Math.round(q);const V=this.source;V.width=K,V.height=q,V._pixiId=`canvas_${X8()}`,V.getContext("2d").drawImage(Z,0,0,J,Q,0,0,K,q),this._resolve(),this._resolve=null}}static getSize(Z){const J=$.SVG_SIZE.exec(Z),Q={};return J&&(Q[J[1]]=Math.round(parseFloat(J[3])),Q[J[5]]=Math.round(parseFloat(J[7]))),Q}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(Z,J){return J==="svg"||typeof Z=="string"&&Z.startsWith("data:image/svg+xml")||typeof Z=="string"&&$.SVG_XML.test(Z)}};G1.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,G1.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var H7=G1;var Y1=class $ extends Q${constructor(Z,J){if(J=J||{},!(Z instanceof HTMLVideoElement)){const Q=document.createElement("video");J.autoLoad!==!1&&Q.setAttribute("preload","auto"),J.playsinline!==!1&&(Q.setAttribute("webkit-playsinline",""),Q.setAttribute("playsinline","")),J.muted===!0&&(Q.setAttribute("muted",""),Q.muted=!0),J.loop===!0&&Q.setAttribute("loop",""),J.autoPlay!==!1&&Q.setAttribute("autoplay",""),typeof Z=="string"&&(Z=[Z]);const K=Z[0].src||Z[0];Q$.crossOrigin(Q,K,J.crossorigin);for(let q=0;q<Z.length;++q){const V=document.createElement("source");let{src:X,mime:W}=Z[q];if(X=X||Z[q],X.startsWith("data:"))W=X.slice(5,X.indexOf(";"));else if(!X.startsWith("blob:")){const U=X.split("?").shift().toLowerCase(),z=U.slice(U.lastIndexOf(".")+1);W=W||$.MIME_TYPES[z]||`video/${z}`}V.src=X,W&&(V.type=W),Q.appendChild(V)}Z=Q}super(Z),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=J.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=J.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),J.autoLoad!==!1&&this.load()}update(Z=0){if(!this.destroyed){if(this._updateFPS){const J=N0.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-J)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1000/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const Z=this.source;return(Z.readyState===Z.HAVE_ENOUGH_DATA||Z.readyState===Z.HAVE_FUTURE_DATA)&&Z.width&&Z.height&&(Z.complete=!0),Z.addEventListener("play",this._onPlayStart),Z.addEventListener("pause",this._onPlayStop),Z.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(Z.addEventListener("canplay",this._onCanPlay),Z.addEventListener("canplaythrough",this._onCanPlay),Z.addEventListener("error",this._onError,!0)),this._load=new Promise((J,Q)=>{this.valid?J(this):(this._resolve=J,this._reject=Q,Z.load())}),this._load}_onError(Z){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(Z),this._reject&&(this._reject(Z),this._reject=null,this._resolve=null)}_isSourcePlaying(){const Z=this.source;return!Z.paused&&!Z.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const Z=this.source;Z.removeEventListener("canplay",this._onCanPlay),Z.removeEventListener("canplaythrough",this._onCanPlay);const J=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!J&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&Z.play()}dispose(){this._configureAutoUpdate();const Z=this.source;Z&&(Z.removeEventListener("play",this._onPlayStart),Z.removeEventListener("pause",this._onPlayStop),Z.removeEventListener("seeked",this._onSeeked),Z.removeEventListener("canplay",this._onCanPlay),Z.removeEventListener("canplaythrough",this._onCanPlay),Z.removeEventListener("error",this._onError,!0),Z.pause(),Z.src="",Z.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(Z){Z!==this._autoUpdate&&(this._autoUpdate=Z,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(Z){Z!==this._updateFPS&&(this._updateFPS=Z,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(N0.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(N0.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(N0.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(Z,J){return globalThis.HTMLVideoElement&&Z instanceof HTMLVideoElement||$.TYPES.includes(J)}};Y1.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Y1.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};var T5=Y1;q5.push(Z6,X7,ZZ,T5,H7,W8,H1,$Z);class h8{constructor(){this.minX=Infinity,this.minY=Infinity,this.maxX=(-Infinity),this.maxY=(-Infinity),this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=Infinity,this.minY=Infinity,this.maxX=(-Infinity),this.maxY=(-Infinity)}getRectangle($){return this.minX>this.maxX||this.minY>this.maxY?m.EMPTY:($=$||new m(0,0,1,1),$.x=this.minX,$.y=this.minY,$.width=this.maxX-this.minX,$.height=this.maxY-this.minY,$)}addPoint($){this.minX=Math.min(this.minX,$.x),this.maxX=Math.max(this.maxX,$.x),this.minY=Math.min(this.minY,$.y),this.maxY=Math.max(this.maxY,$.y)}addPointMatrix($,Z){const{a:J,b:Q,c:K,d:q,tx:V,ty:X}=$,W=J*Z.x+K*Z.y+V,U=Q*Z.x+q*Z.y+X;this.minX=Math.min(this.minX,W),this.maxX=Math.max(this.maxX,W),this.minY=Math.min(this.minY,U),this.maxY=Math.max(this.maxY,U)}addQuad($){let Z=this.minX,J=this.minY,Q=this.maxX,K=this.maxY,q=$[0],V=$[1];Z=q<Z?q:Z,J=V<J?V:J,Q=q>Q?q:Q,K=V>K?V:K,q=$[2],V=$[3],Z=q<Z?q:Z,J=V<J?V:J,Q=q>Q?q:Q,K=V>K?V:K,q=$[4],V=$[5],Z=q<Z?q:Z,J=V<J?V:J,Q=q>Q?q:Q,K=V>K?V:K,q=$[6],V=$[7],Z=q<Z?q:Z,J=V<J?V:J,Q=q>Q?q:Q,K=V>K?V:K,this.minX=Z,this.minY=J,this.maxX=Q,this.maxY=K}addFrame($,Z,J,Q,K){this.addFrameMatrix($.worldTransform,Z,J,Q,K)}addFrameMatrix($,Z,J,Q,K){const{a:q,b:V,c:X,d:W,tx:U,ty:z}=$;let H=this.minX,G=this.minY,Y=this.maxX,w=this.maxY,j=q*Z+X*J+U,B=V*Z+W*J+z;H=j<H?j:H,G=B<G?B:G,Y=j>Y?j:Y,w=B>w?B:w,j=q*Q+X*J+U,B=V*Q+W*J+z,H=j<H?j:H,G=B<G?B:G,Y=j>Y?j:Y,w=B>w?B:w,j=q*Z+X*K+U,B=V*Z+W*K+z,H=j<H?j:H,G=B<G?B:G,Y=j>Y?j:Y,w=B>w?B:w,j=q*Q+X*K+U,B=V*Q+W*K+z,H=j<H?j:H,G=B<G?B:G,Y=j>Y?j:Y,w=B>w?B:w,this.minX=H,this.minY=G,this.maxX=Y,this.maxY=w}addVertexData($,Z,J){let Q=this.minX,K=this.minY,q=this.maxX,V=this.maxY;for(let X=Z;X<J;X+=2){const W=$[X],U=$[X+1];Q=W<Q?W:Q,K=U<K?U:K,q=W>q?W:q,V=U>V?U:V}this.minX=Q,this.minY=K,this.maxX=q,this.maxY=V}addVertices($,Z,J,Q){this.addVerticesMatrix($.worldTransform,Z,J,Q)}addVerticesMatrix($,Z,J,Q,K=0,q=K){const{a:V,b:X,c:W,d:U,tx:z,ty:H}=$;let G=this.minX,Y=this.minY,w=this.maxX,j=this.maxY;for(let B=J;B<Q;B+=2){const C=Z[B],N=Z[B+1],F=V*C+W*N+z,L=U*N+X*C+H;G=Math.min(G,F-K),w=Math.max(w,F+K),Y=Math.min(Y,L-q),j=Math.max(j,L+q)}this.minX=G,this.minY=Y,this.maxX=w,this.maxY=j}addBounds($){const Z=this.minX,J=this.minY,Q=this.maxX,K=this.maxY;this.minX=$.minX<Z?$.minX:Z,this.minY=$.minY<J?$.minY:J,this.maxX=$.maxX>Q?$.maxX:Q,this.maxY=$.maxY>K?$.maxY:K}addBoundsMask($,Z){const J=$.minX>Z.minX?$.minX:Z.minX,Q=$.minY>Z.minY?$.minY:Z.minY,K=$.maxX<Z.maxX?$.maxX:Z.maxX,q=$.maxY<Z.maxY?$.maxY:Z.maxY;if(J<=K&&Q<=q){const V=this.minX,X=this.minY,W=this.maxX,U=this.maxY;this.minX=J<V?J:V,this.minY=Q<X?Q:X,this.maxX=K>W?K:W,this.maxY=q>U?q:U}}addBoundsMatrix($,Z){this.addFrameMatrix(Z,$.minX,$.minY,$.maxX,$.maxY)}addBoundsArea($,Z){const J=$.minX>Z.x?$.minX:Z.x,Q=$.minY>Z.y?$.minY:Z.y,K=$.maxX<Z.x+Z.width?$.maxX:Z.x+Z.width,q=$.maxY<Z.y+Z.height?$.maxY:Z.y+Z.height;if(J<=K&&Q<=q){const V=this.minX,X=this.minY,W=this.maxX,U=this.maxY;this.minX=J<V?J:V,this.minY=Q<X?Q:X,this.maxX=K>W?K:W,this.maxY=q>U?q:U}}pad($=0,Z=$){this.isEmpty()||(this.minX-=$,this.maxX+=$,this.minY-=Z,this.maxY+=Z)}addFramePad($,Z,J,Q,K,q){$-=K,Z-=q,J+=K,Q+=q,this.minX=this.minX<$?this.minX:$,this.maxX=this.maxX>J?this.maxX:J,this.minY=this.minY<Z?this.minY:Z,this.maxY=this.maxY>Q?this.maxY:Q}}class W0 extends T.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new i8,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new h8,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin($){const Z=Object.keys($);for(let J=0;J<Z.length;++J){const Q=Z[J];Object.defineProperty(W0.prototype,Q,Object.getOwnPropertyDescriptor($,Q))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds($,Z){return $||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),Z||(this._boundsRect||(this._boundsRect=new m),Z=this._boundsRect),this._bounds.getRectangle(Z)}getLocalBounds($){$||(this._localBoundsRect||(this._localBoundsRect=new m),$=this._localBoundsRect),this._localBounds||(this._localBounds=new h8);const Z=this.transform,J=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=J?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;const Q=this._bounds,K=this._boundsID;this._bounds=this._localBounds;const q=this.getBounds(!1,$);return this.parent=J,this.transform=Z,this._bounds=Q,this._bounds.updateID+=this._boundsID-K,q}toGlobal($,Z,J=!1){return J||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply($,Z)}toLocal($,Z,J,Q){return Z&&($=Z.toGlobal($,J,Q)),Q||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse($,J)}setParent($){if(!$||!$.addChild)throw new Error("setParent: Argument must be a Container");return $.addChild(this),$}removeFromParent(){this.parent?.removeChild(this)}setTransform($=0,Z=0,J=1,Q=1,K=0,q=0,V=0,X=0,W=0){return this.position.x=$,this.position.y=Z,this.scale.x=J||1,this.scale.y=Q||1,this.rotation=K,this.skew.x=q,this.skew.y=V,this.pivot.x=X,this.pivot.y=W,this}destroy($){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new w1),this.tempDisplayObjectParent}enableTempParent(){const $=this.parent;return this.parent=this._tempDisplayObjectParent,$}disableTempParent($){this.parent=$}get x(){return this.position.x}set x($){this.transform.position.x=$}get y(){return this.position.y}set y($){this.transform.position.y=$}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position($){this.transform.position.copyFrom($)}get scale(){return this.transform.scale}set scale($){this.transform.scale.copyFrom($)}get pivot(){return this.transform.pivot}set pivot($){this.transform.pivot.copyFrom($)}get skew(){return this.transform.skew}set skew($){this.transform.skew.copyFrom($)}get rotation(){return this.transform.rotation}set rotation($){this.transform.rotation=$}get angle(){return this.transform.rotation*nJ}set angle($){this.transform.rotation=$*oJ}get zIndex(){return this._zIndex}set zIndex($){this._zIndex=$,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let $=this;do{if(!$.visible)return!1;$=$.parent}while($);return!0}get mask(){return this._mask}set mask($){if(this._mask!==$){if(this._mask){const Z=this._mask.isMaskData?this._mask.maskObject:this._mask;Z&&(Z._maskRefCount--,Z._maskRefCount===0&&(Z.renderable=!0,Z.isMask=!1))}if(this._mask=$,this._mask){const Z=this._mask.isMaskData?this._mask.maskObject:this._mask;Z&&(Z._maskRefCount===0&&(Z.renderable=!1,Z.isMask=!0),Z._maskRefCount++)}}}}class w1 extends W0{constructor(){super(...arguments),this.sortDirty=null}}W0.prototype.displayObjectUpdateTransform=W0.prototype.updateTransform;var Iw=function($,Z){return $.zIndex===Z.zIndex?$._lastSortedIndex-Z._lastSortedIndex:$.zIndex-Z.zIndex},Ow=new Z0,zX=class $ extends W0{constructor(){super(),this.children=[],this.sortableChildren=$.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(Z){}addChild(...Z){if(Z.length>1)for(let J=0;J<Z.length;J++)this.addChild(Z[J]);else{const J=Z[0];J.parent&&J.parent.removeChild(J),J.parent=this,this.sortDirty=!0,J.transform._parentID=-1,this.children.push(J),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",J,this,this.children.length-1),J.emit("added",this)}return Z[0]}addChildAt(Z,J){if(J<0||J>this.children.length)throw new Error(`${Z}addChildAt: The index ${J} supplied is out of bounds ${this.children.length}`);return Z.parent&&Z.parent.removeChild(Z),Z.parent=this,this.sortDirty=!0,Z.transform._parentID=-1,this.children.splice(J,0,Z),this._boundsID++,this.onChildrenChange(J),Z.emit("added",this),this.emit("childAdded",Z,this,J),Z}swapChildren(Z,J){if(Z===J)return;const Q=this.getChildIndex(Z),K=this.getChildIndex(J);this.children[Q]=J,this.children[K]=Z,this.onChildrenChange(Q<K?Q:K)}getChildIndex(Z){const J=this.children.indexOf(Z);if(J===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return J}setChildIndex(Z,J){if(J<0||J>=this.children.length)throw new Error(`The index ${J} supplied is out of bounds ${this.children.length}`);const Q=this.getChildIndex(Z);T.removeItems(this.children,Q,1),this.children.splice(J,0,Z),this.onChildrenChange(J)}getChildAt(Z){if(Z<0||Z>=this.children.length)throw new Error(`getChildAt: Index (${Z}) does not exist.`);return this.children[Z]}removeChild(...Z){if(Z.length>1)for(let J=0;J<Z.length;J++)this.removeChild(Z[J]);else{const J=Z[0],Q=this.children.indexOf(J);if(Q===-1)return null;J.parent=null,J.transform._parentID=-1,T.removeItems(this.children,Q,1),this._boundsID++,this.onChildrenChange(Q),J.emit("removed",this),this.emit("childRemoved",J,this,Q)}return Z[0]}removeChildAt(Z){const J=this.getChildAt(Z);return J.parent=null,J.transform._parentID=-1,T.removeItems(this.children,Z,1),this._boundsID++,this.onChildrenChange(Z),J.emit("removed",this),this.emit("childRemoved",J,this,Z),J}removeChildren(Z=0,J=this.children.length){const Q=Z,K=J,q=K-Q;let V;if(q>0&&q<=K){V=this.children.splice(Q,q);for(let X=0;X<V.length;++X)V[X].parent=null,V[X].transform&&(V[X].transform._parentID=-1);this._boundsID++,this.onChildrenChange(Z);for(let X=0;X<V.length;++X)V[X].emit("removed",this),this.emit("childRemoved",V[X],this,X);return V}else if(q===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let Z=!1;for(let J=0,Q=this.children.length;J<Q;++J){const K=this.children[J];K._lastSortedIndex=J,!Z&&K.zIndex!==0&&(Z=!0)}Z&&this.children.length>1&&this.children.sort(Iw),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let Z=0,J=this.children.length;Z<J;++Z){const Q=this.children[Z];Q.visible&&Q.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let Z=0;Z<this.children.length;Z++){const J=this.children[Z];if(!(!J.visible||!J.renderable))if(J.calculateBounds(),J._mask){const Q=J._mask.isMaskData?J._mask.maskObject:J._mask;Q?(Q.calculateBounds(),this._bounds.addBoundsMask(J._bounds,Q._bounds)):this._bounds.addBounds(J._bounds)}else J.filterArea?this._bounds.addBoundsArea(J._bounds,J.filterArea):this._bounds.addBounds(J._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(Z,J=!1){const Q=super.getLocalBounds(Z);if(!J)for(let K=0,q=this.children.length;K<q;++K){const V=this.children[K];V.visible&&V.updateTransform()}return Q}_calculateBounds(){}_renderWithCulling(Z){const J=Z.renderTexture.sourceFrame;if(!(J.width>0&&J.height>0))return;let Q,K;this.cullArea?(Q=this.cullArea,K=this.worldTransform):this._render!==$.prototype._render&&(Q=this.getBounds(!0));const q=Z.projection.transform;if(q&&(K?(K=Ow.copyFrom(K),K.prepend(q)):K=q),Q&&J.intersects(Q,K))this._render(Z);else if(this.cullArea)return;for(let V=0,X=this.children.length;V<X;++V){const W=this.children[V],U=W.cullable;W.cullable=U||!this.cullArea,W.render(Z),W.cullable=U}}render(Z){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(Z);else if(this.cullable)this._renderWithCulling(Z);else{this._render(Z);for(let J=0,Q=this.children.length;J<Q;++J)this.children[J].render(Z)}}renderAdvanced(Z){const J=this.filters,Q=this._mask;if(J){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let q=0;q<J.length;q++)J[q].enabled&&this._enabledFilters.push(J[q])}const K=J&&this._enabledFilters?.length||Q&&(!Q.isMaskData||Q.enabled&&(Q.autoDetect||Q.type!==D0.NONE));if(K&&Z.batch.flush(),J&&this._enabledFilters?.length&&Z.filter.push(this,this._enabledFilters),Q&&Z.mask.push(this,this._mask),this.cullable)this._renderWithCulling(Z);else{this._render(Z);for(let q=0,V=this.children.length;q<V;++q)this.children[q].render(Z)}K&&Z.batch.flush(),Q&&Z.mask.pop(this),J&&this._enabledFilters?.length&&Z.filter.pop()}_render(Z){}destroy(Z){super.destroy(),this.sortDirty=!1;const J=typeof Z=="boolean"?Z:Z?.children,Q=this.removeChildren(0,this.children.length);if(J)for(let K=0;K<Q.length;++K)Q[K].destroy(Z)}get width(){return this.scale.x*this.getLocalBounds().width}set width(Z){const J=this.getLocalBounds().width;J!==0?this.scale.x=Z/J:this.scale.x=1,this._width=Z}get height(){return this.scale.y*this.getLocalBounds().height}set height(Z){const J=this.getLocalBounds().height;J!==0?this.scale.y=Z/J:this.scale.y=1,this._height=Z}};zX.defaultSortableChildren=!1;var r=zX;r.prototype.containerUpdateTransform=r.prototype.updateTransform;Object.defineProperties(R,{SORTABLE_CHILDREN:{get(){return r.defaultSortableChildren},set($){T.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),r.defaultSortableChildren=$}}});var JZ=function($,Z){if($){if(typeof $=="function")return $;if(typeof $=="string")return HX[$]}else return HX[Z]},Rw=Object.defineProperty,Pw=($,Z,J)=>(Z in $)?Rw($,Z,{enumerable:!0,configurable:!0,writable:!0,value:J}):$[Z]=J,D=($,Z,J)=>(Pw($,typeof Z!="symbol"?Z+"":Z,J),J);class b${constructor($){D(this,"parent"),D(this,"paused"),this.parent=$,this.paused=!1}destroy(){}down($){return!1}move($){return!1}up($){return!1}wheel($){return!1}update($){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}var Dw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},GX={exports:{}};(function($,Z){(function(){var J,Q;Q=function(K){return $.exports=K},J={linear:function(K,q,V,X){return V*K/X+q},easeInQuad:function(K,q,V,X){return V*(K/=X)*K+q},easeOutQuad:function(K,q,V,X){return-V*(K/=X)*(K-2)+q},easeInOutQuad:function(K,q,V,X){return(K/=X/2)<1?V/2*K*K+q:-V/2*(--K*(K-2)-1)+q},easeInCubic:function(K,q,V,X){return V*(K/=X)*K*K+q},easeOutCubic:function(K,q,V,X){return V*((K=K/X-1)*K*K+1)+q},easeInOutCubic:function(K,q,V,X){return(K/=X/2)<1?V/2*K*K*K+q:V/2*((K-=2)*K*K+2)+q},easeInQuart:function(K,q,V,X){return V*(K/=X)*K*K*K+q},easeOutQuart:function(K,q,V,X){return-V*((K=K/X-1)*K*K*K-1)+q},easeInOutQuart:function(K,q,V,X){return(K/=X/2)<1?V/2*K*K*K*K+q:-V/2*((K-=2)*K*K*K-2)+q},easeInQuint:function(K,q,V,X){return V*(K/=X)*K*K*K*K+q},easeOutQuint:function(K,q,V,X){return V*((K=K/X-1)*K*K*K*K+1)+q},easeInOutQuint:function(K,q,V,X){return(K/=X/2)<1?V/2*K*K*K*K*K+q:V/2*((K-=2)*K*K*K*K+2)+q},easeInSine:function(K,q,V,X){return-V*Math.cos(K/X*(Math.PI/2))+V+q},easeOutSine:function(K,q,V,X){return V*Math.sin(K/X*(Math.PI/2))+q},easeInOutSine:function(K,q,V,X){return-V/2*(Math.cos(Math.PI*K/X)-1)+q},easeInExpo:function(K,q,V,X){return K===0?q:V*Math.pow(2,10*(K/X-1))+q},easeOutExpo:function(K,q,V,X){return K===X?q+V:V*(-Math.pow(2,-10*K/X)+1)+q},easeInOutExpo:function(K,q,V,X){return(K/=X/2)<1?V/2*Math.pow(2,10*(K-1))+q:V/2*(-Math.pow(2,-10*--K)+2)+q},easeInCirc:function(K,q,V,X){return-V*(Math.sqrt(1-(K/=X)*K)-1)+q},easeOutCirc:function(K,q,V,X){return V*Math.sqrt(1-(K=K/X-1)*K)+q},easeInOutCirc:function(K,q,V,X){return(K/=X/2)<1?-V/2*(Math.sqrt(1-K*K)-1)+q:V/2*(Math.sqrt(1-(K-=2)*K)+1)+q},easeInElastic:function(K,q,V,X){var W,U,z;return z=1.70158,U=0,W=V,K===0||(K/=X),U||(U=X*0.3),W<Math.abs(V)?(W=V,z=U/4):z=U/(2*Math.PI)*Math.asin(V/W),-(W*Math.pow(2,10*(K-=1))*Math.sin((K*X-z)*(2*Math.PI)/U))+q},easeOutElastic:function(K,q,V,X){var W,U,z;return z=1.70158,U=0,W=V,K===0||(K/=X),U||(U=X*0.3),W<Math.abs(V)?(W=V,z=U/4):z=U/(2*Math.PI)*Math.asin(V/W),W*Math.pow(2,-10*K)*Math.sin((K*X-z)*(2*Math.PI)/U)+V+q},easeInOutElastic:function(K,q,V,X){var W,U,z;return z=1.70158,U=0,W=V,K===0||(K/=X/2),U||(U=X*0.44999999999999996),W<Math.abs(V)?(W=V,z=U/4):z=U/(2*Math.PI)*Math.asin(V/W),K<1?-0.5*(W*Math.pow(2,10*(K-=1))*Math.sin((K*X-z)*(2*Math.PI)/U))+q:W*Math.pow(2,-10*(K-=1))*Math.sin((K*X-z)*(2*Math.PI)/U)*0.5+V+q},easeInBack:function(K,q,V,X,W){return W===void 0&&(W=1.70158),V*(K/=X)*K*((W+1)*K-W)+q},easeOutBack:function(K,q,V,X,W){return W===void 0&&(W=1.70158),V*((K=K/X-1)*K*((W+1)*K+W)+1)+q},easeInOutBack:function(K,q,V,X,W){return W===void 0&&(W=1.70158),(K/=X/2)<1?V/2*(K*K*(((W*=1.525)+1)*K-W))+q:V/2*((K-=2)*K*(((W*=1.525)+1)*K+W)+2)+q},easeInBounce:function(K,q,V,X){var W;return W=J.easeOutBounce(X-K,0,V,X),V-W+q},easeOutBounce:function(K,q,V,X){return(K/=X)<0.36363636363636365?V*(7.5625*K*K)+q:K<0.7272727272727273?V*(7.5625*(K-=0.5454545454545454)*K+0.75)+q:K<0.9090909090909091?V*(7.5625*(K-=0.8181818181818182)*K+0.9375)+q:V*(7.5625*(K-=0.9545454545454546)*K+0.984375)+q},easeInOutBounce:function(K,q,V,X){var W;return K<X/2?(W=J.easeInBounce(K*2,0,V,X),W*0.5+q):(W=J.easeOutBounce(K*2-X,0,V,X),W*0.5+V*0.5+q)}},Q(J)}).call(Dw)})(GX);var HX=GX.exports,Aw={removeOnInterrupt:!1,ease:"linear",time:1000};class YX extends b${constructor($,Z={}){super($);D(this,"options"),D(this,"startX"),D(this,"startY"),D(this,"deltaX"),D(this,"deltaY"),D(this,"keepCenter"),D(this,"startWidth",null),D(this,"startHeight",null),D(this,"deltaWidth",null),D(this,"deltaHeight",null),D(this,"width",null),D(this,"height",null),D(this,"time",0),this.options=Object.assign({},Aw,Z),this.options.ease=JZ(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),this.width!==null&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),this.height!==null&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),this.width!==null&&this.parent.fitWidth(this.width,this.keepCenter,this.height===null),this.height!==null&&this.parent.fitHeight(this.height,this.keepCenter,this.width===null),!this.keepCenter&&this.options.position&&this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update($){if(this.paused)return;this.time+=$;const Z=new u(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){const J=this.parent.width,Q=this.parent.height;this.complete(),(J!==this.parent.width||Q!==this.parent.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:Z,type:"animate"})}else{const J=this.options.ease(this.time,0,1,this.options.time);if(this.width!==null){const Q=this.startWidth,K=this.deltaWidth;this.parent.fitWidth(Q+K*J,this.keepCenter,this.height===null)}if(this.height!==null){const Q=this.startHeight,K=this.deltaHeight;this.parent.fitHeight(Q+K*J,this.keepCenter,this.width===null)}if(this.width===null?this.parent.scale.x=this.parent.scale.y:this.height===null&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const Q=this.startX,K=this.startY,q=this.deltaX,V=this.deltaY,X=new u(this.parent.x,this.parent.y);this.parent.moveCenter(Q+q*J,K+V*J),this.parent.emit("moved",{viewport:this.parent,original:X,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:Z,type:"animate"})}}}var Mw={sides:"all",friction:0.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class wX extends b${constructor($,Z={}){super($);D(this,"options"),D(this,"left"),D(this,"top"),D(this,"right"),D(this,"bottom"),D(this,"underflowX"),D(this,"underflowY"),D(this,"ease"),D(this,"toX"),D(this,"toY"),this.options=Object.assign({},Mw,Z),this.ease=JZ(this.options.ease,"easeInOutSine"),this.options.sides?this.options.sides==="all"?this.top=this.bottom=this.left=this.right=!0:this.options.sides==="horizontal"?(this.right=this.left=!0,this.top=this.bottom=!1):this.options.sides==="vertical"?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=this.options.sides.indexOf("top")!==-1,this.bottom=this.options.sides.indexOf("bottom")!==-1,this.left=this.options.sides.indexOf("left")!==-1,this.right=this.options.sides.indexOf("right")!==-1):this.left=this.top=this.right=this.bottom=!1;const J=this.options.underflow.toLowerCase();J==="center"?(this.underflowX=0,this.underflowY=0):(this.underflowX=J.indexOf("left")!==-1?-1:J.indexOf("right")!==-1?1:0,this.underflowY=J.indexOf("top")!==-1?-1:J.indexOf("bottom")!==-1?1:0),this.reset()}isActive(){return this.toX!==null||this.toY!==null}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update($){if(!this.paused){if(this.bounce(),this.toX){const Z=this.toX;Z.time+=$,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),Z.time>=this.options.time?(this.parent.x=Z.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(Z.time,Z.start,Z.delta,this.options.time)}if(this.toY){const Z=this.toY;Z.time+=$,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),Z.time>=this.options.time?(this.parent.y=Z.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(Z.time,Z.start,Z.delta,this.options.time)}}}calcUnderflowX(){let $;switch(this.underflowX){case-1:$=0;break;case 1:$=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:$=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return $}calcUnderflowY(){let $;switch(this.underflowY){case-1:$=0;break;case 1:$=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:$=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return $}oob(){const $=this.options.bounceBox;if($){const Z=typeof $.x>"u"?0:$.x,J=typeof $.y>"u"?0:$.y,Q=typeof $.width>"u"?this.parent.worldWidth:$.width,K=typeof $.height>"u"?this.parent.worldHeight:$.height;return{left:this.parent.left<Z,right:this.parent.right>Q,top:this.parent.top<J,bottom:this.parent.bottom>K,topLeft:new u(Z*this.parent.scale.x,J*this.parent.scale.y),bottomRight:new u(Q*this.parent.scale.x-this.parent.screenWidth,K*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new u(0,0),bottomRight:new u(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){var $,Z;if(this.paused)return;let J,Q=this.parent.plugins.get("decelerate",!0);Q&&(Q.x||Q.y)&&(Q.x&&Q.percentChangeX===(($=Q.options)==null?void 0:$.friction)||Q.y&&Q.percentChangeY===((Z=Q.options)==null?void 0:Z.friction))&&(J=this.oob(),(J.left&&this.left||J.right&&this.right)&&(Q.percentChangeX=this.options.friction),(J.top&&this.top||J.bottom&&this.bottom)&&(Q.percentChangeY=this.options.friction));const K=this.parent.plugins.get("drag",!0)||{},q=this.parent.plugins.get("pinch",!0)||{};if(Q=Q||{},!(K!=null&&K.active)&&!(q!=null&&q.active)&&(!this.toX||!this.toY)&&(!Q.x||!Q.y)){J=J||this.oob();const{topLeft:V,bottomRight:X}=J;if(!this.toX&&!Q.x){let W=null;J.left&&this.left?W=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-V.x:J.right&&this.right&&(W=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-X.x),W!==null&&this.parent.x!==W&&(this.toX={time:0,start:this.parent.x,delta:W-this.parent.x,end:W},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!Q.y){let W=null;J.top&&this.top?W=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-V.y:J.bottom&&this.bottom&&(W=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-X.y),W!==null&&this.parent.y!==W&&(this.toY={time:0,start:this.parent.y,delta:W-this.parent.y,end:W},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}var kw={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class jX extends b${constructor($,Z={}){super($);D(this,"options"),D(this,"last"),D(this,"noUnderflow"),D(this,"underflowX"),D(this,"underflowY"),this.options=Object.assign({},kw,Z),this.options.direction&&(this.options.left=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.right=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.top=this.options.direction==="y"||this.options.direction==="all"?!0:null,this.options.bottom=this.options.direction==="y"||this.options.direction==="all"?!0:null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const $=this.options.underflow.toLowerCase();$==="none"?this.noUnderflow=!0:$==="center"?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=$.indexOf("left")!==-1?-1:$.indexOf("right")!==-1?1:0,this.underflowY=$.indexOf("top")!==-1?-1:$.indexOf("bottom")!==-1?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const $=new u(this.parent.x,this.parent.y),Z=this.parent.plugins.decelerate||{};if(this.options.left!==null||this.options.right!==null){let J=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x!==0&&(this.parent.x=0,J=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,J=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,J=!0)}else this.options.left!==null&&this.parent.left<(this.options.left===!0?0:this.options.left)&&(this.parent.x=-(this.options.left===!0?0:this.options.left)*this.parent.scale.x,Z.x=0,J=!0),this.options.right!==null&&this.parent.right>(this.options.right===!0?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(this.options.right===!0?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,Z.x=0,J=!0);J&&this.parent.emit("moved",{viewport:this.parent,original:$,type:"clamp-x"})}if(this.options.top!==null||this.options.bottom!==null){let J=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y!==0&&(this.parent.y=0,J=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,J=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,J=!0)}else this.options.top!==null&&this.parent.top<(this.options.top===!0?0:this.options.top)&&(this.parent.y=-(this.options.top===!0?0:this.options.top)*this.parent.scale.y,Z.y=0,J=!0),this.options.bottom!==null&&this.parent.bottom>(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,Z.y=0,J=!0);J&&this.parent.emit("moved",{viewport:this.parent,original:$,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}var Ew={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class BX extends b${constructor($,Z={}){super($);D(this,"options"),this.options=Object.assign({},Ew,Z),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused){if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let $=this.parent.worldScreenWidth,Z=this.parent.worldScreenHeight;if(this.options.minWidth!==null&&$<this.options.minWidth){const J=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/J,$=this.parent.worldScreenWidth,Z=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxWidth!==null&&$>this.options.maxWidth){const J=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/J,$=this.parent.worldScreenWidth,Z=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.minHeight!==null&&Z<this.options.minHeight){const J=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/J,$=this.parent.worldScreenWidth,Z=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxHeight!==null&&Z>this.options.maxHeight){const J=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/J,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const $={x:null,y:null},Z={x:null,y:null};if(typeof this.options.minScale=="number")$.x=this.options.minScale,$.y=this.options.minScale;else if(this.options.minScale!==null){const K=this.options.minScale;$.x=typeof K.x>"u"?null:K.x,$.y=typeof K.y>"u"?null:K.y}if(typeof this.options.maxScale=="number")Z.x=this.options.maxScale,Z.y=this.options.maxScale;else if(this.options.maxScale!==null){const K=this.options.maxScale;Z.x=typeof K.x>"u"?null:K.x,Z.y=typeof K.y>"u"?null:K.y}let J=this.parent.scale.x,Q=this.parent.scale.y;$.x!==null&&J<$.x&&(J=$.x),Z.x!==null&&J>Z.x&&(J=Z.x),$.y!==null&&Q<$.y&&(Q=$.y),Z.y!==null&&Q>Z.y&&(Q=Z.y),(J!==this.parent.scale.x||Q!==this.parent.scale.y)&&(this.parent.scale.set(J,Q),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}}reset(){this.clamp()}}var Tw={friction:0.98,bounce:0.8,minSpeed:0.01},J6=16;class FX extends b${constructor($,Z={}){super($);D(this,"options"),D(this,"x"),D(this,"y"),D(this,"percentChangeX"),D(this,"percentChangeY"),D(this,"saved"),D(this,"timeSinceRelease"),this.options=Object.assign({},Tw,Z),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",(J)=>this.handleMoved(J))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!!(this.x||this.y)}move(){if(this.paused)return!1;const $=this.parent.input.count();return($===1||$>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}handleMoved($){if(this.saved.length){const Z=this.saved[this.saved.length-1];$.type==="clamp-x"&&$.original?Z.x===$.original.x&&(Z.x=this.parent.x):$.type==="clamp-y"&&$.original&&Z.y===$.original.y&&(Z.y=this.parent.y)}}up(){if(this.parent.input.count()===0&&this.saved.length){const $=performance.now();for(let Z of this.saved)if(Z.time>=$-100){const J=$-Z.time;this.x=(this.parent.x-Z.x)/J,this.y=(this.parent.y-Z.y)/J,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate($){$=$||{},typeof $.x<"u"&&(this.x=$.x,this.percentChangeX=this.options.friction),typeof $.y<"u"&&(this.y=$.y,this.percentChangeY=this.options.friction)}update($){if(this.paused)return;const Z=this.x||this.y,J=this.timeSinceRelease,Q=this.timeSinceRelease+$;if(this.x){const K=this.percentChangeX,q=Math.log(K);this.parent.x+=this.x*J6/q*(Math.pow(K,Q/J6)-Math.pow(K,J/J6)),this.x*=Math.pow(this.percentChangeX,$/J6)}if(this.y){const K=this.percentChangeY,q=Math.log(K);this.parent.y+=this.y*J6/q*(Math.pow(K,Q/J6)-Math.pow(K,J/J6)),this.y*=Math.pow(this.percentChangeY,$/J6)}this.timeSinceRelease+=$,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),Z&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}var bw={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1};class NX extends b${constructor($,Z={}){super($);D(this,"options"),D(this,"moved"),D(this,"reverse"),D(this,"xDirection"),D(this,"yDirection"),D(this,"keyIsPressed"),D(this,"mouse"),D(this,"underflowX"),D(this,"underflowY"),D(this,"last"),D(this,"current"),D(this,"windowEventHandlers",[]),this.options=Object.assign({},bw,Z),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="x",this.yDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="y",this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses($){const Z=(Q)=>{$.includes(Q.code)&&(this.keyIsPressed=!0)},J=(Q)=>{$.includes(Q.code)&&(this.keyIsPressed=!1)};this.addWindowEventHandler("keyup",J),this.addWindowEventHandler("keydown",Z)}addWindowEventHandler($,Z){window.addEventListener($,Z),this.windowEventHandlers.push({event:$,handler:Z})}destroy(){this.windowEventHandlers.forEach(({event:$,handler:Z})=>{window.removeEventListener($,Z)})}mouseButtons($){!$||$==="all"?this.mouse=[!0,!0,!0]:this.mouse=[$.indexOf("left")!==-1,$.indexOf("middle")!==-1,$.indexOf("right")!==-1]}parseUnderflow(){const $=this.options.underflow.toLowerCase();$==="center"?(this.underflowX=0,this.underflowY=0):($.includes("left")?this.underflowX=-1:$.includes("right")?this.underflowX=1:this.underflowX=0,$.includes("top")?this.underflowY=-1:$.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons($){const Z=$.pointerType==="mouse",J=this.parent.input.count();return!!((J===1||J>1&&!this.parent.plugins.get("pinch",!0))&&(!Z||this.mouse[$.button]))}checkKeyPress($){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&$.data.pointerType==="touch"}down($){return this.paused||!this.options.pressDrag?!1:this.checkButtons($)&&this.checkKeyPress($)?(this.last={x:$.global.x,y:$.global.y},this.current=$.pointerId,!0):(this.last=null,!1)}get active(){return this.moved}move($){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===$.data.pointerId){const Z=$.global.x,J=$.global.y,Q=this.parent.input.count();if(Q===1||Q>1&&!this.parent.plugins.get("pinch",!0)){const K=Z-this.last.x,q=J-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(K)||this.yDirection&&this.parent.input.checkThreshold(q)){const V={x:Z,y:J};return this.xDirection&&(this.parent.x+=(V.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(V.y-this.last.y)*this.options.factor),this.last=V,this.moved||this.parent.emit("drag-start",{event:$,screen:new u(this.last.x,this.last.y),world:this.parent.toWorld(new u(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up($){if(this.paused)return!1;const Z=this.parent.input.touches;if(Z.length===1){const J=Z[0];return J.last&&(this.last={x:J.last.x,y:J.last.y},this.current=J.id),this.moved=!1,!0}else if(this.last&&this.moved){const J=new u(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:$,screen:J,world:this.parent.toWorld(J),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel($){if(this.paused)return!1;if(this.options.wheel){const Z=this.parent.plugins.get("wheel",!0);if(!Z||!Z.options.wheelZoom&&!$.ctrlKey){const J=$.deltaMode?this.options.lineHeight:1,Q=[$.deltaX,$.deltaY],[K,q]=this.options.wheelSwapAxes?Q.reverse():Q;return this.xDirection&&(this.parent.x+=K*J*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=q*J*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||$.preventDefault(),this.parent.options.stopPropagation&&$.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const $=this.parent.plugins.get("decelerate",!0)||{};if(this.options.clampWheel!=="y")if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,$.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,$.x=0);if(this.options.clampWheel!=="x")if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,$.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,$.y=0)}}var vw={speed:0,acceleration:null,radius:null};class CX extends b${constructor($,Z,J={}){super($);D(this,"options"),D(this,"target"),D(this,"velocity"),this.target=Z,this.options=Object.assign({},vw,J),this.velocity={x:0,y:0}}update($){if(this.paused)return;const Z=this.parent.center;let J=this.target.x,Q=this.target.y;if(this.options.radius)if(Math.sqrt(Math.pow(this.target.y-Z.y,2)+Math.pow(this.target.x-Z.x,2))>this.options.radius){const V=Math.atan2(this.target.y-Z.y,this.target.x-Z.x);J=this.target.x-Math.cos(V)*this.options.radius,Q=this.target.y-Math.sin(V)*this.options.radius}else return;const K=J-Z.x,q=Q-Z.y;if(K||q)if(this.options.speed)if(this.options.acceleration){const V=Math.atan2(Q-Z.y,J-Z.x),X=Math.sqrt(Math.pow(K,2)+Math.pow(q,2));if(X){const W=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);X>W?this.velocity={x:Math.min(this.velocity.x+(this.options.acceleration*$,this.options.speed)),y:Math.min(this.velocity.y+(this.options.acceleration*$,this.options.speed))}:this.velocity={x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const U=Math.cos(V)*this.velocity.x,z=Math.sin(V)*this.velocity.y,H=Math.abs(U)>Math.abs(K)?J:Z.x+U,G=Math.abs(z)>Math.abs(q)?Q:Z.y+z;this.parent.moveCenter(H,G),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const V=Math.atan2(Q-Z.y,J-Z.x),X=Math.cos(V)*this.options.speed,W=Math.sin(V)*this.options.speed,U=Math.abs(X)>Math.abs(K)?J:Z.x+X,z=Math.abs(W)>Math.abs(q)?Q:Z.y+W;this.parent.moveCenter(U,z),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(J,Q),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}var Sw={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class LX extends b${constructor($,Z={}){super($);D(this,"options"),D(this,"reverse"),D(this,"radiusSquared"),D(this,"left"),D(this,"top"),D(this,"right"),D(this,"bottom"),D(this,"horizontal"),D(this,"vertical"),this.options=Object.assign({},Sw,Z),this.reverse=this.options.reverse?1:-1,this.radiusSquared=typeof this.options.radius=="number"?Math.pow(this.options.radius,2):null,this.resize()}resize(){const $=this.options.distance;$!==null?(this.left=$,this.top=$,this.right=this.parent.screenWidth-$,this.bottom=this.parent.screenHeight-$):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=this.options.right===null?null:this.parent.screenWidth-this.options.right,this.bottom=this.options.bottom===null?null:this.parent.screenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move($){if(this.paused||$.pointerType!=="mouse"&&$.pointerId!==1||!this.options.allowButtons&&$.buttons!==0)return!1;const Z=$.global.x,J=$.global.y;if(this.radiusSquared){const Q=this.parent.toScreen(this.parent.center);if(Math.pow(Q.x-Z,2)+Math.pow(Q.y-J,2)>=this.radiusSquared){const K=Math.atan2(Q.y-J,Q.x-Z);this.options.linear?(this.horizontal=Math.round(Math.cos(K))*this.options.speed*this.reverse*0.06,this.vertical=Math.round(Math.sin(K))*this.options.speed*this.reverse*0.06):(this.horizontal=Math.cos(K)*this.options.speed*this.reverse*0.06,this.vertical=Math.sin(K)*this.options.speed*this.reverse*0.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else this.left!==null&&Z<this.left?this.horizontal=Number(this.reverse)*this.options.speed*0.06:this.right!==null&&Z>this.right?this.horizontal=-1*this.reverse*this.options.speed*0.06:(this.decelerateHorizontal(),this.horizontal=0),this.top!==null&&J<this.top?this.vertical=Number(this.reverse)*this.options.speed*0.06:this.bottom!==null&&J>this.bottom?this.vertical=-1*this.reverse*this.options.speed*0.06:(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const $=this.parent.plugins.get("decelerate",!0);this.horizontal&&$&&!this.options.noDecelerate&&$.activate({x:this.horizontal*this.options.speed*this.reverse/16.666666666666668})}decelerateVertical(){const $=this.parent.plugins.get("decelerate",!0);this.vertical&&$&&!this.options.noDecelerate&&$.activate({y:this.vertical*this.options.speed*this.reverse/16.666666666666668})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const $=this.parent.center;this.horizontal&&($.x+=this.horizontal*this.options.speed),this.vertical&&($.y+=this.vertical*this.options.speed),this.parent.moveCenter($),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}var hw={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class _X extends b${constructor($,Z={}){super($);D(this,"options"),D(this,"active",!1),D(this,"pinching",!1),D(this,"moved",!1),D(this,"lastCenter"),this.options=Object.assign({},hw,Z)}down(){return this.parent.input.count()>=2?(this.active=!0,!0):!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move($){if(this.paused||!this.active)return!1;const Z=$.global.x,J=$.global.y,Q=this.parent.input.touches;if(Q.length>=2){const K=Q[0],q=Q[1],V=K.last&&q.last?Math.sqrt(Math.pow(q.last.x-K.last.x,2)+Math.pow(q.last.y-K.last.y,2)):null;if(K.id===$.pointerId?K.last={x:Z,y:J,data:$}:q.id===$.pointerId&&(q.last={x:Z,y:J,data:$}),V){let X;const W=new u(K.last.x+(q.last.x-K.last.x)/2,K.last.y+(q.last.y-K.last.y)/2);this.options.center||(X=this.parent.toLocal(W));let U=Math.sqrt(Math.pow(q.last.x-K.last.x,2)+Math.pow(q.last.y-K.last.y,2));U=U===0?U=0.0000000001:U;const z=(1-V/U)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=z),this.isAxisY()&&(this.parent.scale.y+=z),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:W});const H=this.parent.plugins.get("clamp-zoom",!0);if(H&&H.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const G=this.parent.toGlobal(X);this.parent.x+=(W.x-G.x)*this.options.factor,this.parent.y+=(W.y-G.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(W.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(W.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=W,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return this.pinching&&this.parent.input.touches.length<=1?(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0):!1}}var fw={topLeft:!1,friction:0.8,time:1000,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class OX extends b${constructor($,Z,J,Q={}){super($);D(this,"options"),D(this,"ease"),D(this,"x"),D(this,"y"),D(this,"percent"),D(this,"snapping"),D(this,"deltaX"),D(this,"deltaY"),D(this,"startX"),D(this,"startY"),this.options=Object.assign({},fw,Q),this.ease=JZ(Q.ease,"easeInOutSine"),this.x=Z,this.y=J,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const $=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-$.x,this.deltaY=this.y-$.y,this.startX=$.x,this.startY=$.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(this.parent.input.count()===0){const $=this.parent.plugins.get("decelerate",!0);$&&($.x||$.y)&&($.percentChangeX=$.percentChangeY=this.options.friction)}return!1}update($){if(!this.paused&&!(this.options.interrupt&&this.parent.input.count()!==0))if(this.snapping){const Z=this.snapping;Z.time+=$;let J,Q,K;const q=this.startX,V=this.startY,X=this.deltaX,W=this.deltaY;if(Z.time>this.options.time)J=!0,Q=q+X,K=V+W;else{const U=this.ease(Z.time,0,1,this.options.time);Q=q+X*U,K=V+W*U}this.options.topLeft?this.parent.moveCorner(Q,K):this.parent.moveCenter(Q,K),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),J&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const Z=this.options.topLeft?this.parent.corner:this.parent.center;(Z.x!==this.x||Z.y!==this.y)&&this.snapStart()}}}var yw={width:0,height:0,time:1000,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class IX extends b${constructor($,Z={}){super($);D(this,"options"),D(this,"ease"),D(this,"xScale"),D(this,"yScale"),D(this,"xIndependent"),D(this,"yIndependent"),D(this,"snapping"),this.options=Object.assign({},yw,Z),this.ease=JZ(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=$.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=$.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,this.options.time===0?($.container.scale.x=this.xScale,$.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):Z.forceStart&&this.createSnapping()}createSnapping(){const $=this.parent.worldScreenWidth,Z=this.parent.worldScreenHeight,J=this.parent.screenWidth/this.xScale,Q=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:$,startY:Z,deltaX:J-$,deltaY:Q-Z},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update($){if(this.paused||this.options.interrupt&&this.parent.input.count()!==0)return;let Z;if(!this.options.center&&!this.options.noMove&&(Z=this.parent.center),!this.snapping)(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping();else if(this.snapping){const J=this.snapping;if(J.time+=$,J.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const K=this.snapping,q=this.ease(K.time,K.startX,K.deltaX,this.options.time),V=this.ease(K.time,K.startY,K.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/q,this.parent.scale.y=this.parent.screenHeight/V}const Q=this.parent.plugins.get("clamp-zoom",!0);Q&&Q.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(Z))}}resume(){this.snapping=null,super.resume()}}var gw={percent:0.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class RX extends b${constructor($,Z={}){super($);D(this,"options"),D(this,"smoothing"),D(this,"smoothingCenter"),D(this,"smoothingCount"),D(this,"keyIsPressed"),this.options=Object.assign({},gw,Z),this.keyIsPressed=!1,this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses($){window.addEventListener("keydown",(Z)=>{$.includes(Z.code)&&(this.keyIsPressed=!0)}),window.addEventListener("keyup",(Z)=>{$.includes(Z.code)&&(this.keyIsPressed=!1)})}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const $=this.smoothingCenter,Z=this.smoothing;let J;this.options.center||(J=this.parent.toLocal($)),this.isAxisX()&&(this.parent.scale.x+=Z.x),this.isAxisY()&&(this.parent.scale.y+=Z.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const Q=this.parent.plugins.get("clamp-zoom",!0);if(Q&&Q.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const K=this.parent.toGlobal(J);this.parent.x+=$.x-K.x,this.parent.y+=$.y-K.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch($){if(this.paused)return;const Z=this.parent.input.getPointerPosition($),J=-$.deltaY*($.deltaMode?this.options.lineHeight:1)/200,Q=Math.pow(2,(1+this.options.percent)*J);let K;this.options.center||(K=this.parent.toLocal(Z)),this.isAxisX()&&(this.parent.scale.x*=Q),this.isAxisY()&&(this.parent.scale.y*=Q),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const q=this.parent.plugins.get("clamp-zoom",!0);if(q&&q.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const V=this.parent.toGlobal(K);this.parent.x+=Z.x-V.x,this.parent.y+=Z.y-V.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:$,viewport:this.parent})}wheel($){if(this.paused||!this.checkKeyPress())return!1;if($.ctrlKey&&this.options.trackpadPinch)this.pinch($);else if(this.options.wheelZoom){const Z=this.parent.input.getPointerPosition($),J=(this.options.reverse?-1:1)*-$.deltaY*($.deltaMode?this.options.lineHeight:1)/500,Q=Math.pow(2,(1+this.options.percent)*J);if(this.options.smooth){const K={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+K.x)*Q-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+K.y)*Q-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=Z}else{let K;this.options.center||(K=this.parent.toLocal(Z)),this.isAxisX()&&(this.parent.scale.x*=Q),this.isAxisY()&&(this.parent.scale.y*=Q),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const q=this.parent.plugins.get("clamp-zoom",!0);if(q&&q.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const V=this.parent.toGlobal(K);this.parent.x+=Z.x-V.x,this.parent.y+=Z.y-V.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:$,viewport:this.parent})}return!this.parent.options.passiveWheel}}class PX{constructor($){D(this,"viewport"),D(this,"clickedAvailable"),D(this,"isMouseDown"),D(this,"last"),D(this,"wheelFunction"),D(this,"touches"),this.viewport=$,this.touches=[],this.addListeners()}addListeners(){this.viewport.eventMode="static",this.viewport.forceHitArea||(this.viewport.hitArea=new m(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.options.allowPreserveDragOutside?this.viewport.on("globalpointermove",this.move,this):this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.options.allowPreserveDragOutside||this.viewport.on("pointerleave",this.up,this),this.wheelFunction=($)=>this.handleWheel($),this.viewport.options.events.domElement.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.events.domElement.removeEventListener("wheel",this.wheelFunction)}down($){if(this.viewport.pause||!this.viewport.worldVisible)return;if($.pointerType==="mouse"?this.isMouseDown=!0:this.get($.pointerId)||this.touches.push({id:$.pointerId,last:null}),this.count()===1){this.last=$.global.clone();const Z=this.viewport.plugins.get("decelerate",!0),J=this.viewport.plugins.get("bounce",!0);(!Z||!Z.isActive())&&(!J||!J.isActive())?this.clickedAvailable=!0:this.clickedAvailable=!1}else this.clickedAvailable=!1;this.viewport.plugins.down($)&&this.viewport.options.stopPropagation&&$.stopPropagation()}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold($){return Math.abs($)>=this.viewport.threshold}move($){if(this.viewport.pause||!this.viewport.worldVisible)return;const Z=this.viewport.plugins.move($);if(this.clickedAvailable&&this.last){const J=$.global.x-this.last.x,Q=$.global.y-this.last.y;(this.checkThreshold(J)||this.checkThreshold(Q))&&(this.clickedAvailable=!1)}Z&&this.viewport.options.stopPropagation&&$.stopPropagation()}up($){if(this.viewport.pause||!this.viewport.worldVisible)return;$.pointerType==="mouse"&&(this.isMouseDown=!1),$.pointerType!=="mouse"&&this.remove($.pointerId);const Z=this.viewport.plugins.up($);this.clickedAvailable&&this.count()===0&&this.last&&(this.viewport.emit("clicked",{event:$,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this.viewport}),this.clickedAvailable=!1),Z&&this.viewport.options.stopPropagation&&$.stopPropagation()}getPointerPosition($){const Z=new u;return this.viewport.options.events.mapPositionToPoint(Z,$.clientX,$.clientY),Z}handleWheel($){if(this.viewport.pause||!this.viewport.worldVisible)return;const Z=this.viewport.toLocal(this.getPointerPosition($));this.viewport.left<=Z.x&&Z.x<=this.viewport.right&&this.viewport.top<=Z.y&&Z.y<=this.viewport.bottom&&this.viewport.plugins.wheel($)&&!this.viewport.options.passiveWheel&&$.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get($){for(let Z of this.touches)if(Z.id===$)return Z;return null}remove($){for(let Z=0;Z<this.touches.length;Z++)if(this.touches[Z].id===$){this.touches.splice(Z,1);return}}count(){return(this.isMouseDown?1:0)+this.touches.length}}var b5=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class DX{constructor($){D(this,"plugins"),D(this,"list"),D(this,"viewport"),this.viewport=$,this.list=[],this.plugins={}}add($,Z,J=b5.length){const Q=this.plugins[$];Q&&Q.destroy(),this.plugins[$]=Z;const K=b5.indexOf($);K!==-1&&b5.splice(K,1),b5.splice(J,0,$),this.sort()}get($,Z){var J;return Z&&(J=this.plugins[$])!=null&&J.paused?null:this.plugins[$]}update($){for(let Z of this.list)Z.update($)}resize(){for(let $ of this.list)$.resize()}reset(){for(let $ of this.list)$.reset()}removeAll(){this.list.forEach(($)=>{$.destroy()}),this.plugins={},this.sort()}remove($){var Z;this.plugins[$]&&((Z=this.plugins[$])==null||Z.destroy(),delete this.plugins[$],this.viewport.emit("plugin-remove",$),this.sort())}pause($){var Z;(Z=this.plugins[$])==null||Z.pause()}resume($){var Z;(Z=this.plugins[$])==null||Z.resume()}sort(){this.list=[];for(let $ of b5)this.plugins[$]&&this.list.push(this.plugins[$])}down($){let Z=!1;for(let J of this.list)J.down($)&&(Z=!0);return Z}move($){let Z=!1;for(let J of this.viewport.plugins.list)J.move($)&&(Z=!0);return Z}up($){let Z=!1;for(let J of this.list)J.up($)&&(Z=!0);return Z}wheel($){let Z=!1;for(let J of this.list)J.wheel($)&&(Z=!0);return Z}}var xw={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,disableOnContextMenu:!1,ticker:N0.shared,allowPreserveDragOutside:!1};class j1 extends r{constructor($){super();D(this,"moving"),D(this,"screenWidth"),D(this,"screenHeight"),D(this,"threshold"),D(this,"input"),D(this,"plugins"),D(this,"zooming"),D(this,"lastViewport"),D(this,"options"),D(this,"_dirty"),D(this,"_forceHitArea"),D(this,"_hitAreaDefault"),D(this,"_pause"),D(this,"tickerFunction"),D(this,"_worldWidth"),D(this,"_worldHeight"),D(this,"_disableOnContextMenu",(Z)=>Z.preventDefault()),this.options={...xw,...$},this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.disableOnContextMenu&&this.options.events.domElement.addEventListener("contextmenu",this._disableOnContextMenu),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new PX(this),this.plugins=new DX(this)}destroy($){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&this.options.events.domElement.removeEventListener("contextmenu",this._disableOnContextMenu),this.input.destroy(),super.destroy($)}update($){this.pause||(this.plugins.update($),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new m(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize($=window.innerWidth,Z=window.innerHeight,J,Q){this.screenWidth=$,this.screenHeight=Z,typeof J<"u"&&(this._worldWidth=J),typeof Q<"u"&&(this._worldHeight=Q),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth($){this._worldWidth=$,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight($){this._worldHeight=$,this.plugins.resize()}getVisibleBounds(){return new m(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld($,Z){return arguments.length===2?this.toLocal(new u($,Z)):this.toLocal($)}toScreen($,Z){return arguments.length===2?this.toGlobal(new u($,Z)):this.toGlobal($)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new u(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center($){this.moveCenter($)}moveCenter(...$){let Z,J;typeof $[0]=="number"?(Z=$[0],J=$[1]):(Z=$[0].x,J=$[0].y);const Q=(this.worldScreenWidth/2-Z)*this.scale.x,K=(this.worldScreenHeight/2-J)*this.scale.y;return(this.x!==Q||this.y!==K)&&(this.position.set(Q,K),this.plugins.reset(),this.dirty=!0),this}get corner(){return new u(-this.x/this.scale.x,-this.y/this.scale.y)}set corner($){this.moveCorner($)}moveCorner(...$){let Z,J;return $.length===1?(Z=-$[0].x*this.scale.x,J=-$[0].y*this.scale.y):(Z=-$[0]*this.scale.x,J=-$[1]*this.scale.y),(Z!==this.x||J!==this.y)&&(this.position.set(Z,J),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth($){return this.screenWidth/$}findFitHeight($){return this.screenHeight/$}findFit($,Z){const J=this.screenWidth/$,Q=this.screenHeight/Z;return Math.min(J,Q)}findCover($,Z){const J=this.screenWidth/$,Q=this.screenHeight/Z;return Math.max(J,Q)}fitWidth($=this.worldWidth,Z,J=!0,Q){let K;Z&&(K=this.center),this.scale.x=this.screenWidth/$,J&&(this.scale.y=this.scale.x);const q=this.plugins.get("clamp-zoom",!0);return!Q&&q&&q.clamp(),Z&&K&&this.moveCenter(K),this}fitHeight($=this.worldHeight,Z,J=!0,Q){let K;Z&&(K=this.center),this.scale.y=this.screenHeight/$,J&&(this.scale.x=this.scale.y);const q=this.plugins.get("clamp-zoom",!0);return!Q&&q&&q.clamp(),Z&&K&&this.moveCenter(K),this}fitWorld($){let Z;$&&(Z=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const J=this.plugins.get("clamp-zoom",!0);return J&&J.clamp(),$&&Z&&this.moveCenter(Z),this}fit($,Z=this.worldWidth,J=this.worldHeight){let Q;$&&(Q=this.center),this.scale.x=this.screenWidth/Z,this.scale.y=this.screenHeight/J,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const K=this.plugins.get("clamp-zoom",!0);return K&&K.clamp(),$&&Q&&this.moveCenter(Q),this}setZoom($,Z){let J;Z&&(J=this.center),this.scale.set($);const Q=this.plugins.get("clamp-zoom",!0);return Q&&Q.clamp(),Z&&J&&this.moveCenter(J),this}zoomPercent($,Z){return this.setZoom(this.scale.x+this.scale.x*$,Z)}zoom($,Z){return this.fitWidth($+this.worldScreenWidth,Z),this}get scaled(){return this.scale.x}set scaled($){this.setZoom($,!0)}snapZoom($){return this.plugins.add("snap-zoom",new IX(this,$)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new u(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right($){this.x=-$*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left($){this.x=-$*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top($){this.y=-$*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom($){this.y=-$*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty($){this._dirty=$}get forceHitArea(){return this._forceHitArea}set forceHitArea($){$?(this._forceHitArea=$,this.hitArea=$):(this._forceHitArea=null,this.hitArea=new m(0,0,this.worldWidth,this.worldHeight))}drag($){return this.plugins.add("drag",new NX(this,$)),this}clamp($){return this.plugins.add("clamp",new jX(this,$)),this}decelerate($){return this.plugins.add("decelerate",new FX(this,$)),this}bounce($){return this.plugins.add("bounce",new wX(this,$)),this}pinch($){return this.plugins.add("pinch",new _X(this,$)),this}snap($,Z,J){return this.plugins.add("snap",new OX(this,$,Z,J)),this}follow($,Z){return this.plugins.add("follow",new CX(this,$,Z)),this}wheel($){return this.plugins.add("wheel",new RX(this,$)),this}animate($){return this.plugins.add("animate",new YX(this,$)),this}clampZoom($){return this.plugins.add("clamp-zoom",new BX(this,$)),this}mouseEdges($){return this.plugins.add("mouse-edges",new LX(this,$)),this}get pause(){return!!this._pause}set pause($){this._pause=$,this.lastViewport=null,this.moving=!1,this.zooming=!1,$&&this.input.pause()}ensureVisible($,Z,J,Q,K){K&&(J>this.worldScreenWidth||Q>this.worldScreenHeight)&&(this.fit(!0,J,Q),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let q=!1;$<this.left?(this.left=$,q=!0):$+J>this.right&&(this.right=$+J,q=!0),Z<this.top?(this.top=Z,q=!0):Z+Q>this.bottom&&(this.bottom=Z+Q,q=!0),q&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}var v5=new u,mw=new Uint16Array([0,1,2,0,2,3]);class S0 extends r{constructor($){super(),this._anchor=new E$(this._onAnchorUpdate,this,$?$.defaultAnchor.x:0,$?$.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new e(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=a.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=$||f.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=mw,this.pluginName="batch",this.isSprite=!0,this._roundPixels=R.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=T.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=T.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const $=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===$._updateID)return;this._textureID!==$._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=$._updateID;const Z=this.transform.worldTransform,J=Z.a,Q=Z.b,K=Z.c,q=Z.d,V=Z.tx,X=Z.ty,W=this.vertexData,U=$.trim,z=$.orig,H=this._anchor;let G=0,Y=0,w=0,j=0;if(U?(Y=U.x-H._x*z.width,G=Y+U.width,j=U.y-H._y*z.height,w=j+U.height):(Y=-H._x*z.width,G=Y+z.width,j=-H._y*z.height,w=j+z.height),W[0]=J*Y+K*j+V,W[1]=q*j+Q*Y+X,W[2]=J*G+K*j+V,W[3]=q*j+Q*G+X,W[4]=J*G+K*w+V,W[5]=q*w+Q*G+X,W[6]=J*Y+K*w+V,W[7]=q*w+Q*Y+X,this._roundPixels){const B=R.RESOLUTION;for(let C=0;C<W.length;++C)W[C]=Math.round(W[C]*B)/B}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const $=this._texture,Z=this.vertexTrimmedData,J=$.orig,Q=this._anchor,K=this.transform.worldTransform,q=K.a,V=K.b,X=K.c,W=K.d,U=K.tx,z=K.ty,H=-Q._x*J.width,G=H+J.width,Y=-Q._y*J.height,w=Y+J.height;if(Z[0]=q*H+X*Y+U,Z[1]=W*Y+V*H+z,Z[2]=q*G+X*Y+U,Z[3]=W*Y+V*G+z,Z[4]=q*G+X*w+U,Z[5]=W*w+V*G+z,Z[6]=q*H+X*w+U,Z[7]=W*w+V*H+z,this._roundPixels){const j=R.RESOLUTION;for(let B=0;B<Z.length;++B)Z[B]=Math.round(Z[B]*j)/j}}_render($){this.calculateVertices(),$.batch.setObjectRenderer($.plugins[this.pluginName]),$.plugins[this.pluginName].render(this)}_calculateBounds(){const $=this._texture.trim,Z=this._texture.orig;!$||$.width===Z.width&&$.height===Z.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds($){return this.children.length===0?(this._localBounds||(this._localBounds=new h8),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),$||(this._localBoundsRect||(this._localBoundsRect=new m),$=this._localBoundsRect),this._localBounds.getRectangle($)):super.getLocalBounds.call(this,$)}containsPoint($){this.worldTransform.applyInverse($,v5);const Z=this._texture.orig.width,J=this._texture.orig.height,Q=-Z*this.anchor.x;let K=0;return v5.x>=Q&&v5.x<Q+Z&&(K=-J*this.anchor.y,v5.y>=K&&v5.y<K+J)}destroy($){if(super.destroy($),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof $=="boolean"?$:$?.texture){const Z=typeof $=="boolean"?$:$?.baseTexture;this._texture.destroy(!!Z)}this._texture=null}static from($,Z){const J=$ instanceof f?$:f.from($,Z);return new S0(J)}set roundPixels($){this._roundPixels!==$&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=$}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width($){const Z=T.sign(this.scale.x)||1;this.scale.x=Z*$/this._texture.orig.width,this._width=$}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height($){const Z=T.sign(this.scale.y)||1;this.scale.y=Z*$/this._texture.orig.height,this._height=$}get anchor(){return this._anchor}set anchor($){this._anchor.copyFrom($)}get tint(){return this._tintColor.value}set tint($){this._tintColor.setValue($),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture($){this._texture!==$&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=$||f.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,$&&($.baseTexture.valid?this._onTextureUpdate():$.once("update",this._onTextureUpdate,this)))}}var AX=new Z0;W0.prototype._cacheAsBitmap=!1;W0.prototype._cacheData=null;W0.prototype._cacheAsBitmapResolution=null;W0.prototype._cacheAsBitmapMultisample=null;class MX{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(W0.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set($){$!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=$,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set($){$!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=$,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set($){if(this._cacheAsBitmap===$)return;this._cacheAsBitmap=$;let Z;$?(this._cacheData||(this._cacheData=new MX),Z=this._cacheData,Z.originalRender=this.render,Z.originalRenderCanvas=this.renderCanvas,Z.originalUpdateTransform=this.updateTransform,Z.originalCalculateBounds=this.calculateBounds,Z.originalGetLocalBounds=this.getLocalBounds,Z.originalDestroy=this.destroy,Z.originalContainsPoint=this.containsPoint,Z.originalMask=this._mask,Z.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(Z=this._cacheData,Z.sprite&&this._destroyCachedDisplayObject(),this.render=Z.originalRender,this.renderCanvas=Z.originalRenderCanvas,this.calculateBounds=Z.originalCalculateBounds,this.getLocalBounds=Z.originalGetLocalBounds,this.destroy=Z.originalDestroy,this.updateTransform=Z.originalUpdateTransform,this.containsPoint=Z.originalContainsPoint,this._mask=Z.originalMask,this.filterArea=Z.originalFilterArea)}}});W0.prototype._renderCached=function($){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject($),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render($))};W0.prototype._initCachedDisplayObject=function($){if(this._cacheData?.sprite)return;const Z=this.alpha;this.alpha=1,$.batch.flush();const J=this.getLocalBounds(new m,!0);if(this.filters?.length){const G=this.filters[0].padding;J.pad(G)}const Q=this.cacheAsBitmapResolution||$.resolution;J.ceil(Q),J.width=Math.max(J.width,1/Q),J.height=Math.max(J.height,1/Q);const K=$.renderTexture.current,q=$.renderTexture.sourceFrame.clone(),V=$.renderTexture.destinationFrame.clone(),X=$.projection.transform,W=c$.create({width:J.width,height:J.height,resolution:Q,multisample:this.cacheAsBitmapMultisample??$.multisample}),U=`cacheAsBitmap_${T.uid()}`;this._cacheData.textureCacheId=U,n.addToCache(W.baseTexture,U),f.addToCache(W,U);const z=this.transform.localTransform.copyTo(AX).invert().translate(-J.x,-J.y);this.render=this._cacheData.originalRender,$.render(this,{renderTexture:W,clear:!0,transform:z,skipUpdateTransform:!1}),$.framebuffer.blit(),$.projection.transform=X,$.renderTexture.bind(K,q,V),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=Z;const H=new S0(W);H.transform.worldTransform=this.transform.worldTransform,H.anchor.x=-(J.x/J.width),H.anchor.y=-(J.y/J.height),H.alpha=Z,H._bounds=this._bounds,this._cacheData.sprite=H,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=H.containsPoint.bind(H)};W0.prototype._renderCachedCanvas=function($){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas($),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas($))};W0.prototype._initCachedDisplayObjectCanvas=function($){if(this._cacheData?.sprite)return;const Z=this.getLocalBounds(new m,!0),J=this.alpha;this.alpha=1;const Q=$.canvasContext.activeContext,K=$._projTransform,q=this.cacheAsBitmapResolution||$.resolution;Z.ceil(q),Z.width=Math.max(Z.width,1/q),Z.height=Math.max(Z.height,1/q);const V=c$.create({width:Z.width,height:Z.height,resolution:q}),X=`cacheAsBitmap_${T.uid()}`;this._cacheData.textureCacheId=X,n.addToCache(V.baseTexture,X),f.addToCache(V,X);const W=AX;this.transform.localTransform.copyTo(W),W.invert(),W.tx-=Z.x,W.ty-=Z.y,this.renderCanvas=this._cacheData.originalRenderCanvas,$.render(this,{renderTexture:V,clear:!0,transform:W,skipUpdateTransform:!1}),$.canvasContext.activeContext=Q,$._projTransform=K,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=J;const U=new S0(V);U.transform.worldTransform=this.transform.worldTransform,U.anchor.x=-(Z.x/Z.width),U.anchor.y=-(Z.y/Z.height),U.alpha=J,U._bounds=this._bounds,this._cacheData.sprite=U,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=$._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=U.containsPoint.bind(U)};W0.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};W0.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};W0.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,n.removeFromCache(this._cacheData.textureCacheId),f.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};W0.prototype._cacheAsBitmapDestroy=function($){this.cacheAsBitmap=!1,this.destroy($)};W0.prototype.name=null;r.prototype.getChildByName=function($,Z){for(let J=0,Q=this.children.length;J<Q;J++)if(this.children[J].name===$)return this.children[J];if(Z)for(let J=0,Q=this.children.length;J<Q;J++){const K=this.children[J];if(!K.getChildByName)continue;const q=K.getChildByName($,!0);if(q)return q}return null};W0.prototype.getGlobalPosition=function($=new u,Z=!1){return this.parent?this.parent.toGlobal(this.position,$,Z):($.x=this.position.x,$.y=this.position.y),$};var kX=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class QZ extends w0{constructor($=1){super(U1,kX,{uAlpha:1}),this.alpha=$}get alpha(){return this.uniforms.uAlpha}set alpha($){this.uniforms.uAlpha=$}}var EX=function($){const Z=cw[$],J=Z.length;let Q=pw,K="";const q="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let V;for(let X=0;X<$;X++){let W=q.replace("%index%",X.toString());V=X,X>=J&&(V=$-X-1),W=W.replace("%value%",Z[V].toString()),K+=W,K+=`
`}return Q=Q.replace("%blur%",K),Q=Q.replace("%size%",$.toString()),Q},cw={5:[0.153388,0.221461,0.250301],7:[0.071303,0.131514,0.189879,0.214607],9:[0.028532,0.067234,0.124009,0.179044,0.20236],11:[0.0093,0.028002,0.065984,0.121703,0.175713,0.198596],13:[0.002406,0.009255,0.027867,0.065666,0.121117,0.174868,0.197641],15:[0.000489,0.002403,0.009246,0.02784,0.065602,0.120999,0.174697,0.197448]},pw=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);var TX=function($,Z){const J=Math.ceil($/2);let Q=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`,K="",q;Z?q="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":q="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let V=0;V<$;V++){let X=q.replace("%index%",V.toString());X=X.replace("%sampleIndex%",`${V-(J-1)}.0`),K+=X,K+=`
`}return Q=Q.replace("%blur%",K),Q=Q.replace("%size%",$.toString()),Q};class k6 extends w0{constructor($,Z=8,J=4,Q=w0.defaultResolution,K=5){const q=TX(K,$),V=EX(K);super(q,V),this.horizontal=$,this.resolution=Q,this._quality=0,this.quality=J,this.blur=Z}apply($,Z,J,Q){if(J?this.horizontal?this.uniforms.strength=1/J.width*(J.width/Z.width):this.uniforms.strength=1/J.height*(J.height/Z.height):this.horizontal?this.uniforms.strength=1/$.renderer.width*($.renderer.width/Z.width):this.uniforms.strength=1/$.renderer.height*($.renderer.height/Z.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)$.applyFilter(this,Z,J,Q);else{const K=$.getFilterTexture(),q=$.renderer;let V=Z,X=K;this.state.blend=!1,$.applyFilter(this,V,X,k$.CLEAR);for(let W=1;W<this.passes-1;W++){$.bindAndClear(V,k$.BLIT),this.uniforms.uSampler=X;const U=X;X=V,V=U,q.shader.bind(this),q.geometry.draw(5)}this.state.blend=!0,$.applyFilter(this,X,J,Q),$.returnFilterTexture(K)}}get blur(){return this.strength}set blur($){this.padding=1+Math.abs($)*2,this.strength=$}get quality(){return this._quality}set quality($){this._quality=$,this.passes=$}}class KZ extends w0{constructor($=8,Z=4,J=w0.defaultResolution,Q=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new k6(!0,$,Z,J,Q),this.blurYFilter=new k6(!1,$,Z,J,Q),this.resolution=J,this.quality=Z,this.blur=$,this.repeatEdgePixels=!1}apply($,Z,J,Q){const K=Math.abs(this.blurXFilter.strength),q=Math.abs(this.blurYFilter.strength);if(K&&q){const V=$.getFilterTexture();this.blurXFilter.apply($,Z,V,k$.CLEAR),this.blurYFilter.apply($,V,J,Q),$.returnFilterTexture(V)}else q?this.blurYFilter.apply($,Z,J,Q):this.blurXFilter.apply($,Z,J,Q)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur($){this.blurXFilter.blur=this.blurYFilter.blur=$,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality($){this.blurXFilter.quality=this.blurYFilter.quality=$}get blurX(){return this.blurXFilter.blur}set blurX($){this.blurXFilter.blur=$,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY($){this.blurYFilter.blur=$,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode($){this.blurYFilter.blendMode=$}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels($){this._repeatEdgePixels=$,this.updatePadding()}}var bX=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class G7 extends w0{constructor(){const $={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(E5,bX,$),this.alpha=1}_loadMatrix($,Z=!1){let J=$;Z&&(this._multiply(J,this.uniforms.m,$),J=this._colorMatrix(J)),this.uniforms.m=J}_multiply($,Z,J){return $[0]=Z[0]*J[0]+Z[1]*J[5]+Z[2]*J[10]+Z[3]*J[15],$[1]=Z[0]*J[1]+Z[1]*J[6]+Z[2]*J[11]+Z[3]*J[16],$[2]=Z[0]*J[2]+Z[1]*J[7]+Z[2]*J[12]+Z[3]*J[17],$[3]=Z[0]*J[3]+Z[1]*J[8]+Z[2]*J[13]+Z[3]*J[18],$[4]=Z[0]*J[4]+Z[1]*J[9]+Z[2]*J[14]+Z[3]*J[19]+Z[4],$[5]=Z[5]*J[0]+Z[6]*J[5]+Z[7]*J[10]+Z[8]*J[15],$[6]=Z[5]*J[1]+Z[6]*J[6]+Z[7]*J[11]+Z[8]*J[16],$[7]=Z[5]*J[2]+Z[6]*J[7]+Z[7]*J[12]+Z[8]*J[17],$[8]=Z[5]*J[3]+Z[6]*J[8]+Z[7]*J[13]+Z[8]*J[18],$[9]=Z[5]*J[4]+Z[6]*J[9]+Z[7]*J[14]+Z[8]*J[19]+Z[9],$[10]=Z[10]*J[0]+Z[11]*J[5]+Z[12]*J[10]+Z[13]*J[15],$[11]=Z[10]*J[1]+Z[11]*J[6]+Z[12]*J[11]+Z[13]*J[16],$[12]=Z[10]*J[2]+Z[11]*J[7]+Z[12]*J[12]+Z[13]*J[17],$[13]=Z[10]*J[3]+Z[11]*J[8]+Z[12]*J[13]+Z[13]*J[18],$[14]=Z[10]*J[4]+Z[11]*J[9]+Z[12]*J[14]+Z[13]*J[19]+Z[14],$[15]=Z[15]*J[0]+Z[16]*J[5]+Z[17]*J[10]+Z[18]*J[15],$[16]=Z[15]*J[1]+Z[16]*J[6]+Z[17]*J[11]+Z[18]*J[16],$[17]=Z[15]*J[2]+Z[16]*J[7]+Z[17]*J[12]+Z[18]*J[17],$[18]=Z[15]*J[3]+Z[16]*J[8]+Z[17]*J[13]+Z[18]*J[18],$[19]=Z[15]*J[4]+Z[16]*J[9]+Z[17]*J[14]+Z[18]*J[19]+Z[19],$}_colorMatrix($){const Z=new Float32Array($);return Z[4]/=255,Z[9]/=255,Z[14]/=255,Z[19]/=255,Z}brightness($,Z){const J=[$,0,0,0,0,0,$,0,0,0,0,0,$,0,0,0,0,0,1,0];this._loadMatrix(J,Z)}tint($,Z){const[J,Q,K]=e.shared.setValue($).toArray(),q=[J,0,0,0,0,0,Q,0,0,0,0,0,K,0,0,0,0,0,1,0];this._loadMatrix(q,Z)}greyscale($,Z){const J=[$,$,$,0,0,$,$,$,0,0,$,$,$,0,0,0,0,0,1,0];this._loadMatrix(J,Z)}blackAndWhite($){const Z=[0.3,0.6,0.1,0,0,0.3,0.6,0.1,0,0,0.3,0.6,0.1,0,0,0,0,0,1,0];this._loadMatrix(Z,$)}hue($,Z){$=($||0)/180*Math.PI;const J=Math.cos($),Q=Math.sin($),K=Math.sqrt,q=0.3333333333333333,V=K(q),X=J+(1-J)*q,W=q*(1-J)-V*Q,U=q*(1-J)+V*Q,z=q*(1-J)+V*Q,H=J+q*(1-J),G=q*(1-J)-V*Q,Y=q*(1-J)-V*Q,w=q*(1-J)+V*Q,j=J+q*(1-J),B=[X,W,U,0,0,z,H,G,0,0,Y,w,j,0,0,0,0,0,1,0];this._loadMatrix(B,Z)}contrast($,Z){const J=($||0)+1,Q=-0.5*(J-1),K=[J,0,0,0,Q,0,J,0,0,Q,0,0,J,0,Q,0,0,0,1,0];this._loadMatrix(K,Z)}saturate($=0,Z){const J=$*2/3+1,Q=(J-1)*-0.5,K=[J,Q,Q,0,0,Q,J,Q,0,0,Q,Q,J,0,0,0,0,0,1,0];this._loadMatrix(K,Z)}desaturate(){this.saturate(-1)}negative($){const Z=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(Z,$)}sepia($){const Z=[0.393,0.7689999,0.18899999,0,0,0.349,0.6859999,0.16799999,0,0,0.272,0.5339999,0.13099999,0,0,0,0,0,1,0];this._loadMatrix(Z,$)}technicolor($){const Z=[1.9125277891456083,-0.8545344976951645,-0.09155508482755585,0,11.793603434377337,-0.3087833385928097,1.7658908555458428,-0.10601743074722245,0,-70.35205161461398,-0.231103377548616,-0.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(Z,$)}polaroid($){const Z=[1.438,-0.062,-0.062,0,0,-0.122,1.378,-0.122,0,0,-0.016,-0.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(Z,$)}toBGR($){const Z=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(Z,$)}kodachrome($){const Z=[1.1285582396593525,-0.3967382283601348,-0.03992559172921793,0,63.72958762196502,-0.16404339962244616,1.0835251566291304,-0.05498805115633132,0,24.732407896706203,-0.16786010706155763,-0.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(Z,$)}browni($){const Z=[0.5997023498159715,0.34553243048391263,-0.2708298674538042,0,47.43192855600873,-0.037703249837783157,0.8609577587992641,0.15059552388459913,0,-36.96841498319127,0.24113635128153335,-0.07441037908422492,0.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(Z,$)}vintage($){const Z=[0.6279345635605994,0.3202183420819367,-0.03965408211312453,0,9.651285835294123,0.02578397704808868,0.6441188644374771,0.03259127616149294,0,7.462829176470591,0.0466055556782719,-0.0851232987247891,0.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(Z,$)}colorTone($,Z,J,Q,K){$=$||0.2,Z=Z||0.15,J=J||16770432,Q=Q||3375104;const q=e.shared,[V,X,W]=q.setValue(J).toArray(),[U,z,H]=q.setValue(Q).toArray(),G=[0.3,0.59,0.11,0,0,V,X,W,$,0,U,z,H,Z,0,V-U,X-z,W-H,0,0];this._loadMatrix(G,K)}night($,Z){$=$||0.1;const J=[$*-2,-$,0,0,0,-$,0,$,0,0,0,$,$*2,0,0,0,0,0,1,0];this._loadMatrix(J,Z)}predator($,Z){const J=[11.224130630493164*$,-4.794486999511719*$,-2.8746118545532227*$,0*$,0.40342438220977783*$,-3.6330697536468506*$,9.193157196044922*$,-2.951810836791992*$,0*$,-1.316135048866272*$,-3.2184197902679443*$,-4.2375030517578125*$,7.476448059082031*$,0*$,0.8044459223747253*$,0,0,0,1,0];this._loadMatrix(J,Z)}lsd($){const Z=[2,-0.4,0.5,0,0,-0.5,2,-0.4,0,0,-0.4,-0.5,3,0,0,0,0,0,1,0];this._loadMatrix(Z,$)}reset(){const $=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix($,!1)}get matrix(){return this.uniforms.m}set matrix($){this.uniforms.m=$}get alpha(){return this.uniforms.uAlpha}set alpha($){this.uniforms.uAlpha=$}}G7.prototype.grayscale=G7.prototype.greyscale;var vX=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`;var SX=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class qZ extends w0{constructor($,Z){const J=new Z0;$.renderable=!1,super(SX,vX,{mapSampler:$._texture,filterMatrix:J,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=$,this.maskMatrix=J,Z==null&&(Z=20),this.scale=new u(Z,Z)}apply($,Z,J,Q){this.uniforms.filterMatrix=$.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const K=this.maskSprite.worldTransform,q=Math.sqrt(K.a*K.a+K.b*K.b),V=Math.sqrt(K.c*K.c+K.d*K.d);q!==0&&V!==0&&(this.uniforms.rotation[0]=K.a/q,this.uniforms.rotation[1]=K.b/q,this.uniforms.rotation[2]=K.c/V,this.uniforms.rotation[3]=K.d/V),$.applyFilter(this,Z,J,Q)}get map(){return this.uniforms.mapSampler}set map($){this.uniforms.mapSampler=$}}var hX=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;var fX=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class VZ extends w0{constructor(){super(fX,hX)}}var yX=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class XZ extends w0{constructor($=0.5,Z=Math.random()){super(E5,yX,{uNoise:0,uSeed:0}),this.noise=$,this.seed=Z}get noise(){return this.uniforms.uNoise}set noise($){this.uniforms.uNoise=$}get seed(){return this.uniforms.uSeed}set seed($){this.uniforms.uSeed=$}}var B1={AlphaFilter:QZ,BlurFilter:KZ,BlurFilterPass:k6,ColorMatrixFilter:G7,DisplacementFilter:qZ,FXAAFilter:VZ,NoiseFilter:XZ};Object.entries(B1).forEach(([$,Z])=>{Object.defineProperty(B1,$,{get(){return T.deprecation("7.1.0",`filters.${$} has moved to ${$}`),Z}})});class gX{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init($){this.removeTickerListener(),this.events=$,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate($){this._pauseUpdate=$}addTickerListener(){this.tickerAdded||!this.domElement||(N0.system.add(this.tickerUpdate,this,T$.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(N0.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const $=this.events.rootPointerEvent;this.events.supportsTouchEvents&&$.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:$.clientX,clientY:$.clientY}))}tickerUpdate($){this._deltaTime+=$,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}var Y8=new gX;class f8{constructor($){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=f8.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new u,this.page=new u,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=$}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent($,Z,J){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent($,Z,J,Q,K){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class y8 extends f8{constructor(){super(...arguments),this.client=new u,this.movement=new u,this.offset=new u,this.global=new u,this.screen=new u}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition($,Z,J){return $.worldTransform.applyInverse(J||this.global,Z)}getModifierState($){return("getModifierState"in this.nativeEvent)&&this.nativeEvent.getModifierState($)}initMouseEvent($,Z,J,Q,K,q,V,X,W,U,z,H,G,Y,w){throw new Error("Method not implemented.")}}class w$ extends y8{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class w8 extends y8{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}w8.DOM_DELTA_PIXEL=0,w8.DOM_DELTA_LINE=1,w8.DOM_DELTA_PAGE=2;var uw=2048,dw=new u,F1=new u;class WZ{constructor($){this.dispatch=new T.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=$,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping($,Z){this.mappingTable[$]||(this.mappingTable[$]=[]),this.mappingTable[$].push({fn:Z,priority:0}),this.mappingTable[$].sort((J,Q)=>J.priority-Q.priority)}dispatchEvent($,Z){$.propagationStopped=!1,$.propagationImmediatelyStopped=!1,this.propagate($,Z),this.dispatch.emit(Z||$.type,$)}mapEvent($){if(!this.rootTarget)return;const Z=this.mappingTable[$.type];if(Z)for(let J=0,Q=Z.length;J<Q;J++)Z[J].fn($);else console.warn(`[EventBoundary]: Event mapping not defined for ${$.type}`)}hitTest($,Z){Y8.pauseUpdate=!0;const J=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",Q=this[J](this.rootTarget,this.rootTarget.eventMode,dw.set($,Z),this.hitTestFn,this.hitPruneFn);return Q&&Q[0]}propagate($,Z){if(!$.target)return;const J=$.composedPath();$.eventPhase=$.CAPTURING_PHASE;for(let Q=0,K=J.length-1;Q<K;Q++)if($.currentTarget=J[Q],this.notifyTarget($,Z),$.propagationStopped||$.propagationImmediatelyStopped)return;if($.eventPhase=$.AT_TARGET,$.currentTarget=$.target,this.notifyTarget($,Z),!($.propagationStopped||$.propagationImmediatelyStopped)){$.eventPhase=$.BUBBLING_PHASE;for(let Q=J.length-2;Q>=0;Q--)if($.currentTarget=J[Q],this.notifyTarget($,Z),$.propagationStopped||$.propagationImmediatelyStopped)return}}all($,Z,J=this._allInteractiveElements){if(J.length===0)return;$.eventPhase=$.BUBBLING_PHASE;const Q=Array.isArray(Z)?Z:[Z];for(let K=J.length-1;K>=0;K--)Q.forEach((q)=>{$.currentTarget=J[K],this.notifyTarget($,q)})}propagationPath($){const Z=[$];for(let J=0;J<uw&&$!==this.rootTarget;J++){if(!$.parent)throw new Error("Cannot find propagation path to disconnected target");Z.push($.parent),$=$.parent}return Z.reverse(),Z}hitTestMoveRecursive($,Z,J,Q,K,q=!1){let V=!1;if(this._interactivePrune($))return null;if(($.eventMode==="dynamic"||Z==="dynamic")&&(Y8.pauseUpdate=!1),$.interactiveChildren&&$.children){const U=$.children;for(let z=U.length-1;z>=0;z--){const H=U[z],G=this.hitTestMoveRecursive(H,this._isInteractive(Z)?Z:H.eventMode,J,Q,K,q||K($,J));if(G){if(G.length>0&&!G[G.length-1].parent)continue;const Y=$.isInteractive();(G.length>0||Y)&&(Y&&this._allInteractiveElements.push($),G.push($)),this._hitElements.length===0&&(this._hitElements=G),V=!0}}}const X=this._isInteractive(Z),W=$.isInteractive();return X&&W&&this._allInteractiveElements.push($),q||this._hitElements.length>0?null:V?this._hitElements:X&&!K($,J)&&Q($,J)?W?[$]:[]:null}hitTestRecursive($,Z,J,Q,K){if(this._interactivePrune($)||K($,J))return null;if(($.eventMode==="dynamic"||Z==="dynamic")&&(Y8.pauseUpdate=!1),$.interactiveChildren&&$.children){const X=$.children;for(let W=X.length-1;W>=0;W--){const U=X[W],z=this.hitTestRecursive(U,this._isInteractive(Z)?Z:U.eventMode,J,Q,K);if(z){if(z.length>0&&!z[z.length-1].parent)continue;const H=$.isInteractive();return(z.length>0||H)&&z.push($),z}}}const q=this._isInteractive(Z),V=$.isInteractive();return q&&Q($,J)?V?[$]:[]:null}_isInteractive($){return $==="static"||$==="dynamic"}_interactivePrune($){return!!(!$||$.isMask||!$.visible||!$.renderable||$.eventMode==="none"||$.eventMode==="passive"&&!$.interactiveChildren||$.isMask)}hitPruneFn($,Z){if($.hitArea&&($.worldTransform.applyInverse(Z,F1),!$.hitArea.contains(F1.x,F1.y)))return!0;if($._mask){const J=$._mask.isMaskData?$._mask.maskObject:$._mask;if(J&&!J.containsPoint?.(Z))return!0}return!1}hitTestFn($,Z){return $.eventMode==="passive"?!1:$.hitArea?!0:$.containsPoint?$.containsPoint(Z):!1}notifyTarget($,Z){Z=Z??$.type;const J=`on${Z}`;$.currentTarget[J]?.($);const Q=$.eventPhase===$.CAPTURING_PHASE||$.eventPhase===$.AT_TARGET?`${Z}capture`:Z;this.notifyListeners($,Q),$.eventPhase===$.AT_TARGET&&this.notifyListeners($,Z)}mapPointerDown($){if(!($ instanceof w$)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const Z=this.createPointerEvent($);if(this.dispatchEvent(Z,"pointerdown"),Z.pointerType==="touch")this.dispatchEvent(Z,"touchstart");else if(Z.pointerType==="mouse"||Z.pointerType==="pen"){const Q=Z.button===2;this.dispatchEvent(Z,Q?"rightdown":"mousedown")}const J=this.trackingData($.pointerId);J.pressTargetsByButton[$.button]=Z.composedPath(),this.freeEvent(Z)}mapPointerMove($){if(!($ instanceof w$)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const Z=this.createPointerEvent($);this._isPointerMoveEvent=!1;const J=Z.pointerType==="mouse"||Z.pointerType==="pen",Q=this.trackingData($.pointerId),K=this.findMountedTarget(Q.overTargets);if(Q.overTargets?.length>0&&K!==Z.target){const X=$.type==="mousemove"?"mouseout":"pointerout",W=this.createPointerEvent($,X,K);if(this.dispatchEvent(W,"pointerout"),J&&this.dispatchEvent(W,"mouseout"),!Z.composedPath().includes(K)){const U=this.createPointerEvent($,"pointerleave",K);for(U.eventPhase=U.AT_TARGET;U.target&&!Z.composedPath().includes(U.target);)U.currentTarget=U.target,this.notifyTarget(U),J&&this.notifyTarget(U,"mouseleave"),U.target=U.target.parent;this.freeEvent(U)}this.freeEvent(W)}if(K!==Z.target){const X=$.type==="mousemove"?"mouseover":"pointerover",W=this.clonePointerEvent(Z,X);this.dispatchEvent(W,"pointerover"),J&&this.dispatchEvent(W,"mouseover");let U=K?.parent;for(;U&&U!==this.rootTarget.parent&&U!==Z.target;)U=U.parent;if(!U||U===this.rootTarget.parent){const z=this.clonePointerEvent(Z,"pointerenter");for(z.eventPhase=z.AT_TARGET;z.target&&z.target!==K&&z.target!==this.rootTarget.parent;)z.currentTarget=z.target,this.notifyTarget(z),J&&this.notifyTarget(z,"mouseenter"),z.target=z.target.parent;this.freeEvent(z)}this.freeEvent(W)}const q=[],V=this.enableGlobalMoveEvents??!0;this.moveOnAll?q.push("pointermove"):this.dispatchEvent(Z,"pointermove"),V&&q.push("globalpointermove"),Z.pointerType==="touch"&&(this.moveOnAll?q.splice(1,0,"touchmove"):this.dispatchEvent(Z,"touchmove"),V&&q.push("globaltouchmove")),J&&(this.moveOnAll?q.splice(1,0,"mousemove"):this.dispatchEvent(Z,"mousemove"),V&&q.push("globalmousemove"),this.cursor=Z.target?.cursor),q.length>0&&this.all(Z,q),this._allInteractiveElements.length=0,this._hitElements.length=0,Q.overTargets=Z.composedPath(),this.freeEvent(Z)}mapPointerOver($){if(!($ instanceof w$)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const Z=this.trackingData($.pointerId),J=this.createPointerEvent($),Q=J.pointerType==="mouse"||J.pointerType==="pen";this.dispatchEvent(J,"pointerover"),Q&&this.dispatchEvent(J,"mouseover"),J.pointerType==="mouse"&&(this.cursor=J.target?.cursor);const K=this.clonePointerEvent(J,"pointerenter");for(K.eventPhase=K.AT_TARGET;K.target&&K.target!==this.rootTarget.parent;)K.currentTarget=K.target,this.notifyTarget(K),Q&&this.notifyTarget(K,"mouseenter"),K.target=K.target.parent;Z.overTargets=J.composedPath(),this.freeEvent(J),this.freeEvent(K)}mapPointerOut($){if(!($ instanceof w$)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const Z=this.trackingData($.pointerId);if(Z.overTargets){const J=$.pointerType==="mouse"||$.pointerType==="pen",Q=this.findMountedTarget(Z.overTargets),K=this.createPointerEvent($,"pointerout",Q);this.dispatchEvent(K),J&&this.dispatchEvent(K,"mouseout");const q=this.createPointerEvent($,"pointerleave",Q);for(q.eventPhase=q.AT_TARGET;q.target&&q.target!==this.rootTarget.parent;)q.currentTarget=q.target,this.notifyTarget(q),J&&this.notifyTarget(q,"mouseleave"),q.target=q.target.parent;Z.overTargets=null,this.freeEvent(K),this.freeEvent(q)}this.cursor=null}mapPointerUp($){if(!($ instanceof w$)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const Z=performance.now(),J=this.createPointerEvent($);if(this.dispatchEvent(J,"pointerup"),J.pointerType==="touch")this.dispatchEvent(J,"touchend");else if(J.pointerType==="mouse"||J.pointerType==="pen"){const V=J.button===2;this.dispatchEvent(J,V?"rightup":"mouseup")}const Q=this.trackingData($.pointerId),K=this.findMountedTarget(Q.pressTargetsByButton[$.button]);let q=K;if(K&&!J.composedPath().includes(K)){let V=K;for(;V&&!J.composedPath().includes(V);){if(J.currentTarget=V,this.notifyTarget(J,"pointerupoutside"),J.pointerType==="touch")this.notifyTarget(J,"touchendoutside");else if(J.pointerType==="mouse"||J.pointerType==="pen"){const X=J.button===2;this.notifyTarget(J,X?"rightupoutside":"mouseupoutside")}V=V.parent}delete Q.pressTargetsByButton[$.button],q=V}if(q){const V=this.clonePointerEvent(J,"click");V.target=q,V.path=null,Q.clicksByButton[$.button]||(Q.clicksByButton[$.button]={clickCount:0,target:V.target,timeStamp:Z});const X=Q.clicksByButton[$.button];if(X.target===V.target&&Z-X.timeStamp<200?++X.clickCount:X.clickCount=1,X.target=V.target,X.timeStamp=Z,V.detail=X.clickCount,V.pointerType==="mouse"){const W=V.button===2;this.dispatchEvent(V,W?"rightclick":"click")}else V.pointerType==="touch"&&this.dispatchEvent(V,"tap");this.dispatchEvent(V,"pointertap"),this.freeEvent(V)}this.freeEvent(J)}mapPointerUpOutside($){if(!($ instanceof w$)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const Z=this.trackingData($.pointerId),J=this.findMountedTarget(Z.pressTargetsByButton[$.button]),Q=this.createPointerEvent($);if(J){let K=J;for(;K;)Q.currentTarget=K,this.notifyTarget(Q,"pointerupoutside"),Q.pointerType==="touch"?this.notifyTarget(Q,"touchendoutside"):(Q.pointerType==="mouse"||Q.pointerType==="pen")&&this.notifyTarget(Q,Q.button===2?"rightupoutside":"mouseupoutside"),K=K.parent;delete Z.pressTargetsByButton[$.button]}this.freeEvent(Q)}mapWheel($){if(!($ instanceof w8)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const Z=this.createWheelEvent($);this.dispatchEvent(Z),this.freeEvent(Z)}findMountedTarget($){if(!$)return null;let Z=$[0];for(let J=1;J<$.length&&$[J].parent===Z;J++)Z=$[J];return Z}createPointerEvent($,Z,J){const Q=this.allocateEvent(w$);return this.copyPointerData($,Q),this.copyMouseData($,Q),this.copyData($,Q),Q.nativeEvent=$.nativeEvent,Q.originalEvent=$,Q.target=J??this.hitTest(Q.global.x,Q.global.y)??this._hitElements[0],typeof Z=="string"&&(Q.type=Z),Q}createWheelEvent($){const Z=this.allocateEvent(w8);return this.copyWheelData($,Z),this.copyMouseData($,Z),this.copyData($,Z),Z.nativeEvent=$.nativeEvent,Z.originalEvent=$,Z.target=this.hitTest(Z.global.x,Z.global.y),Z}clonePointerEvent($,Z){const J=this.allocateEvent(w$);return J.nativeEvent=$.nativeEvent,J.originalEvent=$.originalEvent,this.copyPointerData($,J),this.copyMouseData($,J),this.copyData($,J),J.target=$.target,J.path=$.composedPath().slice(),J.type=Z??J.type,J}copyWheelData($,Z){Z.deltaMode=$.deltaMode,Z.deltaX=$.deltaX,Z.deltaY=$.deltaY,Z.deltaZ=$.deltaZ}copyPointerData($,Z){$ instanceof w$&&Z instanceof w$&&(Z.pointerId=$.pointerId,Z.width=$.width,Z.height=$.height,Z.isPrimary=$.isPrimary,Z.pointerType=$.pointerType,Z.pressure=$.pressure,Z.tangentialPressure=$.tangentialPressure,Z.tiltX=$.tiltX,Z.tiltY=$.tiltY,Z.twist=$.twist)}copyMouseData($,Z){$ instanceof y8&&Z instanceof y8&&(Z.altKey=$.altKey,Z.button=$.button,Z.buttons=$.buttons,Z.client.copyFrom($.client),Z.ctrlKey=$.ctrlKey,Z.metaKey=$.metaKey,Z.movement.copyFrom($.movement),Z.screen.copyFrom($.screen),Z.shiftKey=$.shiftKey,Z.global.copyFrom($.global))}copyData($,Z){Z.isTrusted=$.isTrusted,Z.srcElement=$.srcElement,Z.timeStamp=performance.now(),Z.type=$.type,Z.detail=$.detail,Z.view=$.view,Z.which=$.which,Z.layer.copyFrom($.layer),Z.page.copyFrom($.page)}trackingData($){return this.mappingState.trackingData[$]||(this.mappingState.trackingData[$]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[$]}allocateEvent($){this.eventPool.has($)||this.eventPool.set($,[]);const Z=this.eventPool.get($).pop()||new $(this);return Z.eventPhase=Z.NONE,Z.currentTarget=null,Z.path=null,Z.target=null,Z}freeEvent($){if($.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const Z=$.constructor;this.eventPool.has(Z)||this.eventPool.set(Z,[]),this.eventPool.get(Z).push($)}notifyListeners($,Z){const J=$.currentTarget._events[Z];if(J&&$.currentTarget.isInteractive())if("fn"in J)J.once&&$.currentTarget.removeListener(Z,J.fn,void 0,!0),J.fn.call(J.context,$);else for(let Q=0,K=J.length;Q<K&&!$.propagationImmediatelyStopped;Q++)J[Q].once&&$.currentTarget.removeListener(Z,J[Q].fn,void 0,!0),J[Q].fn.call(J[Q].context,$)}}var lw=1,nw={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},N1=class ${constructor(Z){this.supportsTouchEvents=("ontouchstart"in globalThis),this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=Z,this.rootBoundary=new WZ(null),Y8.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new w$(null),this.rootWheelEvent=new w8(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...$.defaultEventFeatures},{set:(J,Q,K)=>(Q==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=K),J[Q]=K,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(Z){const{view:J,resolution:Q}=this.renderer;this.setTargetElement(J),this.resolution=Q,$._defaultEventMode=Z.eventMode??"auto",Object.assign(this.features,Z.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(Z){this.resolution=Z}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(Z){Z=Z||"default";let J=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(J=!1),this.currentCursor===Z)return;this.currentCursor=Z;const Q=this.cursorStyles[Z];if(Q)switch(typeof Q){case"string":J&&(this.domElement.style.cursor=Q);break;case"function":Q(Z);break;case"object":J&&Object.assign(this.domElement.style,Q);break}else J&&typeof Z=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,Z)&&(this.domElement.style.cursor=Z)}get pointer(){return this.rootPointerEvent}onPointerDown(Z){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const J=this.normalizeToPointerData(Z);this.autoPreventDefault&&J[0].isNormalized&&(Z.cancelable||!("cancelable"in Z))&&Z.preventDefault();for(let Q=0,K=J.length;Q<K;Q++){const q=J[Q],V=this.bootstrapEvent(this.rootPointerEvent,q);this.rootBoundary.mapEvent(V)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(Z){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Y8.pointerMoved();const J=this.normalizeToPointerData(Z);for(let Q=0,K=J.length;Q<K;Q++){const q=this.bootstrapEvent(this.rootPointerEvent,J[Q]);this.rootBoundary.mapEvent(q)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(Z){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let J=Z.target;Z.composedPath&&Z.composedPath().length>0&&(J=Z.composedPath()[0]);const Q=J!==this.domElement?"outside":"",K=this.normalizeToPointerData(Z);for(let q=0,V=K.length;q<V;q++){const X=this.bootstrapEvent(this.rootPointerEvent,K[q]);X.type+=Q,this.rootBoundary.mapEvent(X)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(Z){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const J=this.normalizeToPointerData(Z);for(let Q=0,K=J.length;Q<K;Q++){const q=this.bootstrapEvent(this.rootPointerEvent,J[Q]);this.rootBoundary.mapEvent(q)}this.setCursor(this.rootBoundary.cursor)}onWheel(Z){if(!this.features.wheel)return;const J=this.normalizeWheelEvent(Z);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(J)}setTargetElement(Z){this.removeEvents(),this.domElement=Z,Y8.domElement=Z,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Y8.addTickerListener();const Z=this.domElement.style;Z&&(globalThis.navigator.msPointerEnabled?(Z.msContentZooming="none",Z.msTouchAction="none"):this.supportsPointerEvents&&(Z.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Y8.removeTickerListener();const Z=this.domElement.style;globalThis.navigator.msPointerEnabled?(Z.msContentZooming="",Z.msTouchAction=""):this.supportsPointerEvents&&(Z.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(Z,J,Q){const K=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},q=1/this.resolution;Z.x=(J-K.left)*(this.domElement.width/K.width)*q,Z.y=(Q-K.top)*(this.domElement.height/K.height)*q}normalizeToPointerData(Z){const J=[];if(this.supportsTouchEvents&&Z instanceof TouchEvent)for(let Q=0,K=Z.changedTouches.length;Q<K;Q++){const q=Z.changedTouches[Q];typeof q.button>"u"&&(q.button=0),typeof q.buttons>"u"&&(q.buttons=1),typeof q.isPrimary>"u"&&(q.isPrimary=Z.touches.length===1&&Z.type==="touchstart"),typeof q.width>"u"&&(q.width=q.radiusX||1),typeof q.height>"u"&&(q.height=q.radiusY||1),typeof q.tiltX>"u"&&(q.tiltX=0),typeof q.tiltY>"u"&&(q.tiltY=0),typeof q.pointerType>"u"&&(q.pointerType="touch"),typeof q.pointerId>"u"&&(q.pointerId=q.identifier||0),typeof q.pressure>"u"&&(q.pressure=q.force||0.5),typeof q.twist>"u"&&(q.twist=0),typeof q.tangentialPressure>"u"&&(q.tangentialPressure=0),typeof q.layerX>"u"&&(q.layerX=q.offsetX=q.clientX),typeof q.layerY>"u"&&(q.layerY=q.offsetY=q.clientY),q.isNormalized=!0,q.type=Z.type,J.push(q)}else if(!globalThis.MouseEvent||Z instanceof MouseEvent&&(!this.supportsPointerEvents||!(Z instanceof globalThis.PointerEvent))){const Q=Z;typeof Q.isPrimary>"u"&&(Q.isPrimary=!0),typeof Q.width>"u"&&(Q.width=1),typeof Q.height>"u"&&(Q.height=1),typeof Q.tiltX>"u"&&(Q.tiltX=0),typeof Q.tiltY>"u"&&(Q.tiltY=0),typeof Q.pointerType>"u"&&(Q.pointerType="mouse"),typeof Q.pointerId>"u"&&(Q.pointerId=lw),typeof Q.pressure>"u"&&(Q.pressure=0.5),typeof Q.twist>"u"&&(Q.twist=0),typeof Q.tangentialPressure>"u"&&(Q.tangentialPressure=0),Q.isNormalized=!0,J.push(Q)}else J.push(Z);return J}normalizeWheelEvent(Z){const J=this.rootWheelEvent;return this.transferMouseData(J,Z),J.deltaX=Z.deltaX,J.deltaY=Z.deltaY,J.deltaZ=Z.deltaZ,J.deltaMode=Z.deltaMode,this.mapPositionToPoint(J.screen,Z.clientX,Z.clientY),J.global.copyFrom(J.screen),J.offset.copyFrom(J.screen),J.nativeEvent=Z,J.type=Z.type,J}bootstrapEvent(Z,J){return Z.originalEvent=null,Z.nativeEvent=J,Z.pointerId=J.pointerId,Z.width=J.width,Z.height=J.height,Z.isPrimary=J.isPrimary,Z.pointerType=J.pointerType,Z.pressure=J.pressure,Z.tangentialPressure=J.tangentialPressure,Z.tiltX=J.tiltX,Z.tiltY=J.tiltY,Z.twist=J.twist,this.transferMouseData(Z,J),this.mapPositionToPoint(Z.screen,J.clientX,J.clientY),Z.global.copyFrom(Z.screen),Z.offset.copyFrom(Z.screen),Z.isTrusted=J.isTrusted,Z.type==="pointerleave"&&(Z.type="pointerout"),Z.type.startsWith("mouse")&&(Z.type=Z.type.replace("mouse","pointer")),Z.type.startsWith("touch")&&(Z.type=nw[Z.type]||Z.type),Z}transferMouseData(Z,J){Z.isTrusted=J.isTrusted,Z.srcElement=J.srcElement,Z.timeStamp=performance.now(),Z.type=J.type,Z.altKey=J.altKey,Z.button=J.button,Z.buttons=J.buttons,Z.client.x=J.clientX,Z.client.y=J.clientY,Z.ctrlKey=J.ctrlKey,Z.metaKey=J.metaKey,Z.movement.x=J.movementX,Z.movement.y=J.movementY,Z.page.x=J.pageX,Z.page.y=J.pageY,Z.relatedTarget=null,Z.shiftKey=J.shiftKey}};N1.extension={name:"events",type:[I.RendererSystem,I.CanvasRendererSystem]},N1.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};var S5=N1;P.add(S5);var xX=function($){return $==="dynamic"||$==="static"},mX={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??xX(S5.defaultEventMode)},set interactive($){T.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=$,this.eventMode=$?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??S5.defaultEventMode},set eventMode($){this._internalInteractive=xX($),this._internalEventMode=$},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener($,Z,J){const Q=typeof J=="boolean"&&J||typeof J=="object"&&J.capture,K=typeof Z=="function"?void 0:Z;$=Q?`${$}capture`:$,Z=typeof Z=="function"?Z:Z.handleEvent,this.on($,Z,K)},removeEventListener($,Z,J){const Q=typeof J=="boolean"&&J||typeof J=="object"&&J.capture,K=typeof Z=="function"?void 0:Z;$=Q?`${$}capture`:$,Z=typeof Z=="function"?Z:Z.handleEvent,this.off($,Z,K)},dispatchEvent($){if(!($ instanceof f8))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return $.defaultPrevented=!1,$.path=null,$.target=this,$.manager.dispatchEvent($),!$.defaultPrevented}};W0.mixin(mX);var C1={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};W0.mixin(C1);var ow=9,UZ=100,sw=0,iw=0,cX=2,pX=1,aw=-1000,rw=-1000,tw=2;class zZ{constructor($){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(T.isMobile.tablet||T.isMobile.phone)&&this.createTouchHook();const Z=document.createElement("div");Z.style.width=`${UZ}px`,Z.style.height=`${UZ}px`,Z.style.position="absolute",Z.style.top=`${sw}px`,Z.style.left=`${iw}px`,Z.style.zIndex=cX.toString(),this.div=Z,this.renderer=$,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const $=document.createElement("button");$.style.width=`${pX}px`,$.style.height=`${pX}px`,$.style.position="absolute",$.style.top=`${aw}px`,$.style.left=`${rw}px`,$.style.zIndex=tw.toString(),$.style.backgroundColor="#FF0000",$.title="select to enable accessibility for this content",$.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild($),this._hookDiv=$}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects($){if(!$.visible||!$.accessibleChildren)return;$.accessible&&$.isInteractive()&&($._accessibleActive||this.addChild($),$.renderId=this.renderId);const Z=$.children;if(Z)for(let J=0;J<Z.length;J++)this.updateAccessibleObjects(Z[J])}update(){const $=performance.now();if(T.isMobile.android.device&&$<this.androidUpdateCount||(this.androidUpdateCount=$+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:Z,y:J,width:Q,height:K}=this.renderer.view.getBoundingClientRect(),{width:q,height:V,resolution:X}=this.renderer,W=Q/q*X,U=K/V*X;let z=this.div;z.style.left=`${Z}px`,z.style.top=`${J}px`,z.style.width=`${q}px`,z.style.height=`${V}px`;for(let H=0;H<this.children.length;H++){const G=this.children[H];if(G.renderId!==this.renderId)G._accessibleActive=!1,T.removeItems(this.children,H,1),this.div.removeChild(G._accessibleDiv),this.pool.push(G._accessibleDiv),G._accessibleDiv=null,H--;else{z=G._accessibleDiv;let Y=G.hitArea;const w=G.worldTransform;G.hitArea?(z.style.left=`${(w.tx+Y.x*w.a)*W}px`,z.style.top=`${(w.ty+Y.y*w.d)*U}px`,z.style.width=`${Y.width*w.a*W}px`,z.style.height=`${Y.height*w.d*U}px`):(Y=G.getBounds(),this.capHitArea(Y),z.style.left=`${Y.x*W}px`,z.style.top=`${Y.y*U}px`,z.style.width=`${Y.width*W}px`,z.style.height=`${Y.height*U}px`,z.title!==G.accessibleTitle&&G.accessibleTitle!==null&&(z.title=G.accessibleTitle),z.getAttribute("aria-label")!==G.accessibleHint&&G.accessibleHint!==null&&z.setAttribute("aria-label",G.accessibleHint)),(G.accessibleTitle!==z.title||G.tabIndex!==z.tabIndex)&&(z.title=G.accessibleTitle,z.tabIndex=G.tabIndex,this.debug&&this.updateDebugHTML(z))}}this.renderId++}updateDebugHTML($){$.innerHTML=`type: ${$.type}</br> title : ${$.title}</br> tabIndex: ${$.tabIndex}`}capHitArea($){$.x<0&&($.width+=$.x,$.x=0),$.y<0&&($.height+=$.y,$.y=0);const{width:Z,height:J}=this.renderer;$.x+$.width>Z&&($.width=Z-$.x),$.y+$.height>J&&($.height=J-$.y)}addChild($){let Z=this.pool.pop();Z||(Z=document.createElement("button"),Z.style.width=`${UZ}px`,Z.style.height=`${UZ}px`,Z.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",Z.style.position="absolute",Z.style.zIndex=cX.toString(),Z.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?Z.setAttribute("aria-live","off"):Z.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?Z.setAttribute("aria-relevant","additions"):Z.setAttribute("aria-relevant","text"),Z.addEventListener("click",this._onClick.bind(this)),Z.addEventListener("focus",this._onFocus.bind(this)),Z.addEventListener("focusout",this._onFocusOut.bind(this))),Z.style.pointerEvents=$.accessiblePointerEvents,Z.type=$.accessibleType,$.accessibleTitle&&$.accessibleTitle!==null?Z.title=$.accessibleTitle:(!$.accessibleHint||$.accessibleHint===null)&&(Z.title=`displayObject ${$.tabIndex}`),$.accessibleHint&&$.accessibleHint!==null&&Z.setAttribute("aria-label",$.accessibleHint),this.debug&&this.updateDebugHTML(Z),$._accessibleActive=!0,$._accessibleDiv=Z,Z.displayObject=$,this.children.push($),this.div.appendChild($._accessibleDiv),$._accessibleDiv.tabIndex=$.tabIndex}_dispatchEvent($,Z){const{displayObject:J}=$.target,Q=this.renderer.events.rootBoundary,K=Object.assign(new f8(Q),{target:J});Q.rootTarget=this.renderer.lastObjectRendered,Z.forEach((q)=>Q.dispatchEvent(K,q))}_onClick($){this._dispatchEvent($,["click","pointertap","tap"])}_onFocus($){$.target.getAttribute("aria-live")||$.target.setAttribute("aria-live","assertive"),this._dispatchEvent($,["mouseover"])}_onFocusOut($){$.target.getAttribute("aria-live")||$.target.setAttribute("aria-live","polite"),this._dispatchEvent($,["mouseout"])}_onKeyDown($){$.keyCode===ow&&this.activate()}_onMouseMove($){$.movementX===0&&$.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}zZ.extension={name:"accessibility",type:[I.RendererPlugin,I.CanvasRendererPlugin]};P.add(zZ);var uX=class ${constructor(Z){this.stage=new r,Z=Object.assign({forceCanvas:!1},Z),this.renderer=W1(Z),$._plugins.forEach((J)=>{J.init.call(this,Z)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(Z,J){const Q=$._plugins.slice(0);Q.reverse(),Q.forEach((K)=>{K.destroy.call(this)}),this.stage.destroy(J),this.stage=null,this.renderer.destroy(Z),this.renderer=null}};uX._plugins=[];var HZ=uX;P.handleByList(I.Application,HZ._plugins);class GZ{static init($){Object.defineProperty(this,"resizeTo",{set(Z){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=Z,Z&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let Z,J;if(this._resizeTo===globalThis.window)Z=globalThis.innerWidth,J=globalThis.innerHeight;else{const{clientWidth:Q,clientHeight:K}=this._resizeTo;Z=Q,J=K}this.renderer.resize(Z,J),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=$.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}GZ.extension=I.Application;P.add(GZ);var dX={loader:I.LoadParser,resolver:I.ResolveParser,cache:I.CacheParser,detection:I.DetectionParser};P.handle(I.Asset,($)=>{const Z=$.ref;Object.entries(dX).filter(([J])=>!!Z[J]).forEach(([J,Q])=>P.add(Object.assign(Z[J],{extension:Z[J].extension??Q})))},($)=>{const Z=$.ref;Object.keys(dX).filter((J)=>!!Z[J]).forEach((J)=>P.remove(Z[J]))});class L1{constructor($,Z=!1){this._loader=$,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=Z}add($){$.forEach((Z)=>{this._assetList.push(Z)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const $=[],Z=Math.min(this._assetList.length,this._maxConcurrent);for(let J=0;J<Z;J++)$.push(this._assetList.pop());await this._loader.load($),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active($){this._isActive!==$&&(this._isActive=$,$&&!this._isLoading&&this._next())}}var P$=function($,Z){if(Array.isArray(Z)){for(let J of Z)if($.startsWith(`data:${J}`))return!0;return!1}return $.startsWith(`data:${Z}`)};var u0=function($,Z){const J=$.split("?")[0],Q=T.path.extname(J).toLowerCase();return Array.isArray(Z)?Z.includes(Q):Q===Z};var r0=($,Z,J=!1)=>(Array.isArray($)||($=[$]),Z?$.map((Q)=>typeof Q=="string"||J?Z(Q):Q):$);var E6=($,Z)=>{const J=Z.split("?")[1];return J&&($+=`?${J}`),$};var lX=function($,Z,J,Q,K){const q=Z[J];for(let V=0;V<q.length;V++){const X=q[V];J<Z.length-1?lX($.replace(Q[J],X),Z,J+1,Q,K):K.push($.replace(Q[J],X))}},YZ=function($){const Z=/\{(.*?)\}/g,J=$.match(Z),Q=[];if(J){const K=[];J.forEach((q)=>{const V=q.substring(1,q.length-1).split(",");K.push(V)}),lX($,K,0,J,Q)}else Q.push($);return Q};var g8=($)=>!Array.isArray($);class nX{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has($){return this._cache.has($)}get($){const Z=this._cache.get($);return Z||console.warn(`[Assets] Asset id ${$} was not found in the Cache`),Z}set($,Z){const J=r0($);let Q;for(let V=0;V<this.parsers.length;V++){const X=this.parsers[V];if(X.test(Z)){Q=X.getCacheableAssets(J,Z);break}}Q||(Q={},J.forEach((V)=>{Q[V]=Z}));const K=Object.keys(Q),q={cacheKeys:K,keys:J};if(J.forEach((V)=>{this._cacheMap.set(V,q)}),K.forEach((V)=>{this._cache.has(V)&&this._cache.get(V)!==Z&&console.warn("[Cache] already has key:",V),this._cache.set(V,Q[V])}),Z instanceof f){const V=Z;J.forEach((X)=>{V.baseTexture!==f.EMPTY.baseTexture&&n.addToCache(V.baseTexture,X),f.addToCache(V,X)})}}remove($){if(!this._cacheMap.has($)){console.warn(`[Assets] Asset id ${$} was not found in the Cache`);return}const Z=this._cacheMap.get($);Z.cacheKeys.forEach((J)=>{this._cache.delete(J)}),Z.keys.forEach((J)=>{this._cacheMap.delete(J)})}get parsers(){return this._parsers}}var e$=new nX;class _1{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:($,Z,J)=>(this._parsersValidated=!1,$[Z]=J,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser($,Z){const J={promise:null,parser:null};return J.promise=(async()=>{let Q=null,K=null;if(Z.loadParser&&(K=this._parserHash[Z.loadParser],K||console.warn(`[Assets] specified load parser "${Z.loadParser}" not found while loading ${$}`)),!K){for(let q=0;q<this.parsers.length;q++){const V=this.parsers[q];if(V.load&&V.test?.($,Z,this)){K=V;break}}if(!K)return console.warn(`[Assets] ${$} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}Q=await K.load($,Z,this),J.parser=K;for(let q=0;q<this.parsers.length;q++){const V=this.parsers[q];V.parse&&V.parse&&await V.testParse?.(Q,Z,this)&&(Q=await V.parse(Q,Z,this)||Q,J.parser=V)}return Q})(),J}async load($,Z){this._parsersValidated||this._validateParsers();let J=0;const Q={},K=g8($),q=r0($,(W)=>({alias:[W],src:W})),V=q.length,X=q.map(async(W)=>{const U=T.path.toAbsolute(W.src);if(!Q[W.src])try{this.promiseCache[U]||(this.promiseCache[U]=this._getLoadPromiseAndParser(U,W)),Q[W.src]=await this.promiseCache[U].promise,Z&&Z(++J/V)}catch(z){throw delete this.promiseCache[U],delete Q[W.src],new Error(`[Loader.load] Failed to load ${U}.
${z}`)}});return await Promise.all(X),K?Q[q[0].src]:Q}async unload($){const Z=r0($,(J)=>({alias:[J],src:J})).map(async(J)=>{const Q=T.path.toAbsolute(J.src),K=this.promiseCache[Q];if(K){const q=await K.promise;delete this.promiseCache[Q],K.parser?.unload?.(q,J,this)}});await Promise.all(Z)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(($)=>$.name).reduce(($,Z)=>($[Z.name]&&console.warn(`[Assets] loadParser name conflict "${Z.name}"`),{...$,[Z.name]:Z}),{})}}var I0=(($)=>($[$.Low=0]="Low",$[$.Normal=1]="Normal",$[$.High=2]="High",$))(I0||{});var ew=".json",$j="application/json",O1={extension:{type:I.LoadParser,priority:I0.Low},name:"loadJson",test($){return P$($,$j)||u0($,ew)},async load($){return await(await R.ADAPTER.fetch($)).json()}};P.add(O1);var Zj=".txt",Jj="text/plain",I1={name:"loadTxt",extension:{type:I.LoadParser,priority:I0.Low},test($){return P$($,Jj)||u0($,Zj)},async load($){return await(await R.ADAPTER.fetch($)).text()}};P.add(I1);var R1=function($){const Z=T.path.extname($),J=T.path.basename($,Z).replace(/(-|_)/g," ").toLowerCase().split(" ").map((q)=>q.charAt(0).toUpperCase()+q.slice(1));let Q=J.length>0;for(let q of J)if(!q.match(Vj)){Q=!1;break}let K=J.join(" ");return Q||(K=`"${K.replace(/[\\"]/g,"\\$&")}"`),K},Wj=function($){return Xj.test($)?$:encodeURI($)},Qj=["normal","bold","100","200","300","400","500","600","700","800","900"],Kj=[".ttf",".otf",".woff",".woff2"],qj=["font/ttf","font/otf","font/woff","font/woff2"],Vj=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,Xj=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/,P1={extension:{type:I.LoadParser,priority:I0.Low},name:"loadWebFont",test($){return P$($,qj)||u0($,Kj)},async load($,Z){const J=R.ADAPTER.getFontFaceSet();if(J){const Q=[],K=Z.data?.family??R1($),q=Z.data?.weights?.filter((X)=>Qj.includes(X))??["normal"],V=Z.data??{};for(let X=0;X<q.length;X++){const W=q[X],U=new FontFace(K,`url(${Wj($)})`,{...V,weight:W});await U.load(),J.add(U),Q.push(U)}return Q.length===1?Q[0]:Q}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload($){(Array.isArray($)?$:[$]).forEach((Z)=>R.ADAPTER.getFontFaceSet().delete(Z))}};P.add(P1);var oX=0,D1,Uj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",zj={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Uj}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Hj={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`},A1;class sX{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(($)=>{const Z=URL.createObjectURL(new Blob([zj.code],{type:"application/javascript"})),J=new Worker(Z);J.addEventListener("message",(Q)=>{J.terminate(),URL.revokeObjectURL(Z),$(Q.data)})}),this._isImageBitmapSupported)}loadImageBitmap($){return this._run("loadImageBitmap",[$])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){D1===void 0&&(D1=navigator.hardwareConcurrency||4);let $=this.workerPool.pop();return!$&&this._createdWorkers<D1&&(A1||(A1=URL.createObjectURL(new Blob([Hj.code],{type:"application/javascript"}))),this._createdWorkers++,$=new Worker(A1),$.addEventListener("message",(Z)=>{this.complete(Z.data),this.returnWorker(Z.target),this.next()})),$}returnWorker($){this.workerPool.push($)}complete($){$.error!==void 0?this.resolveHash[$.uuid].reject($.error):this.resolveHash[$.uuid].resolve($.data),this.resolveHash[$.uuid]=null}async _run($,Z){await this._initWorkers();const J=new Promise((Q,K)=>{this.queue.push({id:$,arguments:Z,resolve:Q,reject:K})});return this.next(),J}next(){if(!this.queue.length)return;const $=this.getWorker();if(!$)return;const Z=this.queue.pop(),J=Z.id;this.resolveHash[oX]={resolve:Z.resolve,reject:Z.reject},$.postMessage({data:Z.arguments,uuid:oX++,id:J})}}var M1=new sX;var p$=function($,Z,J){$.resource.internal=!0;const Q=new f($),K=()=>{delete Z.promiseCache[J],e$.has(J)&&e$.remove(J)};return Q.baseTexture.once("destroyed",()=>{(J in Z.promiseCache)&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),K())}),Q.once("destroyed",()=>{$.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),K())}),Q};async function k1($){const Z=await R.ADAPTER.fetch($);if(!Z.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${$}: ${Z.status} ${Z.statusText}`);const J=await Z.blob();return await createImageBitmap(J)}var Gj=[".jpeg",".jpg",".png",".webp",".avif"],Yj=["image/jpeg","image/png","image/webp","image/avif"],x8={name:"loadTextures",extension:{type:I.LoadParser,priority:I0.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test($){return P$($,Yj)||u0($,Gj)},async load($,Z,J){const Q=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let K;Q?this.config.preferWorkers&&await M1.isImageBitmapSupported()?K=await M1.loadImageBitmap($):K=await k1($):K=await new Promise((X,W)=>{const U=new Image;U.crossOrigin=this.config.crossOrigin,U.src=$,U.complete?X(U):(U.onload=()=>X(U),U.onerror=(z)=>W(z))});const q={...Z.data};q.resolution??(q.resolution=T.getResolutionOfUrl($)),Q&&q.resourceOptions?.ownsImageBitmap===void 0&&(q.resourceOptions={...q.resourceOptions},q.resourceOptions.ownsImageBitmap=!0);const V=new n(K,q);return V.resource.src=$,p$(V,J,$)},unload($){$.destroy(!0)}};P.add(x8);var wj=".svg",jj="image/svg+xml",E1={extension:{type:I.LoadParser,priority:I0.High},name:"loadSVG",test($){return P$($,jj)||u0($,wj)},async testParse($){return H7.test($)},async parse($,Z,J){const Q=new H7($,Z?.data?.resourceOptions);await Q.load();const K=new n(Q,{resolution:T.getResolutionOfUrl($),...Z?.data});return K.resource.src=Z.src,p$(K,J,Z.src)},async load($,Z){return(await R.ADAPTER.fetch($)).text()},unload:x8.unload};P.add(E1);var Bj=[".mp4",".m4v",".webm",".ogv"],Fj=["video/mp4","video/webm","video/ogg"],T1={name:"loadVideo",extension:{type:I.LoadParser,priority:I0.High},config:{defaultAutoPlay:!0},test($){return P$($,Fj)||u0($,Bj)},async load($,Z,J){let Q;const K=await(await R.ADAPTER.fetch($)).blob(),q=URL.createObjectURL(K);try{const V={autoPlay:this.config.defaultAutoPlay,...Z?.data?.resourceOptions},X=new T5(q,V);await X.load();const W=new n(X,{alphaMode:await T.detectVideoAlphaMode(),resolution:T.getResolutionOfUrl($),...Z?.data});W.resource.src=$,Q=p$(W,J,$),Q.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(q)})}catch(V){throw URL.revokeObjectURL(q),V}return Q},unload($){$.destroy(!0)}};P.add(T1);class b1{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:($,Z)=>`${$}${this._bundleIdConnector}${Z}`,extractAssetIdFromBundle:($,Z)=>Z.replace(`${$}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier($){if(this._bundleIdConnector=$.connector??this._bundleIdConnector,this._createBundleAssetId=$.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=$.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...$){$.forEach((Z)=>{this._preferredOrder.push(Z),Z.priority||(Z.priority=Object.keys(Z.params))}),this._resolverHash={}}set basePath($){this._basePath=$}get basePath(){return this._basePath}set rootPath($){this._rootPath=$}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams($){if(typeof $=="string")this._defaultSearchParams=$;else{const Z=$;this._defaultSearchParams=Object.keys(Z).map((J)=>`${encodeURIComponent(J)}=${encodeURIComponent(Z[J])}`).join("&")}}getAlias($){const{alias:Z,name:J,src:Q,srcs:K}=$;return r0(Z||J||Q||K,(q)=>typeof q=="string"?q:Array.isArray(q)?q.map((V)=>V?.src??V?.srcs??V):q?.src||q?.srcs?q.src??q.srcs:q,!0)}addManifest($){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=$,$.bundles.forEach((Z)=>{this.addBundle(Z.name,Z.assets)})}addBundle($,Z){const J=[];Array.isArray(Z)?Z.forEach((Q)=>{const K=Q.src??Q.srcs,q=Q.alias??Q.name;let V;if(typeof q=="string"){const X=this._createBundleAssetId($,q);J.push(X),V=[q,X]}else{const X=q.map((W)=>this._createBundleAssetId($,W));J.push(...X),V=[...q,...X]}this.add({...Q,alias:V,src:K})}):Object.keys(Z).forEach((Q)=>{const K=[Q,this._createBundleAssetId($,Q)];if(typeof Z[Q]=="string")this.add({alias:K,src:Z[Q]});else if(Array.isArray(Z[Q]))this.add({alias:K,src:Z[Q]});else{const q=Z[Q],V=q.src??q.srcs;this.add({...q,alias:K,src:Array.isArray(V)?V:[V]})}J.push(...K)}),this._bundles[$]=J}add($,Z,J,Q,K){const q=[];typeof $=="string"||Array.isArray($)&&typeof $[0]=="string"?(T.deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),q.push({alias:$,src:Z,data:J,format:Q,loadParser:K})):Array.isArray($)?q.push(...$):q.push($);let V;V=(X)=>{this.hasKey(X)&&console.warn(`[Resolver] already has key: ${X} overwriting`)},r0(q).forEach((X)=>{const{src:W,srcs:U}=X;let{data:z,format:H,loadParser:G}=X;const Y=r0(W||U).map((B)=>typeof B=="string"?YZ(B):Array.isArray(B)?B:[B]),w=this.getAlias(X);Array.isArray(w)?w.forEach(V):V(w);const j=[];Y.forEach((B)=>{B.forEach((C)=>{let N={};if(typeof C!="object"){N.src=C;for(let F=0;F<this._parsers.length;F++){const L=this._parsers[F];if(L.test(C)){N=L.parse(C);break}}}else z=C.data??z,H=C.format??H,G=C.loadParser??G,N={...N,...C};if(!w)throw new Error(`[Resolver] alias is undefined for this asset: ${N.src}`);N=this.buildResolvedAsset(N,{aliases:w,data:z,format:H,loadParser:G}),j.push(N)})}),w.forEach((B)=>{this._assetMap[B]=j})})}resolveBundle($){const Z=g8($);$=r0($);const J={};return $.forEach((Q)=>{const K=this._bundles[Q];if(K){const q=this.resolve(K),V={};for(let X in q){const W=q[X];V[this._extractAssetIdFromBundle(Q,X)]=W}J[Q]=V}}),Z?J[$[0]]:J}resolveUrl($){const Z=this.resolve($);if(typeof $!="string"){const J={};for(let Q in Z)J[Q]=Z[Q].src;return J}return Z.src}resolve($){const Z=g8($);$=r0($);const J={};return $.forEach((Q)=>{if(!this._resolverHash[Q])if(this._assetMap[Q]){let K=this._assetMap[Q];const q=K[0],V=this._getPreferredOrder(K);V?.priority.forEach((X)=>{V.params[X].forEach((W)=>{const U=K.filter((z)=>z[X]?z[X]===W:!1);U.length&&(K=U)})}),this._resolverHash[Q]=K[0]??q}else this._resolverHash[Q]=this.buildResolvedAsset({alias:[Q],src:Q},{});J[Q]=this._resolverHash[Q]}),Z?J[$[0]]:J}hasKey($){return!!this._assetMap[$]}hasBundle($){return!!this._bundles[$]}_getPreferredOrder($){for(let Z=0;Z<$.length;Z++){const J=$[0],Q=this._preferredOrder.find((K)=>K.params.format.includes(J.format));if(Q)return Q}return this._preferredOrder[0]}_appendDefaultSearchParams($){if(!this._defaultSearchParams)return $;const Z=/\?/.test($)?"&":"?";return`${$}${Z}${this._defaultSearchParams}`}buildResolvedAsset($,Z){const{aliases:J,data:Q,loadParser:K,format:q}=Z;return(this._basePath||this._rootPath)&&($.src=T.path.toAbsolute($.src,this._basePath,this._rootPath)),$.alias=J??$.alias??[$.src],$.src=this._appendDefaultSearchParams($.src),$.data={...Q||{},...$.data},$.loadParser=K??$.loadParser,$.format=q??T.path.extname($.src).slice(1),$.srcs=$.src,$.name=$.alias,$}}class v1{constructor(){this._detections=[],this._initialized=!1,this.resolver=new b1,this.loader=new _1,this.cache=e$,this._backgroundLoader=new L1(this.loader),this._backgroundLoader.active=!0,this.reset()}async init($={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,$.defaultSearchParams&&this.resolver.setDefaultSearchParams($.defaultSearchParams),$.basePath&&(this.resolver.basePath=$.basePath),$.bundleIdentifier&&this.resolver.setBundleIdentifier($.bundleIdentifier),$.manifest){let K=$.manifest;typeof K=="string"&&(K=await this.load(K)),this.resolver.addManifest(K)}const Z=$.texturePreference?.resolution??1,J=typeof Z=="number"?[Z]:Z,Q=await this._detectFormats({preferredFormats:$.texturePreference?.format,skipDetections:$.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:Q,resolution:J}}),$.preferences&&this.setPreferences($.preferences)}add($,Z,J,Q,K){this.resolver.add($,Z,J,Q,K)}async load($,Z){this._initialized||await this.init();const J=g8($),Q=r0($).map((V)=>{if(typeof V!="string"){const X=this.resolver.getAlias(V);return X.some((W)=>!this.resolver.hasKey(W))&&this.add(V),Array.isArray(X)?X[0]:X}return this.resolver.hasKey(V)||this.add({alias:V,src:V}),V}),K=this.resolver.resolve(Q),q=await this._mapLoadToResolve(K,Z);return J?q[Q[0]]:q}addBundle($,Z){this.resolver.addBundle($,Z)}async loadBundle($,Z){this._initialized||await this.init();let J=!1;typeof $=="string"&&(J=!0,$=[$]);const Q=this.resolver.resolveBundle($),K={},q=Object.keys(Q);let V=0,X=0;const W=()=>{Z?.(++V/X)},U=q.map((z)=>{const H=Q[z];return X+=Object.keys(H).length,this._mapLoadToResolve(H,W).then((G)=>{K[z]=G})});return await Promise.all(U),J?K[$[0]]:K}async backgroundLoad($){this._initialized||await this.init(),typeof $=="string"&&($=[$]);const Z=this.resolver.resolve($);this._backgroundLoader.add(Object.values(Z))}async backgroundLoadBundle($){this._initialized||await this.init(),typeof $=="string"&&($=[$]);const Z=this.resolver.resolveBundle($);Object.values(Z).forEach((J)=>{this._backgroundLoader.add(Object.values(J))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get($){if(typeof $=="string")return e$.get($);const Z={};for(let J=0;J<$.length;J++)Z[J]=e$.get($[J]);return Z}async _mapLoadToResolve($,Z){const J=Object.values($),Q=Object.keys($);this._backgroundLoader.active=!1;const K=await this.loader.load(J,Z);this._backgroundLoader.active=!0;const q={};return J.forEach((V,X)=>{const W=K[V.src],U=[V.src];V.alias&&U.push(...V.alias),q[Q[X]]=W,e$.set(U,W)}),q}async unload($){this._initialized||await this.init();const Z=r0($).map((Q)=>typeof Q!="string"?Q.src:Q),J=this.resolver.resolve(Z);await this._unloadFromResolved(J)}async unloadBundle($){this._initialized||await this.init(),$=r0($);const Z=this.resolver.resolveBundle($),J=Object.keys(Z).map((Q)=>this._unloadFromResolved(Z[Q]));await Promise.all(J)}async _unloadFromResolved($){const Z=Object.values($);Z.forEach((J)=>{e$.remove(J.src)}),await this.loader.unload(Z)}async _detectFormats($){let Z=[];$.preferredFormats&&(Z=Array.isArray($.preferredFormats)?$.preferredFormats:[$.preferredFormats]);for(let J of $.detections)$.skipDetections||await J.test()?Z=await J.add(Z):$.skipDetections||(Z=await J.remove(Z));return Z=Z.filter((J,Q)=>Z.indexOf(J)===Q),Z}get detections(){return this._detections}get preferWorkers(){return x8.config.preferWorkers}set preferWorkers($){T.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:$})}setPreferences($){this.loader.parsers.forEach((Z)=>{Z.config&&Object.keys(Z.config).filter((J)=>(J in $)).forEach((J)=>{Z.config[J]=$[J]})})}}var j8=new v1;P.handleByList(I.LoadParser,j8.loader.parsers).handleByList(I.ResolveParser,j8.resolver.parsers).handleByList(I.CacheParser,j8.cache.parsers).handleByList(I.DetectionParser,j8.detections);var S1={extension:I.CacheParser,test:($)=>Array.isArray($)&&$.every((Z)=>Z instanceof f),getCacheableAssets:($,Z)=>{const J={};return $.forEach((Q)=>{Z.forEach((K,q)=>{J[Q+(q===0?"":q+1)]=K})}),J}};P.add(S1);async function wZ($){if("Image"in globalThis)return new Promise((Z)=>{const J=new Image;J.onload=()=>{Z(!0)},J.onerror=()=>{Z(!1)},J.src=$});if(("createImageBitmap"in globalThis)&&("fetch"in globalThis)){try{const Z=await(await fetch($)).blob();await createImageBitmap(Z)}catch{return!1}return!0}return!1}var h1={extension:{type:I.DetectionParser,priority:1},test:async()=>wZ("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async($)=>[...$,"avif"],remove:async($)=>$.filter((Z)=>Z!=="avif")};P.add(h1);var f1={extension:{type:I.DetectionParser,priority:0},test:async()=>wZ("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async($)=>[...$,"webp"],remove:async($)=>$.filter((Z)=>Z!=="webp")};P.add(f1);var iX=["png","jpg","jpeg"],y1={extension:{type:I.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async($)=>[...$,...iX],remove:async($)=>$.filter((Z)=>!iX.includes(Z))};P.add(y1);var Y7=function($){return Nj?!1:document.createElement("video").canPlayType($)!==""},Nj=("WorkerGlobalScope"in globalThis)&&globalThis instanceof globalThis.WorkerGlobalScope;var g1={extension:{type:I.DetectionParser,priority:0},test:async()=>Y7("video/webm"),add:async($)=>[...$,"webm"],remove:async($)=>$.filter((Z)=>Z!=="webm")};P.add(g1);var x1={extension:{type:I.DetectionParser,priority:0},test:async()=>Y7("video/mp4"),add:async($)=>[...$,"mp4","m4v"],remove:async($)=>$.filter((Z)=>Z!=="mp4"&&Z!=="m4v")};P.add(x1);var m1={extension:{type:I.DetectionParser,priority:0},test:async()=>Y7("video/ogg"),add:async($)=>[...$,"ogv"],remove:async($)=>$.filter((Z)=>Z!=="ogv")};P.add(m1);var c1={extension:I.ResolveParser,test:x8.test,parse:($)=>({resolution:parseFloat(R.RETINA_PREFIX.exec($)?.[1]??"1"),format:T.path.extname($).slice(1),src:$})};P.add(c1);var j$=(($)=>($[$.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",$[$.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",$[$.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",$[$.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",$[$.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",$[$.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",$[$.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",$[$.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",$[$.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",$[$.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",$[$.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",$[$.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",$[$.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",$[$.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",$[$.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",$[$.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",$[$.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",$[$.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",$[$.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",$[$.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",$[$.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",$[$.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",$[$.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",$[$.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",$[$.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",$[$.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",$[$.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",$))(j$||{}),Q6={33776:0.5,33777:0.5,33778:1,33779:1,35916:0.5,35917:0.5,35918:1,35919:1,37488:0.5,37489:0.5,37490:1,37491:1,37492:0.5,37496:1,37493:0.5,37497:1,37494:0.5,37495:0.5,35840:0.5,35842:0.5,35841:0.25,35843:0.25,36196:0.5,35986:0.5,35986:1,34798:1,37808:1};var aX=function(){w7={s3tc:m8.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:m8.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:m8.getExtension("WEBGL_compressed_texture_etc"),etc1:m8.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:m8.getExtension("WEBGL_compressed_texture_pvrtc")||m8.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:m8.getExtension("WEBGL_compressed_texture_atc"),astc:m8.getExtension("WEBGL_compressed_texture_astc")}},m8,w7,p1={extension:{type:I.DetectionParser,priority:2},test:async()=>{const $=R.ADAPTER.createCanvas().getContext("webgl");return $?(m8=$,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async($)=>{w7||aX();const Z=[];for(let J in w7)w7[J]&&Z.push(J);return[...Z,...$]},remove:async($)=>(w7||aX(),$.filter((Z)=>!(Z in w7)))};P.add(p1);class h5 extends W8{constructor($,Z={width:1,height:1,autoLoad:!0}){let J,Q;typeof $=="string"?(J=$,Q=new Uint8Array):(J=null,Q=$),super(Q,Z),this.origin=J,this.buffer=Q?new C6(Q):null,this._load=null,this.loaded=!1,this.origin!==null&&Z.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded($){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(($)=>$.blob()).then(($)=>$.arrayBuffer()).then(($)=>(this.data=new Uint32Array($),this.buffer=new C6($),this.loaded=!0,this.onBlobLoaded($),this.update(),this)),this._load)}}class $8 extends h5{constructor($,Z){super($,Z),this.format=Z.format,this.levels=Z.levels||1,this._width=Z.width,this._height=Z.height,this._extension=$8._formatToExtension(this.format),(Z.levelBuffers||this.buffer)&&(this._levelBuffers=Z.levelBuffers||$8._createLevelBuffers($ instanceof Uint8Array?$:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload($,Z,J){const Q=$.gl;if(!$.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;Q.pixelStorei(Q.UNPACK_ALIGNMENT,4);for(let K=0,q=this.levels;K<q;K++){const{levelID:V,levelWidth:X,levelHeight:W,levelBuffer:U}=this._levelBuffers[K];Q.compressedTexImage2D(Q.TEXTURE_2D,V,this.format,X,W,0,U)}return!0}onBlobLoaded(){this._levelBuffers=$8._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension($){if($>=33776&&$<=33779)return"s3tc";if($>=37488&&$<=37497)return"etc";if($>=35840&&$<=35843)return"pvrtc";if($>=36196)return"etc1";if($>=35986&&$<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers($,Z,J,Q,K,q,V){const X=new Array(J);let W=$.byteOffset,U=q,z=V,H=U+Q-1&~(Q-1),G=z+K-1&~(K-1),Y=H*G*Q6[Z];for(let w=0;w<J;w++)X[w]={levelID:w,levelWidth:J>1?U:H,levelHeight:J>1?z:G,levelBuffer:new Uint8Array($.buffer,W,Y)},W+=Y,U=U>>1||1,z=z>>1||1,H=U+Q-1&~(Q-1),G=z+K-1&~(K-1),Y=H*G*Q6[Z];return X}}var NZ=function($){const Z=new Uint32Array($);if(Z[0]!==Lj)throw new Error("Invalid DDS file magic word");const J=new Uint32Array($,0,jZ/Uint32Array.BYTES_PER_ELEMENT),Q=J[BZ.HEIGHT],K=J[BZ.WIDTH],q=J[BZ.MIPMAP_COUNT],V=new Uint32Array($,BZ.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,Cj/Uint32Array.BYTES_PER_ELEMENT),X=V[Oj];if(X&Rj){const W=V[_j.FOURCC];if(W!==Tj){const N=vj[W],F=u1+jZ,L=new Uint8Array($,F);return[new $8(L,{format:N,width:K,height:Q,levels:q})]}const U=u1+jZ,z=new Uint32Array(Z.buffer,U,rX/Uint32Array.BYTES_PER_ELEMENT),H=z[FZ.DXGI_FORMAT],G=z[FZ.RESOURCE_DIMENSION],Y=z[FZ.MISC_FLAG],w=z[FZ.ARRAY_SIZE],j=Sj[H];if(j===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${H}`);if(Y===bj)throw new Error("DDSParser does not support cubemap textures");if(G===6)throw new Error("DDSParser does not supported 3D texture data");const B=new Array,C=u1+jZ+rX;if(w===1)B.push(new Uint8Array($,C));else{const N=Q6[j];let F=0,L=K,k=Q;for(let O=0;O<q;O++){const h=Math.max(1,L+3&-4),c=Math.max(1,k+3&-4),S=h*c*N;F+=S,L=L>>>1,k=k>>>1}let o=C;for(let O=0;O<w;O++)B.push(new Uint8Array($,o,F)),o+=F}return B.map((N)=>new $8(N,{format:j,width:K,height:Q,levels:q}))}throw X&Pj?new Error("DDSParser does not support uncompressed texture data."):X&Dj?new Error("DDSParser does not supported YUV uncompressed texture data."):X&Aj?new Error("DDSParser does not support single-channel (lumninance) texture data!"):X&Ij?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")},u1=4,jZ=124,Cj=32,rX=20,Lj=542327876,BZ={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},_j={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},FZ={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},Oj=1,Ij=2,Rj=4,Pj=64,Dj=512,Aj=131072,Mj=827611204,kj=861165636,Ej=894720068,Tj=808540228,bj=4,vj={[Mj]:j$.COMPRESSED_RGBA_S3TC_DXT1_EXT,[kj]:j$.COMPRESSED_RGBA_S3TC_DXT3_EXT,[Ej]:j$.COMPRESSED_RGBA_S3TC_DXT5_EXT},Sj={70:j$.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:j$.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:j$.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:j$.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:j$.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:j$.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:j$.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:j$.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:j$.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};var LZ=function($,Z,J=!1){const Q=new DataView(Z);if(!fj($,Q))return null;const K=Q.getUint32(Z8.ENDIANNESS,!0)===hj,q=Q.getUint32(Z8.GL_TYPE,K),V=Q.getUint32(Z8.GL_FORMAT,K),X=Q.getUint32(Z8.GL_INTERNAL_FORMAT,K),W=Q.getUint32(Z8.PIXEL_WIDTH,K),U=Q.getUint32(Z8.PIXEL_HEIGHT,K)||1,z=Q.getUint32(Z8.PIXEL_DEPTH,K)||1,H=Q.getUint32(Z8.NUMBER_OF_ARRAY_ELEMENTS,K)||1,G=Q.getUint32(Z8.NUMBER_OF_FACES,K),Y=Q.getUint32(Z8.NUMBER_OF_MIPMAP_LEVELS,K),w=Q.getUint32(Z8.BYTES_OF_KEY_VALUE_DATA,K);if(U===0||z!==1)throw new Error("Only 2D textures are supported");if(G!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(H!==1)throw new Error("WebGL does not support array textures");const j=4,B=4,C=W+3&-4,N=U+3&-4,F=new Array(H);let L=W*U;q===0&&(L=C*N);let k;if(q!==0?CZ[q]?k=CZ[q]*l1[V]:k=n1[q]:k=Q6[X],k===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const o=J?gj(Q,w,K):null;let O=L*k,h=W,c=U,S=C,M=N,y=d1+w;for(let A=0;A<Y;A++){const b=Q.getUint32(y,K);let $0=y+4;for(let Q0=0;Q0<H;Q0++){let l=F[Q0];l||(l=F[Q0]=new Array(Y)),l[A]={levelID:A,levelWidth:Y>1||q!==0?h:S,levelHeight:Y>1||q!==0?c:M,levelBuffer:new Uint8Array(Z,$0,O)},$0+=O}y+=b+4,y=y%4!==0?y+4-y%4:y,h=h>>1||1,c=c>>1||1,S=h+j-1&~(j-1),M=c+B-1&~(B-1),O=S*M*k}return q!==0?{uncompressed:F.map((A)=>{let b=A[0].levelBuffer,$0=!1;return q===d.FLOAT?b=new Float32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4):q===d.UNSIGNED_INT?($0=!0,b=new Uint32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)):q===d.INT&&($0=!0,b=new Int32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)),{resource:new W8(b,{width:A[0].levelWidth,height:A[0].levelHeight}),type:q,format:$0?yj(V):V}}),kvData:o}:{compressed:F.map((A)=>new $8(null,{format:X,width:W,height:U,levels:Y,levelBuffers:A})),kvData:o}},fj=function($,Z){for(let J=0;J<tX.length;J++)if(Z.getUint8(J)!==tX[J])return console.error(`${$} is not a valid *.ktx file!`),!1;return!0},yj=function($){switch($){case v.RGBA:return v.RGBA_INTEGER;case v.RGB:return v.RGB_INTEGER;case v.RG:return v.RG_INTEGER;case v.RED:return v.RED_INTEGER;default:return $}},gj=function($,Z,J){const Q=new Map;let K=0;for(;K<Z;){const q=$.getUint32(d1+K,J),V=d1+K+4,X=3-(q+3)%4;if(q===0||q>Z-K){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let W=0;for(;W<q&&$.getUint8(V+W)!==0;W++);if(W===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const U=(new TextDecoder()).decode(new Uint8Array($.buffer,V,W)),z=new DataView($.buffer,V+W+1,q-W-1);Q.set(U,z),K+=4+q+X}return Q},tX=[171,75,84,88,32,49,49,187,13,10,26,10],hj=67305985,Z8={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},d1=64,CZ={[d.UNSIGNED_BYTE]:1,[d.UNSIGNED_SHORT]:2,[d.INT]:4,[d.UNSIGNED_INT]:4,[d.FLOAT]:4,[d.HALF_FLOAT]:8},l1={[v.RGBA]:4,[v.RGB]:3,[v.RG]:2,[v.RED]:1,[v.LUMINANCE]:1,[v.LUMINANCE_ALPHA]:2,[v.ALPHA]:1},n1={[d.UNSIGNED_SHORT_4_4_4_4]:2,[d.UNSIGNED_SHORT_5_5_5_1]:2,[d.UNSIGNED_SHORT_5_6_5]:2};var o1={extension:{type:I.LoadParser,priority:I0.High},name:"loadDDS",test($){return u0($,".dds")},async load($,Z,J){const Q=await(await R.ADAPTER.fetch($)).arrayBuffer(),K=NZ(Q).map((q)=>{const V=new n(q,{mipmap:s0.OFF,alphaMode:_0.NO_PREMULTIPLIED_ALPHA,resolution:T.getResolutionOfUrl($),...Z.data});return p$(V,J,$)});return K.length===1?K[0]:K},unload($){Array.isArray($)?$.forEach((Z)=>Z.destroy(!0)):$.destroy(!0)}};P.add(o1);var s1={extension:{type:I.LoadParser,priority:I0.High},name:"loadKTX",test($){return u0($,".ktx")},async load($,Z,J){const Q=await(await R.ADAPTER.fetch($)).arrayBuffer(),{compressed:K,uncompressed:q,kvData:V}=LZ($,Q),X=K??q,W={mipmap:s0.OFF,alphaMode:_0.NO_PREMULTIPLIED_ALPHA,resolution:T.getResolutionOfUrl($),...Z.data},U=X.map((z)=>{X===q&&Object.assign(W,{type:z.type,format:z.format});const H=z.resource??z,G=new n(H,W);return G.ktxKeyValueData=V,p$(G,J,$)});return U.length===1?U[0]:U},unload($){Array.isArray($)?$.forEach((Z)=>Z.destroy(!0)):$.destroy(!0)}};P.add(s1);var i1={extension:I.ResolveParser,test:($)=>{const Z=T.path.extname($).slice(1);return["basis","ktx","dds"].includes(Z)},parse:($)=>{const Z=T.path.extname($).slice(1);if(Z==="ktx"){const J=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(J.some((Q)=>$.endsWith(Q)))return{resolution:parseFloat(R.RETINA_PREFIX.exec($)?.[1]??"1"),format:J.find((Q)=>$.endsWith(Q)),src:$}}return{resolution:parseFloat(R.RETINA_PREFIX.exec($)?.[1]??"1"),format:Z,src:$}}};P.add(i1);var _Z=new m,xj=4,eX=class ${constructor(Z){this.renderer=Z,this._rendererPremultipliedAlpha=!1}contextChange(){const Z=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(Z&&Z.alpha&&Z.premultipliedAlpha)}async image(Z,J,Q,K){const q=new Image;return q.src=await this.base64(Z,J,Q,K),q}async base64(Z,J,Q,K){const q=this.canvas(Z,K);if(q.toBlob!==void 0)return new Promise((V,X)=>{q.toBlob((W)=>{if(!W){X(new Error("ICanvas.toBlob failed!"));return}const U=new FileReader;U.onload=()=>V(U.result),U.onerror=X,U.readAsDataURL(W)},J,Q)});if(q.toDataURL!==void 0)return q.toDataURL(J,Q);if(q.convertToBlob!==void 0){const V=await q.convertToBlob({type:J,quality:Q});return new Promise((X,W)=>{const U=new FileReader;U.onload=()=>X(U.result),U.onerror=W,U.readAsDataURL(V)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(Z,J){const{pixels:Q,width:K,height:q,flipY:V,premultipliedAlpha:X}=this._rawPixels(Z,J);V&&$._flipY(Q,K,q),X&&$._unpremultiplyAlpha(Q);const W=new T.CanvasRenderTarget(K,q,1),U=new ImageData(new Uint8ClampedArray(Q.buffer),K,q);return W.context.putImageData(U,0,0),W.canvas}pixels(Z,J){const{pixels:Q,width:K,height:q,flipY:V,premultipliedAlpha:X}=this._rawPixels(Z,J);return V&&$._flipY(Q,K,q),X&&$._unpremultiplyAlpha(Q),Q}_rawPixels(Z,J){const Q=this.renderer;if(!Q)throw new Error("The Extract has already been destroyed");let K,q=!1,V=!1,X,W=!1;Z&&(Z instanceof c$?X=Z:(X=Q.generateTexture(Z,{region:J,resolution:Q.resolution,multisample:Q.multisample}),W=!0,J&&(_Z.width=J.width,_Z.height=J.height,J=_Z)));const U=Q.gl;if(X){if(K=X.baseTexture.resolution,J=J??X.frame,q=!1,V=X.baseTexture.alphaMode>0&&X.baseTexture.format===v.RGBA,!W){Q.renderTexture.bind(X);const Y=X.framebuffer.glFramebuffers[Q.CONTEXT_UID];Y.blitFramebuffer&&Q.framebuffer.bind(Y.blitFramebuffer)}}else K=Q.resolution,J||(J=_Z,J.width=Q.width/K,J.height=Q.height/K),q=!0,V=this._rendererPremultipliedAlpha,Q.renderTexture.bind();const z=Math.max(Math.round(J.width*K),1),H=Math.max(Math.round(J.height*K),1),G=new Uint8Array(xj*z*H);return U.readPixels(Math.round(J.x*K),Math.round(J.y*K),z,H,U.RGBA,U.UNSIGNED_BYTE,G),W&&X?.destroy(!0),{pixels:G,width:z,height:H,flipY:q,premultipliedAlpha:V}}destroy(){this.renderer=null}static _flipY(Z,J,Q){const K=J<<2,q=Q>>1,V=new Uint8Array(K);for(let X=0;X<q;X++){const W=X*K,U=(Q-X-1)*K;V.set(Z.subarray(W,W+K)),Z.copyWithin(W,U,U+K),Z.set(V,U)}}static _unpremultiplyAlpha(Z){Z instanceof Uint8ClampedArray&&(Z=new Uint8Array(Z.buffer));const J=Z.length;for(let Q=0;Q<J;Q+=4){const K=Z[Q+3];if(K!==0){const q=255.001/K;Z[Q]=Z[Q]*q+0.5,Z[Q+1]=Z[Q+1]*q+0.5,Z[Q+2]=Z[Q+2]*q+0.5}}}};eX.extension={name:"extract",type:I.RendererSystem};var $W=eX;P.add($W);var T6={build($){const Z=$.points;let J,Q,K,q,V,X;if($.type===G0.CIRC){const w=$.shape;J=w.x,Q=w.y,V=X=w.radius,K=q=0}else if($.type===G0.ELIP){const w=$.shape;J=w.x,Q=w.y,V=w.width,X=w.height,K=q=0}else{const w=$.shape,j=w.width/2,B=w.height/2;J=w.x+j,Q=w.y+B,V=X=Math.max(0,Math.min(w.radius,Math.min(j,B))),K=j-V,q=B-X}if(!(V>=0&&X>=0&&K>=0&&q>=0)){Z.length=0;return}const W=Math.ceil(2.3*Math.sqrt(V+X)),U=W*8+(K?4:0)+(q?4:0);if(Z.length=U,U===0)return;if(W===0){Z.length=8,Z[0]=Z[6]=J+K,Z[1]=Z[3]=Q+q,Z[2]=Z[4]=J-K,Z[5]=Z[7]=Q-q;return}let z=0,H=W*4+(K?2:0)+2,G=H,Y=U;{const w=K+V,j=q,B=J+w,C=J-w,N=Q+j;if(Z[z++]=B,Z[z++]=N,Z[--H]=N,Z[--H]=C,q){const F=Q-j;Z[G++]=C,Z[G++]=F,Z[--Y]=F,Z[--Y]=B}}for(let w=1;w<W;w++){const j=Math.PI/2*(w/W),B=K+Math.cos(j)*V,C=q+Math.sin(j)*X,N=J+B,F=J-B,L=Q+C,k=Q-C;Z[z++]=N,Z[z++]=L,Z[--H]=L,Z[--H]=F,Z[G++]=F,Z[G++]=k,Z[--Y]=k,Z[--Y]=N}{const w=K,j=q+X,B=J+w,C=J-w,N=Q+j,F=Q-j;Z[z++]=B,Z[z++]=N,Z[--Y]=F,Z[--Y]=B,K&&(Z[z++]=C,Z[z++]=N,Z[--Y]=F,Z[--Y]=C)}},triangulate($,Z){const J=$.points,Q=Z.points,K=Z.indices;if(J.length===0)return;let q=Q.length/2;const V=q;let X,W;if($.type!==G0.RREC){const z=$.shape;X=z.x,W=z.y}else{const z=$.shape;X=z.x+z.width/2,W=z.y+z.height/2}const U=$.matrix;Q.push($.matrix?U.a*X+U.c*W+U.tx:X,$.matrix?U.b*X+U.d*W+U.ty:W),q++,Q.push(J[0],J[1]);for(let z=2;z<J.length;z+=2)Q.push(J[z],J[z+1]),K.push(q++,V,q);K.push(V+1,V,q)}};var ZW=function($,Z=!1){const J=$.length;if(J<6)return;let Q=0;for(let K=0,q=$[J-2],V=$[J-1];K<J;K+=2){const X=$[K],W=$[K+1];Q+=(X-q)*(W+V),q=X,V=W}if(!Z&&Q>0||Z&&Q<=0){const K=J/2;for(let q=K+K%2;q<J;q+=2){const V=J-q-2,X=J-q-1,W=q,U=q+1;[$[V],$[W]]=[$[W],$[V]],[$[X],$[U]]=[$[U],$[X]]}}},f5={build($){$.points=$.shape.points.slice()},triangulate($,Z){let J=$.points;const Q=$.holes,K=Z.points,q=Z.indices;if(J.length>=6){ZW(J,!1);const V=[];for(let U=0;U<Q.length;U++){const z=Q[U];ZW(z.points,!0),V.push(J.length/2),J=J.concat(z.points)}const X=T.earcut(J,V,2);if(!X)return;const W=K.length/2;for(let U=0;U<X.length;U+=3)q.push(X[U]+W),q.push(X[U+1]+W),q.push(X[U+2]+W);for(let U=0;U<J.length;U++)K.push(J[U])}}};var a1={build($){const Z=$.shape,J=Z.x,Q=Z.y,K=Z.width,q=Z.height,V=$.points;V.length=0,K>=0&&q>=0&&V.push(J,Q,J+K,Q,J+K,Q+q,J,Q+q)},triangulate($,Z){const J=$.points,Q=Z.points;if(J.length===0)return;const K=Q.length/2;Q.push(J[0],J[1],J[2],J[3],J[6],J[7],J[4],J[5]),Z.indices.push(K,K+1,K+2,K+1,K+2,K+3)}};var r1={build($){T6.build($)},triangulate($,Z){T6.triangulate($,Z)}};var K$=(($)=>($.MITER="miter",$.BEVEL="bevel",$.ROUND="round",$))(K$||{}),u$=(($)=>($.BUTT="butt",$.ROUND="round",$.SQUARE="square",$))(u$||{}),d$={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:0.0001,_segmentsCount($,Z=20){if(!this.adaptive||!$||isNaN($))return Z;let J=Math.ceil($/this.maxLength);return J<this.minSegments?J=this.minSegments:J>this.maxSegments&&(J=this.maxSegments),J}};class j7{static curveTo($,Z,J,Q,K,q){const V=q[q.length-2],X=q[q.length-1]-Z,W=V-$,U=Q-Z,z=J-$,H=Math.abs(X*z-W*U);if(H<0.00000001||K===0)return(q[q.length-2]!==$||q[q.length-1]!==Z)&&q.push($,Z),null;const G=X*X+W*W,Y=U*U+z*z,w=X*U+W*z,j=K*Math.sqrt(G)/H,B=K*Math.sqrt(Y)/H,C=j*w/G,N=B*w/Y,F=j*z+B*W,L=j*U+B*X,k=W*(B+C),o=X*(B+C),O=z*(j+N),h=U*(j+N),c=Math.atan2(o-L,k-F),S=Math.atan2(h-L,O-F);return{cx:F+$,cy:L+Z,radius:K,startAngle:c,endAngle:S,anticlockwise:W*U>z*X}}static arc($,Z,J,Q,K,q,V,X,W){const U=V-q,z=d$._segmentsCount(Math.abs(U)*K,Math.ceil(Math.abs(U)/s8)*40),H=U/(z*2),G=H*2,Y=Math.cos(H),w=Math.sin(H),j=z-1,B=j%1/j;for(let C=0;C<=j;++C){const N=C+B*C,F=H+q+G*N,L=Math.cos(F),k=-Math.sin(F);W.push((Y*L+w*k)*K+J,(Y*-k+w*L)*K+Q)}}}class y5{constructor(){this.reset()}begin($,Z,J){this.reset(),this.style=$,this.start=Z,this.attribStart=J}end($,Z){this.attribSize=Z-this.attribStart,this.size=$-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class B7{static curveLength($,Z,J,Q,K,q,V,X){let W=0,U=0,z=0,H=0,G=0,Y=0,w=0,j=0,B=0,C=0,N=0,F=$,L=Z;for(let k=1;k<=10;++k)U=k/10,z=U*U,H=z*U,G=1-U,Y=G*G,w=Y*G,j=w*$+3*Y*U*J+3*G*z*K+H*V,B=w*Z+3*Y*U*Q+3*G*z*q+H*X,C=F-j,N=L-B,F=j,L=B,W+=Math.sqrt(C*C+N*N);return W}static curveTo($,Z,J,Q,K,q,V){const X=V[V.length-2],W=V[V.length-1];V.length-=2;const U=d$._segmentsCount(B7.curveLength(X,W,$,Z,J,Q,K,q));let z=0,H=0,G=0,Y=0,w=0;V.push(X,W);for(let j=1,B=0;j<=U;++j)B=j/U,z=1-B,H=z*z,G=H*z,Y=B*B,w=Y*B,V.push(G*X+3*H*B*$+3*z*Y*J+w*K,G*W+3*H*B*Z+3*z*Y*Q+w*q)}}var JW=function($,Z,J,Q,K,q,V,X){const W=$-J*K,U=Z-Q*K,z=$+J*q,H=Z+Q*q;let G,Y;V?(G=Q,Y=-J):(G=-Q,Y=J);const w=W+G,j=U+Y,B=z+G,C=H+Y;return X.push(w,j,B,C),2},b6=function($,Z,J,Q,K,q,V,X){const W=J-$,U=Q-Z;let z=Math.atan2(W,U),H=Math.atan2(K-$,q-Z);X&&z<H?z+=Math.PI*2:!X&&z>H&&(H+=Math.PI*2);let G=z;const Y=H-z,w=Math.abs(Y),j=Math.sqrt(W*W+U*U),B=(15*w*Math.sqrt(j)/Math.PI>>0)+1,C=Y/B;if(G+=C,X){V.push($,Z,J,Q);for(let N=1,F=G;N<B;N++,F+=C)V.push($,Z,$+Math.sin(F)*j,Z+Math.cos(F)*j);V.push($,Z,K,q)}else{V.push(J,Q,$,Z);for(let N=1,F=G;N<B;N++,F+=C)V.push($+Math.sin(F)*j,Z+Math.cos(F)*j,$,Z);V.push(K,q,$,Z)}return B*2},mj=function($,Z){const J=$.shape;let Q=$.points||J.points.slice();const K=Z.closePointEps;if(Q.length===0)return;const q=$.lineStyle,V=new u(Q[0],Q[1]),X=new u(Q[Q.length-2],Q[Q.length-1]),W=J.type!==G0.POLY||J.closeStroke,U=Math.abs(V.x-X.x)<K&&Math.abs(V.y-X.y)<K;if(W){Q=Q.slice(),U&&(Q.pop(),Q.pop(),X.set(Q[Q.length-2],Q[Q.length-1]));const l=(V.x+X.x)*0.5,Y0=(X.y+V.y)*0.5;Q.unshift(l,Y0),Q.push(l,Y0)}const z=Z.points,H=Q.length/2;let G=Q.length;const Y=z.length/2,w=q.width/2,j=w*w,B=q.miterLimit*q.miterLimit;let C=Q[0],N=Q[1],F=Q[2],L=Q[3],k=0,o=0,O=-(N-L),h=C-F,c=0,S=0,M=Math.sqrt(O*O+h*h);O/=M,h/=M,O*=w,h*=w;const y=q.alignment,A=(1-y)*2,b=y*2;W||(q.cap===u$.ROUND?G+=b6(C-O*(A-b)*0.5,N-h*(A-b)*0.5,C-O*A,N-h*A,C+O*b,N+h*b,z,!0)+2:q.cap===u$.SQUARE&&(G+=JW(C,N,O,h,A,b,!0,z))),z.push(C-O*A,N-h*A,C+O*b,N+h*b);for(let l=1;l<H-1;++l){C=Q[(l-1)*2],N=Q[(l-1)*2+1],F=Q[l*2],L=Q[l*2+1],k=Q[(l+1)*2],o=Q[(l+1)*2+1],O=-(N-L),h=C-F,M=Math.sqrt(O*O+h*h),O/=M,h/=M,O*=w,h*=w,c=-(L-o),S=F-k,M=Math.sqrt(c*c+S*S),c/=M,S/=M,c*=w,S*=w;const Y0=F-C,b0=N-L,K0=F-k,b7=o-L,NQ=Y0*K0+b0*b7,i5=b0*K0-b7*Y0,v7=i5<0;if(Math.abs(i5)<0.001*Math.abs(NQ)){z.push(F-O*A,L-h*A,F+O*b,L+h*b),NQ>=0&&(q.join===K$.ROUND?G+=b6(F,L,F-O*A,L-h*A,F-c*A,L-S*A,z,!1)+4:G+=2,z.push(F-c*b,L-S*b,F+c*A,L+S*A));continue}const CQ=(-O+C)*(-h+L)-(-O+F)*(-h+N),LQ=(-c+k)*(-S+L)-(-c+F)*(-S+o),a5=(Y0*LQ-K0*CQ)/i5,r5=(b7*CQ-b0*LQ)/i5,_Q=(a5-F)*(a5-F)+(r5-L)*(r5-L),z6=F+(a5-F)*A,H6=L+(r5-L)*A,G6=F-(a5-F)*b,Y6=L-(r5-L)*b,Vz=Math.min(Y0*Y0+b0*b0,K0*K0+b7*b7),OQ=v7?A:b,Xz=Vz+OQ*OQ*j,Wz=_Q<=Xz;let t5=q.join;if(t5===K$.MITER&&_Q/j>B&&(t5=K$.BEVEL),Wz)switch(t5){case K$.MITER:{z.push(z6,H6,G6,Y6);break}case K$.BEVEL:{v7?z.push(z6,H6,F+O*b,L+h*b,z6,H6,F+c*b,L+S*b):z.push(F-O*A,L-h*A,G6,Y6,F-c*A,L-S*A,G6,Y6),G+=2;break}case K$.ROUND:{v7?(z.push(z6,H6,F+O*b,L+h*b),G+=b6(F,L,F+O*b,L+h*b,F+c*b,L+S*b,z,!0)+4,z.push(z6,H6,F+c*b,L+S*b)):(z.push(F-O*A,L-h*A,G6,Y6),G+=b6(F,L,F-O*A,L-h*A,F-c*A,L-S*A,z,!1)+4,z.push(F-c*A,L-S*A,G6,Y6));break}}else{switch(z.push(F-O*A,L-h*A,F+O*b,L+h*b),t5){case K$.MITER:{v7?z.push(G6,Y6,G6,Y6):z.push(z6,H6,z6,H6),G+=2;break}case K$.ROUND:{v7?G+=b6(F,L,F+O*b,L+h*b,F+c*b,L+S*b,z,!0)+2:G+=b6(F,L,F-O*A,L-h*A,F-c*A,L-S*A,z,!1)+2;break}}z.push(F-c*A,L-S*A,F+c*b,L+S*b),G+=2}}C=Q[(H-2)*2],N=Q[(H-2)*2+1],F=Q[(H-1)*2],L=Q[(H-1)*2+1],O=-(N-L),h=C-F,M=Math.sqrt(O*O+h*h),O/=M,h/=M,O*=w,h*=w,z.push(F-O*A,L-h*A,F+O*b,L+h*b),W||(q.cap===u$.ROUND?G+=b6(F-O*(A-b)*0.5,L-h*(A-b)*0.5,F-O*A,L-h*A,F+O*b,L+h*b,z,!1)+2:q.cap===u$.SQUARE&&(G+=JW(F,L,O,h,A,b,!1,z)));const $0=Z.indices,Q0=d$.epsilon*d$.epsilon;for(let l=Y;l<G+Y-2;++l)C=z[l*2],N=z[l*2+1],F=z[(l+1)*2],L=z[(l+1)*2+1],k=z[(l+2)*2],o=z[(l+2)*2+1],!(Math.abs(C*(L-o)+F*(o-N)+k*(N-L))<Q0)&&$0.push(l,l+1,l+2)},cj=function($,Z){let J=0;const Q=$.shape,K=$.points||Q.points,q=Q.type!==G0.POLY||Q.closeStroke;if(K.length===0)return;const{points:V,indices:X}=Z,W=K.length/2,U=V.length/2;let z=U;for(V.push(K[0],K[1]),J=1;J<W;J++)V.push(K[J*2],K[J*2+1]),X.push(z,z+1),z++;q&&X.push(z,U)},g5=function($,Z){$.lineStyle.native?cj($,Z):mj($,Z)};class F7{static curveLength($,Z,J,Q,K,q){const V=$-2*J+K,X=Z-2*Q+q,W=2*J-2*$,U=2*Q-2*Z,z=4*(V*V+X*X),H=4*(V*W+X*U),G=W*W+U*U,Y=2*Math.sqrt(z+H+G),w=Math.sqrt(z),j=2*z*w,B=2*Math.sqrt(G),C=H/w;return(j*Y+w*H*(Y-B)+(4*G*z-H*H)*Math.log((2*w+C+Y)/(C+B)))/(4*j)}static curveTo($,Z,J,Q,K){const q=K[K.length-2],V=K[K.length-1],X=d$._segmentsCount(F7.curveLength(q,V,$,Z,J,Q));let W=0,U=0;for(let z=1;z<=X;++z){const H=z/X;W=q+($-q)*H,U=V+(Z-V)*H,K.push(W+($+(J-$)*H-W)*H,U+(Z+(Q-Z)*H-U)*H)}}}var x5={[G0.POLY]:f5,[G0.CIRC]:T6,[G0.ELIP]:T6,[G0.RECT]:a1,[G0.RREC]:r1},OZ=[],N7=[];class C7{constructor($,Z=null,J=null,Q=null){this.points=[],this.holes=[],this.shape=$,this.lineStyle=J,this.fillStyle=Z,this.matrix=Q,this.type=$.type}clone(){return new C7(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}var L7=new u,QW=class $ extends J7{constructor(){super(),this.closePointEps=0.0001,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new h8,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let Z=0;Z<this.drawCalls.length;Z++)this.drawCalls[Z].texArray.clear(),N7.push(this.drawCalls[Z]);this.drawCalls.length=0;for(let Z=0;Z<this.batches.length;Z++){const J=this.batches[Z];J.reset(),OZ.push(J)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(Z,J=null,Q=null,K=null){const q=new C7(Z,J,Q,K);return this.graphicsData.push(q),this.dirty++,this}drawHole(Z,J=null){if(!this.graphicsData.length)return null;const Q=new C7(Z,null,null,J),K=this.graphicsData[this.graphicsData.length-1];return Q.lineStyle=K.lineStyle,K.holes.push(Q),this.dirty++,this}destroy(){super.destroy();for(let Z=0;Z<this.graphicsData.length;++Z)this.graphicsData[Z].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(Z){const J=this.graphicsData;for(let Q=0;Q<J.length;++Q){const K=J[Q];if(K.fillStyle.visible&&K.shape&&(K.matrix?K.matrix.applyInverse(Z,L7):L7.copyFrom(Z),K.shape.contains(L7.x,L7.y))){let q=!1;if(K.holes){for(let V=0;V<K.holes.length;V++)if(K.holes[V].shape.contains(L7.x,L7.y)){q=!0;break}}if(!q)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const Z=this.uvs,J=this.graphicsData;let Q=null,K=null;this.batches.length>0&&(Q=this.batches[this.batches.length-1],K=Q.style);for(let W=this.shapeIndex;W<J.length;W++){this.shapeIndex++;const U=J[W],z=U.fillStyle,H=U.lineStyle;x5[U.type].build(U),U.matrix&&this.transformPoints(U.points,U.matrix),(z.visible||H.visible)&&this.processHoles(U.holes);for(let G=0;G<2;G++){const Y=G===0?z:H;if(!Y.visible)continue;const w=Y.texture.baseTexture,j=this.indices.length,B=this.points.length/2;w.wrapMode=z$.REPEAT,G===0?this.processFill(U):this.processLine(U);const C=this.points.length/2-B;C!==0&&(Q&&!this._compareStyles(K,Y)&&(Q.end(j,B),Q=null),Q||(Q=OZ.pop()||new y5,Q.begin(Y,j,B),this.batches.push(Q),K=Y),this.addUvs(this.points,Z,Y.texture,B,C,Y.matrix))}}const q=this.indices.length,V=this.points.length/2;if(Q&&Q.end(q,V),this.batches.length===0){this.batchable=!0;return}const X=V>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&X===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=X?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(Z,J){return!(!Z||!J||Z.texture.baseTexture!==J.texture.baseTexture||Z.color+Z.alpha!==J.color+J.alpha||!!Z.native!=!!J.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let Z=0,J=this.graphicsData.length;Z<J;Z++){const Q=this.graphicsData[Z],K=Q.fillStyle,q=Q.lineStyle;if(K&&!K.texture.baseTexture.valid||q&&!q.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const Z=this.batches;for(let J=0,Q=Z.length;J<Q;J++){const K=Z[J];for(let q=0;q<K.size;q++){const V=K.start+q;this.indicesUint16[V]=this.indicesUint16[V]-K.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const Z=this.batches;for(let J=0;J<Z.length;J++)if(Z[J].style.native)return!1;return this.points.length<$.BATCHABLE_SIZE*2}buildDrawCalls(){let Z=++n._globalBatch;for(let H=0;H<this.drawCalls.length;H++)this.drawCalls[H].texArray.clear(),N7.push(this.drawCalls[H]);this.drawCalls.length=0;const J=this.colors,Q=this.textureIds;let K=N7.pop();K||(K=new L6,K.texArray=new P6),K.texArray.count=0,K.start=0,K.size=0,K.type=_$.TRIANGLES;let q=0,V=null,X=0,W=!1,U=_$.TRIANGLES,z=0;this.drawCalls.push(K);for(let H=0;H<this.batches.length;H++){const G=this.batches[H],w=G.style,j=w.texture.baseTexture;W!==!!w.native&&(W=!!w.native,U=W?_$.LINES:_$.TRIANGLES,V=null,q=8,Z++),V!==j&&(V=j,j._batchEnabled!==Z&&(q===8&&(Z++,q=0,K.size>0&&(K=N7.pop(),K||(K=new L6,K.texArray=new P6),this.drawCalls.push(K)),K.start=z,K.size=0,K.texArray.count=0,K.type=U),j.touched=1,j._batchEnabled=Z,j._batchLocation=q,j.wrapMode=z$.REPEAT,K.texArray.elements[K.texArray.count++]=j,q++)),K.size+=G.size,z+=G.size,X=j._batchLocation,this.addColors(J,w.color,w.alpha,G.attribSize,G.attribStart),this.addTextureIds(Q,X,G.attribSize,G.attribStart)}n._globalBatch=Z,this.packAttributes()}packAttributes(){const Z=this.points,J=this.uvs,Q=this.colors,K=this.textureIds,q=new ArrayBuffer(Z.length*3*4),V=new Float32Array(q),X=new Uint32Array(q);let W=0;for(let U=0;U<Z.length/2;U++)V[W++]=Z[U*2],V[W++]=Z[U*2+1],V[W++]=J[U*2],V[W++]=J[U*2+1],X[W++]=Q[U],V[W++]=K[U];this._buffer.update(q),this._indexBuffer.update(this.indicesUint16)}processFill(Z){Z.holes.length?f5.triangulate(Z,this):x5[Z.type].triangulate(Z,this)}processLine(Z){g5(Z,this);for(let J=0;J<Z.holes.length;J++)g5(Z.holes[J],this)}processHoles(Z){for(let J=0;J<Z.length;J++){const Q=Z[J];x5[Q.type].build(Q),Q.matrix&&this.transformPoints(Q.points,Q.matrix)}}calculateBounds(){const Z=this._bounds;Z.clear(),Z.addVertexData(this.points,0,this.points.length),Z.pad(this.boundsPadding,this.boundsPadding)}transformPoints(Z,J){for(let Q=0;Q<Z.length/2;Q++){const K=Z[Q*2],q=Z[Q*2+1];Z[Q*2]=J.a*K+J.c*q+J.tx,Z[Q*2+1]=J.b*K+J.d*q+J.ty}}addColors(Z,J,Q,K,q=0){const V=e.shared.setValue(J).toLittleEndianNumber(),X=e.shared.setValue(V).toPremultiplied(Q);Z.length=Math.max(Z.length,q+K);for(let W=0;W<K;W++)Z[q+W]=X}addTextureIds(Z,J,Q,K=0){Z.length=Math.max(Z.length,K+Q);for(let q=0;q<Q;q++)Z[K+q]=J}addUvs(Z,J,Q,K,q,V=null){let X=0;const W=J.length,U=Q.frame;for(;X<q;){let H=Z[(K+X)*2],G=Z[(K+X)*2+1];if(V){const Y=V.a*H+V.c*G+V.tx;G=V.b*H+V.d*G+V.ty,H=Y}X++,J.push(H/U.width,G/U.height)}const z=Q.baseTexture;(U.width<z.width||U.height<z.height)&&this.adjustUvs(J,Q,W,q)}adjustUvs(Z,J,Q,K){const q=J.baseTexture,X=Q+K*2,W=J.frame,U=W.width/q.width,z=W.height/q.height;let H=W.x/W.width,G=W.y/W.height,Y=Math.floor(Z[Q]+0.000001),w=Math.floor(Z[Q+1]+0.000001);for(let j=Q+2;j<X;j+=2)Y=Math.min(Y,Math.floor(Z[j]+0.000001)),w=Math.min(w,Math.floor(Z[j+1]+0.000001));H-=Y,G-=w;for(let j=Q;j<X;j+=2)Z[j]=(Z[j]+H)*U,Z[j+1]=(Z[j+1]+G)*z}};QW.BATCHABLE_SIZE=100;var t1=QW;class v6{constructor(){this.color=16777215,this.alpha=1,this.texture=f.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const $=new v6;return $.color=this.color,$.alpha=this.alpha,$.texture=this.texture,$.matrix=this.matrix,$.visible=this.visible,$}reset(){this.color=16777215,this.alpha=1,this.texture=f.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class m5 extends v6{constructor(){super(...arguments),this.width=0,this.alignment=0.5,this.native=!1,this.cap=u$.BUTT,this.join=K$.MITER,this.miterLimit=10}clone(){const $=new m5;return $.color=this.color,$.alpha=this.alpha,$.texture=this.texture,$.matrix=this.matrix,$.visible=this.visible,$.width=this.width,$.alignment=this.alignment,$.native=this.native,$.cap=this.cap,$.join=this.join,$.miterLimit=this.miterLimit,$}reset(){super.reset(),this.color=0,this.alignment=0.5,this.width=0,this.native=!1,this.cap=u$.BUTT,this.join=K$.MITER,this.miterLimit=10}}var e1={},$4=class $ extends r{constructor(Z=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new v6,this._lineStyle=new m5,this._matrix=null,this._holeMode=!1,this.state=p0.for2d(),this._geometry=Z||new t1,this._geometry.refCount++,this._transformID=-1,this._tintColor=new e(16777215),this.blendMode=a.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new $(this._geometry)}set blendMode(Z){this.state.blendMode=Z}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(Z){this._tintColor.setValue(Z)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(Z=null,J=0,Q,K=0.5,q=!1){return typeof Z=="number"&&(Z={width:Z,color:J,alpha:Q,alignment:K,native:q}),this.lineTextureStyle(Z)}lineTextureStyle(Z){const J={width:0,texture:f.WHITE,color:Z?.texture?16777215:0,matrix:null,alignment:0.5,native:!1,cap:u$.BUTT,join:K$.MITER,miterLimit:10};Z=Object.assign(J,Z),this.normalizeColor(Z),this.currentPath&&this.startPoly();const Q=Z.width>0&&Z.alpha>0;return Q?(Z.matrix&&(Z.matrix=Z.matrix.clone(),Z.matrix.invert()),Object.assign(this._lineStyle,{visible:Q},Z)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const Z=this.currentPath.points,J=this.currentPath.points.length;J>2&&(this.drawShape(this.currentPath),this.currentPath=new U8,this.currentPath.closeStroke=!1,this.currentPath.points.push(Z[J-2],Z[J-1]))}else this.currentPath=new U8,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(Z,J){return this.startPoly(),this.currentPath.points[0]=Z,this.currentPath.points[1]=J,this}lineTo(Z,J){this.currentPath||this.moveTo(0,0);const Q=this.currentPath.points,K=Q[Q.length-2],q=Q[Q.length-1];return(K!==Z||q!==J)&&Q.push(Z,J),this}_initCurve(Z=0,J=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[Z,J]):this.moveTo(Z,J)}quadraticCurveTo(Z,J,Q,K){this._initCurve();const q=this.currentPath.points;return q.length===0&&this.moveTo(0,0),F7.curveTo(Z,J,Q,K,q),this}bezierCurveTo(Z,J,Q,K,q,V){return this._initCurve(),B7.curveTo(Z,J,Q,K,q,V,this.currentPath.points),this}arcTo(Z,J,Q,K,q){this._initCurve(Z,J);const V=this.currentPath.points,X=j7.curveTo(Z,J,Q,K,q,V);if(X){const{cx:W,cy:U,radius:z,startAngle:H,endAngle:G,anticlockwise:Y}=X;this.arc(W,U,z,H,G,Y)}return this}arc(Z,J,Q,K,q,V=!1){if(K===q)return this;if(!V&&q<=K?q+=s8:V&&K<=q&&(K+=s8),q-K===0)return this;const X=Z+Math.cos(K)*Q,W=J+Math.sin(K)*Q,U=this._geometry.closePointEps;let z=this.currentPath?this.currentPath.points:null;if(z){const H=Math.abs(z[z.length-2]-X),G=Math.abs(z[z.length-1]-W);H<U&&G<U||z.push(X,W)}else this.moveTo(X,W),z=this.currentPath.points;return j7.arc(X,W,Z,J,Q,K,q,V,z),this}beginFill(Z=0,J){return this.beginTextureFill({texture:f.WHITE,color:Z,alpha:J})}normalizeColor(Z){const J=e.shared.setValue(Z.color??0);Z.color=J.toNumber(),Z.alpha??(Z.alpha=J.alpha)}beginTextureFill(Z){const J={texture:f.WHITE,color:16777215,matrix:null};Z=Object.assign(J,Z),this.normalizeColor(Z),this.currentPath&&this.startPoly();const Q=Z.alpha>0;return Q?(Z.matrix&&(Z.matrix=Z.matrix.clone(),Z.matrix.invert()),Object.assign(this._fillStyle,{visible:Q},Z)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(Z,J,Q,K){return this.drawShape(new m(Z,J,Q,K))}drawRoundedRect(Z,J,Q,K,q){return this.drawShape(new q7(Z,J,Q,K,q))}drawCircle(Z,J,Q){return this.drawShape(new Q7(Z,J,Q))}drawEllipse(Z,J,Q,K){return this.drawShape(new K7(Z,J,Q,K))}drawPolygon(...Z){let J,Q=!0;const K=Z[0];K.points?(Q=K.closeStroke,J=K.points):Array.isArray(Z[0])?J=Z[0]:J=Z;const q=new U8(J);return q.closeStroke=Q,this.drawShape(q),this}drawShape(Z){return this._holeMode?this._geometry.drawHole(Z,this._matrix):this._geometry.drawShape(Z,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const Z=this._geometry.graphicsData;return Z.length===1&&Z[0].shape.type===G0.RECT&&!Z[0].matrix&&!Z[0].holes.length&&!(Z[0].lineStyle.visible&&Z[0].lineStyle.width)}_render(Z){this.finishPoly();const J=this._geometry;J.updateBatches(),J.batchable?(this.batchDirty!==J.batchDirty&&this._populateBatches(),this._renderBatched(Z)):(Z.batch.flush(),this._renderDirect(Z))}_populateBatches(){const Z=this._geometry,J=this.blendMode,Q=Z.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=Z.batchDirty,this.batches.length=Q,this.vertexData=new Float32Array(Z.points);for(let K=0;K<Q;K++){const q=Z.batches[K],V=q.style.color,X=new Float32Array(this.vertexData.buffer,q.attribStart*4*2,q.attribSize*2),W=new Float32Array(Z.uvsFloat32.buffer,q.attribStart*4*2,q.attribSize*2),U=new Uint16Array(Z.indicesUint16.buffer,q.start*2,q.size),z={vertexData:X,blendMode:J,indices:U,uvs:W,_batchRGB:e.shared.setValue(V).toRgbArray(),_tintRGB:V,_texture:q.style.texture,alpha:q.style.alpha,worldAlpha:1};this.batches[K]=z}}_renderBatched(Z){if(this.batches.length){Z.batch.setObjectRenderer(Z.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let J=0,Q=this.batches.length;J<Q;J++){const K=this.batches[J];K.worldAlpha=this.worldAlpha*K.alpha,Z.plugins[this.pluginName].render(K)}}}_renderDirect(Z){const J=this._resolveDirectShader(Z),Q=this._geometry,K=this.worldAlpha,q=J.uniforms,V=Q.drawCalls;q.translationMatrix=this.transform.worldTransform,e.shared.setValue(this._tintColor).premultiply(K).toArray(q.tint),Z.shader.bind(J),Z.geometry.bind(Q,J),Z.state.set(this.state);for(let X=0,W=V.length;X<W;X++)this._renderDrawCallDirect(Z,Q.drawCalls[X])}_renderDrawCallDirect(Z,J){const{texArray:Q,type:K,size:q,start:V}=J,X=Q.count;for(let W=0;W<X;W++)Z.texture.bind(Q.elements[W],W);Z.geometry.draw(K,q,V)}_resolveDirectShader(Z){let J=this.shader;const Q=this.pluginName;if(!J){if(!e1[Q]){const{maxTextures:K}=Z.plugins[Q],q=new Int32Array(K);for(let W=0;W<K;W++)q[W]=W;const V={tint:new Float32Array([1,1,1,1]),translationMatrix:new Z0,default:i0.from({uSamplers:q},!0)},X=Z.plugins[Q]._shader.program;e1[Q]=new a0(X,V)}J=e1[Q]}return J}_calculateBounds(){this.finishPoly();const Z=this._geometry;if(!Z.graphicsData.length)return;const{minX:J,minY:Q,maxX:K,maxY:q}=Z.bounds;this._bounds.addFrame(this.transform,J,Q,K,q)}containsPoint(Z){return this.worldTransform.applyInverse(Z,$._TEMP_POINT),this._geometry.containsPoint($._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let Z=0;Z<this.batches.length;Z++){const J=this.batches[Z];J._tintRGB=e.shared.setValue(this._tintColor).multiply(J._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const Z=this.transform._worldID;if(this._transformID===Z)return;this._transformID=Z;const J=this.transform.worldTransform,Q=J.a,K=J.b,q=J.c,V=J.d,X=J.tx,W=J.ty,U=this._geometry.points,z=this.vertexData;let H=0;for(let G=0;G<U.length;G+=2){const Y=U[G],w=U[G+1];z[H++]=Q*Y+q*w+X,z[H++]=V*w+K*Y+W}}closePath(){const Z=this.currentPath;return Z&&(Z.closeStroke=!0,this.finishPoly()),this}setMatrix(Z){return this._matrix=Z,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(Z){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(Z)}};$4.curves=d$,$4._TEMP_POINT=new u;var J8=$4;class IZ{constructor($,Z){this.uvBuffer=$,this.uvMatrix=Z,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update($){if(!$&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const Z=this.uvBuffer.data;(!this.data||this.data.length!==Z.length)&&(this.data=new Float32Array(Z.length)),this.uvMatrix.multiplyUvs(Z,this.data),this._updateID++}}var Z4=new u,KW=new U8,qW=class $ extends r{constructor(Z,J,Q,K=_$.TRIANGLES){super(),this.geometry=Z,this.shader=J,this.state=Q||p0.for2d(),this.drawMode=K,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=R.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(Z){this._geometry!==Z&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=Z,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(Z){this.shader=Z}get material(){return this.shader}set blendMode(Z){this.state.blendMode=Z}get blendMode(){return this.state.blendMode}set roundPixels(Z){this._roundPixels!==Z&&(this._transformID=-1),this._roundPixels=Z}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(Z){this.shader.tint=Z}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(Z){this.shader.texture=Z}_render(Z){const J=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===_$.TRIANGLES&&J.length<$.BATCHABLE_SIZE*2?this._renderToBatch(Z):this._renderDefault(Z)}_renderDefault(Z){const J=this.shader;J.alpha=this.worldAlpha,J.update&&J.update(),Z.batch.flush(),J.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),Z.shader.bind(J),Z.state.set(this.state),Z.geometry.bind(this.geometry,J),Z.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(Z){const J=this.geometry,Q=this.shader;Q.uvMatrix&&(Q.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=J.indexBuffer.data,this._tintRGB=Q._tintRGB,this._texture=Q.texture;const K=this.material.pluginName;Z.batch.setObjectRenderer(Z.plugins[K]),Z.plugins[K].render(this)}calculateVertices(){const Z=this.geometry.buffers[0],J=Z.data,Q=Z._updateID;if(Q===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==J.length&&(this.vertexData=new Float32Array(J.length));const K=this.transform.worldTransform,q=K.a,V=K.b,X=K.c,W=K.d,U=K.tx,z=K.ty,H=this.vertexData;for(let G=0;G<H.length/2;G++){const Y=J[G*2],w=J[G*2+1];H[G*2]=q*Y+X*w+U,H[G*2+1]=V*Y+W*w+z}if(this._roundPixels){const G=R.RESOLUTION;for(let Y=0;Y<H.length;++Y)H[Y]=Math.round(H[Y]*G)/G}this.vertexDirty=Q}calculateUvs(){const Z=this.geometry.buffers[1],J=this.shader;J.uvMatrix.isSimple?this.uvs=Z.data:(this.batchUvs||(this.batchUvs=new IZ(Z,J.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(Z){if(!this.getBounds().contains(Z.x,Z.y))return!1;this.worldTransform.applyInverse(Z,Z4);const J=this.geometry.getBuffer("aVertexPosition").data,Q=KW.points,K=this.geometry.getIndex().data,q=K.length,V=this.drawMode===4?3:1;for(let X=0;X+2<q;X+=V){const W=K[X]*2,U=K[X+1]*2,z=K[X+2]*2;if(Q[0]=J[W],Q[1]=J[W+1],Q[2]=J[U],Q[3]=J[U+1],Q[4]=J[z],Q[5]=J[z+1],KW.contains(Z4.x,Z4.y))return!0}return!1}destroy(Z){super.destroy(Z),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};qW.BATCHABLE_SIZE=100;var S6=qW;class h6 extends R${constructor($,Z,J){super();const Q=new H0($),K=new H0(Z,!0),q=new H0(J,!0,!0);this.addAttribute("aVertexPosition",Q,2,!1,d.FLOAT).addAttribute("aTextureCoord",K,2,!1,d.FLOAT).addIndex(q),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var VW=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`;var XW=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class K6 extends a0{constructor($,Z){const J={uSampler:$,alpha:1,uTextureMatrix:Z0.IDENTITY,uColor:new Float32Array([1,1,1,1])};Z=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},Z),Z.uniforms&&Object.assign(J,Z.uniforms),super(Z.program||J$.from(XW,VW),J),this._colorDirty=!1,this.uvMatrix=new t8($),this.batchable=Z.program===void 0,this.pluginName=Z.pluginName,this._tintColor=new e(Z.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=Z.alpha}get texture(){return this.uniforms.uSampler}set texture($){this.uniforms.uSampler!==$&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!$.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=$,this.uvMatrix.texture=$)}set alpha($){$!==this._alpha&&(this._alpha=$,this._colorDirty=!0)}get alpha(){return this._alpha}set tint($){$!==this.tint&&(this._tintColor.setValue($),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const $=this.texture.baseTexture.alphaMode;e.shared.setValue(this._tintColor).premultiply(this._alpha,$).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class RZ{constructor($,Z,J){this.geometry=new R$,this.indexBuffer=null,this.size=J,this.dynamicProperties=[],this.staticProperties=[];for(let Q=0;Q<$.length;++Q){let K=$[Q];K={attributeName:K.attributeName,size:K.size,uploadFunction:K.uploadFunction,type:K.type||d.FLOAT,offset:K.offset},Z[Q]?this.dynamicProperties.push(K):this.staticProperties.push(K)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const $=this.geometry;let Z=0;this.indexBuffer=new H0(T.createIndicesForQuads(this.size),!0,!0),$.addIndex(this.indexBuffer),this.dynamicStride=0;for(let q=0;q<this.dynamicProperties.length;++q){const V=this.dynamicProperties[q];V.offset=Z,Z+=V.size,this.dynamicStride+=V.size}const J=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(J),this.dynamicDataUint32=new Uint32Array(J),this.dynamicBuffer=new H0(this.dynamicData,!1,!1);let Q=0;this.staticStride=0;for(let q=0;q<this.staticProperties.length;++q){const V=this.staticProperties[q];V.offset=Q,Q+=V.size,this.staticStride+=V.size}const K=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(K),this.staticDataUint32=new Uint32Array(K),this.staticBuffer=new H0(this.staticData,!0,!1);for(let q=0;q<this.dynamicProperties.length;++q){const V=this.dynamicProperties[q];$.addAttribute(V.attributeName,this.dynamicBuffer,0,V.type===d.UNSIGNED_BYTE,V.type,this.dynamicStride*4,V.offset*4)}for(let q=0;q<this.staticProperties.length;++q){const V=this.staticProperties[q];$.addAttribute(V.attributeName,this.staticBuffer,0,V.type===d.UNSIGNED_BYTE,V.type,this.staticStride*4,V.offset*4)}}uploadDynamic($,Z,J){for(let Q=0;Q<this.dynamicProperties.length;Q++){const K=this.dynamicProperties[Q];K.uploadFunction($,Z,J,K.type===d.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,K.offset)}this.dynamicBuffer._updateID++}uploadStatic($,Z,J){for(let Q=0;Q<this.staticProperties.length;Q++){const K=this.staticProperties[Q];K.uploadFunction($,Z,J,K.type===d.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,K.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var WW=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`;var UW=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class PZ extends H8{constructor($){super($),this.shader=null,this.properties=null,this.tempMatrix=new Z0,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:d.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=a0.from(UW,WW,{}),this.state=p0.for2d()}render($){const{children:Z,_maxSize:J,_batchSize:Q}=$,K=this.renderer;let q=Z.length;if(q===0)return;q>J&&!$.autoResize&&(q=J);let V=$._buffers;V||(V=$._buffers=this.generateBuffers($));const X=Z[0]._texture.baseTexture,W=X.alphaMode>0;this.state.blendMode=T.correctBlendMode($.blendMode,W),K.state.set(this.state);const U=K.gl,z=$.worldTransform.copyTo(this.tempMatrix);z.prepend(K.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=z.toArray(!0),this.shader.uniforms.uColor=e.shared.setValue($.tintRgb).premultiply($.worldAlpha,W).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=X,this.renderer.shader.bind(this.shader);let H=!1;for(let G=0,Y=0;G<q;G+=Q,Y+=1){let w=q-G;w>Q&&(w=Q),Y>=V.length&&V.push(this._generateOneMoreBuffer($));const j=V[Y];j.uploadDynamic(Z,G,w);const B=$._bufferUpdateIDs[Y]||0;H=H||j._updateID<B,H&&(j._updateID=$._updateID,j.uploadStatic(Z,G,w)),K.geometry.bind(j.geometry),U.drawElements(U.TRIANGLES,w*6,U.UNSIGNED_SHORT,0)}}generateBuffers($){const Z=[],J=$._maxSize,Q=$._batchSize,K=$._properties;for(let q=0;q<J;q+=Q)Z.push(new RZ(this.properties,K,Q));return Z}_generateOneMoreBuffer($){const{_batchSize:Z,_properties:J}=$;return new RZ(this.properties,J,Z)}uploadVertices($,Z,J,Q,K,q){let V=0,X=0,W=0,U=0;for(let z=0;z<J;++z){const H=$[Z+z],G=H._texture,Y=H.scale.x,w=H.scale.y,j=G.trim,B=G.orig;j?(X=j.x-H.anchor.x*B.width,V=X+j.width,U=j.y-H.anchor.y*B.height,W=U+j.height):(V=B.width*(1-H.anchor.x),X=B.width*-H.anchor.x,W=B.height*(1-H.anchor.y),U=B.height*-H.anchor.y),Q[q]=X*Y,Q[q+1]=U*w,Q[q+K]=V*Y,Q[q+K+1]=U*w,Q[q+K*2]=V*Y,Q[q+K*2+1]=W*w,Q[q+K*3]=X*Y,Q[q+K*3+1]=W*w,q+=K*4}}uploadPosition($,Z,J,Q,K,q){for(let V=0;V<J;V++){const X=$[Z+V].position;Q[q]=X.x,Q[q+1]=X.y,Q[q+K]=X.x,Q[q+K+1]=X.y,Q[q+K*2]=X.x,Q[q+K*2+1]=X.y,Q[q+K*3]=X.x,Q[q+K*3+1]=X.y,q+=K*4}}uploadRotation($,Z,J,Q,K,q){for(let V=0;V<J;V++){const X=$[Z+V].rotation;Q[q]=X,Q[q+K]=X,Q[q+K*2]=X,Q[q+K*3]=X,q+=K*4}}uploadUvs($,Z,J,Q,K,q){for(let V=0;V<J;++V){const X=$[Z+V]._texture._uvs;X?(Q[q]=X.x0,Q[q+1]=X.y0,Q[q+K]=X.x1,Q[q+K+1]=X.y1,Q[q+K*2]=X.x2,Q[q+K*2+1]=X.y2,Q[q+K*3]=X.x3,Q[q+K*3+1]=X.y3,q+=K*4):(Q[q]=0,Q[q+1]=0,Q[q+K]=0,Q[q+K+1]=0,Q[q+K*2]=0,Q[q+K*2+1]=0,Q[q+K*3]=0,Q[q+K*3+1]=0,q+=K*4)}}uploadTint($,Z,J,Q,K,q){for(let V=0;V<J;++V){const X=$[Z+V],W=e.shared.setValue(X._tintRGB).toPremultiplied(X.alpha,X.texture.baseTexture.alphaMode>0);Q[q]=W,Q[q+K]=W,Q[q+K*2]=W,Q[q+K*3]=W,q+=K*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}PZ.extension={name:"particle",type:I.RendererPlugin};P.add(PZ);var q6=(($)=>($[$.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",$[$.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",$))(q6||{});var DZ={willReadFrequently:!0},B8=class ${static get experimentalLetterSpacingSupported(){let Z=$._experimentalLetterSpacingSupported;if(Z!==void 0){const J=R.ADAPTER.getCanvasRenderingContext2D().prototype;Z=$._experimentalLetterSpacingSupported=("letterSpacing"in J)||("textLetterSpacing"in J)}return Z}constructor(Z,J,Q,K,q,V,X,W,U){this.text=Z,this.style=J,this.width=Q,this.height=K,this.lines=q,this.lineWidths=V,this.lineHeight=X,this.maxLineWidth=W,this.fontProperties=U}static measureText(Z,J,Q,K=$._canvas){Q=Q??J.wordWrap;const q=J.toFontString(),V=$.measureFont(q);V.fontSize===0&&(V.fontSize=J.fontSize,V.ascent=J.fontSize);const X=K.getContext("2d",DZ);X.font=q;const W=(Q?$.wordWrap(Z,J,K):Z).split(/(?:\r\n|\r|\n)/),U=new Array(W.length);let z=0;for(let w=0;w<W.length;w++){const j=$._measureText(W[w],J.letterSpacing,X);U[w]=j,z=Math.max(z,j)}let H=z+J.strokeThickness;J.dropShadow&&(H+=J.dropShadowDistance);const G=J.lineHeight||V.fontSize+J.strokeThickness;let Y=Math.max(G,V.fontSize+J.strokeThickness*2)+J.leading+(W.length-1)*(G+J.leading);return J.dropShadow&&(Y+=J.dropShadowDistance),new $(Z,J,H,Y,W,U,G+J.leading,z,V)}static _measureText(Z,J,Q){let K=!1;$.experimentalLetterSpacingSupported&&($.experimentalLetterSpacing?(Q.letterSpacing=`${J}px`,Q.textLetterSpacing=`${J}px`,K=!0):(Q.letterSpacing="0px",Q.textLetterSpacing="0px"));let q=Q.measureText(Z).width;return q>0&&(K?q-=J:q+=($.graphemeSegmenter(Z).length-1)*J),q}static wordWrap(Z,J,Q=$._canvas){const K=Q.getContext("2d",DZ);let q=0,V="",X="";const W=Object.create(null),{letterSpacing:U,whiteSpace:z}=J,H=$.collapseSpaces(z),G=$.collapseNewlines(z);let Y=!H;const w=J.wordWrapWidth+U,j=$.tokenize(Z);for(let B=0;B<j.length;B++){let C=j[B];if($.isNewline(C)){if(!G){X+=$.addLine(V),Y=!H,V="",q=0;continue}C=" "}if(H){const F=$.isBreakingSpace(C),L=$.isBreakingSpace(V[V.length-1]);if(F&&L)continue}const N=$.getFromCache(C,U,W,K);if(N>w)if(V!==""&&(X+=$.addLine(V),V="",q=0),$.canBreakWords(C,J.breakWords)){const F=$.wordWrapSplit(C);for(let L=0;L<F.length;L++){let k=F[L],o=k,O=1;for(;F[L+O];){const c=F[L+O];if(!$.canBreakChars(o,c,C,L,J.breakWords))k+=c;else break;o=c,O++}L+=O-1;const h=$.getFromCache(k,U,W,K);h+q>w&&(X+=$.addLine(V),Y=!1,V="",q=0),V+=k,q+=h}}else{V.length>0&&(X+=$.addLine(V),V="",q=0);const F=B===j.length-1;X+=$.addLine(C,!F),Y=!1,V="",q=0}else N+q>w&&(Y=!1,X+=$.addLine(V),V="",q=0),(V.length>0||!$.isBreakingSpace(C)||Y)&&(V+=C,q+=N)}return X+=$.addLine(V,!1),X}static addLine(Z,J=!0){return Z=$.trimRight(Z),Z=J?`${Z}
`:Z,Z}static getFromCache(Z,J,Q,K){let q=Q[Z];return typeof q!="number"&&(q=$._measureText(Z,J,K)+J,Q[Z]=q),q}static collapseSpaces(Z){return Z==="normal"||Z==="pre-line"}static collapseNewlines(Z){return Z==="normal"}static trimRight(Z){if(typeof Z!="string")return"";for(let J=Z.length-1;J>=0;J--){const Q=Z[J];if(!$.isBreakingSpace(Q))break;Z=Z.slice(0,-1)}return Z}static isNewline(Z){return typeof Z!="string"?!1:$._newlines.includes(Z.charCodeAt(0))}static isBreakingSpace(Z,J){return typeof Z!="string"?!1:$._breakingSpaces.includes(Z.charCodeAt(0))}static tokenize(Z){const J=[];let Q="";if(typeof Z!="string")return J;for(let K=0;K<Z.length;K++){const q=Z[K],V=Z[K+1];if($.isBreakingSpace(q,V)||$.isNewline(q)){Q!==""&&(J.push(Q),Q=""),J.push(q);continue}Q+=q}return Q!==""&&J.push(Q),J}static canBreakWords(Z,J){return J}static canBreakChars(Z,J,Q,K,q){return!0}static wordWrapSplit(Z){return $.graphemeSegmenter(Z)}static measureFont(Z){if($._fonts[Z])return $._fonts[Z];const J={ascent:0,descent:0,fontSize:0},Q=$._canvas,K=$._context;K.font=Z;const q=$.METRICS_STRING+$.BASELINE_SYMBOL,V=Math.ceil(K.measureText(q).width);let X=Math.ceil(K.measureText($.BASELINE_SYMBOL).width);const W=Math.ceil($.HEIGHT_MULTIPLIER*X);if(X=X*$.BASELINE_MULTIPLIER|0,V===0||W===0)return $._fonts[Z]=J,J;Q.width=V,Q.height=W,K.fillStyle="#f00",K.fillRect(0,0,V,W),K.font=Z,K.textBaseline="alphabetic",K.fillStyle="#000",K.fillText(q,0,X);const U=K.getImageData(0,0,V,W).data,z=U.length,H=V*4;let G=0,Y=0,w=!1;for(G=0;G<X;++G){for(let j=0;j<H;j+=4)if(U[Y+j]!==255){w=!0;break}if(!w)Y+=H;else break}for(J.ascent=X-G,Y=z-H,w=!1,G=W;G>X;--G){for(let j=0;j<H;j+=4)if(U[Y+j]!==255){w=!0;break}if(!w)Y-=H;else break}return J.descent=G-X,J.fontSize=J.ascent+J.descent,$._fonts[Z]=J,J}static clearMetrics(Z=""){Z?delete $._fonts[Z]:$._fonts={}}static get _canvas(){if(!$.__canvas){let Z;try{const J=new OffscreenCanvas(0,0);if(J.getContext("2d",DZ)?.measureText)return $.__canvas=J,J;Z=R.ADAPTER.createCanvas()}catch{Z=R.ADAPTER.createCanvas()}Z.width=Z.height=10,$.__canvas=Z}return $.__canvas}static get _context(){return $.__context||($.__context=$._canvas.getContext("2d",DZ)),$.__context}};B8.METRICS_STRING="|\xC9q\xC5",B8.BASELINE_SYMBOL="M",B8.BASELINE_MULTIPLIER=1.4,B8.HEIGHT_MULTIPLIER=2,B8.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const $=new Intl.Segmenter;return(Z)=>[...$.segment(Z)].map((J)=>J.segment)}return($)=>[...$]})(),B8.experimentalLetterSpacing=!1,B8._fonts={},B8._newlines=[10,13],B8._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var l$=B8;var J4=function($){const Z=e.shared,J=(Q)=>{const K=Z.setValue(Q);return K.alpha===1?K.toHex():K.toRgbaString()};return Array.isArray($)?$.map(J):J($)},nj=function($,Z){if(!Array.isArray($)||!Array.isArray(Z)||$.length!==Z.length)return!1;for(let J=0;J<$.length;++J)if($[J]!==Z[J])return!1;return!0},Q4=function($,Z,J){for(let Q in J)Array.isArray(Z[Q])?$[Q]=Z[Q].slice():$[Q]=Z[Q]},lj=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],zW=class ${constructor(Z){this.styleID=0,this.reset(),Q4(this,Z,Z)}clone(){const Z={};return Q4(Z,this,$.defaultStyle),new $(Z)}reset(){Q4(this,$.defaultStyle,$.defaultStyle)}get align(){return this._align}set align(Z){this._align!==Z&&(this._align=Z,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(Z){this._breakWords!==Z&&(this._breakWords=Z,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(Z){this._dropShadow!==Z&&(this._dropShadow=Z,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(Z){this._dropShadowAlpha!==Z&&(this._dropShadowAlpha=Z,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(Z){this._dropShadowAngle!==Z&&(this._dropShadowAngle=Z,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(Z){this._dropShadowBlur!==Z&&(this._dropShadowBlur=Z,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(Z){const J=J4(Z);this._dropShadowColor!==J&&(this._dropShadowColor=J,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(Z){this._dropShadowDistance!==Z&&(this._dropShadowDistance=Z,this.styleID++)}get fill(){return this._fill}set fill(Z){const J=J4(Z);this._fill!==J&&(this._fill=J,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(Z){this._fillGradientType!==Z&&(this._fillGradientType=Z,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(Z){nj(this._fillGradientStops,Z)||(this._fillGradientStops=Z,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(Z){this.fontFamily!==Z&&(this._fontFamily=Z,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(Z){this._fontSize!==Z&&(this._fontSize=Z,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(Z){this._fontStyle!==Z&&(this._fontStyle=Z,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(Z){this._fontVariant!==Z&&(this._fontVariant=Z,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(Z){this._fontWeight!==Z&&(this._fontWeight=Z,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(Z){this._letterSpacing!==Z&&(this._letterSpacing=Z,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(Z){this._lineHeight!==Z&&(this._lineHeight=Z,this.styleID++)}get leading(){return this._leading}set leading(Z){this._leading!==Z&&(this._leading=Z,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(Z){this._lineJoin!==Z&&(this._lineJoin=Z,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(Z){this._miterLimit!==Z&&(this._miterLimit=Z,this.styleID++)}get padding(){return this._padding}set padding(Z){this._padding!==Z&&(this._padding=Z,this.styleID++)}get stroke(){return this._stroke}set stroke(Z){const J=J4(Z);this._stroke!==J&&(this._stroke=J,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(Z){this._strokeThickness!==Z&&(this._strokeThickness=Z,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(Z){this._textBaseline!==Z&&(this._textBaseline=Z,this.styleID++)}get trim(){return this._trim}set trim(Z){this._trim!==Z&&(this._trim=Z,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(Z){this._whiteSpace!==Z&&(this._whiteSpace=Z,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(Z){this._wordWrap!==Z&&(this._wordWrap=Z,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(Z){this._wordWrapWidth!==Z&&(this._wordWrapWidth=Z,this.styleID++)}toFontString(){const Z=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let J=this.fontFamily;Array.isArray(this.fontFamily)||(J=this.fontFamily.split(","));for(let Q=J.length-1;Q>=0;Q--){let K=J[Q].trim();!/([\"\'])[^\'\"]+\1/.test(K)&&!lj.includes(K)&&(K=`"${K}"`),J[Q]=K}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${Z} ${J.join(",")}`}};zW.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:q6.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};var D$=zW;var oj={texture:!0,children:!1,baseTexture:!0},HW=class $ extends S0{constructor(Z,J,Q){let K=!1;Q||(Q=R.ADAPTER.createCanvas(),K=!0),Q.width=3,Q.height=3;const q=f.from(Q);q.orig=new m,q.trim=new m,super(q),this._ownCanvas=K,this.canvas=Q,this.context=Q.getContext("2d",{willReadFrequently:!0}),this._resolution=$.defaultResolution??R.RESOLUTION,this._autoResolution=$.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=Z,this.style=J,this.localStyleID=-1}static get experimentalLetterSpacing(){return l$.experimentalLetterSpacing}static set experimentalLetterSpacing(Z){T.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),l$.experimentalLetterSpacing=Z}updateText(Z){const J=this._style;if(this.localStyleID!==J.styleID&&(this.dirty=!0,this.localStyleID=J.styleID),!this.dirty&&Z)return;this._font=this._style.toFontString();const Q=this.context,K=l$.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),q=K.width,V=K.height,X=K.lines,W=K.lineHeight,U=K.lineWidths,z=K.maxLineWidth,H=K.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,q)+J.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,V)+J.padding*2)*this._resolution),Q.scale(this._resolution,this._resolution),Q.clearRect(0,0,this.canvas.width,this.canvas.height),Q.font=this._font,Q.lineWidth=J.strokeThickness,Q.textBaseline=J.textBaseline,Q.lineJoin=J.lineJoin,Q.miterLimit=J.miterLimit;let G,Y;const w=J.dropShadow?2:1;for(let j=0;j<w;++j){const B=J.dropShadow&&j===0,C=B?Math.ceil(Math.max(1,V)+J.padding*2):0,N=C*this._resolution;if(B){Q.fillStyle="black",Q.strokeStyle="black";const L=J.dropShadowColor,k=J.dropShadowBlur*this._resolution,o=J.dropShadowDistance*this._resolution;Q.shadowColor=e.shared.setValue(L).setAlpha(J.dropShadowAlpha).toRgbaString(),Q.shadowBlur=k,Q.shadowOffsetX=Math.cos(J.dropShadowAngle)*o,Q.shadowOffsetY=Math.sin(J.dropShadowAngle)*o+N}else Q.fillStyle=this._generateFillStyle(J,X,K),Q.strokeStyle=J.stroke,Q.shadowColor="black",Q.shadowBlur=0,Q.shadowOffsetX=0,Q.shadowOffsetY=0;let F=(W-H.fontSize)/2;W-H.fontSize<0&&(F=0);for(let L=0;L<X.length;L++)G=J.strokeThickness/2,Y=J.strokeThickness/2+L*W+H.ascent+F,J.align==="right"?G+=z-U[L]:J.align==="center"&&(G+=(z-U[L])/2),J.stroke&&J.strokeThickness&&this.drawLetterSpacing(X[L],G+J.padding,Y+J.padding-C,!0),J.fill&&this.drawLetterSpacing(X[L],G+J.padding,Y+J.padding-C)}this.updateTexture()}drawLetterSpacing(Z,J,Q,K=!1){const q=this._style.letterSpacing;let V=!1;if(l$.experimentalLetterSpacingSupported&&(l$.experimentalLetterSpacing?(this.context.letterSpacing=`${q}px`,this.context.textLetterSpacing=`${q}px`,V=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),q===0||V){K?this.context.strokeText(Z,J,Q):this.context.fillText(Z,J,Q);return}let X=J;const W=l$.graphemeSegmenter(Z);let U=this.context.measureText(Z).width,z=0;for(let H=0;H<W.length;++H){const G=W[H];K?this.context.strokeText(G,X,Q):this.context.fillText(G,X,Q);let Y="";for(let w=H+1;w<W.length;++w)Y+=W[w];z=this.context.measureText(Y).width,X+=U-z+q,U=z}}updateTexture(){const Z=this.canvas;if(this._style.trim){const V=T.trimCanvas(Z);V.data&&(Z.width=V.width,Z.height=V.height,this.context.putImageData(V.data,0,0))}const J=this._texture,Q=this._style,K=Q.trim?0:Q.padding,q=J.baseTexture;J.trim.width=J._frame.width=Z.width/this._resolution,J.trim.height=J._frame.height=Z.height/this._resolution,J.trim.x=-K,J.trim.y=-K,J.orig.width=J._frame.width-K*2,J.orig.height=J._frame.height-K*2,this._onTextureUpdate(),q.setRealSize(Z.width,Z.height,this._resolution),J.updateUvs(),this.dirty=!1}_render(Z){this._autoResolution&&this._resolution!==Z.resolution&&(this._resolution=Z.resolution,this.dirty=!0),this.updateText(!0),super._render(Z)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(Z,J){return this.updateText(!0),this._textureID===-1&&(Z=!1),super.getBounds(Z,J)}getLocalBounds(Z){return this.updateText(!0),super.getLocalBounds.call(this,Z)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(Z,J,Q){const K=Z.fill;if(Array.isArray(K)){if(K.length===1)return K[0]}else return K;let q;const V=Z.dropShadow?Z.dropShadowDistance:0,X=Z.padding||0,W=this.canvas.width/this._resolution-V-X*2,U=this.canvas.height/this._resolution-V-X*2,z=K.slice(),H=Z.fillGradientStops.slice();if(!H.length){const G=z.length+1;for(let Y=1;Y<G;++Y)H.push(Y/G)}if(z.unshift(K[0]),H.unshift(0),z.push(K[K.length-1]),H.push(1),Z.fillGradientType===q6.LINEAR_VERTICAL){q=this.context.createLinearGradient(W/2,X,W/2,U+X);const G=Q.fontProperties.fontSize+Z.strokeThickness;for(let Y=0;Y<J.length;Y++){const w=Q.lineHeight*(Y-1)+G,j=Q.lineHeight*Y;let B=j;Y>0&&w>j&&(B=(j+w)/2);const C=j+G,N=Q.lineHeight*(Y+1);let F=C;Y+1<J.length&&N<C&&(F=(C+N)/2);const L=(F-B)/U;for(let k=0;k<z.length;k++){let o=0;typeof H[k]=="number"?o=H[k]:o=k/z.length;let O=Math.min(1,Math.max(0,B/U+o*L));O=Number(O.toFixed(5)),q.addColorStop(O,z[k])}}}else{q=this.context.createLinearGradient(X,U/2,W+X,U/2);const G=z.length+1;let Y=1;for(let w=0;w<z.length;w++){let j;typeof H[w]=="number"?j=H[w]:j=Y/G,q.addColorStop(j,z[w]),Y++}}return q}destroy(Z){typeof Z=="boolean"&&(Z={children:Z}),Z=Object.assign({},oj,Z),super.destroy(Z),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(Z){this.updateText(!0);const J=T.sign(this.scale.x)||1;this.scale.x=J*Z/this._texture.orig.width,this._width=Z}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(Z){this.updateText(!0);const J=T.sign(this.scale.y)||1;this.scale.y=J*Z/this._texture.orig.height,this._height=Z}get style(){return this._style}set style(Z){Z=Z||{},Z instanceof D$?this._style=Z:this._style=new D$(Z),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(Z){Z=String(Z??""),this._text!==Z&&(this._text=Z,this.dirty=!0)}get resolution(){return this._resolution}set resolution(Z){this._autoResolution=!1,this._resolution!==Z&&(this._resolution=Z,this.dirty=!0)}};HW.defaultAutoResolution=!0;var n$=HW;class AZ{constructor($){this.maxItemsPerFrame=$,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}var sj=function($,Z){let J=!1;if($?._textures?.length){for(let Q=0;Q<$._textures.length;Q++)if($._textures[Q]instanceof f){const K=$._textures[Q].baseTexture;Z.includes(K)||(Z.push(K),J=!0)}}return J},ij=function($,Z){if($.baseTexture instanceof n){const J=$.baseTexture;return Z.includes(J)||Z.push(J),!0}return!1},aj=function($,Z){if($._texture&&$._texture instanceof f){const J=$._texture.baseTexture;return Z.includes(J)||Z.push(J),!0}return!1},rj=function($,Z){return Z instanceof n$?(Z.updateText(!0),!0):!1},tj=function($,Z){if(Z instanceof D$){const J=Z.toFontString();return l$.measureFont(J),!0}return!1},ej=function($,Z){if($ instanceof n$){Z.includes($.style)||Z.push($.style),Z.includes($)||Z.push($);const J=$._texture.baseTexture;return Z.includes(J)||Z.push(J),!0}return!1},$B=function($,Z){return $ instanceof D$?(Z.includes($)||Z.push($),!0):!1},GW=class ${constructor(Z){this.limiter=new AZ($.uploadsPerFrame),this.renderer=Z,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(ej),this.registerFindHook($B),this.registerFindHook(sj),this.registerFindHook(ij),this.registerFindHook(aj),this.registerUploadHook(rj),this.registerUploadHook(tj)}upload(Z){return new Promise((J)=>{Z&&this.add(Z),this.queue.length?(this.completes.push(J),this.ticking||(this.ticking=!0,N0.system.addOnce(this.tick,this,T$.UTILITY))):J()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const Z=this.queue[0];let J=!1;if(Z&&!Z._destroyed){for(let Q=0,K=this.uploadHooks.length;Q<K;Q++)if(this.uploadHooks[Q](this.uploadHookHelper,Z)){this.queue.shift(),J=!0;break}}J||this.queue.shift()}if(this.queue.length)N0.system.addOnce(this.tick,this,T$.UTILITY);else{this.ticking=!1;const Z=this.completes.slice(0);this.completes.length=0;for(let J=0,Q=Z.length;J<Q;J++)Z[J]()}}registerFindHook(Z){return Z&&this.addHooks.push(Z),this}registerUploadHook(Z){return Z&&this.uploadHooks.push(Z),this}add(Z){for(let J=0,Q=this.addHooks.length;J<Q&&!this.addHooks[J](Z,this.queue);J++);if(Z instanceof r)for(let J=Z.children.length-1;J>=0;J--)this.add(Z.children[J]);return this}destroy(){this.ticking&&N0.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};GW.uploadsPerFrame=4;var _7=GW;Object.defineProperties(R,{UPLOADS_PER_FRAME:{get(){return _7.uploadsPerFrame},set($){T.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),_7.uploadsPerFrame=$}}});var YW=function($,Z){return Z instanceof n?(Z._glTextures[$.CONTEXT_UID]||$.texture.bind(Z),!0):!1},ZB=function($,Z){if(!(Z instanceof J8))return!1;const{geometry:J}=Z;Z.finishPoly(),J.updateBatches();const{batches:Q}=J;for(let K=0;K<Q.length;K++){const{texture:q}=Q[K].style;q&&YW($,q.baseTexture)}return J.batchable||$.geometry.bind(J,Z._resolveDirectShader($)),!0},JB=function($,Z){return $ instanceof J8?(Z.push($),!0):!1};class MZ extends _7{constructor($){super($),this.uploadHookHelper=this.renderer,this.registerFindHook(JB),this.registerUploadHook(YW),this.registerUploadHook(ZB)}}MZ.extension={name:"prepare",type:I.RendererSystem};P.add(MZ);var c5=new u;class p5 extends S0{constructor($,Z=100,J=100){super($),this.tileTransform=new i8,this._width=Z,this._height=J,this.uvMatrix=this.texture.uvMatrix||new t8($),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin($){this.uvMatrix.clampMargin=$,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale($){this.tileTransform.scale.copyFrom($)}get tilePosition(){return this.tileTransform.position}set tilePosition($){this.tileTransform.position.copyFrom($)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render($){const Z=this._texture;!Z||!Z.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),$.batch.setObjectRenderer($.plugins[this.pluginName]),$.plugins[this.pluginName].render(this))}_calculateBounds(){const $=this._width*-this._anchor._x,Z=this._height*-this._anchor._y,J=this._width*(1-this._anchor._x),Q=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,$,Z,J,Q)}getLocalBounds($){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),$||(this._localBoundsRect||(this._localBoundsRect=new m),$=this._localBoundsRect),this._bounds.getRectangle($)):super.getLocalBounds.call(this,$)}containsPoint($){this.worldTransform.applyInverse($,c5);const Z=this._width,J=this._height,Q=-Z*this.anchor._x;if(c5.x>=Q&&c5.x<Q+Z){const K=-J*this.anchor._y;if(c5.y>=K&&c5.y<K+J)return!0}return!1}destroy($){super.destroy($),this.tileTransform=null,this.uvMatrix=null}static from($,Z){const J=$ instanceof f?$:f.from($,Z);return new p5(J,Z.width,Z.height)}get width(){return this._width}set width($){this._width=$}get height(){return this._height}set height($){this._height=$}}var wW=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`;var jW=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var BW=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`;var K4=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var FW=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;var kZ=new Z0;class EZ extends H8{constructor($){super($),$.runners.contextChange.add(this),this.quad=new U7,this.state=p0.for2d()}contextChange(){const $=this.renderer,Z={globals:$.globalUniforms};this.simpleShader=a0.from(K4,FW,Z),this.shader=$.context.webGLVersion>1?a0.from(jW,wW,Z):a0.from(K4,BW,Z)}render($){const Z=this.renderer,J=this.quad;let Q=J.vertices;Q[0]=Q[6]=$._width*-$.anchor.x,Q[1]=Q[3]=$._height*-$.anchor.y,Q[2]=Q[4]=$._width*(1-$.anchor.x),Q[5]=Q[7]=$._height*(1-$.anchor.y);const K=$.uvRespectAnchor?$.anchor.x:0,q=$.uvRespectAnchor?$.anchor.y:0;Q=J.uvs,Q[0]=Q[6]=-K,Q[1]=Q[3]=-q,Q[2]=Q[4]=1-K,Q[5]=Q[7]=1-q,J.invalidate();const V=$._texture,X=V.baseTexture,W=X.alphaMode>0,U=$.tileTransform.localTransform,z=$.uvMatrix;let H=X.isPowerOfTwo&&V.frame.width===X.width&&V.frame.height===X.height;H&&(X._glTextures[Z.CONTEXT_UID]?H=X.wrapMode!==z$.CLAMP:X.wrapMode===z$.CLAMP&&(X.wrapMode=z$.REPEAT));const G=H?this.simpleShader:this.shader,Y=V.width,w=V.height,j=$._width,B=$._height;kZ.set(U.a*Y/j,U.b*Y/B,U.c*w/j,U.d*w/B,U.tx/j,U.ty/B),kZ.invert(),H?kZ.prepend(z.mapCoord):(G.uniforms.uMapCoord=z.mapCoord.toArray(!0),G.uniforms.uClampFrame=z.uClampFrame,G.uniforms.uClampOffset=z.uClampOffset),G.uniforms.uTransform=kZ.toArray(!0),G.uniforms.uColor=e.shared.setValue($.tint).premultiply($.worldAlpha,W).toArray(G.uniforms.uColor),G.uniforms.translationMatrix=$.transform.worldTransform.toArray(!0),G.uniforms.uSampler=V,Z.shader.bind(G),Z.geometry.bind(J),this.state.blendMode=T.correctBlendMode($.blendMode,W),Z.state.set(this.state),Z.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}EZ.extension={name:"tilingSprite",type:I.RendererPlugin};P.add(EZ);var NW=class ${constructor(Z,J,Q=null){this.linkedSheets=[],this._texture=Z instanceof f?Z:null,this.baseTexture=Z instanceof n?Z:this._texture.baseTexture,this.textures={},this.animations={},this.data=J;const K=this.baseTexture.resource;this.resolution=this._updateResolution(Q||(K?K.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(Z=null){const{scale:J}=this.data.meta;let Q=T.getResolutionOfUrl(Z,null);return Q===null&&(Q=parseFloat(J??"1")),Q!==1&&this.baseTexture.setResolution(Q),Q}parse(){return new Promise((Z)=>{this._callback=Z,this._batchIndex=0,this._frameKeys.length<=$.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(Z){let J=Z;const Q=$.BATCH_SIZE;for(;J-Z<Q&&J<this._frameKeys.length;){const K=this._frameKeys[J],q=this._frames[K],V=q.frame;if(V){let X=null,W=null;const U=q.trimmed!==!1&&q.sourceSize?q.sourceSize:q.frame,z=new m(0,0,Math.floor(U.w)/this.resolution,Math.floor(U.h)/this.resolution);q.rotated?X=new m(Math.floor(V.x)/this.resolution,Math.floor(V.y)/this.resolution,Math.floor(V.h)/this.resolution,Math.floor(V.w)/this.resolution):X=new m(Math.floor(V.x)/this.resolution,Math.floor(V.y)/this.resolution,Math.floor(V.w)/this.resolution,Math.floor(V.h)/this.resolution),q.trimmed!==!1&&q.spriteSourceSize&&(W=new m(Math.floor(q.spriteSourceSize.x)/this.resolution,Math.floor(q.spriteSourceSize.y)/this.resolution,Math.floor(V.w)/this.resolution,Math.floor(V.h)/this.resolution)),this.textures[K]=new f(this.baseTexture,X,z,W,q.rotated?2:0,q.anchor,q.borders),f.addToCache(this.textures[K],K.toString())}J++}}_processAnimations(){const Z=this.data.animations||{};for(let J in Z){this.animations[J]=[];for(let Q=0;Q<Z[J].length;Q++){const K=Z[J][Q];this.animations[J].push(this.textures[K])}}}_parseComplete(){const Z=this._callback;this._callback=null,this._batchIndex=0,Z.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*$.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*$.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(Z=!1){for(let J in this.textures)this.textures[J].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,Z&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};NW.BATCH_SIZE=1000;var f6=NW;var CW=function($,Z,J){const Q={};if($.forEach((K)=>{Q[K]=Z}),Object.keys(Z.textures).forEach((K)=>{Q[K]=Z.textures[K]}),!J){const K=T.path.dirname($[0]);Z.linkedSheets.forEach((q,V)=>{const X=CW([`${K}/${Z.data.meta.related_multi_packs[V]}`],q,!0);Object.assign(Q,X)})}return Q},QB=["jpg","png","jpeg","avif","webp"],LW={extension:I.Asset,cache:{test:($)=>$ instanceof f6,getCacheableAssets:($,Z)=>CW($,Z,!1)},resolver:{test:($)=>{const Z=$.split("?")[0].split("."),J=Z.pop(),Q=Z.pop();return J==="json"&&QB.includes(Q)},parse:($)=>{const Z=$.split(".");return{resolution:parseFloat(R.RETINA_PREFIX.exec($)?.[1]??"1"),format:Z[Z.length-2],src:$}}},loader:{name:"spritesheetLoader",extension:{type:I.LoadParser,priority:I0.Normal},async testParse($,Z){return T.path.extname(Z.src).toLowerCase()===".json"&&!!$.frames},async parse($,Z,J){let Q=T.path.dirname(Z.src);Q&&Q.lastIndexOf("/")!==Q.length-1&&(Q+="/");let K=Q+$.meta.image;K=E6(K,Z.src);const q=(await J.load([K]))[K],V=new f6(q.baseTexture,$,Z.src);await V.parse();const X=$?.meta?.related_multi_packs;if(Array.isArray(X)){const W=[];for(let z of X){if(typeof z!="string")continue;let H=Q+z;Z.data?.ignoreMultiPack||(H=E6(H,Z.src),W.push(J.load({src:H,data:{ignoreMultiPack:!0}})))}const U=await Promise.all(W);V.linkedSheets=U,U.forEach((z)=>{z.linkedSheets=[V].concat(V.linkedSheets.filter((H)=>H!==z))})}return V},unload($){$.destroy(!0)}}};P.add(LW);class c8{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class V6{static test($){return typeof $=="string"&&$.startsWith("info face=")}static parse($){const Z=$.match(/^[a-z]+\s+.+$/gm),J={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let K in Z){const q=Z[K].match(/^[a-z]+/gm)[0],V=Z[K].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),X={};for(let W in V){const U=V[W].split("="),z=U[0],H=U[1].replace(/"/gm,""),G=parseFloat(H),Y=isNaN(G)?H:G;X[z]=Y}J[q].push(X)}const Q=new c8;return J.info.forEach((K)=>Q.info.push({face:K.face,size:parseInt(K.size,10)})),J.common.forEach((K)=>Q.common.push({lineHeight:parseInt(K.lineHeight,10)})),J.page.forEach((K)=>Q.page.push({id:parseInt(K.id,10),file:K.file})),J.char.forEach((K)=>Q.char.push({id:parseInt(K.id,10),page:parseInt(K.page,10),x:parseInt(K.x,10),y:parseInt(K.y,10),width:parseInt(K.width,10),height:parseInt(K.height,10),xoffset:parseInt(K.xoffset,10),yoffset:parseInt(K.yoffset,10),xadvance:parseInt(K.xadvance,10)})),J.kerning.forEach((K)=>Q.kerning.push({first:parseInt(K.first,10),second:parseInt(K.second,10),amount:parseInt(K.amount,10)})),J.distanceField.forEach((K)=>Q.distanceField.push({distanceRange:parseInt(K.distanceRange,10),fieldType:K.fieldType})),Q}}class y6{static test($){const Z=$;return typeof $!="string"&&("getElementsByTagName"in $)&&Z.getElementsByTagName("page").length&&Z.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse($){const Z=new c8,J=$.getElementsByTagName("info"),Q=$.getElementsByTagName("common"),K=$.getElementsByTagName("page"),q=$.getElementsByTagName("char"),V=$.getElementsByTagName("kerning"),X=$.getElementsByTagName("distanceField");for(let W=0;W<J.length;W++)Z.info.push({face:J[W].getAttribute("face"),size:parseInt(J[W].getAttribute("size"),10)});for(let W=0;W<Q.length;W++)Z.common.push({lineHeight:parseInt(Q[W].getAttribute("lineHeight"),10)});for(let W=0;W<K.length;W++)Z.page.push({id:parseInt(K[W].getAttribute("id"),10)||0,file:K[W].getAttribute("file")});for(let W=0;W<q.length;W++){const U=q[W];Z.char.push({id:parseInt(U.getAttribute("id"),10),page:parseInt(U.getAttribute("page"),10)||0,x:parseInt(U.getAttribute("x"),10),y:parseInt(U.getAttribute("y"),10),width:parseInt(U.getAttribute("width"),10),height:parseInt(U.getAttribute("height"),10),xoffset:parseInt(U.getAttribute("xoffset"),10),yoffset:parseInt(U.getAttribute("yoffset"),10),xadvance:parseInt(U.getAttribute("xadvance"),10)})}for(let W=0;W<V.length;W++)Z.kerning.push({first:parseInt(V[W].getAttribute("first"),10),second:parseInt(V[W].getAttribute("second"),10),amount:parseInt(V[W].getAttribute("amount"),10)});for(let W=0;W<X.length;W++)Z.distanceField.push({fieldType:X[W].getAttribute("fieldType"),distanceRange:parseInt(X[W].getAttribute("distanceRange"),10)});return Z}}class g6{static test($){return typeof $=="string"&&$.includes("<font>")?y6.test(R.ADAPTER.parseXML($)):!1}static parse($){return y6.parse(R.ADAPTER.parseXML($))}}var V4=function($){for(let Z=0;Z<q4.length;Z++)if(q4[Z].test($))return q4[Z];return null},q4=[V6,y6,g6];var X4=function($,Z,J,Q,K,q){const V=J.fill;if(Array.isArray(V)){if(V.length===1)return V[0]}else return V;let X;const W=J.dropShadow?J.dropShadowDistance:0,U=J.padding||0,z=$.width/Q-W-U*2,H=$.height/Q-W-U*2,G=V.slice(),Y=J.fillGradientStops.slice();if(!Y.length){const w=G.length+1;for(let j=1;j<w;++j)Y.push(j/w)}if(G.unshift(V[0]),Y.unshift(0),G.push(V[V.length-1]),Y.push(1),J.fillGradientType===q6.LINEAR_VERTICAL){X=Z.createLinearGradient(z/2,U,z/2,H+U);let w=0;const j=(q.fontProperties.fontSize+J.strokeThickness)/H;for(let B=0;B<K.length;B++){const C=q.lineHeight*B;for(let N=0;N<G.length;N++){let F=0;typeof Y[N]=="number"?F=Y[N]:F=N/G.length;const L=C/H+F*j;let k=Math.max(w,L);k=Math.min(k,1),X.addColorStop(k,G[N]),w=k}}}else{X=Z.createLinearGradient(U,H/2,z+U,H/2);const w=G.length+1;let j=1;for(let B=0;B<G.length;B++){let C;typeof Y[B]=="number"?C=Y[B]:C=j/w,X.addColorStop(C,G[B]),j++}}return X};var W4=function($,Z,J,Q,K,q,V){const{text:X,fontProperties:W}=J;Z.translate(Q,K),Z.scale(q,q);const U=V.strokeThickness/2,z=-(V.strokeThickness/2);if(Z.font=V.toFontString(),Z.lineWidth=V.strokeThickness,Z.textBaseline=V.textBaseline,Z.lineJoin=V.lineJoin,Z.miterLimit=V.miterLimit,Z.fillStyle=X4($,Z,V,q,[X],J),Z.strokeStyle=V.stroke,V.dropShadow){const H=V.dropShadowColor,G=V.dropShadowBlur*q,Y=V.dropShadowDistance*q;Z.shadowColor=e.shared.setValue(H).setAlpha(V.dropShadowAlpha).toRgbaString(),Z.shadowBlur=G,Z.shadowOffsetX=Math.cos(V.dropShadowAngle)*Y,Z.shadowOffsetY=Math.sin(V.dropShadowAngle)*Y}else Z.shadowColor="black",Z.shadowBlur=0,Z.shadowOffsetX=0,Z.shadowOffsetY=0;V.stroke&&V.strokeThickness&&Z.strokeText(X,U,z+J.lineHeight-W.descent),V.fill&&Z.fillText(X,U,z+J.lineHeight-W.descent),Z.setTransform(1,0,0,1,0,0),Z.fillStyle="rgba(0, 0, 0, 0)"};var x6=function($){return $.codePointAt?$.codePointAt(0):$.charCodeAt(0)};var u5=function($){return Array.from?Array.from($):$.split("")};var U4=function($){typeof $=="string"&&($=[$]);const Z=[];for(let J=0,Q=$.length;J<Q;J++){const K=$[J];if(Array.isArray(K)){if(K.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${K.length}.`);const q=K[0].charCodeAt(0),V=K[1].charCodeAt(0);if(V<q)throw new Error("[BitmapFont]: Invalid character range.");for(let X=q,W=V;X<=W;X++)Z.push(String.fromCharCode(X))}else Z.push(...u5(K))}if(Z.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return Z};var X6=class ${constructor(Z,J,Q){const[K]=Z.info,[q]=Z.common,[V]=Z.page,[X]=Z.distanceField,W=T.getResolutionOfUrl(V.file),U={};this._ownsTextures=Q,this.font=K.face,this.size=K.size,this.lineHeight=q.lineHeight/W,this.chars={},this.pageTextures=U;for(let z=0;z<Z.page.length;z++){const{id:H,file:G}=Z.page[z];U[H]=J instanceof Array?J[z]:J[G],X?.fieldType&&X.fieldType!=="none"&&(U[H].baseTexture.alphaMode=_0.NO_PREMULTIPLIED_ALPHA,U[H].baseTexture.mipmap=s0.OFF)}for(let z=0;z<Z.char.length;z++){const{id:H,page:G}=Z.char[z];let{x:Y,y:w,width:j,height:B,xoffset:C,yoffset:N,xadvance:F}=Z.char[z];Y/=W,w/=W,j/=W,B/=W,C/=W,N/=W,F/=W;const L=new m(Y+U[G].frame.x/W,w+U[G].frame.y/W,j,B);this.chars[H]={xOffset:C,yOffset:N,xAdvance:F,kerning:{},texture:new f(U[G].baseTexture,L),page:G}}for(let z=0;z<Z.kerning.length;z++){let{first:H,second:G,amount:Y}=Z.kerning[z];H/=W,G/=W,Y/=W,this.chars[G]&&(this.chars[G].kerning[H]=Y)}this.distanceFieldRange=X?.distanceRange,this.distanceFieldType=X?.fieldType?.toLowerCase()??"none"}destroy(){for(let Z in this.chars)this.chars[Z].texture.destroy(),this.chars[Z].texture=null;for(let Z in this.pageTextures)this._ownsTextures&&this.pageTextures[Z].destroy(!0),this.pageTextures[Z]=null;this.chars=null,this.pageTextures=null}static install(Z,J,Q){let K;if(Z instanceof c8)K=Z;else{const V=V4(Z);if(!V)throw new Error("Unrecognized data format for font.");K=V.parse(Z)}J instanceof f&&(J=[J]);const q=new $(K,J,Q);return $.available[q.font]=q,q}static uninstall(Z){const J=$.available[Z];if(!J)throw new Error(`No font found named '${Z}'`);J.destroy(),delete $.available[Z]}static from(Z,J,Q){if(!Z)throw new Error("[BitmapFont] Property `name` is required.");const{chars:K,padding:q,resolution:V,textureWidth:X,textureHeight:W,...U}=Object.assign({},$.defaultOptions,Q),z=U4(K),H=J instanceof D$?J:new D$(J),G=X,Y=new c8;Y.info[0]={face:H.fontFamily,size:H.fontSize},Y.common[0]={lineHeight:H.fontSize};let w=0,j=0,B,C,N,F=0;const L=[],k=[];for(let O=0;O<z.length;O++){B||(B=R.ADAPTER.createCanvas(),B.width=X,B.height=W,C=B.getContext("2d"),N=new n(B,{resolution:V,...U}),L.push(N),k.push(new f(N)),Y.page.push({id:k.length-1,file:""}));const h=z[O],c=l$.measureText(h,H,!1,B),S=c.width,M=Math.ceil(c.height),y=Math.ceil((H.fontStyle==="italic"?2:1)*S);if(j>=W-M*V){if(j===0)throw new Error(`[BitmapFont] textureHeight ${W}px is too small (fontFamily: '${H.fontFamily}', fontSize: ${H.fontSize}px, char: '${h}')`);--O,B=null,C=null,N=null,j=0,w=0,F=0;continue}if(F=Math.max(M+c.fontProperties.descent,F),y*V+w>=G){if(w===0)throw new Error(`[BitmapFont] textureWidth ${X}px is too small (fontFamily: '${H.fontFamily}', fontSize: ${H.fontSize}px, char: '${h}')`);--O,j+=F*V,j=Math.ceil(j),w=0,F=0;continue}W4(B,C,c,w,j,V,H);const A=x6(c.text);Y.char.push({id:A,page:k.length-1,x:w/V,y:j/V,width:y,height:M,xoffset:0,yoffset:0,xadvance:S-(H.dropShadow?H.dropShadowDistance:0)-(H.stroke?H.strokeThickness:0)}),w+=(y+2*q)*V,w=Math.ceil(w)}if(!Q?.skipKerning)for(let O=0,h=z.length;O<h;O++){const c=z[O];for(let S=0;S<h;S++){const M=z[S],y=C.measureText(c).width,A=C.measureText(M).width,b=C.measureText(c+M).width-(y+A);b&&Y.kerning.push({first:x6(c),second:x6(M),amount:b})}}const o=new $(Y,k,!0);return $.available[Z]!==void 0&&$.uninstall(Z),$.available[Z]=o,o}};X6.ALPHA=[["a","z"],["A","Z"]," "],X6.NUMERIC=[["0","9"]],X6.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],X6.ASCII=[[" ","~"]],X6.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:X6.ALPHANUMERIC},X6.available={};var Q8=X6;var _W=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`;var OW=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;var IW=[],RW=[],PW=[],KB=class $ extends r{constructor(Z,J={}){super();const{align:Q,tint:K,maxWidth:q,letterSpacing:V,fontName:X,fontSize:W}=Object.assign({},$.styleDefaults,J);if(!Q8.available[X])throw new Error(`Missing BitmapFont "${X}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=Q,this._tintColor=new e(K),this._font=void 0,this._fontName=X,this._fontSize=W,this.text=Z,this._maxWidth=q,this._maxLineHeight=0,this._letterSpacing=V,this._anchor=new E$(()=>{this.dirty=!0},this,0,0),this._roundPixels=R.ROUND_PIXELS,this.dirty=!0,this._resolution=R.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const Z=Q8.available[this._fontName],J=this.fontSize,Q=J/Z.size,K=new u,q=[],V=[],X=[],W=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",U=u5(W),z=this._maxWidth*Z.size/J,H=Z.distanceFieldType==="none"?IW:RW;let G=null,Y=0,w=0,j=0,B=-1,C=0,N=0,F=0,L=0;for(let M=0;M<U.length;M++){const y=U[M],A=x6(y);if(/(?:\s)/.test(y)&&(B=M,C=Y,L++),y==="\r"||y===`
`){V.push(Y),X.push(-1),w=Math.max(w,Y),++j,++N,K.x=0,K.y+=Z.lineHeight,G=null,L=0;continue}const b=Z.chars[A];if(!b)continue;G&&b.kerning[G]&&(K.x+=b.kerning[G]);const $0=PW.pop()||{texture:f.EMPTY,line:0,charCode:0,prevSpaces:0,position:new u};$0.texture=b.texture,$0.line=j,$0.charCode=A,$0.position.x=Math.round(K.x+b.xOffset+this._letterSpacing/2),$0.position.y=Math.round(K.y+b.yOffset),$0.prevSpaces=L,q.push($0),Y=$0.position.x+Math.max(b.xAdvance-b.xOffset,b.texture.orig.width),K.x+=b.xAdvance+this._letterSpacing,F=Math.max(F,b.yOffset+b.texture.height),G=A,B!==-1&&z>0&&K.x>z&&(++N,T.removeItems(q,1+B-N,1+M-B),M=B,B=-1,V.push(C),X.push(q.length>0?q[q.length-1].prevSpaces:0),w=Math.max(w,C),j++,K.x=0,K.y+=Z.lineHeight,G=null,L=0)}const k=U[U.length-1];k!=="\r"&&k!==`
`&&(/(?:\s)/.test(k)&&(Y=C),V.push(Y),w=Math.max(w,Y),X.push(-1));const o=[];for(let M=0;M<=j;M++){let y=0;this._align==="right"?y=w-V[M]:this._align==="center"?y=(w-V[M])/2:this._align==="justify"&&(y=X[M]<0?0:(w-V[M])/X[M]),o.push(y)}const O=q.length,h={},c=[],S=this._activePagesMeshData;H.push(...S);for(let M=0;M<O;M++){const y=q[M].texture,A=y.baseTexture.uid;if(!h[A]){let b=H.pop();if(!b){const Q0=new h6;let l,Y0;Z.distanceFieldType==="none"?(l=new K6(f.EMPTY),Y0=a.NORMAL):(l=new K6(f.EMPTY,{program:J$.from(OW,_W),uniforms:{uFWidth:0}}),Y0=a.NORMAL_NPM);const b0=new S6(Q0,l);b0.blendMode=Y0,b={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:b0,vertices:null,uvs:null,indices:null}}b.index=0,b.indexCount=0,b.vertexCount=0,b.uvsCount=0,b.total=0;const{_textureCache:$0}=this;$0[A]=$0[A]||new f(y.baseTexture),b.mesh.texture=$0[A],b.mesh.tint=this._tintColor.value,c.push(b),h[A]=b}h[A].total++}for(let M=0;M<S.length;M++)c.includes(S[M])||this.removeChild(S[M].mesh);for(let M=0;M<c.length;M++)c[M].mesh.parent!==this&&this.addChild(c[M].mesh);this._activePagesMeshData=c;for(let M in h){const y=h[M],A=y.total;if(!(y.indices?.length>6*A)||y.vertices.length<S6.BATCHABLE_SIZE*2)y.vertices=new Float32Array(8*A),y.uvs=new Float32Array(8*A),y.indices=new Uint16Array(6*A);else{const{total:b,vertices:$0}=y;for(let Q0=b*4*2;Q0<$0.length;Q0++)$0[Q0]=0}y.mesh.size=6*A}for(let M=0;M<O;M++){const y=q[M];let A=y.position.x+o[y.line]*(this._align==="justify"?y.prevSpaces:1);this._roundPixels&&(A=Math.round(A));const b=A*Q,$0=y.position.y*Q,Q0=y.texture,l=h[Q0.baseTexture.uid],Y0=Q0.frame,b0=Q0._uvs,K0=l.index++;l.indices[K0*6+0]=0+K0*4,l.indices[K0*6+1]=1+K0*4,l.indices[K0*6+2]=2+K0*4,l.indices[K0*6+3]=0+K0*4,l.indices[K0*6+4]=2+K0*4,l.indices[K0*6+5]=3+K0*4,l.vertices[K0*8+0]=b,l.vertices[K0*8+1]=$0,l.vertices[K0*8+2]=b+Y0.width*Q,l.vertices[K0*8+3]=$0,l.vertices[K0*8+4]=b+Y0.width*Q,l.vertices[K0*8+5]=$0+Y0.height*Q,l.vertices[K0*8+6]=b,l.vertices[K0*8+7]=$0+Y0.height*Q,l.uvs[K0*8+0]=b0.x0,l.uvs[K0*8+1]=b0.y0,l.uvs[K0*8+2]=b0.x1,l.uvs[K0*8+3]=b0.y1,l.uvs[K0*8+4]=b0.x2,l.uvs[K0*8+5]=b0.y2,l.uvs[K0*8+6]=b0.x3,l.uvs[K0*8+7]=b0.y3}this._textWidth=w*Q,this._textHeight=(K.y+Z.lineHeight)*Q;for(let M in h){const y=h[M];if(this.anchor.x!==0||this.anchor.y!==0){let Q0=0;const l=this._textWidth*this.anchor.x,Y0=this._textHeight*this.anchor.y;for(let b0=0;b0<y.total;b0++)y.vertices[Q0++]-=l,y.vertices[Q0++]-=Y0,y.vertices[Q0++]-=l,y.vertices[Q0++]-=Y0,y.vertices[Q0++]-=l,y.vertices[Q0++]-=Y0,y.vertices[Q0++]-=l,y.vertices[Q0++]-=Y0}this._maxLineHeight=F*Q;const A=y.mesh.geometry.getBuffer("aVertexPosition"),b=y.mesh.geometry.getBuffer("aTextureCoord"),$0=y.mesh.geometry.getIndex();A.data=y.vertices,b.data=y.uvs,$0.data=y.indices,A.update(),b.update(),$0.update()}for(let M=0;M<q.length;M++)PW.push(q[M]);this._font=Z,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(Z){this._autoResolution&&this._resolution!==Z.resolution&&(this._resolution=Z.resolution,this.dirty=!0);const{distanceFieldRange:J,distanceFieldType:Q,size:K}=Q8.available[this._fontName];if(Q!=="none"){const{a:q,b:V,c:X,d:W}=this.worldTransform,U=Math.sqrt(q*q+V*V),z=Math.sqrt(X*X+W*W),H=(Math.abs(U)+Math.abs(z))/2,G=this.fontSize/K,Y=Z._view.resolution;for(let w of this._activePagesMeshData)w.mesh.shader.uniforms.uFWidth=H*J*G*Y}super._render(Z)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const Z=Q8.available[this._fontName];if(!Z)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==Z&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(Z){if(this.tint!==Z){this._tintColor.setValue(Z);for(let J=0;J<this._activePagesMeshData.length;J++)this._activePagesMeshData[J].mesh.tint=Z}}get align(){return this._align}set align(Z){this._align!==Z&&(this._align=Z,this.dirty=!0)}get fontName(){return this._fontName}set fontName(Z){if(!Q8.available[Z])throw new Error(`Missing BitmapFont "${Z}"`);this._fontName!==Z&&(this._fontName=Z,this.dirty=!0)}get fontSize(){return this._fontSize??Q8.available[this._fontName].size}set fontSize(Z){this._fontSize!==Z&&(this._fontSize=Z,this.dirty=!0)}get anchor(){return this._anchor}set anchor(Z){typeof Z=="number"?this._anchor.set(Z):this._anchor.copyFrom(Z)}get text(){return this._text}set text(Z){Z=String(Z??""),this._text!==Z&&(this._text=Z,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(Z){this._maxWidth!==Z&&(this._maxWidth=Z,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(Z){this._letterSpacing!==Z&&(this._letterSpacing=Z,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(Z){Z!==this._roundPixels&&(this._roundPixels=Z,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(Z){this._autoResolution=!1,this._resolution!==Z&&(this._resolution=Z,this.dirty=!0)}destroy(Z){const{_textureCache:J}=this,Q=Q8.available[this._fontName].distanceFieldType==="none"?IW:RW;Q.push(...this._activePagesMeshData);for(let K of this._activePagesMeshData)this.removeChild(K.mesh);this._activePagesMeshData=[],Q.filter((K)=>J[K.mesh.texture.baseTexture.uid]).forEach((K)=>{K.mesh.texture=f.EMPTY});for(let K in J)J[K].destroy(),delete J[K];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(Z)}};KB.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var qB=[".xml",".fnt"],DW={extension:{type:I.LoadParser,priority:I0.Normal},name:"loadBitmapFont",test($){return qB.includes(T.path.extname($).toLowerCase())},async testParse($){return V6.test($)||g6.test($)},async parse($,Z,J){const Q=V6.test($)?V6.parse($):g6.parse($),{src:K}=Z,{page:q}=Q,V=[];for(let U=0;U<q.length;++U){const z=q[U].file;let H=T.path.join(T.path.dirname(K),z);H=E6(H,K),V.push(H)}const X=await J.load(V),W=V.map((U)=>X[U]);return Q8.install(Q,W,!0)},async load($,Z){return(await R.ADAPTER.fetch($)).text()},unload($){$.destroy()}};P.add(DW);var z4=class $ extends D${constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(Z){return new $(Object.keys($.defaultOptions).reduce((J,Q)=>({...J,[Q]:Z[Q]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach((Z)=>{URL.revokeObjectURL(Z.src),Z.refs--,Z.refs===0&&(Z.fontFace&&document.fonts.delete(Z.fontFace),delete $.availableFonts[Z.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(Z,J={}){const{availableFonts:Q}=$;if(Q[Z]){const K=Q[Z];return this._fonts.push(K),K.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return R.ADAPTER.fetch(Z).then((K)=>K.blob()).then(async(K)=>new Promise((q,V)=>{const X=URL.createObjectURL(K),W=new FileReader;W.onload=()=>q([X,W.result]),W.onerror=V,W.readAsDataURL(K)})).then(async([K,q])=>{const V=Object.assign({family:T.path.basename(Z,T.path.extname(Z)),weight:"normal",style:"normal",display:"auto",src:K,dataSrc:q,refs:1,originalUrl:Z,fontFace:null},J);Q[Z]=V,this._fonts.push(V),this.styleID++;const X=new FontFace(V.family,`url(${V.src})`,{weight:V.weight,style:V.style,display:V.display});V.fontFace=X,await X.load(),document.fonts.add(X),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...Z){const J=Z.filter((Q)=>!this._overrides.includes(Q));J.length>0&&(this._overrides.push(...J),this.styleID++)}removeOverride(...Z){const J=Z.filter((Q)=>this._overrides.includes(Q));J.length>0&&(this._overrides=this._overrides.filter((Q)=>!J.includes(Q)),this.styleID++)}toCSS(Z){return[`transform: scale(${Z})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((Z,J)=>`${Z}
            @font-face {
                font-family: "${J.family}";
                src: url('${J.dataSrc}');
                font-weight: ${J.weight};
                font-style: ${J.style};
                font-display: ${J.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(Z){this._stylesheet!==Z&&(this._stylesheet=Z,this.styleID++)}normalizeColor(Z){return Array.isArray(Z)&&(Z=T.rgb2hex(Z)),typeof Z=="number"?T.hex2string(Z):Z}dropShadowToCSS(){let Z=this.normalizeColor(this.dropShadowColor);const J=this.dropShadowAlpha,Q=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),K=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);Z.startsWith("#")&&J<1&&(Z+=(J*255|0).toString(16).padStart(2,"0"));const q=`${Q}px ${K}px`;return this.dropShadowBlur>0?`text-shadow: ${q} ${this.dropShadowBlur}px ${Z}`:`text-shadow: ${q} ${Z}`}reset(){Object.assign(this,$.defaultOptions)}onBeforeDraw(){const{fontsDirty:Z}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&Z?new Promise((J)=>setTimeout(J,100)):Promise.resolve()}get isSafari(){const{userAgent:Z}=R.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(Z)}set fillGradientStops(Z){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(Z){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(Z){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(Z){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(Z){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(Z){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(Z){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};z4.availableFonts={},z4.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};var d5=z4;var TZ=class $ extends S0{constructor(Z="",J={}){super(f.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const Q=new Image,K=f.from(Q,{scaleMode:R.SCALE_MODE,resourceOptions:{autoLoad:!1}});K.orig=new m,K.trim=new m,this.texture=K;const q="http://www.w3.org/2000/svg",V="http://www.w3.org/1999/xhtml",X=document.createElementNS(q,"svg"),W=document.createElementNS(q,"foreignObject"),U=document.createElementNS(V,"div"),z=document.createElementNS(V,"style");W.setAttribute("width","10000"),W.setAttribute("height","10000"),W.style.overflow="hidden",X.appendChild(W),this.maxWidth=$.defaultMaxWidth,this.maxHeight=$.defaultMaxHeight,this._domElement=U,this._styleElement=z,this._svgRoot=X,this._foreignObject=W,this._foreignObject.appendChild(z),this._foreignObject.appendChild(U),this._image=Q,this._loadImage=new Image,this._autoResolution=$.defaultAutoResolution,this._resolution=$.defaultResolution??R.RESOLUTION,this.text=Z,this.style=J}measureText(Z){const{text:J,style:Q,resolution:K}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},Z);Object.assign(this._domElement,{innerHTML:J,style:Q.toCSS(K)}),this._styleElement.textContent=Q.toGlobalCSS(),document.body.appendChild(this._svgRoot);const q=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:V,height:X}=q;(V>this.maxWidth||X>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const W=Math.min(this.maxWidth,Math.ceil(V)),U=Math.min(this.maxHeight,Math.ceil(X));return this._svgRoot.setAttribute("width",W.toString()),this._svgRoot.setAttribute("height",U.toString()),J!==this._text&&(this._domElement.innerHTML=this._text),Q!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(K)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:W+Q.padding*2,height:U+Q.padding*2}}async updateText(Z=!0){const{style:J,_image:Q,_loadImage:K}=this;if(this.localStyleID!==J.styleID&&(this.dirty=!0,this.localStyleID=J.styleID),!this.dirty&&Z)return;const{width:q,height:V}=this.measureText();Q.width=K.width=Math.ceil(Math.max(1,q)),Q.height=K.height=Math.ceil(Math.max(1,V)),this._updateID++;const X=this._updateID;await new Promise((W)=>{K.onload=async()=>{if(X<this._updateID){W();return}await J.onBeforeDraw(),Q.src=K.src,K.onload=null,K.src="",this.updateTexture(),W()};const U=new XMLSerializer().serializeToString(this._svgRoot);K.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(U)}`})}get source(){return this._image}updateTexture(){const{style:Z,texture:J,_image:Q,resolution:K}=this,{padding:q}=Z,{baseTexture:V}=J;J.trim.width=J._frame.width=Q.width/K,J.trim.height=J._frame.height=Q.height/K,J.trim.x=-q,J.trim.y=-q,J.orig.width=J._frame.width-q*2,J.orig.height=J._frame.height-q*2,this._onTextureUpdate(),V.setRealSize(Q.width,Q.height,K),this.dirty=!1}_render(Z){this._autoResolution&&this._resolution!==Z.resolution&&(this._resolution=Z.resolution,this.dirty=!0),this.updateText(!0),super._render(Z)}_renderCanvas(Z){this._autoResolution&&this._resolution!==Z.resolution&&(this._resolution=Z.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(Z)}getLocalBounds(Z){return this.updateText(!0),super.getLocalBounds(Z)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(Z){typeof Z=="boolean"&&(Z={children:Z}),Z=Object.assign({},$.defaultDestroyOptions,Z),super.destroy(Z);const J=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=J,this._svgRoot?.remove(),this._svgRoot=J,this._domElement?.remove(),this._domElement=J,this._foreignObject?.remove(),this._foreignObject=J,this._styleElement?.remove(),this._styleElement=J,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=J,this._image.src="",this._image=J}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(Z){this.updateText(!0);const J=T.sign(this.scale.x)||1;this.scale.x=J*Z/this._image.width/this.resolution,this._width=Z}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(Z){this.updateText(!0);const J=T.sign(this.scale.y)||1;this.scale.y=J*Z/this._image.height/this.resolution,this._height=Z}get style(){return this._style}set style(Z){this._style!==Z&&(Z=Z||{},Z instanceof d5?(this.ownsStyle=!1,this._style=Z):Z instanceof D$?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=d5.from(Z)):(this.ownsStyle=!0,this._style=new d5(Z)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(Z){Z=String(Z===""||Z===null||Z===void 0?" ":Z),Z=this.sanitiseText(Z),this._text!==Z&&(this._text=Z,this.dirty=!0)}get resolution(){return this._resolution}set resolution(Z){this._autoResolution=!1,this._resolution!==Z&&(this._resolution=Z,this.dirty=!0)}sanitiseText(Z){return Z.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};TZ.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},TZ.defaultMaxWidth=2024,TZ.defaultMaxHeight=2024,TZ.defaultAutoResolution=!0;/*!
 * @pixi-essentials/cull - v1.1.0
 * Compiled Sun, 05 Mar 2023 03:07:48 UTC
 *
 * @pixi-essentials/cull is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2020, Shukant Pal <shukantpal@outlook.com>, All Rights Reserved
 */var m6=new m;class H4{constructor($={}){this._recursive=typeof $.recursive==="boolean"?$.recursive:!0,this._toggle=$.toggle||"visible",this._targetList=new Set}add($){return this._targetList.add($),this}addAll($){for(let Z=0,J=$.length;Z<J;Z++)this._targetList.add($[Z]);return this}remove($){return this._targetList.delete($),this}removeAll($){for(let Z=0,J=$.length;Z<J;Z++)this._targetList.delete($[Z]);return this}clear(){return this._targetList.clear(),this}cull($,Z=!1){if(!Z)this.uncull();return this._targetList.forEach((J)=>{if(!Z)J.getBounds(!1,m6);if(this._recursive)this.cullRecursive($,J,Z);else{if(Z)J._bounds.getRectangle($);J[this._toggle]=m6.right>$.left&&m6.left<$.right&&m6.bottom>$.top&&m6.top<$.bottom}}),this}uncull(){return this._targetList.forEach(($)=>{if(this._recursive)this.uncullRecursive($);else $[this._toggle]=!1}),this}cullRecursive($,Z,J){const Q=J?Z._bounds.getRectangle(m6):Z.getBounds(!0,m6);if(Z[this._toggle]=Q.right>$.left&&Q.left<$.right&&Q.bottom>$.top&&Q.top<$.bottom,!(Q.left>=$.left&&Q.top>=$.top&&Q.right<=$.right&&Q.bottom<=$.bottom)&&Z[this._toggle]&&Z.children&&Z.children.length){const q=Z.children;for(let V=0,X=q.length;V<X;V++)this.cullRecursive($,q[V])}}uncullRecursive($){if($[this._toggle]=!0,$.children&&$.children.length){const Z=$.children;for(let J=0,Q=Z.length;J<Q;J++)this.uncullRecursive(Z[J])}}}class G4{Initialized=!1;container;skillTreeData;skillTreeDataCompare;_lastTick=Date.now();constructor($,Z,J){this.container=$,this.skillTreeData=Z,this.skillTreeDataCompare=J}Tick(){const $=Date.now(),Z=this._lastTick-$;if(this._lastTick=$,this.PreUpdate(Z),this.IsDirty())this.Update(Z);this.PostUpdate(Z),requestAnimationFrame(()=>{this.Tick()})}RenderBase=()=>{if(!this.Initialized)return;this.SetupLayers(),this.GenerateCompare(),this.ClearLayer(g.Background),this.DrawBackground(),this.ClearLayer(g.GroupBackground),this.DrawGroupBackgrounds(),this.DrawAscendancyBackgrounds(),this.ClearLayer(g.CharacterStarts),this.DrawInactiveCharacters(),this.ClearLayer(g.Connections),this.DrawConnectionsForNodes(g.Connections,this.skillTreeData.nodes),this.ClearLayer(g.SkillIcons),this.ClearLayer(g.SkillIconsFrames),this.ClearLayer(g.SkillIconsCompare),this.DrawInactiveNodes(),this.DrawCompareHighlights()};DrawBackground=()=>{var $=this.skillTreeData.hasSprite("background","Background1")?"Background1":"Background2",Z={patch:this.skillTreeData.patch,key:this.skillTreeData.tree.slice(0,5)==="Atlas"?"atlasBackground":"background",icon:this.skillTreeData.tree.slice(0,5)==="Atlas"?"AtlasPassiveBackground":$};this.DrawBackgroundAsset(g.Background,Z)};GenerateCompare=()=>{if(this.skillTreeDataCompare===void 0)return;for(let $ in this.skillTreeData.nodes){const Z=this.skillTreeData.nodes[$];if(Z.nodeGroup===void 0||Z.classStartIndex!==void 0)continue;if(this.skillTreeDataCompare.nodes[Z.GetId()]===void 0)continue;const J=this.skillTreeDataCompare.nodes[Z.GetId()];let Q=Z.stats.length!==J.stats.length;for(let V of Z.stats){let X=!1;for(let W of J.stats)if(V.toUpperCase()===W.toUpperCase())X=!0;if(!X){Q=!0;break}}if(Q)this.skillTreeDataCompare.addState(J,_.Compared);const K=Z.targetSize;if(K.width!==0&&K.height!==0&&(Math.abs(Z.x-J.x)>K.width||Math.abs(Z.y-J.y)>K.height))this.skillTreeDataCompare.addState(J,_.Moved)}};DrawGroupBackgrounds=()=>{const $=[];for(let Z in this.skillTreeData.groups){const J=this.skillTreeData.groups[Z],Q=J.background;if(Q===void 0)continue;$.push({patch:this.skillTreeData.patch,key:"groupBackground",icon:Q.image,x:Math.ceil(J.x*this.skillTreeData.scale)+(Q.offsetX?Q.offsetX*this.skillTreeData.scale:0),y:Math.ceil(J.y*this.skillTreeData.scale)+(Q.offsetY?Q.offsetY*this.skillTreeData.scale:0),half:Q.isHalfImage})}this.DrawSpriteSheetAssets(g.GroupBackground,$)};DrawAscendancyBackgrounds=()=>{for(let $ in this.skillTreeData.ascendancyNodes){const Z=this.skillTreeData.ascendancyNodes[$];if(!Z.isAscendancyStart||Z.nodeGroup===void 0)continue;const{nodeGroup:J,ascendancyName:Q}=Z,K=`Classes${Z.ascendancyName}`;this.DrawAscendancyBackground(this.skillTreeData.classes.flatMap((q)=>q.ascendancies),J,Q,"ascendancyBackground",K),this.DrawAscendancyBackground(this.skillTreeData.alternate_ascendancies,J,Q,"azmeriBackground",K)}};DrawAscendancyBackground=($,Z,J,Q,K)=>{if(!this.skillTreeData.hasSprite(Q,K))return;const q={patch:this.skillTreeData.patch,key:Q,icon:K,x:Math.ceil(Z.x*this.skillTreeData.scale),y:Math.ceil(Z.y*this.skillTreeData.scale),mask:"circle"},V=this.DrawSpriteSheetAsset(g.GroupBackground,q);if($===void 0||$.length===0)return;for(let X in $){const W=$[X];if(W.id!==J||W.flavourTextRect===void 0)continue;const U=[W.flavourTextRect.x,W.flavourTextRect.y],z=Math.ceil((Z.x+ +U[0])*this.skillTreeData.scale)-V.width/2,H=Math.ceil((Z.y+ +U[1])*this.skillTreeData.scale)-V.height/2,[G,Y,w]=this.ExtractColour(W.flavourTextColour),j="0x"+((1<<24)+(G<<16)+(Y<<8)+w).toString(16).slice(1);this.DrawText(g.GroupBackground,W.flavourText,j,z,H)}};ExtractColour=($)=>{let Z=0,J=0,Q=0;if($.indexOf(",")>0){const K=$.split(",");Z=+K[0],J=+K[1],Q=+K[2]}else{const K=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec("#"+$);if(K&&K.length===4)Z=parseInt(K[1],16),J=parseInt(K[2],16),Q=parseInt(K[3],16)}return[Z,J,Q]};DrawInactiveCharacters=()=>{if(!this.skillTreeData.hasSprite("startNode","PSStartNodeBackgroundInactive"))return;const $=[];for(let Z of this.skillTreeData.root.out){const J=this.skillTreeData.nodes[Z];if(J.classStartIndex===void 0||J.nodeGroup===void 0||J.ascendancyName!=="")continue;$.push({patch:this.skillTreeData.patch,key:"startNode",icon:"PSStartNodeBackgroundInactive",x:J.nodeGroup.x*this.skillTreeData.scale,y:J.nodeGroup.y*this.skillTreeData.scale})}this.DrawSpriteSheetAssets(g.CharacterStarts,$)};DrawInactiveNodes=()=>{if(this.DrawNodes(g.SkillIcons,this.skillTreeData.nodes,this.skillTreeData.nodes,{filterClassIndex:!0,bindEvents:!0}),this.skillTreeDataCompare===void 0)return;const $={};for(let Z in this.skillTreeDataCompare.nodes){const J=this.skillTreeDataCompare.nodes[Z];if(this.skillTreeData.nodes[J.GetId()]!==void 0)continue;$[Z]=J}this.DrawNodes(g.SkillIconsCompare,$,this.skillTreeDataCompare.nodes,{filterClassIndex:!0,bindEvents:!0})};DrawCompareHighlights=()=>{if(this.skillTreeDataCompare===void 0)return;const $=[];for(let J in this.skillTreeData.nodes){const Q=this.skillTreeData.nodes[J];if(Q.nodeGroup===void 0||Q.classStartIndex!==void 0)continue;const K=this.skillTreeDataCompare.nodes[Q.GetId()];if(K===void 0)$.push({node:Q,color:p8.Added});else{if(!(K.is(_.Compared)||K.is(_.Moved)))continue;$.push({node:Q,color:p8.Changed})}}this.DrawHighlights(g.SkillIconsFrames,$);const Z=[];for(let J in this.skillTreeDataCompare.nodes){const Q=this.skillTreeDataCompare.nodes[J];if(this.skillTreeData.nodes[Q.GetId()]!==void 0)continue;this.skillTreeDataCompare.addState(Q,_.Compared),Z.push({node:Q,color:p8.Removed})}this.DrawHighlights(g.SkillIconsCompare,Z)};DrawConnectionsForNodes=($,Z)=>{const J=[],Q={};for(let K in Z){const q=Z[K];if(q.nodeGroup===void 0||$===g.Connections&&q.classStartIndex!==void 0)continue;let V=q.in.filter((X)=>!Q[`${+K}-${X}`]||!Q[`${X}-${+K}`]).map((X)=>{return Q[`${+K}-${X}`]=!0,Q[`${X}-${+K}`]=!0,this.skillTreeData.nodes[X]});if($===g.Connections)V=V.filter((X)=>X.classStartIndex===void 0);for(let X of V){if(!this.IsValidConnection(q,X))continue;const W=q.GetConnectionType(X),U=q.group===X.group&&q.orbit===X.orbit?E8.Arc:E8.Line,z=U===E8.Arc?`Orbit${q.orbit}${W}`:`LineConnector${W}`,H=q.is(_.Active|_.Pathing)&&X.is(_.Active|_.Pathing);J.push({patch:q.patch,key:"line",icon:z,style:U,node:q,other:X,removing:H})}}this.DrawConnections($,J)};IsValidConnection=($,Z)=>{if($.ascendancyName!==""&&Z.ascendancyName===""||$.ascendancyName===""&&Z.ascendancyName!=="")return!1;if($.classStartIndex!==void 0||Z.classStartIndex!==void 0){const J=this.skillTreeData.getStartClass();return $.classStartIndex===J||Z.classStartIndex===J}if($.isMastery||Z.isMastery)return!1;if($.isWormhole&&Z.isWormhole)return!1;if(($.is(_.Pathing)||$.is(_.Hovered))&&!(Z.is(_.Pathing)||Z.is(_.Hovered)||Z.is(_.Active)))return!1;return!0};DrawNodes=($,Z,J,Q)=>{const K=[],q=[],V=[],X=[];for(let W in Z){const U=Z[W];if(U.nodeGroup===void 0||Q.filterClassIndex&&U.classStartIndex!==void 0)continue;if(U.activeEffectImage!==""&&U.is(_.Active))K.push({patch:U.patch,key:"masteryActiveEffect",icon:U.activeEffectImage,x:U.x,y:U.y});const z=U.GetIcon();if(!U.isAscendancyStart&&z!=="")if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&U.isMastery&&U.is(_.Hovered))if(this.skillTreeData.hasSprite("masteryOverlay",z))V.push({patch:U.patch,key:"masteryOverlay",icon:z,x:U.x,y:U.y});else V.push({patch:U.patch,key:"mastery",icon:z,x:U.x,y:U.y,scale:2.5});else q.push({patch:U.patch,key:U.GetSpriteSheetKey(),icon:z,x:U.x,y:U.y,node:Q.bindEvents?U:void 0});let H=U.out.map((w)=>J[w]).filter((w)=>w);if(Q.filterClassIndex)H=H.filter((w)=>w.classStartIndex===void 0);if(Q.outFrames)for(let w of H){if(w.classStartIndex!==void 0)continue;const j=w.in.map((N)=>J[N]),B=w.GetFrameAssetKey(j),C=this.GetFrameSpriteSheetKey(w,B);if(B!==null)X.push({patch:U.patch,key:C,icon:B,x:w.x,y:w.y})}const G=U.GetFrameAssetKey(H),Y=this.GetFrameSpriteSheetKey(U,G);if(G!==null)X.push({patch:U.patch,key:Y,icon:G,x:U.x,y:U.y,node:Q.bindEvents?U:void 0})}this.DrawSpriteSheetAssets(g.SkillIconsActiveEffects,K),this.DrawSpriteSheetAssets(g.AtlasMasteryHighlight,V),this.DrawSpriteSheetAssets($,q),this.DrawSpriteSheetAssets($+3,X)};GetFrameSpriteSheetKey=($,Z)=>{if(this.skillTreeData.isWildwoodAscendancyClass($))return"azmeri";if(Z?.startsWith("Ascendancy"))return"ascendancy";return"frame"};RenderActive=()=>{if(!this.Initialized)return;this.ClearLayer(g.ConnectionsPathing),this.ClearLayer(g.ConnectionsActive),this.DrawConnectionsForNodes(g.ConnectionsActive,this.skillTreeData.getNodes(_.Active)),this.ClearLayer(g.SkillIconsPathing),this.ClearLayer(g.SkillIconsPathingFrames),this.ClearLayer(g.SkillIconsActive),this.ClearLayer(g.SkillIconsActiveFrames),this.ClearLayer(g.SkillIconsActiveEffects),this.DrawNodes(g.SkillIconsActive,this.skillTreeData.getNodes(_.Active),this.skillTreeData.nodes,{outFrames:!0})};RenderCharacterStartsActive=()=>{if(!this.Initialized)return;this.ClearLayer(g.BackgroundActive),this.ClearLayer(g.CharacterStartsActive);const $=[],Z=[];for(let Q of this.skillTreeData.root.out){const K=this.skillTreeData.nodes[Q],q=K.classStartIndex;if(q===void 0||!K.is(_.Active)||K.nodeGroup===void 0)continue;const V=x0.getKeyByValue(this.skillTreeData.constants.classes,q);if(this.skillTreeData.hasSprite("startNode","AtlasPassiveSkillScreenStart"))Z.push({patch:K.patch,key:"startNode",icon:"AtlasPassiveSkillScreenStart",x:K.x,y:K.y});else if(V!==void 0){const X=this.skillTreeData.constants.classesToName[V];var J=`Background${V.replace("Class","")}`;if(this.skillTreeData.extraImages!==void 0&&this.skillTreeData.hasSprite("startNode",J)){const W=this.skillTreeData.extraImages[q];if(W)$.push({patch:K.patch,key:"startNode",icon:J,x:W.x*this.skillTreeData.scale,y:W.y*this.skillTreeData.scale,offsetX:0})}Z.push({patch:K.patch,key:"startNode",icon:`center${X.toLocaleLowerCase()}`,x:K.x,y:K.y})}}this.DrawSpriteSheetAssets(g.BackgroundActive,$),this.DrawSpriteSheetAssets(g.CharacterStartsActive,Z)};RenderHighlight=()=>{if(!this.Initialized)return;this.ClearLayer(g.Highlights);const $=[],Z=this.skillTreeData.getNodes(_.Highlighted);for(let q in Z)$.push({node:Z[q],color:p8.Searched});const J=this.skillTreeData.root.out,Q=this.skillTreeData.getNodes(_.Desired);for(let q in Q)if(J.indexOf(q)===-1&&!Q[q].isAscendancyStart)$.push({node:Q[q],color:p8.Desired});const K=this.skillTreeData.getNodes(_.UnDesired);for(let q in K)$.push({node:K[q],color:p8.UnDesired});this.DrawHighlights(g.Highlights,$)};StartRenderHover=($)=>{if(!this.Initialized)return;if(this.StopRenderHover($),this.DrawConnectionsForNodes(g.ConnectionsPathing,this.skillTreeData.getHoveredNodes()),this.DrawNodes(g.SkillIconsPathing,this.skillTreeData.getHoveredNodes(),this.skillTreeData.nodes,{}),this.DrawCompareMovedHighlights(),this.skillTreeDataCompare!==void 0&&$.is(_.Compared))this.skillTreeDataCompare.addState($,_.Hovered);this.RenderTooltip($)};StopRenderHover=($)=>{if(!this.Initialized)return;this.ClearLayer(g.ConnectionsPathing),this.ClearLayer(g.SkillIconsPathing),this.ClearLayer(g.SkillIconsPathingFrames),this.ClearLayer(g.AtlasMasteryHighlight),this.ClearLayer(g.NodeMoveCompare),this.ClearLayer(g.Tooltip),this.ClearLayer(g.TooltipCompare),this.DestroyTooltips()};DrawCompareMovedHighlights=()=>{if(this.skillTreeDataCompare===void 0)return;this.skillTreeDataCompare.clearState(_.Hovered);const $=this.skillTreeData.getNodes(_.Hovered),Z=[];for(let J in $){const Q=$[J];let K=this.skillTreeDataCompare.nodes[Q.GetId()];if(K===void 0)for(let q in this.skillTreeDataCompare.nodes){const V=this.skillTreeDataCompare.nodes[q];if(Math.abs(V.x-Q.x)<5&&Math.abs(V.y-Q.y)<5)K=V}if(K){if(K.is(_.Compared))this.skillTreeDataCompare.addState(K,_.Hovered);if(K.nodeGroup!==void 0&&K.is(_.Moved))Z.push({node:K,color:p8.Moved})}}this.DrawHighlights(g.NodeMoveCompare,Z)}}var g;(function(O){O[O["Background"]=0]="Background";O[O["BackgroundActive"]=1]="BackgroundActive";O[O["GroupBackground"]=2]="GroupBackground";O[O["Connections"]=3]="Connections";O[O["SkillIconsActiveEffects"]=4]="SkillIconsActiveEffects";O[O["ConnectionsActive"]=5]="ConnectionsActive";O[O["ConnectionsPathing"]=6]="ConnectionsPathing";O[O["SkillIcons"]=7]="SkillIcons";O[O["SkillIconsActive"]=8]="SkillIconsActive";O[O["SkillIconsPathing"]=9]="SkillIconsPathing";O[O["SkillIconsFrames"]=10]="SkillIconsFrames";O[O["SkillIconsActiveFrames"]=11]="SkillIconsActiveFrames";O[O["SkillIconsPathingFrames"]=12]="SkillIconsPathingFrames";O[O["CharacterStarts"]=13]="CharacterStarts";O[O["CharacterStartsActive"]=14]="CharacterStartsActive";O[O["JewelSocketActive"]=15]="JewelSocketActive";O[O["JewelSocketHighlights"]=16]="JewelSocketHighlights";O[O["SkillIconsCompare"]=17]="SkillIconsCompare";O[O["Highlights"]=18]="Highlights";O[O["NodeMoveCompare"]=19]="NodeMoveCompare";O[O["AtlasMasteryHighlight"]=20]="AtlasMasteryHighlight";O[O["Tooltip"]=21]="Tooltip";O[O["TooltipCompare"]=22]="TooltipCompare"})(g||(g={}));var p8;(function(X){X[X["Added"]=65280]="Added";X[X["Changed"]=16756736]="Changed";X[X["Removed"]=16711680]="Removed";X[X["Moved"]=16716947]="Moved";X[X["Searched"]=11817727]="Searched";X[X["Desired"]=1031494]="Desired";X[X["UnDesired"]=8388640]="UnDesired"})(p8||(p8={}));class Y4 extends G4{NodeTooltips;NodeSpritesheets;_dirty=!0;pixi;viewport;cull;DO_NOT_CULL=[g.Tooltip,g.TooltipCompare];LayerContainers={[g.Background]:new r,[g.BackgroundActive]:new r,[g.GroupBackground]:new r,[g.Connections]:new r,[g.SkillIconsActiveEffects]:new r,[g.ConnectionsActive]:new r,[g.ConnectionsPathing]:new r,[g.SkillIcons]:new r,[g.SkillIconsActive]:new r,[g.SkillIconsPathing]:new r,[g.SkillIconsFrames]:new r,[g.SkillIconsActiveFrames]:new r,[g.SkillIconsPathingFrames]:new r,[g.CharacterStarts]:new r,[g.CharacterStartsActive]:new r,[g.JewelSocketActive]:new r,[g.JewelSocketHighlights]:new r,[g.SkillIconsCompare]:new r,[g.Highlights]:new r,[g.NodeMoveCompare]:new r,[g.AtlasMasteryHighlight]:new r,[g.Tooltip]:new r,[g.TooltipCompare]:new r};constructor($,Z,J){super($,Z,J);this.NodeTooltips={},this.NodeSpritesheets={};const Q=Z.tree.slice(0,5)==="Atlas"?L$.v3_22_0_atlas:L$.v3_22_0;this.pixi=new HZ({width:window.innerWidth,height:window.innerHeight,resolution:devicePixelRatio,sharedTicker:!0,backgroundColor:Z.patch.compare(Q)>=0?461584:1709073}),N0.shared.stop(),N0.system.stop(),$.appendChild(this.pixi.view),r.defaultSortableChildren=!1,n.defaultOptions.scaleMode=O$.LINEAR,R.ROUND_PIXELS=!1,R.RESOLUTION=devicePixelRatio,T.destroyTextureCache(),j8.reset();const K=this.skillTreeData.imageZoomLevels.length>2?this.skillTreeData.imageZoomLevels[1]-this.skillTreeData.imageZoomLevels[0]:0.1,q={minWidth:this.skillTreeData.width*(K/2),minHeight:this.skillTreeData.height*(K/2),maxWidth:this.skillTreeData.width*(K*15),maxHeight:this.skillTreeData.height*(K*15)};if(this.viewport=new j1({screenWidth:this.pixi.renderer.width,screenHeight:this.pixi.renderer.height,worldWidth:this.skillTreeData.width*(this.skillTreeData.scale*1.25),worldHeight:this.skillTreeData.height*(this.skillTreeData.scale*1.25),events:this.pixi.renderer.events,noTicker:!0,stopPropagation:!0,disableOnContextMenu:!0}),this.viewport.name="viewport",this.viewport.drag().wheel({percent:K}).pinch({percent:K*10}),this.viewport.clampZoom(q),Z.tree.slice(0,5)==="Atlas")this.viewport.moveCenter(this.viewport.center.x*(K/2),this.viewport.center.y*(K/2)-2000);this.viewport.fitWorld(!0),this.viewport.zoomPercent(1.726),this.viewport.on("pointerdown",(V)=>x.viewport.fire("down",this.viewport.toWorld(V.global))),this.viewport.on("pointermove",(V)=>x.viewport.fire("move",this.viewport.toWorld(V.global))),this.viewport.on("pointerup",(V)=>x.viewport.fire("up",this.viewport.toWorld(V.global))),this.viewport.on("rightup",(V)=>x.viewport.fire("rightup",this.viewport.toWorld(V.global))),this.viewport.on("pointercancel",()=>x.viewport.fire("cancel")),this.pixi.stage.addChild(this.viewport),window.onresize=()=>{this.pixi.renderer.resize(window.innerWidth,window.innerHeight),this.viewport.resize(this.pixi.renderer.width,this.pixi.renderer.height,this.skillTreeData.width*(this.skillTreeData.scale*1.25),this.skillTreeData.height*(this.skillTreeData.scale*1.25)),this.viewport.clampZoom(q)},this.cull=new H4,super.Tick()}IsDirty(){return this._dirty||this.viewport.dirty}PreUpdate($){this.viewport.update($)}Update($){this.cull.cull(this.pixi.renderer.screen),this.pixi.render(),this._dirty=this.viewport.dirty=!1}PostUpdate($){}SetupLayers(){this.viewport.removeChildren();for(let $ in this.LayerContainers){const Z=Number($),J=this.LayerContainers[Z];if(this.DO_NOT_CULL.indexOf(Z)===-1)this.cull.add(J);this.viewport.addChild(J)}}SetLayer($,Z){this._dirty=!0,Z.eventMode="none",this.LayerContainers[$]=Z;const J=this.viewport.getChildAt($);if(this.DO_NOT_CULL.indexOf($)===-1)this.cull.remove(J);if(this.DO_NOT_CULL.indexOf($)===-1)this.cull.add(Z);if(Z===J)return;this.viewport.addChild(Z),this.viewport.swapChildren(J,Z),this.viewport.removeChild(J)}GetLayer($){return this.viewport.getChildAt($)}ClearLayer($){this.SetLayer($,new r)}async Initialize(){if(this.Initialized)return!0;return await this.LoadAssets([this.skillTreeData,this.skillTreeDataCompare]),this.InitializeSpriteSheets()}LoadAssets=($)=>{const Z=$.filter(x0.NotUndefined);if(Z.length<=0)throw new Error("SkillTreeData has not been defined. Could not load assets.");const J=new Array;for(let V of Z)for(let X in V.sprites){const W=V.sprites[X],U=W[V.scale.toString()]||W["1"];if(U===void 0)continue;const z=U.filename;if(z==="LOAD_COORDS"){for(let H in U.coords)if(J.indexOf(H)<0)J.push(H),j8.add({alias:H,src:`${x0.SKILL_TREES_URI}/${V.patch}/assets/${H}.png`})}else if(J.indexOf(z)<0)J.push(z),j8.add({alias:z,src:`${x0.SKILL_TREES_URI}/${V.patch}/assets/${z}`})}const K=Z[0].width/2;let q="";return j8.load(J,(V)=>{const X=`${V*100}%`;if(X!==q){this.viewport.removeChildren(),q=X;const W=new J8;W.moveTo(0,0),W.beginFill(16777215,0.75),W.lineStyle(2,13350300),W.drawRect(0,0,V*K,50),W.endFill(),this.viewport.addChild(W);const U=new n$(q,{fontSize:250,fill:16777215});U.position.set(0,-50),this.viewport.addChild(U),this.Tick()}}).then((V)=>!0)};async InitializeSpriteSheets(){if(this.Initialized)return!0;const $=new Promise((Z)=>{this.LoadSpriteSheetAssets([this.skillTreeData,this.skillTreeDataCompare]).then(()=>Z(!0))});return $.then(()=>this.Initialized=!0),$}LoadSpriteSheetAssets=($)=>{for(let J of $){if(J===void 0)continue;const Q=J.sprites;for(let K in Q){const q=this.GetSpritesheetKey(J.patch,K);if(this.NodeSpritesheets[q]===void 0)this.NodeSpritesheets[q]=[];const V=Q[K][J.scale.toString()]||Q[K]["1"];if(V===void 0)continue;const X=V.filename;if(X==="LOAD_COORDS")for(let W in V.coords){const U=f.from(W),z=this.GetCoordSpritesheetData(V,q,W,U);this.NodeSpritesheets[q]?.push(new f6(U.baseTexture,z))}else{const W=f.from(X),U=this.GetSpritesheetData(V,q);this.NodeSpritesheets[q]?.push(new f6(W.baseTexture,U))}}}const Z=new Array;for(let J in this.NodeSpritesheets){const Q=this.NodeSpritesheets[J];if(Q!==void 0)for(let K in Q){const q=new Promise((V)=>this.NodeSpritesheets[J][K].parse().then((X)=>V(!0)));Z.push(q)}}return Promise.all(Z)};GetSpritesheetData=($,Z)=>{let J={frames:{},animations:void 0,meta:{scale:"1"}};for(let Q in $.coords){const K=$.coords[Q],q=this.GetSpritesheetFrameKey(Z,Q);J.frames[q]={frame:K,rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0},sourceSize:{w:K.w,h:K.h}}}return J};GetCoordSpritesheetData=($,Z,J,Q)=>{let K={frames:{},animations:void 0,meta:{scale:"1"}};const q=$.coords[J],V=this.GetSpritesheetFrameKey(Z,J);if(q.w===-1&&q.h===-1)q.w=Q.width,q.h=Q.height;return K.frames[V]={frame:q,rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0},sourceSize:{w:q.w,h:q.h}},K};GetSpritesheetKey=($,Z)=>{return`${$.version}/${Z}`};GetSpritesheetFrameKey=($,Z)=>{return`${$}/${Z.startsWith("PassiveSkillScreen")?Z.replace("PassiveSkillScreen",""):Z}`};DrawSpriteSheetAsset=($,Z)=>{return this.DrawSpriteSheetAssets($,[Z])[0]};DrawSpriteSheetAssets=($,Z)=>{const J=[],Q=this.GetLayer($);for(var K of Z){const q=this.GetSpritesheetTexture(K.patch,K.key,K.icon);if(q===null||!q.valid)continue;const V=S0.from(q);V.name=`${K.patch}/${K.key}/${K.icon}`,V.position.set(K.x,K.y),V.eventMode="none";const X=K.offsetX===void 0?0.5:K.offsetX;if(V.anchor.set(X,K.offsetY),K.scale!==void 0)V.scale.set(K.scale);if(Q.addChild(V),K.half){V.anchor.set(X,1);const W=S0.from(q);W.name=`${V.name}-half`,W.rotation=Math.PI,W.position.set(K.x,K.y),W.anchor.set(X,1),W.scale=V.scale,Q.addChild(W)}if(K.mask=="circle"){const W=new J8;W.beginFill(65280),W.drawCircle(V.x,V.y,V.height/2),W.endFill(),V.mask=W,Q.addChild(W)}J.push({width:V.width,height:V.height*(K.half?2:1)})}return this.SetLayer($,Q),J};DrawText=($,Z,J,Q,K)=>{const q=this.GetLayer($),V=new n$(Z,{fill:J,fontSize:48,fontFamily:"serif",fontStyle:"italic",stroke:0,strokeThickness:4});V.name=Z,V.position.set(Q,K),V.scale.set(this.skillTreeData.scale),q.addChild(V),this.SetLayer($,q)};DrawBackgroundAsset=($,Z)=>{const J=this.GetLayer($),Q=this.GetSpritesheetTexture(Z.patch,Z.key,Z.icon);if(Q===null||!Q.valid)return;if(Z.icon==="AtlasPassiveBackground"){let K=S0.from(Q);K.name=Z.icon,K.scale.set(2.8173),K.anchor.set(0.506,0.931),J.addChild(K)}else{Q.baseTexture.wrapMode=z$.REPEAT;const K=10,q=10,V=this.skillTreeData.width*(this.skillTreeData.scale*1.25),X=this.skillTreeData.height*(this.skillTreeData.scale*1.25),W=V/K,U=X/q;for(let z=0;z<q;z++)for(let H=0;H<K;H++){const G=W*H-V/2,Y=U*z-X/2;let w=S0.from(Q);w.name=`${Z.icon}-r:${z}-c:${H}`,w=p5.from(Q.baseTexture,{width:W,height:U}),w.position.set(G,Y),J.addChild(w)}}this.SetLayer($,J)};DrawConnections=($,Z)=>{const J=this.GetLayer($),Q=new r;for(let K of Z){const q=this.DrawConnection(K);if(q)Q.addChild(q)}J.addChild(Q),this.SetLayer($,J)};DrawConnection=($)=>{switch($.style){case E8.Arc:return this.DrawArcConnection($);case E8.Line:return this.DrawLineConnection($)}};DrawArcConnection=($)=>{const Z=this.GetSpritesheetTexture($.patch,$.key,$.icon);if(Z===null||!Z.valid)return null;const{node:J,other:Q}=$;if(J.nodeGroup===void 0)return null;let K=J.arc<Q.arc?J.arc:Q.arc,q=J.arc<Q.arc?Q.arc:J.arc;const V=q-K;if(V>=Math.PI){const G=2*Math.PI-V;K=q,q=K+G}K-=Math.PI/2,q-=Math.PI/2;let X=q-K;const W=Math.ceil(X/(Math.PI/2)),U=Math.PI/2+K,z=new r,H=new J8;H.lineStyle(50*J.scale,16761035),H.arc(J.nodeGroup.x*J.scale,J.nodeGroup.y*J.scale,J.orbitRadii[J.orbit]*J.scale,K,q,!1),z.addChild(H);for(let G=0;G<W;++G){const Y=S0.from(Z);if(Y.rotation=X+U,Y.position.set(J.nodeGroup.x*J.scale,J.nodeGroup.y*J.scale),Y.anchor.set(1),$.removing)Y.tint=16711680;if(Y.mask=H,z.addChild(Y),X<Math.PI/2)continue;X-=Math.PI/2}return z};DrawLineConnection=($)=>{const Z=$.node.skill>$.other.skill?$.node:$.other,J=$.node.skill>$.other.skill?$.other:$.node,Q=this.GetSpritesheetTexture($.patch,$.key,$.icon);if(Q===null||!Q.valid)return null;const K=new r,q=Math.atan2(J.y-Z.y,J.x-Z.x);let V=Math.hypot(Z.x-J.x,Z.y-J.y);var X={x:Z.x,y:Z.y},W=Math.ceil(V/Q.frame.width);for(let U=0;U<W;++U){const z=V>=Q.frame.width?Q:new f(Q.baseTexture,new m(Q.frame.x,Q.frame.y,V,Q.frame.height)),H=S0.from(z);if(H.anchor.set(0,0.5),H.position.set(X.x,X.y),H.rotation=q,$.removing)H.tint=16711680;K.addChild(H),X={x:X.x+H.width*Math.cos(q),y:X.y+H.width*Math.sin(q)},V-=Q.frame.width}return K};DrawHighlights=($,Z)=>{const J=this.GetLayer($);for(var Q of Z){const K=Q.node.targetSize;if(K.width===0||K.height===0)continue;const q=new J8;if(q.name=`highlight-${Q.node.id}`,q.beginFill(0,0),q.lineStyle(5,Q.color),Q.node.is(_.Desired))q.drawCircle(0,0,Math.max(K.width,K.height)*0.85);else if(Q.node.is(_.UnDesired))q.lineStyle(7,Q.color),q.moveTo(-K.width*0.7,-K.height*0.7),q.lineTo(K.width*0.7,K.height*0.7),q.moveTo(-K.width*0.7,K.height*0.7),q.lineTo(K.width*0.7,-K.height*0.7);else q.drawRoundedRect(-K.width*0.72,-K.height*0.72,K.width/0.68,K.width/0.68,1);q.endFill(),q.position.set(Q.node.x,Q.node.y),J.addChild(q)}this.SetLayer($,J)};CreateScreenshot=async($)=>{return await this.pixi.renderer.extract.base64(this.viewport,$,1)};GetSpritesheetTexture=($,Z,J)=>{const Q=this.GetSpritesheetKey($,Z),K=this.GetSpritesheetFrameKey(Q,J),q=this.NodeSpritesheets[Q];if(q!==void 0)for(let V of q){const X=V.textures[K];if(X!==void 0)return X}return console.warn(`Texture not found for ${K}`),null};RenderTooltip=($)=>{const Z=this.GetLayer(g.Tooltip),J=this.GetLayer(g.TooltipCompare);let Q=void 0,K=void 0;const q=10,V=this.CreateTooltip($);if(V.position.set(q/2,q/2),this.skillTreeData.patch===$.patch)Q=new J8,Q.beginFill(0,0.75),Q.lineStyle(2,13350300),Q.drawRect(0,0,V.width+q,V.height+q),Q.endFill(),Q.addChild(V);let X=void 0;if(this.skillTreeDataCompare!==void 0){const W=this.skillTreeDataCompare.getNodes(_.Hovered);for(let U in W){const z=W[U];if(z.nodeGroup===void 0)continue;X=z;const H=10,G=this.CreateTooltip(z);G.position.set(H/2,H/2),K=new J8,K.beginFill(0,0.75),K.lineStyle(2,16756736),K.drawRect(0,0,G.width+H,G.height+H),K.endFill(),K.addChild(G)}}if(Q===void 0&&K!==void 0&&X!==void 0)Q=K,$=X,K=void 0,X=void 0;if(Q!==void 0)Z.addChild(Q);if(K!==void 0)J.addChild(K);if(Q!==void 0&&$!==void 0){const W=Q.getBounds(),U=$.targetSize,z=Q.width/W.width/devicePixelRatio,H=Q.height/W.height/devicePixelRatio;if(Q.worldTransform.tx+W.width>screen.width)Q.x=$.x-Q.width*z-U.width;else Q.x=$.x+U.width;if(Q.worldTransform.ty+W.height>screen.height)Q.y=$.y-Q.height*H+U.height/2;else Q.y=$.y-U.height/2;if(Q.scale.set(z,H),K!==void 0&&X!==void 0){const G=K.getBounds();K.y=Q.y,K.x=Q.x+Q.width,K.scale.set(K.width/G.width/devicePixelRatio,K.height/G.height/devicePixelRatio)}}this.SetLayer(g.Tooltip,Z),this.SetLayer(g.TooltipCompare,J)};CreateTooltip=($)=>{let Z=this.NodeTooltips[`${$.GetId()}_${$.patch}`];const J=this.skillTreeData.getNodes(_.Desired);if(Z===void 0){let Q=$.name.length>0?new n$(`${$.name} [${$.id}]`,{fill:16777215,fontSize:18}):null,K=$.stats.filter(x0.NotNullOrWhiteSpace).length>0?new n$(`\n${$.stats.filter(x0.NotNullOrWhiteSpace).join("\n")}`,{fill:16777215,fontSize:14}):null,q=$.flavourText.filter(x0.NotNullOrWhiteSpace).length>0?new n$(`\n${$.flavourText.filter(x0.NotNullOrWhiteSpace).join("\n")}`,{fill:11493413,fontSize:14}):null,V=$.reminderText.filter(x0.NotNullOrWhiteSpace).length>0?new n$(`\n${$.reminderText.filter(x0.NotNullOrWhiteSpace).join("\n")}`,{fill:8421504,fontSize:14}):null,X=J[$.id]!==void 0?new n$("Desired",{fill:16777215,fontSize:18}):null;Z=new r,Z.position.set(0,0);let W=0;if(Q!==null)Z.addChild(Q),Q.position.set(0,W),W+=Q.height;if(K!==null)Z.addChild(K),K.position.set(0,W),W+=K.height;if(q!==null)Z.addChild(q),q.position.set(0,W),W+=q.height;if(V!==null)V.style.wordWrap=!0,V.style.wordWrapWidth=Z.width,Z.addChild(V),V.position.set(0,W),W+=V.height;if(X!==null)Z.addChild(X),X.position.set(0,W),W+=X.height;Z.eventMode="none",Z.containerUpdateTransform=()=>{},this.NodeTooltips[`${$.GetId()}_${$.patch}`]=Z}return Z};DestroyTooltips=()=>{for(let $ in this.NodeTooltips){const Z=this.NodeTooltips[$];if(Z===void 0)continue;Z.destroy({children:!0,texture:!0,baseTexture:!0}),delete this.NodeTooltips[$]}}}class w4{canDecode($){return $.length>=6&&this.version($)==3}decode($){const Z=this.version($),J=this.class($),Q=this.fullscreen($),K=new Array;for(let q=6;q<$.length;q+=2){if(q+1>$.length)break;K.push($[q]<<8|$[q+1])}return{version:Z,class:J,ascendancy:0,wildwoodAscendancy:0,nodeCount:K.length,nodes:K,extendedNodeCount:0,extendedNodes:[],masteryEffectCount:0,masteryEffects:[]}}version($){return $[0]<<24|$[1]<<16|$[2]<<8|$[3]}class($){return $[4]}fullscreen($){return $[5]}}class j4{canDecode($){return $.length>=7&&this.version($)==4}decode($){const Z=this.version($),J=this.class($),Q=this.ascendancy($),K=this.fullscreen($),q=new Array;for(let V=7;V<$.length;V+=2){if(V+1>$.length)break;q.push($[V]<<8|$[V+1])}return{version:Z,class:J,ascendancy:Q,wildwoodAscendancy:0,nodeCount:q.length,nodes:q,extendedNodeCount:0,extendedNodes:[],masteryEffectCount:0,masteryEffects:[]}}version($){return $[0]<<24|$[1]<<16|$[2]<<8|$[3]}class($){return $[4]}ascendancy($){return $[5]}fullscreen($){return $[6]}}class B4{canDecode($){return $.length>=8&&this.version($)==5}decode($){const Z=this.version($),J=this.class($),Q=this.ascendancy($);let K=6;const q=$[K++],V=new Array;for(let U=0;U<q;U++){if(K+1>$.length)break;V.push($[K++]<<8|$[K++])}const X=$[K++],W=new Array;for(let U=0;U<X;U++){if(K+1>$.length)break;W.push($[K++]<<8|$[K++])}return{version:Z,class:J,ascendancy:Q,wildwoodAscendancy:0,nodeCount:V.length,nodes:V,extendedNodeCount:W.length,extendedNodes:W,masteryEffectCount:0,masteryEffects:[]}}version($){return $[0]<<24|$[1]<<16|$[2]<<8|$[3]}class($){return $[4]}ascendancy($){return $[5]}}class F4{canDecode($){return $.length>=9&&this.version($)==6}decode($,Z){const J=this.version($),Q=this.class($),K=this.ascendancyByte($),q=K&3,V=K>>2;let X=6;const W=$[X++],U=Z?0:$[X++],z=Z?0:$[X++],H=new Array,G=new Array,Y=new Array,w=new Array;if(Z){for(let L=0;L<W;L++){if(X+1>$.length)break;H.push($[X++]<<8|$[X++])}const F=$[X++];for(let L=0;L<F;L++){if(X+1>$.length)break;G.push($[X++]<<8|$[X++])}}else{for(let F=0;F<U;F++){if(X+1>$.length)break;Y.push($[X++]<<8|$[X++])}for(let F=0;F<z;F++){if(X+1>$.length)break;w.push($[X++]<<8|$[X++])}H.push($[X++]<<8|$[X++])}const j=$[X++],B=new Array;for(let F=0;F<j;F++){if(X+3>$.length)break;var C=$[X++]<<8|$[X++],N=$[X++]<<8|$[X++];B.push([N,C])}return{version:J,class:Q,ascendancy:q,wildwoodAscendancy:V,nodeCount:H.length,nodes:H,extendedNodeCount:G.length,extendedNodes:G,masteryEffectCount:B.length,masteryEffects:B,desiredNodes:Y,undesiredNodes:w}}version($){return $[0]<<24|$[1]<<16|$[2]<<8|$[3]}class($){return $[4]}ascendancyByte($){return $[5]}}class bZ{static _decoders=[new F4,new B4,new j4,new w4];encodeURL($,Z){const J=[];J.push(6>>24&255),J.push(6>>16&255),J.push(6>>8&255),J.push(6>>0&255),J.push($.getStartClass());const K=$.getAscendancyClass(),q=$.getWildwoodAscendancyClass();J.push(q<<2|K&3);const V=$.getSkilledNodes(),X=new Array,W=new Array,U=$.getDesiredNodes(),z=$.getUndesiredNodes();if(!Z){for(let Y in U)X.push(U[Y]);for(let Y in z)X.push(z[Y]);const G=Object.values($.getClassStartNodes()).filter((Y)=>Object.keys(V).includes(Y.id||String(Y.skill)))[0];X.push(G)}else{for(let G in V){const Y=V[G];if(Y.classStartIndex!==void 0||Y.isAscendancyStart)continue;if(Y.expansionJewel!==void 0)W.push(Y);else if(!Y.isMastery)X.push(Y)}X.sort((G,Y)=>{return+(G.id||G.skill)-+(Y.id||G.skill)})}if(J.push(X.length),!Z)J.push(Object.keys(U).length),J.push(Object.keys(z).length);for(let G of X)J.push(+(G.id||G.skill)>>8&255),J.push(+(G.id||G.skill)&255);J.push(W.length);for(let G of W)J.push(+(G.id||G.skill)>>8&255),J.push(+(G.id||G.skill)&255);const H=new Array;for(let G in $.masteryEffects){const Y=$.masteryEffects[G];H.push([+G,Y])}J.push(H.length);for(let[G,Y]of H)J.push(Y>>8&255),J.push(Y&255),J.push(G>>8&255),J.push(G&255);return this.Uint8ArryToBase64(new Uint8Array(J))}decodeURL($,Z,J){const Q=this.Base64ToUint8Array($),K=this.decode(Q,J),q={Version:K.version,Class:K.class,Ascendancy:K.ascendancy,WildwoodAscendancy:K.wildwoodAscendancy,Nodes:[],ExtendedNodes:[],MasteryEffects:[],Desired:new Array,Undesired:new Array};for(let V of K.nodes){const X=Z.nodes[V.toString()];if(X!==void 0)q.Nodes.push(X)}for(let V of K.desiredNodes){const X=Z.nodes[V.toString()];if(X!==void 0)q.Desired.push(X)}for(let V of K.undesiredNodes){const X=Z.nodes[V.toString()];if(X!==void 0)q.Undesired.push(X)}for(let V of K.extendedNodes){const X=Z.nodes[V.toString()];if(X!==void 0)q.ExtendedNodes.push(X)}for(let[V,X]of K.masteryEffects){const W=Z.nodes[V.toString()];if(W!==void 0)q.MasteryEffects.push([W,X])}return q}decode($,Z){for(let J of bZ._decoders)if(J.canDecode($))return J.decode($,Z);return{version:6,class:3,ascendancy:0,wildwoodAscendancy:0,nodeCount:0,nodes:[],extendedNodeCount:0,extendedNodes:[],masteryEffectCount:0,masteryEffects:[],desiredNodes:[],undesiredNodes:[]}}Uint8ArryToBase64=($)=>{return btoa(Array.prototype.map.call($,(Z)=>String.fromCharCode(Z)).join("")).replace(/\+/gi,"-").replace(/\//gi,"_")};Base64ToUint8Array=($)=>{$=atob($.replace(/-/gi,"+").replace(/_/gi,"/"));const Z=new Uint8Array($.length);for(let J=0;J<$.length;J++)Z[J]=$.charCodeAt(J);return Z}}var a4=l6(Qz(),1);class r4{Execute($,Z,J,Q){if(Q=!1,Z.length===0)return new Array;const K=[];let q=999;const V=new a4.FibonacciHeap((Y,w)=>{const j=W[Y.id],B=W[w.id];if(j===void 0||B===void 0)return 0;if(j<B)return-1;if(j>B)return 1;return 0}),X=new a4.FibonacciHeap((Y,w)=>{if(Y.length===void 0||w.length===void 0)return 0;if(Y.length<w.length)return-1;if(Y.length>w.length)return 1;return 0}),W={},U={},z={};for(let Y of Z)V.push(Y),W[Y.id]=0;while(V.size>0){const Y=V.pop();if(Y===void 0){if(Q)console.log("frontierNode undefined");break}if(K.includes(Y.GetId()))continue;if(Q)console.log("Current frontier ID",Y.GetId());U[Y.GetId()]=Y;const w=W[Y.GetId()];let j=0,B=[...new Set([...Y.out,...Y.in])];for(let C of B){if(++j>20)break;if(Q)console.log("Current out ID",C);const N=$.nodes[C];if(Y.ascendancyName===""&&N.ascendancyName!==""&&!N.is(_.Active)||Y.ascendancyName!==""&&N.ascendancyName===""&&!Y.is(_.Active))continue;let F=w+(N.classStartIndex||N.is(_.Active||Z.includes(N))?0:J[C]!==void 0?J[C]:1);if(Q)console.log("Shortest path "+q+" and newDist "+F);if(U[C]||q<F||W[C]&&W[C]<F)continue;if((N.classStartIndex!==void 0||N.isAscendancyStart)&&!N.is(_.Active))continue;if(N.is(_.UnDesired)||N.isMastery)continue;if(Q&&!N.isMastery)console.log("Adding out node to frontier");if(W[C]=F,Q)console.log("Distance to out node",W[C]);if(z[C]=Y,!N.isMastery)V.push(N);if(Q)console.log("Is out active?",N.is(_.Active));if(!Z.includes(N)&&N.is(_.Active)){const L=N;if(Q)console.log("FOUND NODE");if(L===Y||W[L.GetId()]===void 0);let k=L;const o=Z.map((c)=>c.GetId()),O=new Array;let h=!1;while(k!==void 0){if(!o.includes(k.GetId())){if(Q)console.log("Added "+k.GetId()+" to path");O.push(k)}else if(!h){if(Q)console.log("Added "+k.GetId()+" to path");O.push(k),h=!0}if(!K.includes(k.GetId()))K.push(k.GetId());k=z[k.GetId()]}if(O.length>q*2){const c=[];let S=X.pop();while(S!==void 0){if(Q)console.log(S.length,q);if(S.length-2==q)c.push(S);else break;S=X.pop()}if(Q)console.log("Returning "+c.length+" paths");return c}q=O.length-2,X.push(O.reverse())}}}const H=[];let G=X.pop();while(G!==void 0){if(Q)console.log(G.length,q);if(G.length-2<=q)H.push(G);else break;G=X.pop()}if(Q)console.log("Returning "+H.length+" paths");return H}}class t4{skillTreeData;fixedGroups;constructor($,Z){this.skillTreeData=$,this.fixedGroups=Z}Execute($){const J=Object.values(this.skillTreeData.getNodes(_.Active)).filter((z)=>!z.is(_.Desired)&&z.classStartIndex===void 0&&!z.isAscendancyStart);for(let z of J)this.skillTreeData.removeState(z,_.Active);const Q=Object.values(this.skillTreeData.getNodes(_.Desired));let K=[];for(let z of Q)this.skillTreeData.addState(z,_.Active),K.push([z]);let q=!1;while(!q){let z=void 0,H=void 0;for(let G of K){for(let Y of G){if(Y.isMastery)continue;const w=[...Y.in,...Y.out];for(let j of w){const B=this.skillTreeData.nodes[j];if(B.isMastery)continue;if(B.is(_.Active)&&!G.includes(B)){z=Y,H=B;break}}if(z&&H)break}if(z&&H)break}if(z&&H){const G=K.find((j)=>j.includes(z)),Y=K.find((j)=>j.includes(H)),w=this.mergeGroups(G,Y);K=K.filter((j)=>j.map((B)=>B.skill).sort().join(",")!==G.map((B)=>B.skill).sort().join(",")&&j.map((B)=>B.skill).sort().join(",")!=Y.map((B)=>B.skill).sort().join(",")),K.push(w)}else q=!0}const V=0.01,X=this.adjustDesiredGroupDistances(Q.filter((z)=>z.isNotable),V);for(let z of Object.values(this.skillTreeData.nodes).filter((H)=>H.isNotable)){X[z.skill]=X[z.skill]?X[z.skill]-0.5:0.5;for(let H of z.stats)if(H.includes("maximum Life"))X[z.skill]=X[z.skill]?X[z.skill]-2*V:1-2*V}const W=["1% increased quantity of items found in your maps","3% increased scarabs found in your maps","2% increased effect of modifiers on your maps","2% chance for one monster in each of your maps to drop an additional connected map"];for(let z in K){if(K[z].some((w)=>w.classStartIndex!==void 0))continue;const H=[...K[z]],G=[],Y=[];while(H.length>0){const w=H.shift();if(w===void 0)break;const j=[...new Set([...w.in,...w.out])].filter((B)=>![...G,...Y].map((C)=>C.GetId()).includes(B));for(let B of j){const C=this.skillTreeData.nodes[B];if(C.isRegular1||C.stats.some((N)=>W.includes(N.toLowerCase())))G.push(C);else H.push(C),Y.push(C)}}if(G.length===1){const w=G[0];this.skillTreeData.addState(w,_.Active);const j=[...new Set([...w.in,...w.out])];let B=!1;for(let C in K){if(K[C].map((N)=>N.GetId()).includes(w.GetId()))continue;if(K[C].some((N)=>j.includes(N.GetId()))){K[C].push(w),B=!0;break}}if(!B)K.push([w])}}const U=Object.values(this.skillTreeData.nodes).filter((z)=>this.skillTreeData.tree==="Default"?z.isRegular1:z.isRegular2&&z.stats.some((H)=>W.includes(H.toLowerCase())));for(let z of U)X[z.id]=X[z.id]!==void 0?X[z.id]*V:1-V;if(this.skillTreeData.tree.slice(0,5)==="Atlas"){const z=["Alva","Anarchy","Bestiary","Beyond","Blight","Breach","CleansingFire","Conqueror","Delirium","Delve","Domination","ElderShaper","Essence","Expedition","Harbinger","Harvest","Heist","Jun","Kirac","Labyrinth","Legion","Map","Metamorph","Necropolis","Ritual","Scarab","Sextant","Strongbox","Synthesis","Tangle","Torment","Vaal"];for(let H of z)if(Q.filter((G)=>G.GetIcon().toLowerCase().indexOf(H.toLowerCase())>-1&&G.GetIcon().toLowerCase().indexOf("wheelofdisabling")===-1).filter((G)=>!U.includes(G)).length>0){const G=Object.values(this.skillTreeData.nodes).filter((Y)=>Y.GetIcon().toLowerCase().indexOf(H.toLowerCase())>-1&&Y.GetIcon().toLowerCase().indexOf("wheelofdisabling")===-1).filter((Y)=>!U.includes(Y));for(let Y of G)X[Y.id]=X[Y.id]!==void 0?X[Y.id]-2*V:1-2*V}if(this.skillTreeData.nodes["65225"].is(_.Desired))for(let H of Object.values(this.skillTreeData.nodes).filter((G)=>G.isRegular2&&G.stats.some((Y)=>Y.toLowerCase()==="3% increased scarabs found in your maps")))X[H.id]=1.1}if(K.length>1){let z=0,H=!0;while(K.length>1){let B=function(S,M){let y=S.reduce((b,$0)=>b+j[$0.skill],0)/(S.length-2),A=M.reduce((b,$0)=>b+j[$0.skill],0)/(M.length-2);if(y===void 0||A===void 0)return 0;if(y<A)return 1;if(y>A)return-1;return 0},C=function(S,M){let y=S.length,A=S.filter((Q0)=>Q0.isWormhole).length,b=M.length,$0=M.filter((Q0)=>Q0.isWormhole).length;if(H){let Q0=S.some((Y0)=>Y0.classStartIndex!==void 0),l=M.some((Y0)=>Y0.classStartIndex!==void 0);if(Q0&&l)return 0;if(Q0&&!l)return 1;if(!Q0&&l)return-1}if(y===void 0||b===void 0)return 0;if(y<b)return-1;if(y>b)return 1;if(A<$0)return-1;if(A>$0)return 1;return 0};if(++z>200){console.log("Infinite loop detection triggered. Please report this as a bug.");break}const G=[],Y=K.length>2?K.filter((S)=>!S.some((M)=>M.classStartIndex!==void 0)):K,w=Y.some((S)=>S.every((M)=>!M.isMastery));for(let S of Y){if(w&&S.length===1&&(S[0].isMastery&&[...new Set([...S[0].in,...S[0].out])].map((y)=>this.skillTreeData.nodes[y]).some((y)=>y.is(_.Active)||y.is(_.Desired))))continue;const M=$.Execute(this.skillTreeData,S,X,!1);for(let y of M)if(y.length>0)G.push(y)}const j={};for(let S of G)for(let M of S)if(S.indexOf(M)!==0&&S.indexOf(M)!==S.length-1)j[M.skill]=j[M.skill]?j[M.skill]+1:1;else j[M.skill]=j[M.skill]?j[M.skill]:0;if(G.sort(B),G.sort(C),Y.filter((S)=>S.some((M)=>M.classStartIndex!==-1)).length===1)H=!1;if(G.length==0)break;let N=G.shift();if(N===void 0)return;const F=N.shift();if(F===void 0)return;if(!F.is(_.Active))this.skillTreeData.addState(F,_.Active);for(let S of N)if(!S.is(_.Active))this.skillTreeData.addState(S,_.Active);const L=N[N.length-1],k=K.find((S)=>S.includes(F)),o=K.find((S)=>S.includes(L));if(k===void 0||o===void 0){console.log(K),console.log(k,F),console.log(o,L);return}const O=this.mergeGroups(k,o);K=K.filter((S)=>S.map((M)=>M.skill).sort().join(",")!==k.map((M)=>M.skill).sort().join(",")&&S.map((M)=>M.skill).sort().join(",")!=o.map((M)=>M.skill).sort().join(","));const h=N.filter((S)=>![...O].includes(S)),c=[...O,...h];K.push(c)}}}mergeGroups=($,Z)=>{if($===void 0||Z===void 0)return console.log("Group undefined"),console.log($),console.log(Z),new Array;return[...$,...Z]};adjustDesiredGroupDistances=($,Z)=>{const J={};function Q(K,q,V,X){const W=V-K,U=X-q;return Math.sqrt(W*W+U*U)}for(let K of $){const q=K.group;if(q===void 0)continue;const X=this.skillTreeData.groups[q].nodes;let W=0,U=0,z=0,H="";for(let B of X){const C=this.skillTreeData.nodes[B];if(C.isMastery)H=C.name;U+=C.x,z+=C.y}const G=U/X.length,Y=z/X.length,w=!1;for(let B of X){const C=this.skillTreeData.nodes[B];if(C.name==="Map Drop Duplication"||C.name==="Adjacent Map Drop Chance")continue;if(w)console.log(C.name);const N=Q(G,Y,C.x,C.y);W=N>W?N:W}const j=this.skillTreeData.getNodesInRange(G,Y,W*1.05);for(let B of j){let C=!1;if(H!=""&&B.group&&B.group!==q)for(let N of this.skillTreeData.groups[B.group].nodes){const F=this.skillTreeData.nodes[N];if(F.isMastery&&F.name!==H)C=!0}if(C)continue;J[B.id]=1-Z}}return J}}class e4{skillTreeData;skillTreeDataCompare;skillTreeCodec;shortestPath;allocationAlgorithm;abyssGroup=0;exarchGroup=0;notableException;pause=!1;constructor($,Z){if(this.skillTreeData=$,this.skillTreeDataCompare=Z,this.skillTreeCodec=new bZ,this.skillTreeData.patch.compare(L$.v3_24_0_atlas)==0)this.abyssGroup=140,this.exarchGroup=28;else if(this.skillTreeData.patch.compare(L$.v3_24_0_standard)==0)this.abyssGroup=136,this.exarchGroup=25;else if(this.skillTreeData.patch.compare(L$.v3_23_0_atlas)==0)this.abyssGroup=127,this.exarchGroup=25;else if(this.skillTreeData.patch.compare(L$.v3_22_0_atlas)==0)this.abyssGroup=126,this.exarchGroup=25;this.shortestPath=new r4,this.allocationAlgorithm=new t4(this.skillTreeData,{abyssGroup:this.abyssGroup,exarchGroup:this.exarchGroup}),this.notableException=["3315","1444","44954","49699","23485"],x.node.on("click",this.click),x.node.on("in",this.mouseover),x.node.on("out",this.mouseout),x.node.on("rightclick",this.rightclick),x.controls.on("class-change",this.changeStartClass),x.controls.on("ascendancy-class-change",this.changeAscendancyClass),x.controls.on("wildwood-ascendancy-class-change",this.changeWildwoodAscendancyClass),x.controls.on("search-change",this.searchChange),x.controls.on("import-change",this.importChange),x.controls.on("pause-change",()=>{this.pause=!this.pause,this.allocateNodes(!1)}),x.skill_tree.on("recalculate",this.allocateNodes),x.skill_tree.on("encode-url",this.encodeURL)}decodeImport=($=void 0)=>{if($===void 0)return;const J=$.replace("https://www.pathofexile.com/","").replace("fullscreen-","").replace("passive-skill-tree/","").replace("atlas-skill-tree/",""),Q=/\d\.\d\d\.\d\//g,K=J.replace(Q,""),q=/\?accountName.*/g,V=K.replace(q,"");try{if(V===null)return;const X=this.skillTreeCodec.decodeURL(V,this.skillTreeData,!0);this.skillTreeData.version=X.Version,this.changeStartClass(X.Class,!1),this.changeAscendancyClass(X.Ascendancy-1,!1);const W=Object.values(this.skillTreeData.getNodes(_.Desired));for(let Y of W)this.skillTreeData.removeState(Y,_.Desired);let U=Object.values(this.skillTreeData.getClassStartNodes())[0];for(let Y in this.skillTreeData.classStartNodes){const w=this.skillTreeData.nodes[Y];if(w.classStartIndex===void 0)continue;if(w.classStartIndex!==X.Class)continue;U=w}if(U===void 0)return;this.skillTreeData.addState(U,_.Desired);const z=X.Nodes.map((Y)=>Y.skill),H=[];let G=[...new Set([...U.out,...U.in])].map((Y)=>Number(Y));G=G.filter((Y)=>z.includes(Y)&&!H.includes(Y));while(G.length>0){const Y=G.shift();if(Y===void 0)break;H.push(Y);const w=this.skillTreeData.nodes[String(Y)];G.push(...[...new Set([...w.out,...w.in])].map((j)=>Number(j)).filter((j)=>z.includes(j)&&!H.includes(j)))}for(let Y of X.Nodes){if(!H.includes(Y.skill))continue;if(Y.isNotable||Y.isKeystone||Y.isJewelSocket||Y.isAscendancyStart||Y.classStartIndex!==void 0)this.skillTreeData.addStateById(`${Y.skill}`,_.Desired)}for(let Y of X.ExtendedNodes){if(!H.includes(Y.skill))continue;if(Y.isNotable||Y.isKeystone||Y.isJewelSocket||Y.isAscendancyStart||Y.classStartIndex!==void 0)this.skillTreeData.addStateById(`${Y.skill}`,_.Desired)}for(let[Y,w]of X.MasteryEffects){if(!H.includes(Y.skill))continue;this.skillTreeData.addStateById(`${Y.skill}`,_.Desired)}for(let Y of X.Desired)this.skillTreeData.addStateById(`${Y.skill}`,_.Desired);for(let Y of X.Undesired)this.skillTreeData.addStateById(`${Y.skill}`,_.UnDesired);window.location.hash="#"+this.encodeURL(!1),this.allocateNodes(!1)}catch(X){console.log(X)}};lastHash="";decodeURL=($)=>{if(window.location.hash==="")this.changeStartClass(this.skillTreeData.getDefaultStartNode(),!1);if(this.lastHash===window.location.hash)return;this.lastHash=window.location.hash;try{const Z=window.location.hash.replace("#","");if(Z===null){window.location.hash="";return}const J=this.skillTreeCodec.decodeURL(Z,this.skillTreeData,$);this.skillTreeData.version=J.Version,this.changeStartClass(J.Class,!1),this.changeAscendancyClass(J.Ascendancy,!1),this.changeWildwoodAscendancyClass(J.WildwoodAscendancy,!1);for(let Q of J.Nodes)this.skillTreeData.addStateById(`${Q.skill}`,_.Active);for(let Q of J.ExtendedNodes)this.skillTreeData.addStateById(`${Q.skill}`,_.Active);for(let[Q,K]of J.MasteryEffects)this.skillTreeData.addStateById(`${Q.skill}`,_.Active),this.skillTreeData.masteryEffects[Q.skill]=K;for(let Q of J.Desired)this.skillTreeData.addStateById(`${Q.skill}`,_.Desired);for(let Q of J.Undesired)this.skillTreeData.addStateById(`${Q.skill}`,_.UnDesired);window.location.hash="#"+this.encodeURL(!1)}catch(Z){window.location.hash="",console.log(Z)}};encodeURL=($)=>{return x.skill_tree.fire("active-nodes-update"),x.skill_tree.fire("highlighted-nodes-update"),this.broadcastSkillCounts(),`${this.skillTreeCodec.encodeURL(this.skillTreeData,$)}`};broadcastSkillCounts=()=>{let $=this.skillTreeData.points.totalPoints;const Z=this.skillTreeData.points.ascendancyPoints;let J=0,Q=0,K=0;const q=this.skillTreeData.getNodes(_.Active);for(let V in q){const X=q[V];if(X.classStartIndex===void 0&&!X.isAscendancyStart&&!X.isMultipleChoice){if(X.ascendancyName==="")J++;else if(this.skillTreeData.isWildwoodAscendancyClass(X))K++;else Q++;$+=X.grantedPassivePoints}}x.skill_tree.fire("normal-node-count",J),x.skill_tree.fire("normal-node-count-maximum",$),x.skill_tree.fire("ascendancy-node-count",Q),x.skill_tree.fire("ascendancy-node-count-maximum",Z),x.skill_tree.fire("wildwood-ascendancy-node-count",K),x.skill_tree.fire("wildwood-ascendancy-node-count-maximum",Z)};changeStartClass=($,Z=!0)=>{for(let J in this.skillTreeData.classStartNodes){const Q=this.skillTreeData.nodes[J];if(Q.classStartIndex===void 0)continue;if(Q.classStartIndex!==$){this.skillTreeData.removeState(Q,_.Active),this.skillTreeData.removeState(Q,_.Desired);continue}this.skillTreeData.addState(Q,_.Active),this.skillTreeData.addState(Q,_.Desired),x.skill_tree.fire("class-change",Q)}if(this.changeAscendancyClass(0,!1,!0),this.changeWildwoodAscendancyClass(0,!1,!0),this.allocateNodes(!1),Z)window.location.hash="#"+this.encodeURL(!1)};changeAscendancyClass=($,Z=!0,J=!1)=>{if(J)x.skill_tree.fire("ascendancy-class-change");if(this.skillTreeData.classes.length===0)return;const Q=this.skillTreeData.classes[this.skillTreeData.getStartClass()].ascendancies;if(Q===void 0)return;this.changeAscendancyClassInternal(!1,$,Q,Z)};changeWildwoodAscendancyClass=($,Z=!0,J=!1)=>{if(J)x.skill_tree.fire("wildwood-ascendancy-class-change");if(this.skillTreeData.alternate_ascendancies.length===0)return;const Q=this.skillTreeData.alternate_ascendancies;if(Q===void 0)return;this.changeAscendancyClassInternal(!0,$,Q,Z)};changeAscendancyClassInternal=($,Z,J,Q)=>{const K=J[Z-1],q=K!==void 0?K.id:void 0;for(let V in this.skillTreeData.ascendancyNodes){const X=this.skillTreeData.nodes[V];if(this.skillTreeData.isWildwoodAscendancyClass(X)!==$)continue;if(X.ascendancyName!==q){this.skillTreeData.removeState(X,_.Active),this.skillTreeData.removeState(X,_.Desired);continue}if(X.isAscendancyStart)this.skillTreeData.addState(X,_.Active),this.skillTreeData.addState(X,_.Desired),x.skill_tree.fire("highlighted-nodes-update")}if(Q)window.location.hash="#"+this.encodeURL(!1)};searchChange=($=void 0)=>{if(this.skillTreeData.clearState(_.Highlighted),$!==void 0&&$.length!==0){const Z=new RegExp($,"gi");for(let J in this.skillTreeData.nodes){const Q=this.skillTreeData.nodes[J];if(Q.isAscendancyStart||Q.classStartIndex!==void 0)continue;if(Q.name.match(Z)!==null||Q.stats.find((K)=>K.match(Z)!==null)!==void 0)this.skillTreeData.addState(Q,_.Highlighted)}}x.skill_tree.fire("highlighted-nodes-update")};importChange=($=void 0)=>{this.decodeImport($)};wanderingPathButtonClick=()=>{let $=0;for(let Z of Object.values(this.skillTreeData.nodes))if(!Z.is(_.UnDesired)&&!Z.is(_.Desired)&&!Z.isNotable&&!Z.isKeystone)for(let J of Z.stats){if($<100&&J.indexOf("additional connected Map")!==-1)$+=4,this.skillTreeData.addState(Z,_.Desired);if(J.indexOf("increased Quantity of Items found in your Maps")!==-1)this.skillTreeData.addState(Z,_.Desired);if(J.indexOf("increased effect of Modifiers on your Non-Unique Maps")!==-1)this.skillTreeData.addState(Z,_.Desired)}};seventhGateClick=($,Z)=>{const J=Object.values(this.skillTreeData.nodes).filter((Q)=>Q.isWormhole);if($){for(let Q of J)this.skillTreeData.removeState(Q,_.Desired),this.skillTreeData.removeState(Q,_.UnDesired);return}for(let Q of J)if(Z.is(_.Desired))this.skillTreeData.removeState(Q,_.Desired),this.skillTreeData.addState(Q,_.UnDesired);else if(Z.is(_.UnDesired))this.skillTreeData.removeState(Q,_.UnDesired);else this.skillTreeData.addState(Q,_.Desired)};click=($)=>{if($.is(_.Compared))return;if($.classStartIndex!==void 0||$.isAscendancyStart)return;if($.classStartIndex!==void 0||$.isAscendancyStart)return;const Z=Object.values(this.skillTreeData.getNodes(_.Active)).filter((J)=>J.isAscendancyStart).filter((J)=>this.skillTreeData.isWildwoodAscendancyClass($)==this.skillTreeData.isWildwoodAscendancyClass(J))[0];if($.ascendancyName!==""&&Z.ascendancyName!==$.ascendancyName)return;if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.id==="41153")this.seventhGateClick(!1,$);if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.isMastery){let J=[];for(let Q in this.skillTreeData.nodes){const K=this.skillTreeData.nodes[Q];if(!K.isMastery)continue;if(K.name!==$.name)continue;if(K.group===void 0)continue;if(!J.includes(K.group))J.push(K.group)}for(let Q of J){let K=[...this.skillTreeData.groups[Q].nodes];if(K.includes("65499"))K.push("54499","55003");if(K.includes("19599"))K.push("9338","50203","5515");for(let q of K){const V=this.skillTreeData.nodes[q];if(V.isNotable||this.notableException.includes(q)){if(V.is(_.Desired))this.skillTreeData.removeState(V,_.Desired),this.skillTreeData.addState(V,_.UnDesired);else if(V.is(_.UnDesired))this.skillTreeData.removeState(V,_.UnDesired);else if(!V.isMastery)this.skillTreeData.addState(V,_.Desired);x.skill_tree.fire("highlighted-nodes-update")}}}}else{if($.is(_.Desired))this.skillTreeData.removeState($,_.Desired),this.skillTreeData.addState($,_.UnDesired);else if($.is(_.UnDesired))this.skillTreeData.removeState($,_.UnDesired);else this.skillTreeData.addState($,_.Desired);x.skill_tree.fire("highlighted-nodes-update")}this.allocateNodes(!1)};rightclick=($)=>{if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.id==="41153")this.seventhGateClick(!0,$);if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.isMastery){let Z=[];for(let J in this.skillTreeData.nodes){const Q=this.skillTreeData.nodes[J];if(!Q.isMastery)continue;if(Q.name!==$.name)continue;if(Q.group===void 0)continue;if(!Z.includes(Q.group))Z.push(Q.group)}for(let J of Z){let Q=[...this.skillTreeData.groups[J].nodes];if(Q.includes("65499"))Q.push("54499","55003");if(Q.includes("19599"))Q.push("9338","50203","5515");for(let K of Q){const q=this.skillTreeData.nodes[K];if(q.isNotable||this.notableException.includes(K))this.skillTreeData.removeState(q,_.Desired),this.skillTreeData.removeState(q,_.UnDesired)}}}else this.skillTreeData.removeState($,_.Desired),this.skillTreeData.removeState($,_.UnDesired);this.allocateNodes(!1),x.skill_tree.fire("highlighted-nodes-update")};allocateNodes=($)=>{if(!$&&this.pause)return;const Z=performance.now();this.allocationAlgorithm.Execute(this.shortestPath);const J=performance.now()-Z;this.skillTreeData.clearState(_.Hovered),this.skillTreeData.clearState(_.Pathing),this.skillTreeDataCompare?.clearState(_.Hovered),window.location.hash="#"+this.encodeURL(!1)};mouseover=($)=>{if(this.skillTreeData.clearState(_.Hovered),this.skillTreeData.clearState(_.Pathing),this.skillTreeDataCompare?.clearState(_.Hovered),$.classStartIndex===void 0){if($.is(_.Compared))this.skillTreeDataCompare?.addState($,_.Hovered);else if(this.skillTreeData.addState($,_.Hovered),this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.isMastery)for(let Z in this.skillTreeData.nodes){const J=this.skillTreeData.nodes[Z];if(!J.isMastery)continue;if(J.name!==$.name)continue;this.skillTreeData.addState(J,_.Hovered)}}x.skill_tree.fire("hovered-nodes-start",$)};mouseout=($)=>{this.skillTreeData.clearState(_.Hovered),this.skillTreeData.clearState(_.Pathing),this.skillTreeDataCompare?.clearState(_.Hovered),x.skill_tree.fire("hovered-nodes-end",$)}}class $Q{CanProcess($){return $.circles===void 0}Process($){let Z=$;return Z.realm="pc",Z.circles={Small:[{level:0.1246,width:199},{level:0.2109,width:337},{level:0.2972,width:476},{level:0.3835,width:614}],Medium:[{level:0.1246,width:299},{level:0.2109,width:506},{level:0.2972,width:713},{level:0.3835,width:920}],Large:[{level:0.1246,width:374},{level:0.2109,width:633},{level:0.2972,width:892},{level:0.3835,width:1151}]},Z}}class ZQ{CanProcess($,Z){return Z!==void 0}Process($,Z){if(Z===void 0)return $;if($.classes===void 0)$.classes=[];for(let J in Z.ascClasses){const Q=Z.ascClasses[J],K=$.classes[+J]||{};K.name=K.name||Q.name,K.ascendancies=[];for(let q in Q.classes){const V=Q.classes[q];K.ascendancies[+q-1]={flavourText:V.flavourText,flavourTextColour:V.flavourTextColour,flavourTextRect:this.UpgradeFlavourTextRect(V.flavourTextRect),id:V.displayName,name:V.name}}$.classes[+J]=K}return $}UpgradeFlavourTextRect($){const Z=$.split(",");return{x:+Z[0],y:+Z[1],width:+Z[2],height:+Z[3]}}}class JQ{CanProcess($){return!0}Process($){$.nodes.root.in=$.nodes.root.in||[],$.nodes.root.out=$.nodes.root.out||[];const Z={};for(let K in $.nodes)Z[K.toString()]=this.FixNode(K,$.nodes[K]);for(let K in Z){if(K==="root")continue;for(let q of Z[K].out){if(q==="root")continue;if(Z[K].in.indexOf(q)<0)Z[K].in.push(q);if(!Z[q].isMastery&&Z[q].out.indexOf(K)<0)Z[q].out.push(K)}for(let q of Z[K].in){if(q==="root")continue;if(!Z[K].isMastery&&Z[K].out.indexOf(q)<0)Z[K].out.push(q);if(Z[q].in.indexOf(K)<0)Z[q].in.push(K)}}$.nodes=Z;for(var J in $.sprites)for(var Q in $.sprites[J])$.sprites[J][Q].filename=$.sprites[J][Q].filename.replace("https://web.poecdn.com/image/passive-skill/","");for(let K in $.groups){const q=$.groups[K];$.groups[K].nodes=(q.nodes||[]).map((V)=>V.toString()),$.groups[K].orbits=q.orbits||[]}return $}FixNode($,Z){return Z.in=(Z.in||[]).map((J)=>J.toString())||[],Z.out=(Z.out||[]).map((J)=>J.toString())||[],Z.in=Z.in.filter((J)=>J!==$),Z.out=Z.out.filter((J)=>J!==$),Z}}class QQ{CanProcess($){return $.root!==void 0&&$.root.g!==void 0&&Array.isArray($.nodes)&&Object.keys($.skillSprites).length===2&&$.skillSprites.active!==void 0&&$.skillSprites.inactive!==void 0}Process($){var Z=JSON.parse(JSON.stringify($));for(let J in $.skillSprites){const Q=$.skillSprites[J];if(!(J==="active"||J==="inactive"))continue;const K=J.charAt(0).toUpperCase()+J.slice(1),q={};q[`notable${K}`]=[],q[`keystone${K}`]=[],q[`normal${K}`]=[];for(let V of Q){const X=V.notableCoords===void 0?V.coords:V.notableCoords,W=V.notableCoords===void 0?V.coords:V.notableCoords,U=V.coords;q[`notable${K}`].push({filename:V.filename,coords:X}),q[`keystone${K}`].push({filename:V.filename,coords:W}),q[`normal${K}`].push({filename:V.filename,coords:U})}for(let V in q)Z.skillSprites[V]=q[V]}return Z}}class KQ{CanProcess($){if(!($.root!==void 0&&$.root.g!==void 0&&Array.isArray($.nodes)&&Object.keys($.skillSprites).length>=6))return!1;for(var J in $.nodes){const Q=$.nodes[J];if(Q.ascendancyName!==void 0&&Q.ascendancyName!=="")return!1}return!0}Process($){var Z=JSON.parse(JSON.stringify($)),J=[];for(let Q of $.nodes)J.push(this.UpgradeNode(Q));return Z.nodes=J,Z}UpgradeNode($){var Z=$;return Z.isJewelSocket=!1,Z.isMultipleChoice=!1,Z.isMultipleChoiceOption=!1,Z.passivePointsGranted=0,Z.ascendancyName="",Z.isAscendancyStart=!1,Z.flavourText=[],Z.reminderText=[],Z}}class qQ{CanProcess($){return $.extraImages===void 0}Process($){var Z=JSON.parse(JSON.stringify($));return Z.extraImages={},Z}}class VQ{CanProcess($){return Array.isArray($.nodes)}Process($){var Z=JSON.parse(JSON.stringify($));const J={};for(let Q of $.nodes)J[Q.id.toString()]=this.UpgradeNode(Q);return Z.nodes=J,Z}UpgradeNode($){var Z=$;if(Z.out===void 0)Z.out=[];if(Z.in===void 0)Z.in=[];return Z}}class XQ{CanProcess($){for(var Z in $.nodes)if($.nodes[Z].isBlighted===!0)return!1;return!0}Process($){var Z=JSON.parse(JSON.stringify($));const J={};for(let Q in $.nodes)J[Q.toString()]=this.UpgradeNode($.nodes[Q]);return Z.nodes=J,Z}UpgradeNode($){var Z=$;return Z.isBlighted=!1,Z}}class WQ{CanProcess($){return $.root!==void 0}Process($){var Z={assets:$.assets||{},classes:[],constants:$.constants||{},extraImages:$.extraImages||{},groups:{},imageZoomLevels:$.imageZoomLevels||[],jewelSlots:[],max_x:$.max_x,max_y:$.max_y,min_x:$.min_x,min_y:$.min_y,nodes:{},skillSprites:$.skillSprites||{}};for(let K in $.characterData){const q=$.characterData[K],V=this.ClassIdToName(+K);if(V===null)continue;Z.classes[+K]={ascendancies:[],base_dex:q.base_dex,base_int:q.base_int,base_str:q.base_str,name:V}}const J={};for(let K in $.nodes)J[K.toString()]=this.UpgradeNode($.nodes[K]);J.root=this.UpgradeNode($.root),Z.nodes=J;const Q={};for(let K in $.groups)Q[K.toString()]=this.UpgradeGroup($.groups[K]);return Z.groups=Q,Z}UpgradeNode($){return{ascendancyName:$.ascendancyName||"",classStartIndex:$.spc&&$.spc.length>0?$.spc[0]:void 0,expansionJewel:void 0,flavourText:$.flavourText||[],grantedDexterity:$.da||0,grantedIntelligence:$.ia||0,grantedPassivePoints:$.passivePointsGranted||0,grantedStrength:$.sa||0,group:$.g,icon:$.icon,in:($.in||[]).map((Z)=>Z.toString())||[],isAscendancyStart:$.isAscendancyStart||!1,isBlighted:$.isBlighted||!1,isJewelSocket:$.isJewelSocket||!1,isKeystone:$.ks||!1,isMastery:$.m||!1,isMultipleChoice:$.isMultipleChoice||!1,isMultipleChoiceOption:$.isMultipleChoiceOption||!1,isNotable:$.not||!1,isProxy:!1,name:$.dn||"",orbit:$.o||0,orbitIndex:$.oidx||0,out:($.out||[]).map((Z)=>Z.toString())||[],recipe:[],reminderText:$.reminderText||[],skill:+$.id||-1,stats:$.sd||[]}}UpgradeGroup($){var Z=[];if(Array.isArray($.oo))$.oo={"0":$.oo[0]};for(let J in $.oo)Z.push(+J);return{isProxy:!1,nodes:($.n||[]).map((J)=>J.toString()),orbits:Z,x:$.x,y:$.y}}ClassIdToName($){switch($){case 0:return"Scion";case 1:return"Marauder";case 2:return"Ranger";case 3:return"Witch";case 4:return"Duelist";case 5:return"Templar";case 6:return"Shadow";default:return null}}}class UQ{CanProcess($){return $.tree===void 0}Process($){var Z=$;return Z.tree="Default",Z}}class zQ{CanProcess($){for(var Z in $.nodes)if($.nodes[Z].activeEffectImage!==void 0)return!1;return!0}Process($){var Z=$;const J={};for(let Q in $.nodes)J[Q.toString()]=this.UpgradeNode($.nodes[Q]);return Z.nodes=J,Z}UpgradeNode($){var Z=$;return Z.activeEffectImage=void 0,Z.activeIcon=void 0,Z.inactiveIcon=void 0,Z.masteryEffects=void 0,Z}}class HQ{CanProcess($){return $.points===void 0}Process($){var Z=$;return Z.points={totalPoints:121,ascendancyPoints:8},Z}}class GQ{CanProcess($){return $.assets!==void 0}Process($){const Z=JSON.parse(JSON.stringify($)),J={},Q=this.UpgradeSpriteSheets($);for(let q in Q){J[q]={};const V=Q[q];for(let X in V)J[q][X]=Q[q][X]}const K=this.UpgradeAssets($);for(let q in K){J[q]={};const V=K[q];for(let X in V)J[q][X]=K[q][X]}return Z.sprites=J,delete Z.assets,delete Z.skillSprites,Z}UpgradeSpriteSheets($){const Z={};for(let Q in $.skillSprites){const K=$.skillSprites[Q];for(let q in $.imageZoomLevels){const V=$.imageZoomLevels[q].toString(),X=K[q];if(X===void 0)continue;const W=Z[`${X.filename}-${V}`]||{w:0,h:0};Z[`${X.filename}-${V}`]=this.CalculateWidthAndHeight(W,X)}}const J={};for(let Q in $.skillSprites){J[Q]={};const K=$.skillSprites[Q];for(let q in $.imageZoomLevels){const V=$.imageZoomLevels[q].toString(),X=K[q];if(X===void 0)continue;J[Q][V]=this.UpgradeSpriteSheet(X,Z[`${X.filename}-${V}`])}}return J}UpgradeSpriteSheet($,Z){const J=$;return J.w=Z.w,J.h=Z.h,J}CalculateWidthAndHeight($,Z){let{w:J,h:Q}=$;for(let K in Z.coords){const q=Z.coords[K];J=Math.max(J,q.x+q.w),Q=Math.max(Q,q.y+q.h)}return{w:J,h:Q}}UpgradeAssets($){const Z={};for(let J in $.assets){const Q=this.MapAssetToGroup(J);if(Q===null)continue;if(Z[Q]===void 0)Z[Q]={};for(let K in $.assets[J]){if(Z[Q][K]===void 0)Z[Q][K]={filename:"LOAD_COORDS",h:-1,w:-1,coords:{}};Z[Q][K].coords[J]={x:0,y:0,h:-1,w:-1}}}return Z}MapAssetToGroup($){if($=$.startsWith("PassiveSkillScreen")?$.replace("PassiveSkillScreen",""):$,$==="Background2"||$==="Background1")return"background";if($==="PassiveMasteryConnectedButton")return"masteryActiveSelected";if($.startsWith("Classes"))return"ascendancyBackground";if($.startsWith("Ascendancy"))return"ascendancy";if($.startsWith("Background")||$.startsWith("center")||$==="PSStartNodeBackgroundInactive")return"startNode";if($.startsWith("PSGroupBackground")||$.startsWith("GroupBackground"))return"groupBackground";if($.indexOf("Frame")>=0||$.startsWith("JewelSocketClusterAlt")||$.startsWith("JewelSocketAlt"))return"frame";if($.startsWith("JewelSocket"))return"jewel";if($.startsWith("LineConnector")||$.startsWith("Orbit")||$.startsWith("PSLineDeco"))return"line";if($.indexOf("JewelCircle")>=0)return"jewelRadius";if($==="AtlasPassiveSkillScreenStart")return"startNode";if($==="AtlasPassiveBackground")return"atlasBackground";if($==="PSStartNodeBackgroundActive")return null;if($.startsWith("imgPSFade"))return null;if($.endsWith("Oil"))return null;throw new Error(`Unhandled Asset: ${$}`)}}class YQ{CanProcess($){for(let Z in $.groups)if($.groups[Z].background)return!1;return!0}Process($){const Z=JSON.parse(JSON.stringify($)),J=this.UpgradeGroups($);return Z.groups=J,delete Z.uiArtOptions,Z}UpgradeGroups($){var Z={};for(let J in $.groups){const Q=$.groups[J],K=Q.nodes||[];if(K.length===0||K.find((X)=>$.nodes[X].ascendancyName!==void 0)!==void 0){Z[J]=this.CopyGroup(Q);continue}let q=Q.orbits||[];q=q.filter((X)=>X<=3);const V=Q.backgroundOverride!==void 0&&Q.backgroundOverride!==0?Q.backgroundOverride:Math.max(...q);if(V<=0||V>3){Z[J]=this.CopyGroup(Q);continue}Z[J]=this.UpgradeGroup(Q,V,$.uiArtOptions==void 0?!0:$.uiArtOptions.largeGroupUsesHalfImage)}return Z}CopyGroup($){return{x:$.x,y:$.y,isProxy:$.isProxy,orbits:$.orbits,nodes:$.nodes,background:void 0}}UpgradeGroup($,Z,J){var Q=this.CopyGroup($);return Q.background={image:this.MapBackground(Z),isHalfImage:Z===3&&J?!0:void 0,offsetX:void 0,offsetY:void 0},Q}MapBackground($){switch($){case 1:return"PSGroupBackground1";case 2:return"PSGroupBackground2";case 3:return"PSGroupBackground3";default:throw new Error(`Unhandled BackgroundKey: ${$}`)}}}class wQ{CanProcess($){return $.tree.slice(0,5)==="Atlas"&&$.sprites.wormholeInactive===void 0}Process($){return JSON.parse(JSON.stringify($))}}class jQ{CanProcess($){return $.sprites.tattooActiveEffect===void 0}Process($){return JSON.parse(JSON.stringify($))}}class BQ{CanProcess($){return $.sprites.azmeri===void 0}Process($){return JSON.parse(JSON.stringify($))}}class FQ{static _preprocessors=[new QQ,new KQ,new qQ,new VQ,new XQ,new WQ,new UQ,new zQ,new HQ,new GQ,new YQ,new wQ,new jQ,new BQ,new ZQ,new JQ];static _optionsPreprocessors=[new $Q];static Decode($,Z){if(Z!==void 0){for(let J of this._optionsPreprocessors)if(J.CanProcess(Z))Z=J.Process(Z)}for(let J of this._preprocessors)if(J.CanProcess($,Z))$=J.Process($,Z);return $}}var Kz=l6(H9(),1);class s5{DRAG_THRESHOLD_SQUARED=16;start={x:0,y:0};dragged=!1;hovered=[];skillTreeData;skillTreeDataCompare;constructor($,Z){this.skillTreeData=$,this.skillTreeDataCompare=Z,x.viewport.on("up",this.up),x.viewport.on("rightup",this.rightup),x.viewport.on("move",this.move),x.viewport.on("down",this.down),x.viewport.on("cancel",()=>setTimeout(()=>this.cancelDrag(),250))}skillTrees=()=>{const $=[this.skillTreeData];if(this.skillTreeDataCompare!==void 0)$.push(this.skillTreeDataCompare);return $};up=($)=>{if(!this.dragged)s5.clickSkillTree($,this.skillTreeData);this.cancelDrag()};rightup=($)=>{if(!this.dragged)s5.rightClickSkillTree($,this.skillTreeData);this.cancelDrag()};static clickSkillTree=($,Z)=>{const J=Z.getNodeAtPoint($);if(J===null)return;x.node.fire("click",J)};static rightClickSkillTree=($,Z)=>{const J=Z.getNodeAtPoint($);if(J===null)return;x.node.fire("rightclick",J)};cancelDrag=()=>{this.start={x:0,y:0},this.dragged=!1};down=($)=>{this.start={x:$.x,y:$.y}};move=($)=>{if(!this.dragged&&this.start.x!==0&&this.start.y!==0){const Q={x:this.start.x-$.x,y:this.start.y-$.y};this.dragged=this.dragged||Q.x*Q.x+Q.y*Q.y>this.DRAG_THRESHOLD_SQUARED}const Z=new Array;for(let Q of this.skillTrees()){const K=Q.getNodeAtPoint($);if(K!==null){Z.push(K);break}}const J=this.hovered.filter((Q)=>!Z.includes(Q));for(let Q of J)x.node.fire("out",Q);this.hovered=Z;for(let Q of this.hovered)x.node.fire("in",Q)}}class T7{skillTreeData;skillTreeDataCompare;skillTreeUtilities;renderer;uievents;launch=async($,Z,J)=>{for(let j of[$,Z]){if(j==="")continue;let B=void 0;const C=new Kz.SemVer(j);var Q=await fetch(`${x0.SKILL_TREES_URI}/${j}/SkillTree.json`).then((F)=>F.json()),K=Q;const N=new GJ(FQ.Decode(K,B),C);if(j===$)this.skillTreeData=N;if(j===Z)this.skillTreeDataCompare=void 0}this.uievents=new s5(this.skillTreeData,this.skillTreeDataCompare),this.skillTreeUtilities=new e4(this.skillTreeData,this.skillTreeDataCompare);const q=document.getElementById("skillTreeControl_Version");for(let j of J.versions){const B=document.createElement("option");if(B.text=B.value=j,j===$)B.setAttribute("selected","selected");q.appendChild(B);const C=document.createElement("option");if(C.text=C.value=j,j===Z)C.setAttribute("selected","selected")}q.onchange=()=>{const j=q.value!=="0"?q.value:"";T7.ChangeSkillTreeVersion(j,"","")};const V=document.getElementsByClassName("skillTreeVersions");for(let j in V)if(V[j].style!==void 0)V[j].style.removeProperty("display");document.getElementById("skillTreeControl_Reset").addEventListener("click",()=>{const j=this.skillTreeData.getStartClass(),B=this.skillTreeData.getAscendancyClass(),C=this.skillTreeData.getWildwoodAscendancyClass(),N=document.getElementById("skillTreeControl_Import");N.value="",this.skillTreeData.clearState(_.Active),this.skillTreeData.clearState(_.Desired),this.skillTreeData.clearState(_.UnDesired),x.controls.fire("class-change",j),x.controls.fire("ascendancy-class-change",B),x.skill_tree.fire("highlighted-nodes-update"),x.controls.fire("wildwood-ascendancy-class-change",C)}),document.getElementById("skillTreeControl_Export").addEventListener("click",()=>{const j=this.skillTreeUtilities.encodeURL(!0),C="https://www.pathofexile.com/fullscreen-"+(this.skillTreeData.tree.slice(0,5)==="Atlas"?"atlas":"passive")+"-skill-tree/"+j;navigator.clipboard.writeText(C)});const U=document.getElementById("poePlanner_Button");if(U.addEventListener("click",()=>{const B="https://poeplanner.com/atlas-tree/"+this.skillTreeUtilities.encodeURL(!0);window.open(B,"_blank")}),J.versions[J.versions.length-1].slice(0,4)!==$.slice(0,4))U.style.setProperty("display","none");else U.style.setProperty("display","inline");const z=document.getElementById("skillTreeStats_ShowHide");z.addEventListener("click",()=>{const j=document.getElementById("skillTreeStats_Content"),B=document.getElementById("skillTreeStats");if(j.toggleAttribute("hidden"))B.style.setProperty("height","fit-content"),z.innerText="Show stats";else B.style.setProperty("height","80%"),z.innerText="Hide stats"});const H=document.getElementById("help_ShowHide");H.addEventListener("click",()=>{const j=document.getElementById("help_Content"),B=document.getElementById("help");if(j.toggleAttribute("hidden"))H.innerText="Show help";else H.innerText="Hide help"});const G=document.getElementById("skillTreeControl_Recalculate");G.addEventListener("click",()=>{x.skill_tree.fire("recalculate",!0)});const Y=document.getElementById("skillTreeControl_Pause");Y.addEventListener("click",()=>{if(Y.innerText=="Pause Allocation")Y.innerText="Unpause Allocation",G.style.setProperty("display","inline");else Y.innerText="Pause Allocation",G.style.setProperty("display","none");x.controls.fire("pause-change")});const w=document.getElementById("skillTreeContainer");if(w!==null)this.renderer=new Y4(w,this.skillTreeData,this.skillTreeDataCompare),this.renderer.Initialize().then(()=>{this.SetupEventsAndControls(),this.renderer.RenderBase(),this.skillTreeUtilities.decodeURL(!1),this.skillTreeUtilities.allocateNodes(!1),this.renderer.RenderCharacterStartsActive(),this.renderer.RenderActive()}).catch((j)=>console.error(j))};SetupPregeneration=($)=>{const Z=Object.values($.nodes).map((Q)=>Q.skill);let J=[];for(let Q of $.nodes.root.out){let K=[];K.push(...$.nodes[Q].out),K.push(...$.nodes[Q].in);for(let q of K)if($.nodes[q].isAscendancyStart===void 0)J.push(Number(q))}this.PreGenerateShortestDistances($,Z,J)};PreGenerateShortestDistances=($,Z,J)=>{let Q=!1;const K=$.nodes;console.log("Shortest distances started");for(let W in K)$.nodes[W].distance={};console.log("Reset done");let q=0;console.log("Checking "+Z.length+""),console.log(J);for(let W of Z){if(W==="root"){console.log("Skipping root");continue}if(W===void 0||K[W]===void 0){console.log("Skipping undefined node");continue}if($.tree.slice(0,5)!=="Atlas"&&K[W].ascendancyName!==void 0)continue;if(K[W].out===void 0&&K[W].in===void 0||K[W].out&&K[W].out.length===0&&K[W].in&&K[W].in.length===0){console.log("Skipping no out or in");continue}let U={};U[W]=0;const z=[K[W]],H={};while(z.length>0){const G=z.shift();if(G===void 0)continue;if(W===65499&&G.skill===5515)console.log("verbose enabled"),Q=!0;H[G.skill]=G;const Y=U[G.skill];let w=[];if(G.out)w.push(...G.out);if(G.in)w.push(...G.in);for(let j of w){const B=K[j];if(B.ascendancyName!==""&&B.ascendancyName!==void 0)continue;if(H[j]||U[j])continue;if(J.includes(Number(j)))$.nodes[W].distance[j]=Y+1;q++,U[j]=Y+1,z.push(B)}}}console.log("Total frontier checks: "+q);var V=document.createElement("a"),X=new Blob([JSON.stringify($,null,4)],{type:"text/plain"});V.href=URL.createObjectURL(X),V.download="UpdatedTree.json",V.click()};SetupEventsAndControls=()=>{x.skill_tree.on("highlighted-nodes-update",this.renderer.RenderHighlight),x.skill_tree.on("class-change",this.renderer.RenderCharacterStartsActive),x.skill_tree.on("class-change",this.updateClassControl),x.skill_tree.on("ascendancy-class-change",this.updateAscClassControl),x.skill_tree.on("wildwood-ascendancy-class-change",this.updateWildwoodAscClassControl),x.skill_tree.on("hovered-nodes-start",this.renderer.StartRenderHover),x.skill_tree.on("hovered-nodes-end",this.renderer.StopRenderHover),x.skill_tree.on("active-nodes-update",this.renderer.RenderActive),x.skill_tree.on("active-nodes-update",this.updateStats),x.skill_tree.on("normal-node-count",(J)=>{const Q=document.getElementById("skillTreeNormalNodeCount");if(Q!==null)Q.innerHTML=J.toString()}),x.skill_tree.on("normal-node-count-maximum",(J)=>{const Q=document.getElementById("skillTreeNormalNodeCountMaximum");if(Q!==null)Q.innerHTML=J.toString()}),x.skill_tree.on("ascendancy-node-count",(J)=>{const Q=document.getElementById("skillTreeAscendancyNodeCount");if(Q!==null)Q.innerHTML=J.toString()}),x.skill_tree.on("ascendancy-node-count-maximum",(J)=>{const Q=document.getElementById("skillTreeAscendancyNodeCountMaximum");if(Q!==null)Q.innerHTML=J.toString()}),x.skill_tree.on("wildwood-ascendancy-node-count",(J)=>{const Q=document.getElementById("skillTreeWildwoodAscendancyNodeCount");if(Q!==null)Q.innerHTML=J.toString()}),x.skill_tree.on("wildwood-ascendancy-node-count-maximum",(J)=>{const Q=document.getElementById("skillTreeWildwoodAscendancyNodeCountMaximum");if(Q!==null)Q.innerHTML=J.toString()}),this.populateStartClasses(document.getElementById("skillTreeControl_Class")),this.bindSearchBox(document.getElementById("skillTreeControl_Search")),this.bindImportBox(document.getElementById("skillTreeControl_Import"));const $=document.getElementsByClassName("skillTreeControls");for(let J in $)if($[J].style!==void 0)$[J].style.removeProperty("display");const Z=document.getElementsByClassName("skillTreePoints");for(let J in Z)if(Z[J].style!==void 0)Z[J].style.removeProperty("display")};masteries=void 0;masteryTest=void 0;defaultStats=void 0;buildStatLookups=($)=>{if(this.masteries===void 0||this.masteryTest===void 0){const Z=["The Maven"],J={"The Maven":" Maven"};for(let Q in this.skillTreeData.nodes){const K=this.skillTreeData.nodes[Q],q=this.skillTreeData.getMasteryForGroup(K.nodeGroup);if(q!==null&&q.name!==$)Z.push(q.name),J[q.name]=q.name.replace("The","").replace("Mastery","")}this.masteries=Z,this.masteryTest=J}if(this.defaultStats===void 0){const Z={};for(let J in this.skillTreeData.nodes){const Q=this.skillTreeData.nodes[J];for(let K of Q.stats){if(Z[K]!==void 0)continue;if(this.skillTreeData.getMasteryForGroup(Q.nodeGroup)===null){let V=!1;for(let X of this.masteries)if(K.indexOf(this.masteryTest[X])>=0){V=!0;break}if(!V)Z[K]=!0}}}this.defaultStats=Z}return[this.masteries,this.masteryTest,this.defaultStats]};updateStats=()=>{const $=this.skillTreeData.tree.slice(0,5)==="Atlas"?"Maps":"Default",[Z,J,Q]=this.buildStatLookups($),K={},q={},V={},X=this.skillTreeData.getSkilledNodes();for(let U in X){const z=X[U];for(let H of z.stats){if(V[H]===void 0)V[H]=1;else V[H]=V[H]+1;if(q[H]!==void 0){const Y=q[H];if(K[Y].indexOf(H)===-1)K[Y].push(H);continue}if(Q[H]){if(K[$]===void 0)K[$]=[];if(K[$].indexOf(H)===-1)q[H]=$,K[$].push(H);continue}const G=this.skillTreeData.getMasteryForGroup(z.nodeGroup);if(G!==null){if(K[G.name]===void 0)K[G.name]=[];if(K[G.name].indexOf(H)===-1)q[H]=G.name,K[G.name].push(H)}else{let Y=$;for(let w of Z)if(H.indexOf(J[w])>=0){Y=w;break}if(K[Y]===void 0)K[Y]=[];if(K[Y].indexOf(H)===-1)q[H]=Y,K[Y].push(H)}}}const W=document.getElementById("skillTreeStats_Content");while(W.firstChild)W.removeChild(W.firstChild);for(let U of Object.keys(K).sort((z,H)=>z===$?-1:H===$?1:z<H?-1:1)){const z={};for(let G of K[U])z[G]=V[G];const H=this.createStatGroup(U,z);W.appendChild(H)}};createStatGroup=($,Z)=>{const J=document.createElement("div");J.className="group";const Q=document.createElement("span");Q.className="title",Q.innerText=$,Q.addEventListener("click",()=>{document.querySelectorAll(`[data-group-name="${$}"]`).forEach((q)=>{q.toggleAttribute("hidden")})}),J.appendChild(Q);for(let K of Object.keys(Z).sort()){const q=Z[K];J.appendChild(this.createStat($,`${q}x ${K}`))}return J};createStat=($,Z)=>{const J=document.createElement("div");return J.className="stat",J.innerText=Z,J.setAttribute("data-group-name",$),J};populateStartClasses=($)=>{while($.firstChild)$.removeChild($.firstChild);const Z=new Array;for(let K in this.skillTreeData.classStartNodes){const q=this.skillTreeData.nodes[K].classStartIndex;if(q===void 0)continue;const V=document.createElement("option");if(V.text=this.skillTreeData.root.out.length===1?"Atlas":this.skillTreeData.constants.classIdToName[q],V.value=q.toString(),q===this.skillTreeData.getStartClass())V.setAttribute("selected","selected");Z.push(V)}Z.sort((K,q)=>{const V=K.value,X=q.value;if(V!==null&&X!==null)return+V-+X;return 0});for(let K of Z)$.append(K);const J=document.getElementById("skillTreeControl_Ascendancy");if(J!==null)this.populateAscendancyClasses(J);const Q=document.getElementById("skillTreeControl_WildwoodAscendancy");if(Q!==null)this.populateWildwoodAscendancyClasses(Q);$.onchange=()=>{const K=$.value;if(x.controls.fire("class-change",+K),J!==null)this.populateAscendancyClasses(J,+K,0);if(Q!==null)this.populateWildwoodAscendancyClasses(Q,0)}};updateClassControl=()=>{const $=this.skillTreeData.getStartClass();document.getElementById("skillTreeControl_Class").value=String($)};updateAscClassControl=()=>{if(this.skillTreeData.classes.length===0)return;const $=this.skillTreeData.getAscendancyClass(),Z=this.skillTreeData.classes[this.skillTreeData.getStartClass()].ascendancies;if(Z===void 0)return;const J=document.getElementById("skillTreeControl_Ascendancy");this.createAscendancyClassOptions(J,Z,$)};populateAscendancyClasses=($,Z=void 0,J=void 0)=>{while($.firstChild)$.removeChild($.firstChild);if(this.skillTreeData.classes.length===0){$.style.display="none";const V=document.getElementById("skillTreeAscendancy");if(V!==null)V.style.display="none";return}const Q=Z!==void 0?Z:this.skillTreeData.getStartClass(),K=this.skillTreeData.classes[Q].ascendancies;if(K===void 0)return;const q=J!==void 0?J:this.skillTreeData.getAscendancyClass();this.createAscendancyClassOptions($,K,q),$.onchange=()=>{x.controls.fire("ascendancy-class-change",+$.value)}};updateWildwoodAscClassControl=()=>{if(this.skillTreeData.alternate_ascendancies.length===0)return;const $=this.skillTreeData.getWildwoodAscendancyClass(),Z=this.skillTreeData.alternate_ascendancies;if(Z===void 0)return;const J=document.getElementById("skillTreeControl_WildwoodAscendancy");this.createAscendancyClassOptions(J,Z,$)};populateWildwoodAscendancyClasses=($,Z=void 0)=>{while($.firstChild)$.removeChild($.firstChild);if(this.skillTreeData.alternate_ascendancies.length===0){$.style.display="none";const K=document.getElementById("skillTreeWildwoodAscendancy");if(K!==null)K.style.display="none";return}const J=this.skillTreeData.alternate_ascendancies;if(J===void 0)return;const Q=Z!==void 0?Z:this.skillTreeData.getAscendancyClass();this.createAscendancyClassOptions($,J,Q),$.onchange=()=>{x.controls.fire("wildwood-ascendancy-class-change",+$.value)}};createAscendancyClassOptions=($,Z,J)=>{while($.firstChild)$.removeChild($.firstChild);const Q=document.createElement("option");if(Q.text="None",Q.value="0",J===0)Q.setAttribute("selected","selected");if($.append(Q),Z.length===0)return;for(let K in Z){const q=Z[K],V=+K+1,X=document.createElement("option");if(X.text=q.id,X.value=`${V}`,V===J)X.setAttribute("selected","selected");$.append(X)}};searchTimout=null;bindSearchBox=($)=>{$.onkeyup=()=>{if(this.searchTimout!==null)clearTimeout(this.searchTimout);this.searchTimout=setTimeout(()=>{x.controls.fire("search-change",$.value),this.searchTimout=null},250)}};bindImportBox=($)=>{$.onpaste=(Z)=>{x.controls.fire("import-change",Z.clipboardData?.getData("text"))},$.onclick=()=>{$.select()}};static decodeURLParams=($="")=>{return $.slice($.indexOf("?")+1).split("&").reduce((J,Q)=>{const K=Q.indexOf("=");if(K<0)return Object.assign(J,{[Q]:null});const q=Q.slice(0,K),V=Q.slice(K+1);return Object.assign(J,{[q]:decodeURIComponent(V)})},{})};static ChangeSkillTreeVersion=($,Z,J)=>{let Q="?";if($!=="")Q+=`v=${$}`;if(!Q.endsWith("?")&&Z!=="")Q+="&";if(Z!=="")Q+=`c=${Z}`;if(window.location.hash!==J)window.location.hash=J;if(window.location.search!==Q)window.location.search=Q;const K=document.getElementById("skillTreeControl_Class");if($.slice(-5)==="atlas"||$.slice(-8)==="standard")K.style.visibility="hidden";else K.style.visibility="visible"}}window.onload=async()=>{const $=T7.decodeURLParams(window.location.search),Z={versions:[]},J=Object.fromEntries(Object.entries(L$));for(let Q in J){const K=J[Q];if(!(K instanceof qz.SemVer))continue;Z.versions.push(K.version)}if(Z.versions.indexOf($.v)===-1)$.v=Z.versions[Z.versions.length-1];if(!$.c)$.c="";T7.ChangeSkillTreeVersion($.v,$.c,window.location.hash),new T7().launch($.v,$.c,Z)};
