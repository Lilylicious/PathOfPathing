var cW=Object.create;var{getPrototypeOf:mW,defineProperty:d7,getOwnPropertyNames:uW}=Object;var dW=Object.prototype.hasOwnProperty;var f5=($,J,Z)=>{Z=$!=null?cW(mW($)):{};let Q=J||!$||!$.__esModule?d7(Z,"default",{value:$,enumerable:!0}):Z;for(let q of uW($))if(!dW.call(Q,q))d7(Q,q,{get:()=>$[q],enumerable:!0});return Q};var A=($,J)=>()=>(J||$((J={exports:{}}).exports,J),J.exports);var pW=($,J)=>{for(var Z in J)d7($,Z,{get:J[Z],enumerable:!0,configurable:!0,set:(Q)=>J[Z]=()=>Q})};var L6=A((vI,CQ)=>{var lW=Number.MAX_SAFE_INTEGER||9007199254740991,nW=["major","premajor","minor","preminor","patch","prepatch","prerelease"];CQ.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:lW,RELEASE_TYPES:nW,SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var k6=A((yI,NQ)=>{var oW=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...$)=>console.error("SEMVER",...$):()=>{};NQ.exports=oW});var v5=A((Q8,BQ)=>{var{MAX_SAFE_COMPONENT_LENGTH:p7,MAX_SAFE_BUILD_LENGTH:sW,MAX_LENGTH:iW}=L6(),aW=k6();Q8=BQ.exports={};var rW=Q8.re=[],tW=Q8.safeRe=[],m=Q8.src=[],eW=Q8.safeSrc=[],u=Q8.t={},$z=0,l7="[a-zA-Z0-9-]",Jz=[["\\s",1],["\\d",iW],[l7,sW]],Zz=($)=>{for(let[J,Z]of Jz)$=$.split(`${J}*`).join(`${J}{0,${Z}}`).split(`${J}+`).join(`${J}{1,${Z}}`);return $},e=($,J,Z)=>{let Q=Zz(J),q=$z++;aW($,q,J),u[$]=q,m[q]=J,eW[q]=Q,rW[q]=new RegExp(J,Z?"g":void 0),tW[q]=new RegExp(Q,Z?"g":void 0)};e("NUMERICIDENTIFIER","0|[1-9]\\d*");e("NUMERICIDENTIFIERLOOSE","\\d+");e("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${l7}*`);e("MAINVERSION",`(${m[u.NUMERICIDENTIFIER]})\\.(${m[u.NUMERICIDENTIFIER]})\\.(${m[u.NUMERICIDENTIFIER]})`);e("MAINVERSIONLOOSE",`(${m[u.NUMERICIDENTIFIERLOOSE]})\\.(${m[u.NUMERICIDENTIFIERLOOSE]})\\.(${m[u.NUMERICIDENTIFIERLOOSE]})`);e("PRERELEASEIDENTIFIER",`(?:${m[u.NONNUMERICIDENTIFIER]}|${m[u.NUMERICIDENTIFIER]})`);e("PRERELEASEIDENTIFIERLOOSE",`(?:${m[u.NONNUMERICIDENTIFIER]}|${m[u.NUMERICIDENTIFIERLOOSE]})`);e("PRERELEASE",`(?:-(${m[u.PRERELEASEIDENTIFIER]}(?:\\.${m[u.PRERELEASEIDENTIFIER]})*))`);e("PRERELEASELOOSE",`(?:-?(${m[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${m[u.PRERELEASEIDENTIFIERLOOSE]})*))`);e("BUILDIDENTIFIER",`${l7}+`);e("BUILD",`(?:\\+(${m[u.BUILDIDENTIFIER]}(?:\\.${m[u.BUILDIDENTIFIER]})*))`);e("FULLPLAIN",`v?${m[u.MAINVERSION]}${m[u.PRERELEASE]}?${m[u.BUILD]}?`);e("FULL",`^${m[u.FULLPLAIN]}$`);e("LOOSEPLAIN",`[v=\\s]*${m[u.MAINVERSIONLOOSE]}${m[u.PRERELEASELOOSE]}?${m[u.BUILD]}?`);e("LOOSE",`^${m[u.LOOSEPLAIN]}$`);e("GTLT","((?:<|>)?=?)");e("XRANGEIDENTIFIERLOOSE",`${m[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);e("XRANGEIDENTIFIER",`${m[u.NUMERICIDENTIFIER]}|x|X|\\*`);e("XRANGEPLAIN",`[v=\\s]*(${m[u.XRANGEIDENTIFIER]})(?:\\.(${m[u.XRANGEIDENTIFIER]})(?:\\.(${m[u.XRANGEIDENTIFIER]})(?:${m[u.PRERELEASE]})?${m[u.BUILD]}?)?)?`);e("XRANGEPLAINLOOSE",`[v=\\s]*(${m[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${m[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${m[u.XRANGEIDENTIFIERLOOSE]})(?:${m[u.PRERELEASELOOSE]})?${m[u.BUILD]}?)?)?`);e("XRANGE",`^${m[u.GTLT]}\\s*${m[u.XRANGEPLAIN]}$`);e("XRANGELOOSE",`^${m[u.GTLT]}\\s*${m[u.XRANGEPLAINLOOSE]}$`);e("COERCEPLAIN",`(^|[^\\d])(\\d{1,${p7}})(?:\\.(\\d{1,${p7}}))?(?:\\.(\\d{1,${p7}}))?`);e("COERCE",`${m[u.COERCEPLAIN]}(?:$|[^\\d])`);e("COERCEFULL",m[u.COERCEPLAIN]+`(?:${m[u.PRERELEASE]})?(?:${m[u.BUILD]})?(?:$|[^\\d])`);e("COERCERTL",m[u.COERCE],!0);e("COERCERTLFULL",m[u.COERCEFULL],!0);e("LONETILDE","(?:~>?)");e("TILDETRIM",`(\\s*)${m[u.LONETILDE]}\\s+`,!0);Q8.tildeTrimReplace="$1~";e("TILDE",`^${m[u.LONETILDE]}${m[u.XRANGEPLAIN]}$`);e("TILDELOOSE",`^${m[u.LONETILDE]}${m[u.XRANGEPLAINLOOSE]}$`);e("LONECARET","(?:\\^)");e("CARETTRIM",`(\\s*)${m[u.LONECARET]}\\s+`,!0);Q8.caretTrimReplace="$1^";e("CARET",`^${m[u.LONECARET]}${m[u.XRANGEPLAIN]}$`);e("CARETLOOSE",`^${m[u.LONECARET]}${m[u.XRANGEPLAINLOOSE]}$`);e("COMPARATORLOOSE",`^${m[u.GTLT]}\\s*(${m[u.LOOSEPLAIN]})$|^$`);e("COMPARATOR",`^${m[u.GTLT]}\\s*(${m[u.FULLPLAIN]})$|^$`);e("COMPARATORTRIM",`(\\s*)${m[u.GTLT]}\\s*(${m[u.LOOSEPLAIN]}|${m[u.XRANGEPLAIN]})`,!0);Q8.comparatorTrimReplace="$1$2$3";e("HYPHENRANGE",`^\\s*(${m[u.XRANGEPLAIN]})\\s+-\\s+(${m[u.XRANGEPLAIN]})\\s*$`);e("HYPHENRANGELOOSE",`^\\s*(${m[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${m[u.XRANGEPLAINLOOSE]})\\s*$`);e("STAR","(<|>)?=?\\s*\\*");e("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");e("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var d9=A((gI,IQ)=>{var Qz=Object.freeze({loose:!0}),qz=Object.freeze({}),Kz=($)=>{if(!$)return qz;if(typeof $!=="object")return Qz;return $};IQ.exports=Kz});var n7=A((xI,jQ)=>{var FQ=/^[0-9]+$/,OQ=($,J)=>{let Z=FQ.test($),Q=FQ.test(J);if(Z&&Q)$=+$,J=+J;return $===J?0:Z&&!Q?-1:Q&&!Z?1:$<J?-1:1},Vz=($,J)=>OQ(J,$);jQ.exports={compareIdentifiers:OQ,rcompareIdentifiers:Vz}});var e0=A((cI,PQ)=>{var p9=k6(),{MAX_LENGTH:_Q,MAX_SAFE_INTEGER:l9}=L6(),{safeRe:n9,t:o9}=v5(),Hz=d9(),{compareIdentifiers:y5}=n7();class l1{constructor($,J){if(J=Hz(J),$ instanceof l1)if($.loose===!!J.loose&&$.includePrerelease===!!J.includePrerelease)return $;else $=$.version;else if(typeof $!=="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof $}".`);if($.length>_Q)throw new TypeError(`version is longer than ${_Q} characters`);p9("SemVer",$,J),this.options=J,this.loose=!!J.loose,this.includePrerelease=!!J.includePrerelease;let Z=$.trim().match(J.loose?n9[o9.LOOSE]:n9[o9.FULL]);if(!Z)throw new TypeError(`Invalid Version: ${$}`);if(this.raw=$,this.major=+Z[1],this.minor=+Z[2],this.patch=+Z[3],this.major>l9||this.major<0)throw new TypeError("Invalid major version");if(this.minor>l9||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>l9||this.patch<0)throw new TypeError("Invalid patch version");if(!Z[4])this.prerelease=[];else this.prerelease=Z[4].split(".").map((Q)=>{if(/^[0-9]+$/.test(Q)){let q=+Q;if(q>=0&&q<l9)return q}return Q});this.build=Z[5]?Z[5].split("."):[],this.format()}format(){if(this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length)this.version+=`-${this.prerelease.join(".")}`;return this.version}toString(){return this.version}compare($){if(p9("SemVer.compare",this.version,this.options,$),!($ instanceof l1)){if(typeof $==="string"&&$===this.version)return 0;$=new l1($,this.options)}if($.version===this.version)return 0;return this.compareMain($)||this.comparePre($)}compareMain($){if(!($ instanceof l1))$=new l1($,this.options);return y5(this.major,$.major)||y5(this.minor,$.minor)||y5(this.patch,$.patch)}comparePre($){if(!($ instanceof l1))$=new l1($,this.options);if(this.prerelease.length&&!$.prerelease.length)return-1;else if(!this.prerelease.length&&$.prerelease.length)return 1;else if(!this.prerelease.length&&!$.prerelease.length)return 0;let J=0;do{let Z=this.prerelease[J],Q=$.prerelease[J];if(p9("prerelease compare",J,Z,Q),Z===void 0&&Q===void 0)return 0;else if(Q===void 0)return 1;else if(Z===void 0)return-1;else if(Z===Q)continue;else return y5(Z,Q)}while(++J)}compareBuild($){if(!($ instanceof l1))$=new l1($,this.options);let J=0;do{let Z=this.build[J],Q=$.build[J];if(p9("build compare",J,Z,Q),Z===void 0&&Q===void 0)return 0;else if(Q===void 0)return 1;else if(Z===void 0)return-1;else if(Z===Q)continue;else return y5(Z,Q)}while(++J)}inc($,J,Z){if($.startsWith("pre")){if(!J&&Z===!1)throw new Error("invalid increment argument: identifier is empty");if(J){let Q=`-${J}`.match(this.options.loose?n9[o9.PRERELEASELOOSE]:n9[o9.PRERELEASE]);if(!Q||Q[1]!==J)throw new Error(`invalid identifier: ${J}`)}}switch($){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",J,Z);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",J,Z);break;case"prepatch":this.prerelease.length=0,this.inc("patch",J,Z),this.inc("pre",J,Z);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",J,Z);this.inc("pre",J,Z);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0,this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":{let Q=Number(Z)?1:0;if(this.prerelease.length===0)this.prerelease=[Q];else{let q=this.prerelease.length;while(--q>=0)if(typeof this.prerelease[q]==="number")this.prerelease[q]++,q=-2;if(q===-1){if(J===this.prerelease.join(".")&&Z===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(Q)}}if(J){let q=[J,Q];if(Z===!1)q=[J];if(y5(this.prerelease[0],J)===0){if(isNaN(this.prerelease[1]))this.prerelease=q}else this.prerelease=q}break}default:throw new Error(`invalid increment argument: ${$}`)}if(this.raw=this.format(),this.build.length)this.raw+=`+${this.build.join(".")}`;return this}}PQ.exports=l1});var V5=A((mI,LQ)=>{var DQ=e0(),Xz=($,J,Z=!1)=>{if($ instanceof DQ)return $;try{return new DQ($,J)}catch(Q){if(!Z)return null;throw Q}};LQ.exports=Xz});var AQ=A((uI,kQ)=>{var Wz=V5(),zz=($,J)=>{let Z=Wz($,J);return Z?Z.version:null};kQ.exports=zz});var MQ=A((dI,RQ)=>{var Gz=V5(),Yz=($,J)=>{let Z=Gz($.trim().replace(/^[=v]+/,""),J);return Z?Z.version:null};RQ.exports=Yz});var TQ=A((pI,hQ)=>{var EQ=e0(),wz=($,J,Z,Q,q)=>{if(typeof Z==="string")q=Q,Q=Z,Z=void 0;try{return new EQ($ instanceof EQ?$.version:$,Z).inc(J,Q,q).version}catch(K){return null}};hQ.exports=wz});var fQ=A((lI,bQ)=>{var SQ=V5(),Uz=($,J)=>{let Z=SQ($,null,!0),Q=SQ(J,null,!0),q=Z.compare(Q);if(q===0)return null;let K=q>0,V=K?Z:Q,H=K?Q:Z,X=!!V.prerelease.length;if(!!H.prerelease.length&&!X){if(!H.patch&&!H.minor)return"major";if(H.compareMain(V)===0){if(H.minor&&!H.patch)return"minor";return"patch"}}let z=X?"pre":"";if(Z.major!==Q.major)return z+"major";if(Z.minor!==Q.minor)return z+"minor";if(Z.patch!==Q.patch)return z+"patch";return"prerelease"};bQ.exports=Uz});var yQ=A((nI,vQ)=>{var Cz=e0(),Nz=($,J)=>new Cz($,J).major;vQ.exports=Nz});var xQ=A((oI,gQ)=>{var Bz=e0(),Iz=($,J)=>new Bz($,J).minor;gQ.exports=Iz});var mQ=A((sI,cQ)=>{var Fz=e0(),Oz=($,J)=>new Fz($,J).patch;cQ.exports=Oz});var dQ=A((iI,uQ)=>{var jz=V5(),_z=($,J)=>{let Z=jz($,J);return Z&&Z.prerelease.length?Z.prerelease:null};uQ.exports=_z});var S1=A((aI,lQ)=>{var pQ=e0(),Pz=($,J,Z)=>new pQ($,Z).compare(new pQ(J,Z));lQ.exports=Pz});var oQ=A((rI,nQ)=>{var Dz=S1(),Lz=($,J,Z)=>Dz(J,$,Z);nQ.exports=Lz});var iQ=A((tI,sQ)=>{var kz=S1(),Az=($,J)=>kz($,J,!0);sQ.exports=Az});var s9=A((eI,rQ)=>{var aQ=e0(),Rz=($,J,Z)=>{let Q=new aQ($,Z),q=new aQ(J,Z);return Q.compare(q)||Q.compareBuild(q)};rQ.exports=Rz});var eQ=A(($F,tQ)=>{var Mz=s9(),Ez=($,J)=>$.sort((Z,Q)=>Mz(Z,Q,J));tQ.exports=Ez});var Jq=A((JF,$q)=>{var hz=s9(),Tz=($,J)=>$.sort((Z,Q)=>hz(Q,Z,J));$q.exports=Tz});var A6=A((ZF,Zq)=>{var Sz=S1(),bz=($,J,Z)=>Sz($,J,Z)>0;Zq.exports=bz});var i9=A((QF,Qq)=>{var fz=S1(),vz=($,J,Z)=>fz($,J,Z)<0;Qq.exports=vz});var o7=A((qF,qq)=>{var yz=S1(),gz=($,J,Z)=>yz($,J,Z)===0;qq.exports=gz});var s7=A((KF,Kq)=>{var xz=S1(),cz=($,J,Z)=>xz($,J,Z)!==0;Kq.exports=cz});var a9=A((VF,Vq)=>{var mz=S1(),uz=($,J,Z)=>mz($,J,Z)>=0;Vq.exports=uz});var r9=A((HF,Hq)=>{var dz=S1(),pz=($,J,Z)=>dz($,J,Z)<=0;Hq.exports=pz});var i7=A((XF,Xq)=>{var lz=o7(),nz=s7(),oz=A6(),sz=a9(),iz=i9(),az=r9(),rz=($,J,Z,Q)=>{switch(J){case"===":if(typeof $==="object")$=$.version;if(typeof Z==="object")Z=Z.version;return $===Z;case"!==":if(typeof $==="object")$=$.version;if(typeof Z==="object")Z=Z.version;return $!==Z;case"":case"=":case"==":return lz($,Z,Q);case"!=":return nz($,Z,Q);case">":return oz($,Z,Q);case">=":return sz($,Z,Q);case"<":return iz($,Z,Q);case"<=":return az($,Z,Q);default:throw new TypeError(`Invalid operator: ${J}`)}};Xq.exports=rz});var zq=A((WF,Wq)=>{var tz=e0(),ez=V5(),{safeRe:t9,t:e9}=v5(),$G=($,J)=>{if($ instanceof tz)return $;if(typeof $==="number")$=String($);if(typeof $!=="string")return null;J=J||{};let Z=null;if(!J.rtl)Z=$.match(J.includePrerelease?t9[e9.COERCEFULL]:t9[e9.COERCE]);else{let X=J.includePrerelease?t9[e9.COERCERTLFULL]:t9[e9.COERCERTL],W;while((W=X.exec($))&&(!Z||Z.index+Z[0].length!==$.length)){if(!Z||W.index+W[0].length!==Z.index+Z[0].length)Z=W;X.lastIndex=W.index+W[1].length+W[2].length}X.lastIndex=-1}if(Z===null)return null;let Q=Z[2],q=Z[3]||"0",K=Z[4]||"0",V=J.includePrerelease&&Z[5]?`-${Z[5]}`:"",H=J.includePrerelease&&Z[6]?`+${Z[6]}`:"";return ez(`${Q}.${q}.${K}${V}${H}`,J)};Wq.exports=$G});var wq=A((zF,Yq)=>{class Gq{constructor(){this.max=1000,this.map=new Map}get($){let J=this.map.get($);if(J===void 0)return;else return this.map.delete($),this.map.set($,J),J}delete($){return this.map.delete($)}set($,J){if(!this.delete($)&&J!==void 0){if(this.map.size>=this.max){let Q=this.map.keys().next().value;this.delete(Q)}this.map.set($,J)}return this}}Yq.exports=Gq});var b1=A((GF,Bq)=>{var JG=/\s+/g;class R6{constructor($,J){if(J=QG(J),$ instanceof R6)if($.loose===!!J.loose&&$.includePrerelease===!!J.includePrerelease)return $;else return new R6($.raw,J);if($ instanceof a7)return this.raw=$.value,this.set=[[$]],this.formatted=void 0,this;if(this.options=J,this.loose=!!J.loose,this.includePrerelease=!!J.includePrerelease,this.raw=$.trim().replace(JG," "),this.set=this.raw.split("||").map((Z)=>this.parseRange(Z.trim())).filter((Z)=>Z.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let Z=this.set[0];if(this.set=this.set.filter((Q)=>!Cq(Q[0])),this.set.length===0)this.set=[Z];else if(this.set.length>1){for(let Q of this.set)if(Q.length===1&&zG(Q[0])){this.set=[Q];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let $=0;$<this.set.length;$++){if($>0)this.formatted+="||";let J=this.set[$];for(let Z=0;Z<J.length;Z++){if(Z>0)this.formatted+=" ";this.formatted+=J[Z].toString().trim()}}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange($){let Z=((this.options.includePrerelease&&XG)|(this.options.loose&&WG))+":"+$,Q=Uq.get(Z);if(Q)return Q;let q=this.options.loose,K=q?N1[V1.HYPHENRANGELOOSE]:N1[V1.HYPHENRANGE];$=$.replace(K,OG(this.options.includePrerelease)),w0("hyphen replace",$),$=$.replace(N1[V1.COMPARATORTRIM],KG),w0("comparator trim",$),$=$.replace(N1[V1.TILDETRIM],VG),w0("tilde trim",$),$=$.replace(N1[V1.CARETTRIM],HG),w0("caret trim",$);let V=$.split(" ").map((z)=>GG(z,this.options)).join(" ").split(/\s+/).map((z)=>FG(z,this.options));if(q)V=V.filter((z)=>{return w0("loose invalid filter",z,this.options),!!z.match(N1[V1.COMPARATORLOOSE])});w0("range list",V);let H=new Map,X=V.map((z)=>new a7(z,this.options));for(let z of X){if(Cq(z))return[z];H.set(z.value,z)}if(H.size>1&&H.has(""))H.delete("");let W=[...H.values()];return Uq.set(Z,W),W}intersects($,J){if(!($ instanceof R6))throw new TypeError("a Range is required");return this.set.some((Z)=>{return Nq(Z,J)&&$.set.some((Q)=>{return Nq(Q,J)&&Z.every((q)=>{return Q.every((K)=>{return q.intersects(K,J)})})})})}test($){if(!$)return!1;if(typeof $==="string")try{$=new qG($,this.options)}catch(J){return!1}for(let J=0;J<this.set.length;J++)if(jG(this.set[J],$,this.options))return!0;return!1}}Bq.exports=R6;var ZG=wq(),Uq=new ZG,QG=d9(),a7=M6(),w0=k6(),qG=e0(),{safeRe:N1,t:V1,comparatorTrimReplace:KG,tildeTrimReplace:VG,caretTrimReplace:HG}=v5(),{FLAG_INCLUDE_PRERELEASE:XG,FLAG_LOOSE:WG}=L6(),Cq=($)=>$.value==="<0.0.0-0",zG=($)=>$.value==="",Nq=($,J)=>{let Z=!0,Q=$.slice(),q=Q.pop();while(Z&&Q.length)Z=Q.every((K)=>{return q.intersects(K,J)}),q=Q.pop();return Z},GG=($,J)=>{return w0("comp",$,J),$=UG($,J),w0("caret",$),$=YG($,J),w0("tildes",$),$=NG($,J),w0("xrange",$),$=IG($,J),w0("stars",$),$},H1=($)=>!$||$.toLowerCase()==="x"||$==="*",YG=($,J)=>{return $.trim().split(/\s+/).map((Z)=>wG(Z,J)).join(" ")},wG=($,J)=>{let Z=J.loose?N1[V1.TILDELOOSE]:N1[V1.TILDE];return $.replace(Z,(Q,q,K,V,H)=>{w0("tilde",$,Q,q,K,V,H);let X;if(H1(q))X="";else if(H1(K))X=`>=${q}.0.0 <${+q+1}.0.0-0`;else if(H1(V))X=`>=${q}.${K}.0 <${q}.${+K+1}.0-0`;else if(H)w0("replaceTilde pr",H),X=`>=${q}.${K}.${V}-${H} <${q}.${+K+1}.0-0`;else X=`>=${q}.${K}.${V} <${q}.${+K+1}.0-0`;return w0("tilde return",X),X})},UG=($,J)=>{return $.trim().split(/\s+/).map((Z)=>CG(Z,J)).join(" ")},CG=($,J)=>{w0("caret",$,J);let Z=J.loose?N1[V1.CARETLOOSE]:N1[V1.CARET],Q=J.includePrerelease?"-0":"";return $.replace(Z,(q,K,V,H,X)=>{w0("caret",$,q,K,V,H,X);let W;if(H1(K))W="";else if(H1(V))W=`>=${K}.0.0${Q} <${+K+1}.0.0-0`;else if(H1(H))if(K==="0")W=`>=${K}.${V}.0${Q} <${K}.${+V+1}.0-0`;else W=`>=${K}.${V}.0${Q} <${+K+1}.0.0-0`;else if(X)if(w0("replaceCaret pr",X),K==="0")if(V==="0")W=`>=${K}.${V}.${H}-${X} <${K}.${V}.${+H+1}-0`;else W=`>=${K}.${V}.${H}-${X} <${K}.${+V+1}.0-0`;else W=`>=${K}.${V}.${H}-${X} <${+K+1}.0.0-0`;else if(w0("no pr"),K==="0")if(V==="0")W=`>=${K}.${V}.${H}${Q} <${K}.${V}.${+H+1}-0`;else W=`>=${K}.${V}.${H}${Q} <${K}.${+V+1}.0-0`;else W=`>=${K}.${V}.${H} <${+K+1}.0.0-0`;return w0("caret return",W),W})},NG=($,J)=>{return w0("replaceXRanges",$,J),$.split(/\s+/).map((Z)=>BG(Z,J)).join(" ")},BG=($,J)=>{$=$.trim();let Z=J.loose?N1[V1.XRANGELOOSE]:N1[V1.XRANGE];return $.replace(Z,(Q,q,K,V,H,X)=>{w0("xRange",$,Q,q,K,V,H,X);let W=H1(K),z=W||H1(V),G=z||H1(H),Y=G;if(q==="="&&Y)q="";if(X=J.includePrerelease?"-0":"",W)if(q===">"||q==="<")Q="<0.0.0-0";else Q="*";else if(q&&Y){if(z)V=0;if(H=0,q===">")if(q=">=",z)K=+K+1,V=0,H=0;else V=+V+1,H=0;else if(q==="<=")if(q="<",z)K=+K+1;else V=+V+1;if(q==="<")X="-0";Q=`${q+K}.${V}.${H}${X}`}else if(z)Q=`>=${K}.0.0${X} <${+K+1}.0.0-0`;else if(G)Q=`>=${K}.${V}.0${X} <${K}.${+V+1}.0-0`;return w0("xRange return",Q),Q})},IG=($,J)=>{return w0("replaceStars",$,J),$.trim().replace(N1[V1.STAR],"")},FG=($,J)=>{return w0("replaceGTE0",$,J),$.trim().replace(N1[J.includePrerelease?V1.GTE0PRE:V1.GTE0],"")},OG=($)=>(J,Z,Q,q,K,V,H,X,W,z,G,Y)=>{if(H1(Q))Z="";else if(H1(q))Z=`>=${Q}.0.0${$?"-0":""}`;else if(H1(K))Z=`>=${Q}.${q}.0${$?"-0":""}`;else if(V)Z=`>=${Z}`;else Z=`>=${Z}${$?"-0":""}`;if(H1(W))X="";else if(H1(z))X=`<${+W+1}.0.0-0`;else if(H1(G))X=`<${W}.${+z+1}.0-0`;else if(Y)X=`<=${W}.${z}.${G}-${Y}`;else if($)X=`<${W}.${z}.${+G+1}-0`;else X=`<=${X}`;return`${Z} ${X}`.trim()},jG=($,J,Z)=>{for(let Q=0;Q<$.length;Q++)if(!$[Q].test(J))return!1;if(J.prerelease.length&&!Z.includePrerelease){for(let Q=0;Q<$.length;Q++){if(w0($[Q].semver),$[Q].semver===a7.ANY)continue;if($[Q].semver.prerelease.length>0){let q=$[Q].semver;if(q.major===J.major&&q.minor===J.minor&&q.patch===J.patch)return!0}}return!1}return!0}});var M6=A((YF,Pq)=>{var E6=Symbol("SemVer ANY");class $${static get ANY(){return E6}constructor($,J){if(J=Iq(J),$ instanceof $$)if($.loose===!!J.loose)return $;else $=$.value;if($=$.trim().split(/\s+/).join(" "),t7("comparator",$,J),this.options=J,this.loose=!!J.loose,this.parse($),this.semver===E6)this.value="";else this.value=this.operator+this.semver.version;t7("comp",this)}parse($){let J=this.options.loose?Fq[Oq.COMPARATORLOOSE]:Fq[Oq.COMPARATOR],Z=$.match(J);if(!Z)throw new TypeError(`Invalid comparator: ${$}`);if(this.operator=Z[1]!==void 0?Z[1]:"",this.operator==="=")this.operator="";if(!Z[2])this.semver=E6;else this.semver=new jq(Z[2],this.options.loose)}toString(){return this.value}test($){if(t7("Comparator.test",$,this.options.loose),this.semver===E6||$===E6)return!0;if(typeof $==="string")try{$=new jq($,this.options)}catch(J){return!1}return r7($,this.operator,this.semver,this.options)}intersects($,J){if(!($ instanceof $$))throw new TypeError("a Comparator is required");if(this.operator===""){if(this.value==="")return!0;return new _q($.value,J).test(this.value)}else if($.operator===""){if($.value==="")return!0;return new _q(this.value,J).test($.semver)}if(J=Iq(J),J.includePrerelease&&(this.value==="<0.0.0-0"||$.value==="<0.0.0-0"))return!1;if(!J.includePrerelease&&(this.value.startsWith("<0.0.0")||$.value.startsWith("<0.0.0")))return!1;if(this.operator.startsWith(">")&&$.operator.startsWith(">"))return!0;if(this.operator.startsWith("<")&&$.operator.startsWith("<"))return!0;if(this.semver.version===$.semver.version&&this.operator.includes("=")&&$.operator.includes("="))return!0;if(r7(this.semver,"<",$.semver,J)&&this.operator.startsWith(">")&&$.operator.startsWith("<"))return!0;if(r7(this.semver,">",$.semver,J)&&this.operator.startsWith("<")&&$.operator.startsWith(">"))return!0;return!1}}Pq.exports=$$;var Iq=d9(),{safeRe:Fq,t:Oq}=v5(),r7=i7(),t7=k6(),jq=e0(),_q=b1()});var h6=A((wF,Dq)=>{var _G=b1(),PG=($,J,Z)=>{try{J=new _G(J,Z)}catch(Q){return!1}return J.test($)};Dq.exports=PG});var kq=A((UF,Lq)=>{var DG=b1(),LG=($,J)=>new DG($,J).set.map((Z)=>Z.map((Q)=>Q.value).join(" ").trim().split(" "));Lq.exports=LG});var Rq=A((CF,Aq)=>{var kG=e0(),AG=b1(),RG=($,J,Z)=>{let Q=null,q=null,K=null;try{K=new AG(J,Z)}catch(V){return null}return $.forEach((V)=>{if(K.test(V)){if(!Q||q.compare(V)===-1)Q=V,q=new kG(Q,Z)}}),Q};Aq.exports=RG});var Eq=A((NF,Mq)=>{var MG=e0(),EG=b1(),hG=($,J,Z)=>{let Q=null,q=null,K=null;try{K=new EG(J,Z)}catch(V){return null}return $.forEach((V)=>{if(K.test(V)){if(!Q||q.compare(V)===1)Q=V,q=new MG(Q,Z)}}),Q};Mq.exports=hG});var Sq=A((BF,Tq)=>{var e7=e0(),TG=b1(),hq=A6(),SG=($,J)=>{$=new TG($,J);let Z=new e7("0.0.0");if($.test(Z))return Z;if(Z=new e7("0.0.0-0"),$.test(Z))return Z;Z=null;for(let Q=0;Q<$.set.length;++Q){let q=$.set[Q],K=null;if(q.forEach((V)=>{let H=new e7(V.semver.version);switch(V.operator){case">":if(H.prerelease.length===0)H.patch++;else H.prerelease.push(0);H.raw=H.format();case"":case">=":if(!K||hq(H,K))K=H;break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${V.operator}`)}}),K&&(!Z||hq(Z,K)))Z=K}if(Z&&$.test(Z))return Z;return null};Tq.exports=SG});var fq=A((IF,bq)=>{var bG=b1(),fG=($,J)=>{try{return new bG($,J).range||"*"}catch(Z){return null}};bq.exports=fG});var J$=A((FF,xq)=>{var vG=e0(),gq=M6(),{ANY:yG}=gq,gG=b1(),xG=h6(),vq=A6(),yq=i9(),cG=r9(),mG=a9(),uG=($,J,Z,Q)=>{$=new vG($,Q),J=new gG(J,Q);let q,K,V,H,X;switch(Z){case">":q=vq,K=cG,V=yq,H=">",X=">=";break;case"<":q=yq,K=mG,V=vq,H="<",X="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(xG($,J,Q))return!1;for(let W=0;W<J.set.length;++W){let z=J.set[W],G=null,Y=null;if(z.forEach((w)=>{if(w.semver===yG)w=new gq(">=0.0.0");if(G=G||w,Y=Y||w,q(w.semver,G.semver,Q))G=w;else if(V(w.semver,Y.semver,Q))Y=w}),G.operator===H||G.operator===X)return!1;if((!Y.operator||Y.operator===H)&&K($,Y.semver))return!1;else if(Y.operator===X&&V($,Y.semver))return!1}return!0};xq.exports=uG});var mq=A((OF,cq)=>{var dG=J$(),pG=($,J,Z)=>dG($,J,">",Z);cq.exports=pG});var dq=A((jF,uq)=>{var lG=J$(),nG=($,J,Z)=>lG($,J,"<",Z);uq.exports=nG});var nq=A((_F,lq)=>{var pq=b1(),oG=($,J,Z)=>{return $=new pq($,Z),J=new pq(J,Z),$.intersects(J,Z)};lq.exports=oG});var sq=A((PF,oq)=>{var sG=h6(),iG=S1();oq.exports=($,J,Z)=>{let Q=[],q=null,K=null,V=$.sort((z,G)=>iG(z,G,Z));for(let z of V)if(sG(z,J,Z)){if(K=z,!q)q=z}else{if(K)Q.push([q,K]);K=null,q=null}if(q)Q.push([q,null]);let H=[];for(let[z,G]of Q)if(z===G)H.push(z);else if(!G&&z===V[0])H.push("*");else if(!G)H.push(`>=${z}`);else if(z===V[0])H.push(`<=${G}`);else H.push(`${z} - ${G}`);let X=H.join(" || "),W=typeof J.raw==="string"?J.raw:String(J);return X.length<W.length?X:J}});var $K=A((DF,eq)=>{var iq=b1(),JJ=M6(),{ANY:$J}=JJ,T6=h6(),ZJ=S1(),aG=($,J,Z={})=>{if($===J)return!0;$=new iq($,Z),J=new iq(J,Z);let Q=!1;$:for(let q of $.set){for(let K of J.set){let V=tG(q,K,Z);if(Q=Q||V!==null,V)continue $}if(Q)return!1}return!0},rG=[new JJ(">=0.0.0-0")],aq=[new JJ(">=0.0.0")],tG=($,J,Z)=>{if($===J)return!0;if($.length===1&&$[0].semver===$J)if(J.length===1&&J[0].semver===$J)return!0;else if(Z.includePrerelease)$=rG;else $=aq;if(J.length===1&&J[0].semver===$J)if(Z.includePrerelease)return!0;else J=aq;let Q=new Set,q,K;for(let w of $)if(w.operator===">"||w.operator===">=")q=rq(q,w,Z);else if(w.operator==="<"||w.operator==="<=")K=tq(K,w,Z);else Q.add(w.semver);if(Q.size>1)return null;let V;if(q&&K){if(V=ZJ(q.semver,K.semver,Z),V>0)return null;else if(V===0&&(q.operator!==">="||K.operator!=="<="))return null}for(let w of Q){if(q&&!T6(w,String(q),Z))return null;if(K&&!T6(w,String(K),Z))return null;for(let U of J)if(!T6(w,String(U),Z))return!1;return!0}let H,X,W,z,G=K&&!Z.includePrerelease&&K.semver.prerelease.length?K.semver:!1,Y=q&&!Z.includePrerelease&&q.semver.prerelease.length?q.semver:!1;if(G&&G.prerelease.length===1&&K.operator==="<"&&G.prerelease[0]===0)G=!1;for(let w of J){if(z=z||w.operator===">"||w.operator===">=",W=W||w.operator==="<"||w.operator==="<=",q){if(Y){if(w.semver.prerelease&&w.semver.prerelease.length&&w.semver.major===Y.major&&w.semver.minor===Y.minor&&w.semver.patch===Y.patch)Y=!1}if(w.operator===">"||w.operator===">="){if(H=rq(q,w,Z),H===w&&H!==q)return!1}else if(q.operator===">="&&!T6(q.semver,String(w),Z))return!1}if(K){if(G){if(w.semver.prerelease&&w.semver.prerelease.length&&w.semver.major===G.major&&w.semver.minor===G.minor&&w.semver.patch===G.patch)G=!1}if(w.operator==="<"||w.operator==="<="){if(X=tq(K,w,Z),X===w&&X!==K)return!1}else if(K.operator==="<="&&!T6(K.semver,String(w),Z))return!1}if(!w.operator&&(K||q)&&V!==0)return!1}if(q&&W&&!K&&V!==0)return!1;if(K&&z&&!q&&V!==0)return!1;if(Y||G)return!1;return!0},rq=($,J,Z)=>{if(!$)return J;let Q=ZJ($.semver,J.semver,Z);return Q>0?$:Q<0?J:J.operator===">"&&$.operator===">="?J:$},tq=($,J,Z)=>{if(!$)return J;let Q=ZJ($.semver,J.semver,Z);return Q<0?$:Q>0?J:J.operator==="<"&&$.operator==="<="?J:$};eq.exports=aG});var Z$=A((LF,QK)=>{var QJ=v5(),JK=L6(),eG=e0(),ZK=n7(),$Y=V5(),JY=AQ(),ZY=MQ(),QY=TQ(),qY=fQ(),KY=yQ(),VY=xQ(),HY=mQ(),XY=dQ(),WY=S1(),zY=oQ(),GY=iQ(),YY=s9(),wY=eQ(),UY=Jq(),CY=A6(),NY=i9(),BY=o7(),IY=s7(),FY=a9(),OY=r9(),jY=i7(),_Y=zq(),PY=M6(),DY=b1(),LY=h6(),kY=kq(),AY=Rq(),RY=Eq(),MY=Sq(),EY=fq(),hY=J$(),TY=mq(),SY=dq(),bY=nq(),fY=sq(),vY=$K();QK.exports={parse:$Y,valid:JY,clean:ZY,inc:QY,diff:qY,major:KY,minor:VY,patch:HY,prerelease:XY,compare:WY,rcompare:zY,compareLoose:GY,compareBuild:YY,sort:wY,rsort:UY,gt:CY,lt:NY,eq:BY,neq:IY,gte:FY,lte:OY,cmp:jY,coerce:_Y,Comparator:PY,Range:DY,satisfies:LY,toComparators:kY,maxSatisfying:AY,minSatisfying:RY,minVersion:MY,validRange:EY,outside:hY,gtr:TY,ltr:SY,intersects:bY,simplifyRange:fY,subset:vY,SemVer:eG,re:QJ.re,src:QJ.src,tokens:QJ.t,SEMVER_SPEC_VERSION:JK.SEMVER_SPEC_VERSION,RELEASE_TYPES:JK.RELEASE_TYPES,compareIdentifiers:ZK.compareIdentifiers,rcompareIdentifiers:ZK.rcompareIdentifiers}});var BK=A((yO,wJ)=>{var cY=Object.prototype.hasOwnProperty,z1="~";function v6(){}if(Object.create){if(v6.prototype=Object.create(null),!new v6().__proto__)z1=!1}function mY($,J,Z){this.fn=$,this.context=J,this.once=Z||!1}function NK($,J,Z,Q,q){if(typeof Z!=="function")throw new TypeError("The listener must be a function");var K=new mY(Z,Q||$,q),V=z1?z1+J:J;if(!$._events[V])$._events[V]=K,$._eventsCount++;else if(!$._events[V].fn)$._events[V].push(K);else $._events[V]=[$._events[V],K];return $}function X$($,J){if(--$._eventsCount===0)$._events=new v6;else delete $._events[J]}function $1(){this._events=new v6,this._eventsCount=0}$1.prototype.eventNames=function $(){var J=[],Z,Q;if(this._eventsCount===0)return J;for(Q in Z=this._events)if(cY.call(Z,Q))J.push(z1?Q.slice(1):Q);if(Object.getOwnPropertySymbols)return J.concat(Object.getOwnPropertySymbols(Z));return J};$1.prototype.listeners=function $(J){var Z=z1?z1+J:J,Q=this._events[Z];if(!Q)return[];if(Q.fn)return[Q.fn];for(var q=0,K=Q.length,V=new Array(K);q<K;q++)V[q]=Q[q].fn;return V};$1.prototype.listenerCount=function $(J){var Z=z1?z1+J:J,Q=this._events[Z];if(!Q)return 0;if(Q.fn)return 1;return Q.length};$1.prototype.emit=function $(J,Z,Q,q,K,V){var H=z1?z1+J:J;if(!this._events[H])return!1;var X=this._events[H],W=arguments.length,z,G;if(X.fn){if(X.once)this.removeListener(J,X.fn,void 0,!0);switch(W){case 1:return X.fn.call(X.context),!0;case 2:return X.fn.call(X.context,Z),!0;case 3:return X.fn.call(X.context,Z,Q),!0;case 4:return X.fn.call(X.context,Z,Q,q),!0;case 5:return X.fn.call(X.context,Z,Q,q,K),!0;case 6:return X.fn.call(X.context,Z,Q,q,K,V),!0}for(G=1,z=new Array(W-1);G<W;G++)z[G-1]=arguments[G];X.fn.apply(X.context,z)}else{var Y=X.length,w;for(G=0;G<Y;G++){if(X[G].once)this.removeListener(J,X[G].fn,void 0,!0);switch(W){case 1:X[G].fn.call(X[G].context);break;case 2:X[G].fn.call(X[G].context,Z);break;case 3:X[G].fn.call(X[G].context,Z,Q);break;case 4:X[G].fn.call(X[G].context,Z,Q,q);break;default:if(!z)for(w=1,z=new Array(W-1);w<W;w++)z[w-1]=arguments[w];X[G].fn.apply(X[G].context,z)}}}return!0};$1.prototype.on=function $(J,Z,Q){return NK(this,J,Z,Q,!1)};$1.prototype.once=function $(J,Z,Q){return NK(this,J,Z,Q,!0)};$1.prototype.removeListener=function $(J,Z,Q,q){var K=z1?z1+J:J;if(!this._events[K])return this;if(!Z)return X$(this,K),this;var V=this._events[K];if(V.fn){if(V.fn===Z&&(!q||V.once)&&(!Q||V.context===Q))X$(this,K)}else{for(var H=0,X=[],W=V.length;H<W;H++)if(V[H].fn!==Z||q&&!V[H].once||Q&&V[H].context!==Q)X.push(V[H]);if(X.length)this._events[K]=X.length===1?X[0]:X;else X$(this,K)}return this};$1.prototype.removeAllListeners=function $(J){var Z;if(J){if(Z=z1?z1+J:J,this._events[Z])X$(this,Z)}else this._events=new v6,this._eventsCount=0;return this};$1.prototype.off=$1.prototype.removeListener;$1.prototype.addListener=$1.prototype.on;$1.prefixed=z1;$1.EventEmitter=$1;if(typeof wJ!=="undefined")wJ.exports=$1});var _K=A((gO,BJ)=>{BJ.exports=G$;BJ.exports.default=G$;function G$($,J,Z){Z=Z||2;var Q=J&&J.length,q=Q?J[0]*Z:$.length,K=FK($,0,q,Z,!0),V=[];if(!K||K.next===K.prev)return V;var H,X,W,z,G,Y,w;if(Q)K=nY($,J,K,Z);if($.length>80*Z){H=W=$[0],X=z=$[1];for(var U=Z;U<q;U+=Z){if(G=$[U],Y=$[U+1],G<H)H=G;if(Y<X)X=Y;if(G>W)W=G;if(Y>z)z=Y}w=Math.max(W-H,z-X),w=w!==0?32767/w:0}return y6(K,V,Z,H,X,w,0),V}function FK($,J,Z,Q,q){var K,V;if(q===NJ($,J,Z,Q)>0)for(K=J;K<Z;K+=Q)V=IK(K,$[K],$[K+1],V);else for(K=Z-Q;K>=J;K-=Q)V=IK(K,$[K],$[K+1],V);if(V&&Y$(V,V.next))x6(V),V=V.next;return V}function Y5($,J){if(!$)return $;if(!J)J=$;var Z=$,Q;do if(Q=!1,!Z.steiner&&(Y$(Z,Z.next)||O0(Z.prev,Z,Z.next)===0)){if(x6(Z),Z=J=Z.prev,Z===Z.next)break;Q=!0}else Z=Z.next;while(Q||Z!==J);return J}function y6($,J,Z,Q,q,K,V){if(!$)return;if(!V&&K)rY($,Q,q,K);var H=$,X,W;while($.prev!==$.next){if(X=$.prev,W=$.next,K?dY($,Q,q,K):uY($)){J.push(X.i/Z|0),J.push($.i/Z|0),J.push(W.i/Z|0),x6($),$=W.next,H=W.next;continue}if($=W,$===H){if(!V)y6(Y5($),J,Z,Q,q,K,1);else if(V===1)$=pY(Y5($),J,Z),y6($,J,Z,Q,q,K,2);else if(V===2)lY($,J,Z,Q,q,K);break}}}function uY($){var J=$.prev,Z=$,Q=$.next;if(O0(J,Z,Q)>=0)return!1;var q=J.x,K=Z.x,V=Q.x,H=J.y,X=Z.y,W=Q.y,z=q<K?q<V?q:V:K<V?K:V,G=H<X?H<W?H:W:X<W?X:W,Y=q>K?q>V?q:V:K>V?K:V,w=H>X?H>W?H:W:X>W?X:W,U=Q.next;while(U!==J){if(U.x>=z&&U.x<=Y&&U.y>=G&&U.y<=w&&u5(q,H,K,X,V,W,U.x,U.y)&&O0(U.prev,U,U.next)>=0)return!1;U=U.next}return!0}function dY($,J,Z,Q){var q=$.prev,K=$,V=$.next;if(O0(q,K,V)>=0)return!1;var H=q.x,X=K.x,W=V.x,z=q.y,G=K.y,Y=V.y,w=H<X?H<W?H:W:X<W?X:W,U=z<G?z<Y?z:Y:G<Y?G:Y,C=H>X?H>W?H:W:X>W?X:W,N=z>G?z>Y?z:Y:G>Y?G:Y,O=UJ(w,U,J,Z,Q),I=UJ(C,N,J,Z,Q),B=$.prevZ,F=$.nextZ;while(B&&B.z>=O&&F&&F.z<=I){if(B.x>=w&&B.x<=C&&B.y>=U&&B.y<=N&&B!==q&&B!==V&&u5(H,z,X,G,W,Y,B.x,B.y)&&O0(B.prev,B,B.next)>=0)return!1;if(B=B.prevZ,F.x>=w&&F.x<=C&&F.y>=U&&F.y<=N&&F!==q&&F!==V&&u5(H,z,X,G,W,Y,F.x,F.y)&&O0(F.prev,F,F.next)>=0)return!1;F=F.nextZ}while(B&&B.z>=O){if(B.x>=w&&B.x<=C&&B.y>=U&&B.y<=N&&B!==q&&B!==V&&u5(H,z,X,G,W,Y,B.x,B.y)&&O0(B.prev,B,B.next)>=0)return!1;B=B.prevZ}while(F&&F.z<=I){if(F.x>=w&&F.x<=C&&F.y>=U&&F.y<=N&&F!==q&&F!==V&&u5(H,z,X,G,W,Y,F.x,F.y)&&O0(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function pY($,J,Z){var Q=$;do{var q=Q.prev,K=Q.next.next;if(!Y$(q,K)&&OK(q,Q,Q.next,K)&&g6(q,K)&&g6(K,q))J.push(q.i/Z|0),J.push(Q.i/Z|0),J.push(K.i/Z|0),x6(Q),x6(Q.next),Q=$=K;Q=Q.next}while(Q!==$);return Y5(Q)}function lY($,J,Z,Q,q,K){var V=$;do{var H=V.next.next;while(H!==V.prev){if(V.i!==H.i&&$w(V,H)){var X=jK(V,H);V=Y5(V,V.next),X=Y5(X,X.next),y6(V,J,Z,Q,q,K,0),y6(X,J,Z,Q,q,K,0);return}H=H.next}V=V.next}while(V!==$)}function nY($,J,Z,Q){var q=[],K,V,H,X,W;for(K=0,V=J.length;K<V;K++){if(H=J[K]*Q,X=K<V-1?J[K+1]*Q:$.length,W=FK($,H,X,Q,!1),W===W.next)W.steiner=!0;q.push(eY(W))}q.sort(oY);for(K=0;K<q.length;K++)Z=sY(q[K],Z);return Z}function oY($,J){return $.x-J.x}function sY($,J){var Z=iY($,J);if(!Z)return J;var Q=jK(Z,$);return Y5(Q,Q.next),Y5(Z,Z.next)}function iY($,J){var Z=J,Q=$.x,q=$.y,K=-1/0,V;do{if(q<=Z.y&&q>=Z.next.y&&Z.next.y!==Z.y){var H=Z.x+(q-Z.y)*(Z.next.x-Z.x)/(Z.next.y-Z.y);if(H<=Q&&H>K){if(K=H,V=Z.x<Z.next.x?Z:Z.next,H===Q)return V}}Z=Z.next}while(Z!==J);if(!V)return null;var X=V,W=V.x,z=V.y,G=1/0,Y;Z=V;do{if(Q>=Z.x&&Z.x>=W&&Q!==Z.x&&u5(q<z?Q:K,q,W,z,q<z?K:Q,q,Z.x,Z.y)){if(Y=Math.abs(q-Z.y)/(Q-Z.x),g6(Z,$)&&(Y<G||Y===G&&(Z.x>V.x||Z.x===V.x&&aY(V,Z))))V=Z,G=Y}Z=Z.next}while(Z!==X);return V}function aY($,J){return O0($.prev,$,J.prev)<0&&O0(J.next,$,$.next)<0}function rY($,J,Z,Q){var q=$;do{if(q.z===0)q.z=UJ(q.x,q.y,J,Z,Q);q.prevZ=q.prev,q.nextZ=q.next,q=q.next}while(q!==$);q.prevZ.nextZ=null,q.prevZ=null,tY(q)}function tY($){var J,Z,Q,q,K,V,H,X,W=1;do{Z=$,$=null,K=null,V=0;while(Z){V++,Q=Z,H=0;for(J=0;J<W;J++)if(H++,Q=Q.nextZ,!Q)break;X=W;while(H>0||X>0&&Q){if(H!==0&&(X===0||!Q||Z.z<=Q.z))q=Z,Z=Z.nextZ,H--;else q=Q,Q=Q.nextZ,X--;if(K)K.nextZ=q;else $=q;q.prevZ=K,K=q}Z=Q}K.nextZ=null,W*=2}while(V>1);return $}function UJ($,J,Z,Q,q){return $=($-Z)*q|0,J=(J-Q)*q|0,$=($|$<<8)&16711935,$=($|$<<4)&252645135,$=($|$<<2)&858993459,$=($|$<<1)&1431655765,J=(J|J<<8)&16711935,J=(J|J<<4)&252645135,J=(J|J<<2)&858993459,J=(J|J<<1)&1431655765,$|J<<1}function eY($){var J=$,Z=$;do{if(J.x<Z.x||J.x===Z.x&&J.y<Z.y)Z=J;J=J.next}while(J!==$);return Z}function u5($,J,Z,Q,q,K,V,H){return(q-V)*(J-H)>=($-V)*(K-H)&&($-V)*(Q-H)>=(Z-V)*(J-H)&&(Z-V)*(K-H)>=(q-V)*(Q-H)}function $w($,J){return $.next.i!==J.i&&$.prev.i!==J.i&&!Jw($,J)&&(g6($,J)&&g6(J,$)&&Zw($,J)&&(O0($.prev,$,J.prev)||O0($,J.prev,J))||Y$($,J)&&O0($.prev,$,$.next)>0&&O0(J.prev,J,J.next)>0)}function O0($,J,Z){return(J.y-$.y)*(Z.x-J.x)-(J.x-$.x)*(Z.y-J.y)}function Y$($,J){return $.x===J.x&&$.y===J.y}function OK($,J,Z,Q){var q=z$(O0($,J,Z)),K=z$(O0($,J,Q)),V=z$(O0(Z,Q,$)),H=z$(O0(Z,Q,J));if(q!==K&&V!==H)return!0;if(q===0&&W$($,Z,J))return!0;if(K===0&&W$($,Q,J))return!0;if(V===0&&W$(Z,$,Q))return!0;if(H===0&&W$(Z,J,Q))return!0;return!1}function W$($,J,Z){return J.x<=Math.max($.x,Z.x)&&J.x>=Math.min($.x,Z.x)&&J.y<=Math.max($.y,Z.y)&&J.y>=Math.min($.y,Z.y)}function z$($){return $>0?1:$<0?-1:0}function Jw($,J){var Z=$;do{if(Z.i!==$.i&&Z.next.i!==$.i&&Z.i!==J.i&&Z.next.i!==J.i&&OK(Z,Z.next,$,J))return!0;Z=Z.next}while(Z!==$);return!1}function g6($,J){return O0($.prev,$,$.next)<0?O0($,J,$.next)>=0&&O0($,$.prev,J)>=0:O0($,J,$.prev)<0||O0($,$.next,J)<0}function Zw($,J){var Z=$,Q=!1,q=($.x+J.x)/2,K=($.y+J.y)/2;do{if(Z.y>K!==Z.next.y>K&&Z.next.y!==Z.y&&q<(Z.next.x-Z.x)*(K-Z.y)/(Z.next.y-Z.y)+Z.x)Q=!Q;Z=Z.next}while(Z!==$);return Q}function jK($,J){var Z=new CJ($.i,$.x,$.y),Q=new CJ(J.i,J.x,J.y),q=$.next,K=J.prev;return $.next=J,J.prev=$,Z.next=q,q.prev=Z,Q.next=Z,Z.prev=Q,K.next=Q,Q.prev=K,Q}function IK($,J,Z,Q){var q=new CJ($,J,Z);if(!Q)q.prev=q,q.next=q;else q.next=Q.next,q.prev=Q,Q.next.prev=q,Q.next=q;return q}function x6($){if($.next.prev=$.prev,$.prev.next=$.next,$.prevZ)$.prevZ.nextZ=$.nextZ;if($.nextZ)$.nextZ.prevZ=$.prevZ}function CJ($,J,Z){this.i=$,this.x=J,this.y=Z,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}G$.deviation=function($,J,Z,Q){var q=J&&J.length,K=q?J[0]*Z:$.length,V=Math.abs(NJ($,0,K,Z));if(q)for(var H=0,X=J.length;H<X;H++){var W=J[H]*Z,z=H<X-1?J[H+1]*Z:$.length;V-=Math.abs(NJ($,W,z,Z))}var G=0;for(H=0;H<Q.length;H+=3){var Y=Q[H]*Z,w=Q[H+1]*Z,U=Q[H+2]*Z;G+=Math.abs(($[Y]-$[U])*($[w+1]-$[Y+1])-($[Y]-$[w])*($[U+1]-$[Y+1]))}return V===0&&G===0?0:Math.abs((G-V)/V)};function NJ($,J,Z,Q){var q=0;for(var K=J,V=Z-Q;K<Z;K+=Q)q+=($[V]-$[K])*($[K+1]+$[V+1]),V=K;return q}G$.flatten=function($){var J=$[0][0].length,Z={vertices:[],holes:[],dimensions:J},Q=0;for(var q=0;q<$.length;q++){for(var K=0;K<$[q].length;K++)for(var V=0;V<J;V++)Z.vertices.push($[q][K][V]);if(q>0)Q+=$[q-1].length,Z.holes.push(Q)}return Z}});var KH=A((SC)=>{SC.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer!=="undefined";SC.SYMBOL_SUPPORT=typeof Symbol!=="undefined"});var N0=A((Gp,HH)=>{var VH=KH(),vC=VH.ARRAY_BUFFER_SUPPORT,yC=VH.SYMBOL_SUPPORT;HH.exports=function $(J,Z){var Q,q,K,V,H;if(!J)throw new Error("obliterator/forEach: invalid iterable.");if(typeof Z!=="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(J)||vC&&ArrayBuffer.isView(J)||typeof J==="string"||J.toString()==="[object Arguments]"){for(K=0,V=J.length;K<V;K++)Z(J[K],K);return}if(typeof J.forEach==="function"){J.forEach(Z);return}if(yC&&Symbol.iterator in J&&typeof J.next!=="function")J=J[Symbol.iterator]();if(typeof J.next==="function"){Q=J,K=0;while(H=Q.next(),H.done!==!0)Z(H.value,K),K++;return}for(q in J)if(J.hasOwnProperty(q))Z(J[q],q);return}});var y9=A((uC)=>{var gC=function($,J){if($<J)return-1;if($>J)return 1;return 0},xC=function($,J){if($<J)return 1;if($>J)return-1;return 0};function cC($){return function(J,Z){return $(Z,J)}}function mC($){if($===2)return function(J,Z){if(J[0]<Z[0])return-1;if(J[0]>Z[0])return 1;if(J[1]<Z[1])return-1;if(J[1]>Z[1])return 1;return 0};return function(J,Z){var Q=0;while(Q<$){if(J[Q]<Z[Q])return-1;if(J[Q]>Z[Q])return 1;Q++}return 0}}uC.DEFAULT_COMPARATOR=gC;uC.DEFAULT_REVERSE_COMPARATOR=xC;uC.reverseComparator=cC;uC.createTupleComparator=mC});var w1=A(($N)=>{var oC=Math.pow(2,8)-1,sC=Math.pow(2,16)-1,iC=Math.pow(2,32)-1,aC=Math.pow(2,7)-1,rC=Math.pow(2,15)-1,tC=Math.pow(2,31)-1;$N.getPointerArray=function($){var J=$-1;if(J<=oC)return Uint8Array;if(J<=sC)return Uint16Array;if(J<=iC)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")};$N.getSignedPointerArray=function($){var J=$-1;if(J<=aC)return Int8Array;if(J<=rC)return Int16Array;if(J<=tC)return Int32Array;return Float64Array};$N.getNumberType=function($){if($===($|0))if(Math.sign($)===-1){if($<=127&&$>=-128)return Int8Array;if($<=32767&&$>=-32768)return Int16Array;return Int32Array}else{if($<=255)return Uint8Array;if($<=65535)return Uint16Array;return Uint32Array}return Float64Array};var eC={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};$N.getMinimalRepresentation=function($,J){var Z=null,Q=0,q,K,V,H,X;for(H=0,X=$.length;H<X;H++)if(V=J?J($[H]):$[H],K=$N.getNumberType(V),q=eC[K.name],q>Q)Q=q,Z=K;return Z};$N.isTypedArray=function($){return typeof ArrayBuffer!=="undefined"&&ArrayBuffer.isView($)};$N.concat=function(){var $=0,J,Z,Q;for(J=0,Q=arguments.length;J<Q;J++)$+=arguments[J].length;var q=new arguments[0].constructor($);for(J=0,Z=0;J<Q;J++)q.set(arguments[J],Z),Z+=arguments[J].length;return q};$N.indices=function($){var J=$N.getPointerArray($),Z=new J($);for(var Q=0;Q<$;Q++)Z[Q]=Q;return Z}});var D1=A((WN)=>{var zH=N0(),GH=w1();function VN($){return Array.isArray($)||GH.isTypedArray($)}function zZ($){if(typeof $.length==="number")return $.length;if(typeof $.size==="number")return $.size;return}function HN($){var J=zZ($),Z=typeof J==="number"?new Array(J):[],Q=0;return zH($,function(q){Z[Q++]=q}),Z}function XN($){var J=zZ($),Z=typeof J==="number"?GH.getPointerArray(J):Array,Q=typeof J==="number"?new Array(J):[],q=typeof J==="number"?new Z(J):[],K=0;return zH($,function(V){Q[K]=V,q[K]=K++}),[Q,q]}WN.isArrayLike=VN;WN.guessLength=zZ;WN.toArray=HN;WN.toArrayWithIndices=XN});var E7=A((Cp,CH)=>{var A7=N0(),YH=y9(),C8=D1(),M7=YH.DEFAULT_COMPARATOR,GZ=YH.reverseComparator;function YZ($,J,Z,Q){var q=J[Q],K,V;while(Q>Z){if(K=Q-1>>1,V=J[K],$(q,V)<0){J[Q]=V,Q=K;continue}break}J[Q]=q}function g9($,J,Z){var Q=J.length,q=Z,K=J[Z],V=2*Z+1,H;while(V<Q){if(H=V+1,H<Q&&$(J[V],J[H])>=0)V=H;J[Z]=J[V],Z=V,V=2*Z+1}J[Z]=K,YZ($,J,q,Z)}function wH($,J,Z){J.push(Z),YZ($,J,0,J.length-1)}function wZ($,J){var Z=J.pop();if(J.length!==0){var Q=J[0];return J[0]=Z,g9($,J,0),Q}return Z}function w6($,J,Z){if(J.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var Q=J[0];return J[0]=Z,g9($,J,0),Q}function UH($,J,Z){var Q;if(J.length!==0&&$(J[0],Z)<0)Q=J[0],J[0]=Z,Z=Q,g9($,J,0);return Z}function E5($,J){var Z=J.length,Q=Z>>1,q=Q;while(--q>=0)g9($,J,q)}function UZ($,J){var Z=J.length,Q=0,q=new Array(Z);while(Q<Z)q[Q++]=wZ($,J);return q}function UN($,J,Z){if(arguments.length===2)Z=J,J=$,$=M7;var Q=GZ($),q,K,V,H=1/0,X;if(J===1){if(C8.isArrayLike(Z)){for(q=0,K=Z.length;q<K;q++)if(V=Z[q],H===1/0||$(V,H)<0)H=V;return X=new Z.constructor(1),X[0]=H,X}return A7(Z,function(z){if(H===1/0||$(z,H)<0)H=z}),[H]}if(C8.isArrayLike(Z)){if(J>=Z.length)return Z.slice().sort($);X=Z.slice(0,J),E5(Q,X);for(q=J,K=Z.length;q<K;q++)if(Q(Z[q],X[0])>0)w6(Q,X,Z[q]);return X.sort($)}var W=C8.guessLength(Z);if(W!==null&&W<J)J=W;if(X=new Array(J),q=0,A7(Z,function(z){if(q<J)X[q]=z;else{if(q===J)E5(Q,X);if(Q(z,X[0])>0)w6(Q,X,z)}q++}),X.length>q)X.length=q;return X.sort($)}function CN($,J,Z){if(arguments.length===2)Z=J,J=$,$=M7;var Q=GZ($),q,K,V,H=-1/0,X;if(J===1){if(C8.isArrayLike(Z)){for(q=0,K=Z.length;q<K;q++)if(V=Z[q],H===-1/0||$(V,H)>0)H=V;return X=new Z.constructor(1),X[0]=H,X}return A7(Z,function(z){if(H===-1/0||$(z,H)>0)H=z}),[H]}if(C8.isArrayLike(Z)){if(J>=Z.length)return Z.slice().sort(Q);X=Z.slice(0,J),E5($,X);for(q=J,K=Z.length;q<K;q++)if($(Z[q],X[0])>0)w6($,X,Z[q]);return X.sort(Q)}var W=C8.guessLength(Z);if(W!==null&&W<J)J=W;if(X=new Array(J),q=0,A7(Z,function(z){if(q<J)X[q]=z;else{if(q===J)E5($,X);if($(z,X[0])>0)w6($,X,z)}q++}),X.length>q)X.length=q;return X.sort(Q)}function X0($){if(this.clear(),this.comparator=$||M7,typeof this.comparator!=="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}X0.prototype.clear=function(){this.items=[],this.size=0};X0.prototype.push=function($){return wH(this.comparator,this.items,$),++this.size};X0.prototype.peek=function(){return this.items[0]};X0.prototype.pop=function(){if(this.size!==0)this.size--;return wZ(this.comparator,this.items)};X0.prototype.replace=function($){return w6(this.comparator,this.items,$)};X0.prototype.pushpop=function($){return UH(this.comparator,this.items,$)};X0.prototype.consume=function(){return this.size=0,UZ(this.comparator,this.items)};X0.prototype.toArray=function(){return UZ(this.comparator,this.items.slice())};X0.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:X0,enumerable:!1}),$};if(typeof Symbol!=="undefined")X0.prototype[Symbol.for("nodejs.util.inspect.custom")]=X0.prototype.inspect;function R7($){if(this.clear(),this.comparator=$||M7,typeof this.comparator!=="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=GZ(this.comparator)}R7.prototype=X0.prototype;X0.from=function($,J){var Z=new X0(J),Q;if(C8.isArrayLike($))Q=$.slice();else Q=C8.toArray($);return E5(Z.comparator,Q),Z.items=Q,Z.size=Q.length,Z};R7.from=function($,J){var Z=new R7(J),Q;if(C8.isArrayLike($))Q=$.slice();else Q=C8.toArray($);return E5(Z.comparator,Q),Z.items=Q,Z.size=Q.length,Z};X0.siftUp=g9;X0.siftDown=YZ;X0.push=wH;X0.pop=wZ;X0.replace=w6;X0.pushpop=UH;X0.heapify=E5;X0.consume=UZ;X0.nsmallest=UN;X0.nlargest=CN;X0.MinHeap=X0;X0.MaxHeap=R7;CH.exports=X0});var CZ=A((Np,_H)=>{var NH=y9(),BH=N0(),IH=NH.DEFAULT_COMPARATOR,NN=NH.reverseComparator;function U1($){if(this.clear(),this.comparator=$||IH,typeof this.comparator!=="function")throw new Error("mnemonist/FibonacciHeap.constructor: given comparator should be a function.")}U1.prototype.clear=function(){this.root=null,this.min=null,this.size=0};function BN($){return{item:$,degree:0}}function FH($,J){if(!$.root)$.root=J;else J.right=$.root.right,J.left=$.root,$.root.right.left=J,$.root.right=J}U1.prototype.push=function($){var J=BN($);if(J.left=J,J.right=J,FH(this,J),!this.min||this.comparator(J.item,this.min.item)<=0)this.min=J;return++this.size};U1.prototype.peek=function(){return this.min?this.min.item:void 0};function OH($){var J=[],Z=$,Q=!1;while(!0){if(Z===$&&Q)break;else if(Z===$)Q=!0;J.push(Z),Z=Z.right}return J}function jH($,J){if($.root===J)$.root=J.right;J.left.right=J.right,J.right.left=J.left}function IN($,J){if(!$.child)$.child=J;else J.right=$.child.right,J.left=$.child,$.child.right.left=J,$.child.right=J}function FN($,J,Z){jH($,J),J.left=J,J.right=J,IN(Z,J),Z.degree++,J.parent=Z}function ON($){var J=new Array($.size),Z=OH($.root),Q,q,K,V,H,X;for(Q=0,q=Z.length;Q<q;Q++){K=Z[Q],H=K.degree;while(J[H]){if(V=J[H],$.comparator(K.item,V.item)>0)X=K,K=V,V=X;FN($,V,K),J[H]=null,H++}J[H]=K}for(Q=0;Q<$.size;Q++)if(J[Q]&&$.comparator(J[Q].item,$.min.item)<=0)$.min=J[Q]}U1.prototype.pop=function(){if(!this.size)return;var $=this.min;if($.child){var J=OH($.child),Z,Q,q;for(Q=0,q=J.length;Q<q;Q++)Z=J[Q],FH(this,Z),delete Z.parent}if(jH(this,$),$===$.right)this.min=null,this.root=null;else this.min=$.right,ON(this);return this.size--,$.item};U1.prototype.inspect=function(){var $={size:this.size};if(this.min&&"item"in this.min)$.top=this.min.item;return Object.defineProperty($,"constructor",{value:U1,enumerable:!1}),$};if(typeof Symbol!=="undefined")U1.prototype[Symbol.for("nodejs.util.inspect.custom")]=U1.prototype.inspect;function h7($){if(this.clear(),this.comparator=$||IH,typeof this.comparator!=="function")throw new Error("mnemonist/FibonacciHeap.constructor: given comparator should be a function.");this.comparator=NN(this.comparator)}h7.prototype=U1.prototype;U1.from=function($,J){var Z=new U1(J);return BH($,function(Q){Z.push(Q)}),Z};h7.from=function($,J){var Z=new h7(J);return BH($,function(Q){Z.push(Q)}),Z};U1.MinFibonacciHeap=U1;U1.MaxFibonacciHeap=h7;_H.exports=U1});var AH=A((Bp,kH)=>{var PH="\x01";function DH($,J,Z){var Q=J.length,q=[],K=Q,V=-1,H,X=0,W;while(K--)V=Math.max($[J[K]+Z],V);W=V>>24&&32||V>>16&&24||V>>8&&16||8;for(;X<W;X+=4){for(K=16;K--;)q[K]=[];for(K=Q;K--;)q[$[J[K]+Z]>>X&15].push(J[K]);for(H=0;H<16;H++)for(V=q[H].length;V--;)J[++K]=q[H][V]}}function jN($,J,Z,Q){return $[Z]-$[Q]||(Z%3===2?$[Z+1]-$[Q+1]||J[Z+2]-J[Q+2]:J[Z+1]-J[Q+1])}function NZ($,J){var Z=[],Q=[],q=2*J/3|0,K=J-q,V=q+1>>1,H=q,X=0,W,z=[],G=[];if(J===1)return[0];while(H--)Z[H]=(H*3>>1)+1;for(H=3;H--;)DH($,Z,H);X=Q[(Z[0]/3|0)+(Z[0]%3===1?0:V)]=1;for(H=1;H<q;H++){if($[Z[H]]!==$[Z[H-1]]||$[Z[H]+1]!==$[Z[H-1]+1]||$[Z[H]+2]!==$[Z[H-1]+2])X++;Q[(Z[H]/3|0)+(Z[H]%3===1?0:V)]=X}if(X<q){Q=NZ(Q,q);for(H=q;H--;)Z[H]=Q[H]<V?Q[H]*3+1:(Q[H]-V)*3+2}for(H=q;H--;)z[Z[H]]=H;z[J]=-1,z[J+1]=-2,Q=J%3===1?[J-1]:[];for(H=0;H<q;H++)if(Z[H]%3===1)Q.push(Z[H]-1);DH($,Q,0);for(H=0,X=0,W=0;H<q&&X<K;)G[W++]=jN($,z,Z[H],Q[X])<0?Z[H++]:Q[X++];while(H<q)G[W++]=Z[H++];while(X<K)G[W++]=Q[X++];return G}function LH($){var J=$.length,Z=J%3,Q=new Array(J+Z),q,K;if(typeof $!=="string"){var V=Object.create(null);for(K=0;K<J;K++)if(!V[$[K]])V[$[K]]=!0;var H=Object.create(null),X=Object.keys(V).sort();for(K=0,q=X.length;K<q;K++)H[X[K]]=K+1;for(K=0;K<J;K++)Q[K]=H[$[K]]}else for(K=0;K<J;K++)Q[K]=$.charCodeAt(K);for(K=J;K<J+Z;K++)Q[K]=0;return Q}function $5($){this.hasArbitrarySequence=typeof $!=="string",this.string=$,this.length=$.length,this.array=NZ(LH($),this.length)}$5.prototype.toString=function(){return this.array.join(",")};$5.prototype.toJSON=function(){return this.array};$5.prototype.inspect=function(){var $=new Array(this.length);for(var J=0;J<this.length;J++)$[J]=this.string.slice(this.array[J]);return Object.defineProperty($,"constructor",{value:$5,enumerable:!1}),$};if(typeof Symbol!=="undefined")$5.prototype[Symbol.for("nodejs.util.inspect.custom")]=$5.prototype.inspect;function J5($){if(this.hasArbitrarySequence=typeof $[0]!=="string",this.size=$.length,this.hasArbitrarySequence){this.text=[];for(var J=0,Z=this.size;J<Z;J++)if(this.text.push.apply(this.text,$[J]),J<Z-1)this.text.push(PH)}else this.text=$.join(PH);this.firstLength=$[0].length,this.length=this.text.length,this.array=NZ(LH(this.text),this.length)}J5.prototype.longestCommonSubsequence=function(){var $=this.hasArbitrarySequence?[]:"",J,Z,Q,q,K;for(Z=1;Z<this.length;Z++){if(q=this.array[Z],K=this.array[Z-1],q<this.firstLength&&K<this.firstLength)continue;if(q>this.firstLength&&K>this.firstLength)continue;J=Math.min(this.length-q,this.length-K);for(Q=0;Q<J;Q++)if(this.text[q+Q]!==this.text[K+Q]){J=Q;break}if(J>$.length)$=this.text.slice(q,q+J)}return $};J5.prototype.toString=function(){return this.array.join(",")};J5.prototype.toJSON=function(){return this.array};J5.prototype.inspect=function(){var $=new Array(this.length);for(var J=0;J<this.length;J++)$[J]=this.text.slice(this.array[J]);return Object.defineProperty($,"constructor",{value:J5,enumerable:!1}),$};if(typeof Symbol!=="undefined")J5.prototype[Symbol.for("nodejs.util.inspect.custom")]=J5.prototype.inspect;$5.GeneralizedSuffixArray=J5;kH.exports=$5});var TH=A((Ip,hH)=>{var _N=N0();function $8($){this.size=0,this.items=new Map,this.inverse=$}function E1(){this.size=0,this.items=new Map,this.inverse=new $8(this)}function RH(){this.size=0,this.items.clear(),this.inverse.items.clear()}E1.prototype.clear=RH;$8.prototype.clear=RH;function MH($,J){if(this.items.has($)){var Z=this.items.get($);if(Z===J)return this;else this.inverse.items.delete(Z)}if(this.inverse.items.has(J)){var Q=this.inverse.items.get(J);if(Q===$)return this;else this.items.delete(Q)}return this.items.set($,J),this.inverse.items.set(J,$),this.size=this.items.size,this.inverse.size=this.inverse.items.size,this}E1.prototype.set=MH;$8.prototype.set=MH;function EH($){if(this.items.has($)){var J=this.items.get($);return this.items.delete($),this.inverse.items.delete(J),this.size=this.items.size,this.inverse.size=this.inverse.items.size,!0}return!1}E1.prototype.delete=EH;$8.prototype.delete=EH;var PN=["has","get","forEach","keys","values","entries"];PN.forEach(function($){E1.prototype[$]=$8.prototype[$]=function(){return Map.prototype[$].apply(this.items,arguments)}});if(typeof Symbol!=="undefined")E1.prototype[Symbol.iterator]=E1.prototype.entries,$8.prototype[Symbol.iterator]=$8.prototype.entries;E1.prototype.inspect=function(){var $={left:this.items,right:this.inverse.items};return Object.defineProperty($,"constructor",{value:E1,enumerable:!1}),$};if(typeof Symbol!=="undefined")E1.prototype[Symbol.for("nodejs.util.inspect.custom")]=E1.prototype.inspect;$8.prototype.inspect=function(){var $={left:this.inverse.items,right:this.items};return Object.defineProperty($,"constructor",{value:$8,enumerable:!1}),$};if(typeof Symbol!=="undefined")$8.prototype[Symbol.for("nodejs.util.inspect.custom")]=$8.prototype.inspect;E1.from=function($){var J=new E1;return _N($,function(Z,Q){J.set(Q,Z)}),J};hH.exports=E1});var u0=A((Fp,SH)=>{function N8($){if(typeof $!=="function")throw new Error("obliterator/iterator: expecting a function!");this.next=$}if(typeof Symbol!=="undefined")N8.prototype[Symbol.iterator]=function(){return this};N8.of=function(){var $=arguments,J=$.length,Z=0;return new N8(function(){if(Z>=J)return{done:!0};return{done:!1,value:$[Z++]}})};N8.empty=function(){var $=new N8(function(){return{done:!0}});return $};N8.fromSequence=function($){var J=0,Z=$.length;return new N8(function(){if(J>=Z)return{done:!0};return{done:!1,value:$[J++]}})};N8.is=function($){if($ instanceof N8)return!0;return typeof $==="object"&&$!==null&&typeof $.next==="function"};SH.exports=N8});var FZ=A((DN)=>{function bH($){return $|=$>>1,$|=$>>2,$|=$>>4,$|=$>>8,$|=$>>16,$&~($>>1)}DN.msb32=bH;function IZ($){return $|=$>>1,$|=$>>2,$|=$>>4,$&~($>>1)}DN.msb8=IZ;DN.test=function($,J){return $>>J&1};DN.criticalBit8=function($,J){return IZ($^J)};DN.criticalBit8Mask=function($,J){return~IZ($^J)>>>0&255};DN.testCriticalBit8=function($,J){return 1+($|J)>>8};DN.criticalBit32Mask=function($,J){return~bH($^J)>>>0&4294967295};DN.popcount=function($){return $-=$>>1&1431655765,$=($&858993459)+($>>2&858993459),$=$+($>>4)&252645135,$+=$>>8,$+=$>>16,$&127};var C6=new Uint8Array(Math.pow(2,8));for(U6=0,BZ=C6.length;U6<BZ;U6++)C6[U6]=DN.popcount(U6);var U6,BZ;DN.table8Popcount=function($){return C6[$&255]+C6[$>>8&255]+C6[$>>16&255]+C6[$>>24&255]}});var xH=A((jp,gH)=>{var yH=u0(),vH=FZ();function b0($){this.length=$,this.clear()}b0.prototype.clear=function(){this.size=0,this.array=new Uint32Array(Math.ceil(this.length/32))};b0.prototype.set=function($,J){var Z=$>>5,Q=$&31,q=this.array[Z],K;if(J===0||J===!1)K=this.array[Z]&=~(1<<Q);else K=this.array[Z]|=1<<Q;if(K=K>>>0,K>q)this.size++;else if(K<q)this.size--;return this};b0.prototype.reset=function($){var J=$>>5,Z=$&31,Q=this.array[J],q;if(q=this.array[J]&=~(1<<Z),q<Q)this.size--;return this};b0.prototype.flip=function($){var J=$>>5,Z=$&31,Q=this.array[J],q=this.array[J]^=1<<Z;if(q=q>>>0,q>Q)this.size++;else if(q<Q)this.size--;return this};b0.prototype.get=function($){var J=$>>5,Z=$&31;return this.array[J]>>Z&1};b0.prototype.test=function($){return Boolean(this.get($))};b0.prototype.rank=function($){if(this.size===0)return 0;var J=$>>5,Z=$&31,Q=0;for(var q=0;q<J;q++)Q+=vH.table8Popcount(this.array[q]);var K=this.array[J]&(1<<Z)-1;return Q+=vH.table8Popcount(K),Q};b0.prototype.select=function($){if(this.size===0)return-1;if($>=this.length)return-1;var J,Z=32,Q=0,q=0;for(var K=0,V=this.array.length;K<V;K++){if(J=this.array[K],J===0)continue;if(K===V-1)Z=this.length%32||32;for(var H=0;H<Z;H++,Q++)if(q+=J>>H&1,q===$)return Q}};b0.prototype.forEach=function($,J){J=arguments.length>1?J:this;var Z=this.length,Q,q,K=32;for(var V=0,H=this.array.length;V<H;V++){if(Q=this.array[V],V===H-1)K=Z%32||32;for(var X=0;X<K;X++)q=Q>>X&1,$.call(J,q,V*32+X)}};b0.prototype.values=function(){var $=this.length,J=!1,Z,Q,q=this.array,K=q.length,V=0,H=-1,X=32;return new yH(function W(){if(!J){if(V>=K)return{done:!0};if(V===K-1)X=$%32||32;Z=q[V++],J=!0,H=-1}if(H++,H>=X)return J=!1,W();return Q=Z>>H&1,{value:Q}})};b0.prototype.entries=function(){var $=this.length,J=!1,Z,Q,q=this.array,K,V=q.length,H=0,X=-1,W=32;return new yH(function z(){if(!J){if(H>=V)return{done:!0};if(H===V-1)W=$%32||32;Z=q[H++],J=!0,X=-1}if(X++,K=~-H*32+X,X>=W)return J=!1,z();return Q=Z>>X&1,{value:[K,Q]}})};if(typeof Symbol!=="undefined")b0.prototype[Symbol.iterator]=b0.prototype.values;b0.prototype.inspect=function(){var $=new Uint8Array(this.length);return this.forEach(function(J,Z){$[Z]=J}),Object.defineProperty($,"constructor",{value:b0,enumerable:!1}),$};if(typeof Symbol!=="undefined")b0.prototype[Symbol.for("nodejs.util.inspect.custom")]=b0.prototype.inspect;b0.prototype.toJSON=function(){return Array.from(this.array)};gH.exports=b0});var dH=A((_p,uH)=>{var mH=u0(),cH=FZ(),SN=function($){return Math.max(1,Math.ceil($*1.5))};function bN($){return new Uint32Array(Math.ceil($/32))}function B0($){var J=$||0,Z=SN;if(typeof $==="object")J=$.initialLength||$.initialCapacity||0,Z=$.policy||Z;this.size=0,this.length=J,this.capacity=Math.ceil(this.length/32)*32,this.policy=Z,this.array=bN(this.capacity)}B0.prototype.set=function($,J){if(this.length<$)throw new Error("BitVector.set: index out of bounds.");var Z=$>>5,Q=$&31,q=this.array[Z],K;if(J===0||J===!1)K=this.array[Z]&=~(1<<Q);else K=this.array[Z]|=1<<Q;if(K=K>>>0,K>q)this.size++;else if(K<q)this.size--;return this};B0.prototype.reset=function($){var J=$>>5,Z=$&31,Q=this.array[J],q;if(q=this.array[J]&=~(1<<Z),q<Q)this.size--;return this};B0.prototype.flip=function($){var J=$>>5,Z=$&31,Q=this.array[J],q=this.array[J]^=1<<Z;if(q=q>>>0,q>Q)this.size++;else if(q<Q)this.size--;return this};B0.prototype.applyPolicy=function($){var J=this.policy($||this.capacity);if(typeof J!=="number"||J<0)throw new Error("mnemonist/bit-vector.applyPolicy: policy returned an invalid value (expecting a positive integer).");if(J<=this.capacity)throw new Error("mnemonist/bit-vector.applyPolicy: policy returned a less or equal capacity to allocate.");return Math.ceil(J/32)*32};B0.prototype.reallocate=function($){var J=$;if($=Math.ceil($/32)*32,J<this.length)this.length=J;if($===this.capacity)return this;var Z=this.array,Q=$/32;if(Q===this.array.length)return this;if(Q>this.array.length)this.array=new Uint32Array(Q),this.array.set(Z,0);else this.array=Z.slice(0,Q);return this.capacity=$,this};B0.prototype.grow=function($){var J;if(typeof $==="number"){if(this.capacity>=$)return this;J=this.capacity;while(J<$)J=this.applyPolicy(J);return this.reallocate(J),this}return J=this.applyPolicy(),this.reallocate(J),this};B0.prototype.resize=function($){if($===this.length)return this;if($<this.length)return this.length=$,this;return this.length=$,this.reallocate($),this};B0.prototype.push=function($){if(this.capacity===this.length)this.grow();if($===0||$===!1)return++this.length;this.size++;var J=this.length++,Z=J>>5,Q=J&31;return this.array[Z]|=1<<Q,this.length};B0.prototype.pop=function(){if(this.length===0)return;var $=--this.length,J=$>>5,Z=$&31;return this.array[J]>>Z&1};B0.prototype.get=function($){if(this.length<$)return;var J=$>>5,Z=$&31;return this.array[J]>>Z&1};B0.prototype.test=function($){if(this.length<$)return!1;return Boolean(this.get($))};B0.prototype.rank=function($){if(this.size===0)return 0;var J=$>>5,Z=$&31,Q=0;for(var q=0;q<J;q++)Q+=cH.table8Popcount(this.array[q]);var K=this.array[J]&(1<<Z)-1;return Q+=cH.table8Popcount(K),Q};B0.prototype.select=function($){if(this.size===0)return-1;if($>=this.length)return-1;var J,Z=32,Q=0,q=0;for(var K=0,V=this.array.length;K<V;K++){if(J=this.array[K],J===0)continue;if(K===V-1)Z=this.length%32||32;for(var H=0;H<Z;H++,Q++)if(q+=J>>H&1,q===$)return Q}};B0.prototype.forEach=function($,J){J=arguments.length>1?J:this;var Z=this.length,Q,q,K=32;for(var V=0,H=this.array.length;V<H;V++){if(Q=this.array[V],V===H-1)K=Z%32||32;for(var X=0;X<K;X++)q=Q>>X&1,$.call(J,q,V*32+X)}};B0.prototype.values=function(){var $=this.length,J=!1,Z,Q,q=this.array,K=q.length,V=0,H=-1,X=32;return new mH(function W(){if(!J){if(V>=K)return{done:!0};if(V===K-1)X=$%32||32;Z=q[V++],J=!0,H=-1}if(H++,H>=X)return J=!1,W();return Q=Z>>H&1,{value:Q}})};B0.prototype.entries=function(){var $=this.length,J=!1,Z,Q,q=this.array,K,V=q.length,H=0,X=-1,W=32;return new mH(function z(){if(!J){if(H>=V)return{done:!0};if(H===V-1)W=$%32||32;Z=q[H++],J=!0,X=-1}if(X++,K=~-H*32+X,X>=W)return J=!1,z();return Q=Z>>X&1,{value:[K,Q]}})};if(typeof Symbol!=="undefined")B0.prototype[Symbol.iterator]=B0.prototype.values;B0.prototype.inspect=function(){var $=new Uint8Array(this.length);return this.forEach(function(J,Z){$[Z]=J}),Object.defineProperty($,"constructor",{value:B0,enumerable:!1}),$};if(typeof Symbol!=="undefined")B0.prototype[Symbol.for("nodejs.util.inspect.custom")]=B0.prototype.inspect;B0.prototype.toJSON=function(){return Array.from(this.array.slice(0,(this.length>>5)+1))};uH.exports=B0});var lH=A((Pp,pH)=>{function h5($,J){return($&65535)*J+((($>>>16)*J&65535)<<16)&4294967295}function fN($,J){return($&65535)+(J>>>16)+((($>>>16)+J&65535)<<16)&4294967295}function OZ($,J){return $<<J|$>>>32-J}pH.exports=function $(J,Z){var Q=3432918353,q=461845907,K=15,V=13,H=5,X=1801774676,W=J,z,G,Y;for(G=0,Y=Z.length-4;G<=Y;G+=4)z=Z[G]|Z[G+1]<<8|Z[G+2]<<16|Z[G+3]<<24,z=h5(z,Q),z=OZ(z,K),z=h5(z,q),W^=z,W=OZ(W,V),W=h5(W,H),W=fN(W,X);switch(z=0,Z.length&3){case 3:z^=Z[G+2]<<16;case 2:z^=Z[G+1]<<8;case 1:z^=Z[G],z=h5(z,Q),z=OZ(z,K),z=h5(z,q),W^=z;default:}return W^=Z.length,W^=W>>>16,W=h5(W,2246822507),W^=W>>>13,W=h5(W,3266489909),W^=W>>>16,W>>>0}});var iH=A((Dp,sH)=>{var vN=lH(),yN=N0(),gN=Math.LN2*Math.LN2,xN={errorRate:0.005};function nH($){var J=new Uint16Array($.length),Z,Q;for(Z=0,Q=$.length;Z<Q;Z++)J[Z]=$.charCodeAt(Z);return J}function oH($,J,Z){var Q=vN(J*4221880213&4294967295,Z);return Q%($*8)}function T5($){var J={};if(!$)throw new Error("mnemonist/BloomFilter.constructor: a BloomFilter must be created with a capacity.");if(typeof $==="object")J=$;else J.capacity=$;if(typeof J.capacity!=="number"||J.capacity<=0)throw new Error("mnemonist/BloomFilter.constructor: `capacity` option should be a positive integer.");if(this.capacity=J.capacity,this.errorRate=J.errorRate||xN.errorRate,typeof this.errorRate!=="number"||J.errorRate<=0)throw new Error("mnemonist/BloomFilter.constructor: `errorRate` option should be a positive float.");this.clear()}T5.prototype.clear=function(){var $=-1/gN*this.capacity*Math.log(this.errorRate),J=$/8|0;this.hashFunctions=J*8/this.capacity*Math.LN2|0,this.data=new Uint8Array(J);return};T5.prototype.add=function($){var J=nH($);for(var Z=0,Q=this.hashFunctions;Z<Q;Z++){var q=oH(this.data.length,Z,J),K=1<<(7&q);this.data[q>>3]|=K}return this};T5.prototype.test=function($){var J=nH($);for(var Z=0,Q=this.hashFunctions;Z<Q;Z++){var q=oH(this.data.length,Z,J);if(!(this.data[q>>3]&1<<(7&q)))return!1}return!0};T5.prototype.toJSON=function(){return this.data};T5.from=function($,J){if(!J){if(J=$.length||$.size,typeof J!=="number")throw new Error("BloomFilter.from: could not infer the filter's capacity. Try passing it as second argument.")}var Z=new T5(J);return yN($,function(Q){Z.add(Q)}),Z};sH.exports=T5});var rH=A((Lp,aH)=>{var cN=N0();function J8($){if(typeof $!=="function")throw new Error("mnemonist/BKTree.constructor: given `distance` should be a function.");this.distance=$,this.clear()}J8.prototype.add=function($){if(!this.root)return this.root={item:$,children:{}},this.size++,this;var J=this.root,Z;while(!0){if(Z=this.distance($,J.item),!J.children[Z])break;J=J.children[Z]}return J.children[Z]={item:$,children:{}},this.size++,this};J8.prototype.search=function($,J){if(!this.root)return[];var Z=[],Q=[this.root],q,K,V,H,X;while(Q.length){if(q=Q.pop(),V=this.distance(J,q.item),V<=$)Z.push({item:q.item,distance:V});for(H=V-$,X=V+$+1;H<X;H++)if(K=q.children[H],K)Q.push(K)}return Z};J8.prototype.clear=function(){this.size=0,this.root=null};J8.prototype.toJSON=function(){return this.root};J8.prototype.inspect=function(){var $=[],J=[this.root],Z,Q;while(J.length){if(Z=J.pop(),!Z)continue;$.push(Z.item);for(Q in Z.children)J.push(Z.children[Q])}return Object.defineProperty($,"constructor",{value:J8,enumerable:!1}),$};if(typeof Symbol!=="undefined")J8.prototype[Symbol.for("nodejs.util.inspect.custom")]=J8.prototype.inspect;J8.from=function($,J){var Z=new J8(J);return cN($,function(Q){Z.add(Q)}),Z};aH.exports=J8});var _Z=A((kp,eH)=>{var jZ=D1(),tH=u0();function k0($,J){if(arguments.length<2)throw new Error("mnemonist/fixed-deque: expecting an Array class and a capacity.");if(typeof J!=="number"||J<=0)throw new Error("mnemonist/fixed-deque: `capacity` should be a positive number.");this.ArrayClass=$,this.capacity=J,this.items=new $(this.capacity),this.clear()}k0.prototype.clear=function(){this.start=0,this.size=0};k0.prototype.push=function($){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.push: deque capacity ("+this.capacity+") exceeded!");var J=this.start+this.size;if(J>=this.capacity)J-=this.capacity;return this.items[J]=$,++this.size};k0.prototype.unshift=function($){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.unshift: deque capacity ("+this.capacity+") exceeded!");var J=this.start-1;if(this.start===0)J=this.capacity-1;return this.items[J]=$,this.start=J,++this.size};k0.prototype.pop=function(){if(this.size===0)return;this.size--;var $=this.start+this.size;if($>=this.capacity)$-=this.capacity;return this.items[$]};k0.prototype.shift=function(){if(this.size===0)return;var $=this.start;if(this.size--,this.start++,this.start===this.capacity)this.start=0;return this.items[$]};k0.prototype.peekFirst=function(){if(this.size===0)return;return this.items[this.start]};k0.prototype.peekLast=function(){if(this.size===0)return;var $=this.start+this.size-1;if($>=this.capacity)$-=this.capacity;return this.items[$]};k0.prototype.get=function($){if(this.size===0||$>=this.capacity)return;if($=this.start+$,$>=this.capacity)$-=this.capacity;return this.items[$]};k0.prototype.forEach=function($,J){J=arguments.length>1?J:this;var Z=this.capacity,Q=this.size,q=this.start,K=0;while(K<Q)if($.call(J,this.items[q],K,this),q++,K++,q===Z)q=0};k0.prototype.toArray=function(){var $=this.start+this.size;if($<this.capacity)return this.items.slice(this.start,$);var J=new this.ArrayClass(this.size),Z=this.capacity,Q=this.size,q=this.start,K=0;while(K<Q)if(J[K]=this.items[q],q++,K++,q===Z)q=0;return J};k0.prototype.values=function(){var $=this.items,J=this.capacity,Z=this.size,Q=this.start,q=0;return new tH(function(){if(q>=Z)return{done:!0};var K=$[Q];if(Q++,q++,Q===J)Q=0;return{value:K,done:!1}})};k0.prototype.entries=function(){var $=this.items,J=this.capacity,Z=this.size,Q=this.start,q=0;return new tH(function(){if(q>=Z)return{done:!0};var K=$[Q];if(Q++,Q===J)Q=0;return{value:[q++,K],done:!1}})};if(typeof Symbol!=="undefined")k0.prototype[Symbol.iterator]=k0.prototype.values;k0.prototype.inspect=function(){var $=this.toArray();return $.type=this.ArrayClass.name,$.capacity=this.capacity,Object.defineProperty($,"constructor",{value:k0,enumerable:!1}),$};if(typeof Symbol!=="undefined")k0.prototype[Symbol.for("nodejs.util.inspect.custom")]=k0.prototype.inspect;k0.from=function($,J,Z){if(arguments.length<3){if(Z=jZ.guessLength($),typeof Z!=="number")throw new Error("mnemonist/fixed-deque.from: could not guess iterable length. Please provide desired capacity as last argument.")}var Q=new k0(J,Z);if(jZ.isArrayLike($)){var q,K;for(q=0,K=$.length;q<K;q++)Q.items[q]=$[q];return Q.size=K,Q}return jZ.forEach($,function(V){Q.push(V)}),Q};eH.exports=k0});var ZX=A((Ap,JX)=>{var PZ=D1(),DZ=_Z();function N6($,J){if(arguments.length<2)throw new Error("mnemonist/circular-buffer: expecting an Array class and a capacity.");if(typeof J!=="number"||J<=0)throw new Error("mnemonist/circular-buffer: `capacity` should be a positive number.");this.ArrayClass=$,this.capacity=J,this.items=new $(this.capacity),this.clear()}function $X($){N6.prototype[$]=DZ.prototype[$]}Object.keys(DZ.prototype).forEach($X);if(typeof Symbol!=="undefined")Object.getOwnPropertySymbols(DZ.prototype).forEach($X);N6.prototype.push=function($){var J=this.start+this.size;if(J>=this.capacity)J-=this.capacity;if(this.items[J]=$,this.size===this.capacity){if(J++,J>=this.capacity)this.start=0;else this.start=J;return this.size}return++this.size};N6.prototype.unshift=function($){var J=this.start-1;if(this.start===0)J=this.capacity-1;if(this.items[J]=$,this.size===this.capacity)return this.start=J,this.size;return this.start=J,++this.size};N6.from=function($,J,Z){if(arguments.length<3){if(Z=PZ.guessLength($),typeof Z!=="number")throw new Error("mnemonist/circular-buffer.from: could not guess iterable length. Please provide desired capacity as last argument.")}var Q=new N6(J,Z);if(PZ.isArrayLike($)){var q,K;for(q=0,K=$.length;q<K;q++)Q.items[q]=$[q];return Q.size=K,Q}return PZ.forEach($,function(V){Q.push(V)}),Q};JX.exports=N6});var qX=A((Rp,QX)=>{function r0($){if(typeof $!=="function")throw new Error("mnemonist/DefaultMap.constructor: expecting a function.");this.items=new Map,this.factory=$,this.size=0}r0.prototype.clear=function(){this.items.clear(),this.size=0};r0.prototype.get=function($){var J=this.items.get($);if(typeof J==="undefined")J=this.factory($,this.size),this.items.set($,J),this.size++;return J};r0.prototype.peek=function($){return this.items.get($)};r0.prototype.set=function($,J){return this.items.set($,J),this.size=this.items.size,this};r0.prototype.has=function($){return this.items.has($)};r0.prototype.delete=function($){var J=this.items.delete($);return this.size=this.items.size,J};r0.prototype.forEach=function($,J){J=arguments.length>1?J:this,this.items.forEach($,J)};r0.prototype.entries=function(){return this.items.entries()};r0.prototype.keys=function(){return this.items.keys()};r0.prototype.values=function(){return this.items.values()};if(typeof Symbol!=="undefined")r0.prototype[Symbol.iterator]=r0.prototype.entries;r0.prototype.inspect=function(){return this.items};if(typeof Symbol!=="undefined")r0.prototype[Symbol.for("nodejs.util.inspect.custom")]=r0.prototype.inspect;r0.autoIncrement=function(){var $=0;return function(){return $++}};QX.exports=r0});var VX=A((Mp,KX)=>{function B8($){if(typeof $!=="function")throw new Error("mnemonist/DefaultWeakMap.constructor: expecting a function.");this.items=new WeakMap,this.factory=$}B8.prototype.clear=function(){this.items=new WeakMap};B8.prototype.get=function($){var J=this.items.get($);if(typeof J==="undefined")J=this.factory($),this.items.set($,J);return J};B8.prototype.peek=function($){return this.items.get($)};B8.prototype.set=function($,J){return this.items.set($,J),this};B8.prototype.has=function($){return this.items.has($)};B8.prototype.delete=function($){return this.items.delete($)};B8.prototype.inspect=function(){return this.items};if(typeof Symbol!=="undefined")B8.prototype[Symbol.for("nodejs.util.inspect.custom")]=B8.prototype.inspect;KX.exports=B8});var XX=A((Ep,HX)=>{var LZ=w1();function I8($){var J=LZ.getPointerArray($),Z=LZ.getPointerArray(Math.log2($));this.size=$,this.dimension=$,this.parents=new J($),this.ranks=new Z($);for(var Q=0;Q<$;Q++)this.parents[Q]=Q}I8.prototype.find=function($){var J=$,Z,Q;while(!0){if(Z=this.parents[J],J===Z)break;J=Z}while(!0){if(Q=this.parents[$],Q===J)break;this.parents[$]=J,$=Q}return J};I8.prototype.union=function($,J){var Z=this.find($),Q=this.find(J);if(Z===Q)return this;this.dimension--;var q=this.ranks[$],K=this.ranks[J];if(q<K)this.parents[Z]=Q;else if(q>K)this.parents[Q]=Z;else this.parents[Q]=Z,this.ranks[Z]++;return this};I8.prototype.connected=function($,J){var Z=this.find($);return Z===this.find(J)};I8.prototype.mapping=function(){var $=LZ.getPointerArray(this.dimension),J={},Z=new $(this.size),Q=0,q;for(var K=0,V=this.parents.length;K<V;K++)if(q=this.find(K),typeof J[q]==="undefined")Z[K]=Q,J[q]=Q++;else Z[K]=J[q];return Z};I8.prototype.compile=function(){var $={},J=new Array(this.dimension),Z=0,Q;for(var q=0,K=this.parents.length;q<K;q++)if(Q=this.find(q),typeof $[Q]==="undefined")J[Z]=[q],$[Q]=Z++;else J[$[Q]].push(q);return J};I8.prototype.inspect=function(){var $=this.compile();return Object.defineProperty($,"constructor",{value:I8,enumerable:!1}),$};if(typeof Symbol!=="undefined")I8.prototype[Symbol.for("nodejs.util.inspect.custom")]=I8.prototype.inspect;HX.exports=I8});var T7=A((hp,GX)=>{var WX=y9(),kZ=E7(),mN=WX.DEFAULT_COMPARATOR,uN=WX.reverseComparator;function dN($,J,Z,Q){var q=Z,K=Q,V=J[Q],H=2*Q+1,X;while(H<q){if(X=H+1,X<q&&$(J[H],J[X])>=0)H=X;J[Q]=J[H],Q=H,H=2*Q+1}J[Q]=V,kZ.siftDown($,J,K,Q)}function zX($,J,Z,Q){var q=Q,K=q,V=new $(Q),H,X;while(K>0){if(H=Z[--K],K!==0)X=Z[0],Z[0]=H,dN(J,Z,--Q,0),H=X;V[K]=H}return V}function F8($,J,Z){if(arguments.length===2)Z=J,J=null;if(this.ArrayClass=$,this.capacity=Z,this.items=new $(Z),this.clear(),this.comparator=J||mN,typeof Z!=="number"&&Z<=0)throw new Error("mnemonist/FixedReverseHeap.constructor: capacity should be a number > 0.");if(typeof this.comparator!=="function")throw new Error("mnemonist/FixedReverseHeap.constructor: given comparator should be a function.");this.comparator=uN(this.comparator)}F8.prototype.clear=function(){this.size=0};F8.prototype.push=function($){if(this.size<this.capacity)this.items[this.size]=$,kZ.siftDown(this.comparator,this.items,0,this.size),this.size++;else if(this.comparator($,this.items[0])>0)kZ.replace(this.comparator,this.items,$);return this.size};F8.prototype.peek=function(){return this.items[0]};F8.prototype.consume=function(){var $=zX(this.ArrayClass,this.comparator,this.items,this.size);return this.size=0,$};F8.prototype.toArray=function(){return zX(this.ArrayClass,this.comparator,this.items.slice(0,this.size),this.size)};F8.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:F8,enumerable:!1}),$};if(typeof Symbol!=="undefined")F8.prototype[Symbol.for("nodejs.util.inspect.custom")]=F8.prototype.inspect;GX.exports=F8});var UX=A((Tp,wX)=>{var pN=N0(),YX=function($){return $};function Q1($){if(this.items=new Map,this.clear(),Array.isArray($))this.writeHashFunction=$[0],this.readHashFunction=$[1];else this.writeHashFunction=$,this.readHashFunction=$;if(!this.writeHashFunction)this.writeHashFunction=YX;if(!this.readHashFunction)this.readHashFunction=YX;if(typeof this.writeHashFunction!=="function")throw new Error("mnemonist/FuzzyMap.constructor: invalid hash function given.");if(typeof this.readHashFunction!=="function")throw new Error("mnemonist/FuzzyMap.constructor: invalid hash function given.")}Q1.prototype.clear=function(){this.items.clear(),this.size=0};Q1.prototype.add=function($){var J=this.writeHashFunction($);return this.items.set(J,$),this.size=this.items.size,this};Q1.prototype.set=function($,J){return $=this.writeHashFunction($),this.items.set($,J),this.size=this.items.size,this};Q1.prototype.get=function($){return $=this.readHashFunction($),this.items.get($)};Q1.prototype.has=function($){return $=this.readHashFunction($),this.items.has($)};Q1.prototype.forEach=function($,J){J=arguments.length>1?J:this,this.items.forEach(function(Z){$.call(J,Z,Z)})};Q1.prototype.values=function(){return this.items.values()};if(typeof Symbol!=="undefined")Q1.prototype[Symbol.iterator]=Q1.prototype.values;Q1.prototype.inspect=function(){var $=Array.from(this.items.values());return Object.defineProperty($,"constructor",{value:Q1,enumerable:!1}),$};if(typeof Symbol!=="undefined")Q1.prototype[Symbol.for("nodejs.util.inspect.custom")]=Q1.prototype.inspect;Q1.from=function($,J,Z){var Q=new Q1(J);return pN($,function(q,K){if(Z)Q.set(K,q);else Q.add(q)}),Q};wX.exports=Q1});var AZ=A((Sp,CX)=>{var S7=u0(),lN=N0();function Y0($){this.Container=$||Array,this.items=new Map,this.clear(),Object.defineProperty(this.items,"constructor",{value:Y0,enumerable:!1})}Y0.prototype.clear=function(){this.size=0,this.dimension=0,this.items.clear()};Y0.prototype.set=function($,J){var Z=this.items.get($),Q;if(!Z)this.dimension++,Z=new this.Container,this.items.set($,Z);if(this.Container===Set){if(Q=Z.size,Z.add(J),Q<Z.size)this.size++}else Z.push(J),this.size++;return this};Y0.prototype.delete=function($){var J=this.items.get($);if(!J)return!1;return this.size-=this.Container===Set?J.size:J.length,this.dimension--,this.items.delete($),!0};Y0.prototype.remove=function($,J){var Z=this.items.get($),Q,q;if(!Z)return!1;if(this.Container===Set){if(Q=Z.delete(J),Q)this.size--;if(Z.size===0)this.items.delete($),this.dimension--;return Q}else{if(q=Z.indexOf(J),q===-1)return!1;if(this.size--,Z.length===1)return this.items.delete($),this.dimension--,!0;return Z.splice(q,1),!0}};Y0.prototype.has=function($){return this.items.has($)};Y0.prototype.get=function($){return this.items.get($)};Y0.prototype.multiplicity=function($){var J=this.items.get($);if(typeof J==="undefined")return 0;return this.Container===Set?J.size:J.length};Y0.prototype.count=Y0.prototype.multiplicity;Y0.prototype.forEach=function($,J){J=arguments.length>1?J:this;var Z;function Q(q){$.call(J,q,Z)}this.items.forEach(function(q,K){Z=K,q.forEach(Q)})};Y0.prototype.forEachAssociation=function($,J){J=arguments.length>1?J:this,this.items.forEach($,J)};Y0.prototype.keys=function(){return this.items.keys()};Y0.prototype.values=function(){var $=this.items.values(),J=!1,Z,Q,q,K;if(this.Container===Set)return new S7(function V(){if(!J){if(Q=$.next(),Q.done)return{done:!0};J=!0,Z=Q.value.values()}if(Q=Z.next(),Q.done)return J=!1,V();return{done:!1,value:Q.value}});return new S7(function V(){if(!J){if(Q=$.next(),Q.done)return{done:!0};J=!0,Z=Q.value,q=0,K=Z.length}if(q>=K)return J=!1,V();return{done:!1,value:Z[q++]}})};Y0.prototype.entries=function(){var $=this.items.entries(),J=!1,Z,Q,q,K,V;if(this.Container===Set)return new S7(function H(){if(!J){if(Q=$.next(),Q.done)return{done:!0};J=!0,q=Q.value[0],Z=Q.value[1].values()}if(Q=Z.next(),Q.done)return J=!1,H();return{done:!1,value:[q,Q.value]}});return new S7(function H(){if(!J){if(Q=$.next(),Q.done)return{done:!0};J=!0,q=Q.value[0],Z=Q.value[1],K=0,V=Z.length}if(K>=V)return J=!1,H();return{done:!1,value:[q,Z[K++]]}})};Y0.prototype.containers=function(){return this.items.values()};Y0.prototype.associations=function(){return this.items.entries()};if(typeof Symbol!=="undefined")Y0.prototype[Symbol.iterator]=Y0.prototype.entries;Y0.prototype.inspect=function(){return this.items};if(typeof Symbol!=="undefined")Y0.prototype[Symbol.for("nodejs.util.inspect.custom")]=Y0.prototype.inspect;Y0.prototype.toJSON=function(){return this.items};Y0.from=function($,J){var Z=new Y0(J);return lN($,function(Q,q){Z.set(q,Q)}),Z};CX.exports=Y0});var IX=A((bp,BX)=>{var nN=AZ(),oN=N0(),NX=function($){return $};function q1($,J){if(this.items=new nN(J),this.clear(),Array.isArray($))this.writeHashFunction=$[0],this.readHashFunction=$[1];else this.writeHashFunction=$,this.readHashFunction=$;if(!this.writeHashFunction)this.writeHashFunction=NX;if(!this.readHashFunction)this.readHashFunction=NX;if(typeof this.writeHashFunction!=="function")throw new Error("mnemonist/FuzzyMultiMap.constructor: invalid hash function given.");if(typeof this.readHashFunction!=="function")throw new Error("mnemonist/FuzzyMultiMap.constructor: invalid hash function given.")}q1.prototype.clear=function(){this.items.clear(),this.size=0,this.dimension=0};q1.prototype.add=function($){var J=this.writeHashFunction($);return this.items.set(J,$),this.size=this.items.size,this.dimension=this.items.dimension,this};q1.prototype.set=function($,J){return $=this.writeHashFunction($),this.items.set($,J),this.size=this.items.size,this.dimension=this.items.dimension,this};q1.prototype.get=function($){return $=this.readHashFunction($),this.items.get($)};q1.prototype.has=function($){return $=this.readHashFunction($),this.items.has($)};q1.prototype.forEach=function($,J){J=arguments.length>1?J:this,this.items.forEach(function(Z){$.call(J,Z,Z)})};q1.prototype.values=function(){return this.items.values()};if(typeof Symbol!=="undefined")q1.prototype[Symbol.iterator]=q1.prototype.values;q1.prototype.inspect=function(){var $=Array.from(this);return Object.defineProperty($,"constructor",{value:q1,enumerable:!1}),$};if(typeof Symbol!=="undefined")q1.prototype[Symbol.for("nodejs.util.inspect.custom")]=q1.prototype.inspect;q1.from=function($,J,Z,Q){if(arguments.length===3){if(typeof Z==="boolean")Q=Z,Z=Array}var q=new q1(J,Z);return oN($,function(K,V){if(Q)q.set(V,K);else q.add(K)}),q};BX.exports=q1});var jX=A((fp,OX)=>{var FX=1024;function sN($){return($&$-1)===0}function Z8($,J){if(arguments.length<1)throw new Error("mnemonist/hashed-array-tree: expecting at least a byte array constructor.");var Z=J||0,Q=FX,q=0;if(typeof J==="object")Z=J.initialCapacity||0,q=J.initialLength||0,Q=J.blockSize||FX;if(!Q||!sN(Q))throw new Error("mnemonist/hashed-array-tree: block size should be a power of two.");var K=Math.max(q,Z),V=Math.ceil(K/Q);this.ArrayClass=$,this.length=q,this.capacity=V*Q,this.blockSize=Q,this.offsetMask=Q-1,this.blockMask=Math.log2(Q),this.blocks=new Array(V);for(var H=0;H<V;H++)this.blocks[H]=new this.ArrayClass(this.blockSize)}Z8.prototype.set=function($,J){if(this.length<$)throw new Error("HashedArrayTree("+this.ArrayClass.name+").set: index out of bounds.");var Z=$>>this.blockMask,Q=$&this.offsetMask;return this.blocks[Z][Q]=J,this};Z8.prototype.get=function($){if(this.length<$)return;var J=$>>this.blockMask,Z=$&this.offsetMask;return this.blocks[J][Z]};Z8.prototype.grow=function($){if(typeof $!=="number")$=this.capacity+this.blockSize;if(this.capacity>=$)return this;while(this.capacity<$)this.blocks.push(new this.ArrayClass(this.blockSize)),this.capacity+=this.blockSize;return this};Z8.prototype.resize=function($){if($===this.length)return this;if($<this.length)return this.length=$,this;return this.length=$,this.grow($),this};Z8.prototype.push=function($){if(this.capacity===this.length)this.grow();var J=this.length,Z=J>>this.blockMask,Q=J&this.offsetMask;return this.blocks[Z][Q]=$,++this.length};Z8.prototype.pop=function(){if(this.length===0)return;var $=this.blocks[this.blocks.length-1],J=--this.length&this.offsetMask;return $[J]};Z8.prototype.inspect=function(){var $=new this.ArrayClass(this.length),J;for(var Z=0,Q=this.length;Z<Q;Z++)J=Z>>this.blockMask,$[Z]=this.blocks[J][Z&this.offsetMask];return $.type=this.ArrayClass.name,$.items=this.length,$.capacity=this.capacity,$.blockSize=this.blockSize,Object.defineProperty($,"constructor",{value:Z8,enumerable:!1}),$};if(typeof Symbol!=="undefined")Z8.prototype[Symbol.for("nodejs.util.inspect.custom")]=Z8.prototype.inspect;OX.exports=Z8});var MZ=A((vp,PX)=>{var _X=u0(),RZ=D1();function f0($,J){if(arguments.length<2)throw new Error("mnemonist/fixed-stack: expecting an Array class and a capacity.");if(typeof J!=="number"||J<=0)throw new Error("mnemonist/fixed-stack: `capacity` should be a positive number.");this.capacity=J,this.ArrayClass=$,this.items=new this.ArrayClass(this.capacity),this.clear()}f0.prototype.clear=function(){this.size=0};f0.prototype.push=function($){if(this.size===this.capacity)throw new Error("mnemonist/fixed-stack.push: stack capacity ("+this.capacity+") exceeded!");return this.items[this.size++]=$,this.size};f0.prototype.pop=function(){if(this.size===0)return;return this.items[--this.size]};f0.prototype.peek=function(){return this.items[this.size-1]};f0.prototype.forEach=function($,J){J=arguments.length>1?J:this;for(var Z=0,Q=this.items.length;Z<Q;Z++)$.call(J,this.items[Q-Z-1],Z,this)};f0.prototype.toArray=function(){var $=new this.ArrayClass(this.size),J=this.size-1,Z=this.size;while(Z--)$[Z]=this.items[J-Z];return $};f0.prototype.values=function(){var $=this.items,J=this.size,Z=0;return new _X(function(){if(Z>=J)return{done:!0};var Q=$[J-Z-1];return Z++,{value:Q,done:!1}})};f0.prototype.entries=function(){var $=this.items,J=this.size,Z=0;return new _X(function(){if(Z>=J)return{done:!0};var Q=$[J-Z-1];return{value:[Z++,Q],done:!1}})};if(typeof Symbol!=="undefined")f0.prototype[Symbol.iterator]=f0.prototype.values;f0.prototype.toString=function(){return this.toArray().join(",")};f0.prototype.toJSON=function(){return this.toArray()};f0.prototype.inspect=function(){var $=this.toArray();return $.type=this.ArrayClass.name,$.capacity=this.capacity,Object.defineProperty($,"constructor",{value:f0,enumerable:!1}),$};if(typeof Symbol!=="undefined")f0.prototype[Symbol.for("nodejs.util.inspect.custom")]=f0.prototype.inspect;f0.from=function($,J,Z){if(arguments.length<3){if(Z=RZ.guessLength($),typeof Z!=="number")throw new Error("mnemonist/fixed-stack.from: could not guess iterable length. Please provide desired capacity as last argument.")}var Q=new f0(J,Z);if(RZ.isArrayLike($)){var q,K;for(q=0,K=$.length;q<K;q++)Q.items[q]=$[q];return Q.size=K,Q}return RZ.forEach($,function(V){Q.push(V)}),Q};PX.exports=f0});var LX=A((yp,DX)=>{var iN=D1(),aN=w1(),rN=MZ();function EZ($,J,Z,Q,q,K,V,H){var X=V+(H-V)/2|0,W=~-X,z=-~X,G=Z[X];Q[K]=G+1;var Y=J?J($[G]):$[G][1],w=K*2+1,U=K*2+2,C=-1/0,N=-1/0;if(V<=W)C=EZ($,J,Z,Q,q,w,V,W);if(z<=H)N=EZ($,J,Z,Q,q,U,z,H);var O=Math.max(Y,C,N),I=G;if(O===C)I=q[Q[w]-1];else if(O===N)I=q[Q[U]-1];return q[G]=I,O}function O8($,J){this.size=$.length,this.intervals=$;var Z=null,Q=null;if(Array.isArray(J))Z=J[0],Q=J[1];var q=$.length,K=aN.getPointerArray(q+1),V=new K(q),H;for(H=1;H<q;H++)V[H]=H;V.sort(function(Y,w){if(Y=$[Y],w=$[w],Z)Y=Z(Y),w=Z(w);else Y=Y[0],w=w[0];if(Y<w)return-1;if(Y>w)return 1;return 0});var X=Math.ceil(Math.log2(q+1)),W=Math.pow(2,X)-1,z=new K(W),G=new K(q);EZ($,Q,V,z,G,0,0,q-1),V=null,this.height=X,this.tree=z,this.augmentations=G,this.startGetter=Z,this.endGetter=Q,this.stack=new rN(K,this.height)}O8.prototype.intervalsContainingPoint=function($){var J=[],Z=this.stack;Z.clear(),Z.push(0);var Q=this.tree.length,q,K,V,H,X,W,z,G,Y;while(Z.size){if(q=Z.pop(),K=this.tree[q]-1,V=this.intervals[K],H=this.intervals[this.augmentations[K]],z=this.endGetter?this.endGetter(H):H[1],$>z)continue;if(G=q*2+1,G<Q&&this.tree[G]!==0)Z.push(G);if(X=this.startGetter?this.startGetter(V):V[0],W=this.endGetter?this.endGetter(V):V[1],$>=X&&$<=W)J.push(V);if($<X)continue;if(Y=q*2+2,Y<Q&&this.tree[Y]!==0)Z.push(Y)}return J};O8.prototype.intervalsOverlappingInterval=function($){var J=this.startGetter?this.startGetter($):$[0],Z=this.endGetter?this.endGetter($):$[1],Q=[],q=this.stack;q.clear(),q.push(0);var K=this.tree.length,V,H,X,W,z,G,Y,w,U;while(q.size){if(V=q.pop(),H=this.tree[V]-1,X=this.intervals[H],W=this.intervals[this.augmentations[H]],Y=this.endGetter?this.endGetter(W):W[1],J>Y)continue;if(w=V*2+1,w<K&&this.tree[w]!==0)q.push(w);if(z=this.startGetter?this.startGetter(X):X[0],G=this.endGetter?this.endGetter(X):X[1],Z>=z&&J<=G)Q.push(X);if(Z<z)continue;if(U=V*2+2,U<K&&this.tree[U]!==0)q.push(U)}return Q};O8.prototype.inspect=function(){var $=this.intervals.slice();return Object.defineProperty($,"constructor",{value:O8,enumerable:!1}),$};if(typeof Symbol!=="undefined")O8.prototype[Symbol.for("nodejs.util.inspect.custom")]=O8.prototype.inspect;O8.from=function($,J){if(iN.isArrayLike($))return new O8($,J);return new O8(Array.from($),J)};DX.exports=O8});var hZ=A((tN)=>{tN.search=function($,J,Z,Q){var q=0;Z=typeof Z!=="undefined"?Z:0,Q=typeof Q!=="undefined"?Q:$.length,Q--;var K;while(Z<=Q)if(q=Z+Q>>>1,K=$[q],K>J)Q=~-q;else if(K<J)Z=-~q;else return q;return-1};tN.searchWithComparator=function($,J,Z){var Q=0,q=0,K=~-J.length,V;while(q<=K)if(Q=q+K>>>1,V=$(J[Q],Z),V>0)K=~-Q;else if(V<0)q=-~Q;else return Q;return-1};tN.lowerBound=function($,J,Z,Q){var q=0;Z=typeof Z!=="undefined"?Z:0,Q=typeof Q!=="undefined"?Q:$.length;while(Z<Q)if(q=Z+Q>>>1,J<=$[q])Q=q;else Z=-~q;return Z};tN.lowerBoundWithComparator=function($,J,Z){var Q=0,q=0,K=J.length;while(q<K)if(Q=q+K>>>1,$(Z,J[Q])<=0)K=Q;else q=-~Q;return q};tN.lowerBoundIndices=function($,J,Z,Q,q){var K=0;Q=typeof Q!=="undefined"?Q:0,q=typeof q!=="undefined"?q:$.length;while(Q<q)if(K=Q+q>>>1,Z<=$[J[K]])q=K;else Q=-~K;return Q};tN.upperBound=function($,J,Z,Q){var q=0;Z=typeof Z!=="undefined"?Z:0,Q=typeof Q!=="undefined"?Q:$.length;while(Z<Q)if(q=Z+Q>>>1,J>=$[q])Z=-~q;else Q=q;return Z};tN.upperBoundWithComparator=function($,J,Z){var Q=0,q=0,K=J.length;while(q<K)if(Q=q+K>>>1,$(Z,J[Q])>=0)q=-~Q;else K=Q;return q}});var hX=A((XB)=>{var B6=w1(),I6=D1().isArrayLike,S5=hZ(),kX=CZ();function AX($,J){if($.length===0)return J.slice();if(J.length===0)return $.slice();var Z;if($[0]>J[0])Z=$,$=J,J=Z;var Q=$[$.length-1],q=J[0];if(Q<=q){if(B6.isTypedArray($))return B6.concat($,J);return $.concat(J)}var K=new $.constructor($.length+J.length),V,H,X;for(V=0,H=$.length;V<H;V++)if(X=$[V],X<=q)K[V]=X;else break;var W=V,z=$.length,G=0,Y=J.length,w,U;while(W<z&&G<Y)if(w=$[W],U=J[G],w<=U)K[V++]=w,W++;else K[V++]=U,G++;while(W<z)K[V++]=$[W++];while(G<Y)K[V++]=J[G++];return K}function RX($,J){if($.length===0)return J.slice();if(J.length===0)return $.slice();var Z;if($[0]>J[0])Z=$,$=J,J=Z;var Q=$[$.length-1],q=J[0];if(Q<q){if(B6.isTypedArray($))return B6.concat($,J);return $.concat(J)}var K=new $.constructor,V,H,X;for(V=0,H=$.length;V<H;V++)if(X=$[V],X<q)K.push(X);else break;var W=V,z=$.length,G=0,Y=J.length,w,U;while(W<z&&G<Y)if(w=$[W],U=J[G],w<=U){if(K.length===0||K[K.length-1]!==w)K.push(w);W++}else{if(K.length===0||K[K.length-1]!==U)K.push(U);G++}while(W<z)if(w=$[W++],K.length===0||K[K.length-1]!==w)K.push(w);while(G<Y)if(U=J[G++],K.length===0||K[K.length-1]!==U)K.push(U);return K}XB.intersectionUniqueArrays=function($,J){if($.length===0||J.length===0)return new $.constructor(0);var Z;if($[0]>J[0])Z=$,$=J,J=Z;var Q=$[$.length-1],q=J[0];if(Q<q)return new $.constructor(0);var K=new $.constructor,V=S5.lowerBound($,q),H=$.length,X=0,W=S5.upperBound(J,Q),z,G;while(V<H&&X<W)if(z=$[V],G=J[X],z<G)V=S5.lowerBound($,G,V+1);else if(z>G)X=S5.lowerBound(J,z,X+1);else K.push(z),V++,X++;return K};function VB($){var J=0,Z=-1/0,Q,q,K,V=[];for(q=0,K=$.length;q<K;q++){if(Q=$[q].length,Q===0)continue;if(V.push($[q]),J+=Q,Q>Z)Z=Q}if(V.length===0)return new $[0].constructor(0);if(V.length===1)return V[0].slice();if(V.length===2)return AX(V[0],V[1]);$=V;var H=new $[0].constructor(J),X=B6.getPointerArray(Z),W=new X($.length),z=new kX(function(w,U){if(w=$[w][W[w]],U=$[U][W[U]],w<U)return-1;if(w>U)return 1;return 0});for(q=0;q<K;q++)z.push(q);q=0;var G,Y;while(z.size)if(G=z.pop(),Y=$[G][W[G]++],H[q++]=Y,W[G]<$[G].length)z.push(G);return H}function HB($){var J=-1/0,Z,Q,q,K=[];for(Q=0,q=$.length;Q<q;Q++){if(Z=$[Q].length,Z===0)continue;if(K.push($[Q]),Z>J)J=Z}if(K.length===0)return new $[0].constructor(0);if(K.length===1)return K[0].slice();if(K.length===2)return RX(K[0],K[1]);$=K;var V=new $[0].constructor,H=B6.getPointerArray(J),X=new H($.length),W=new kX(function(Y,w){if(Y=$[Y][X[Y]],w=$[w][X[w]],Y<w)return-1;if(Y>w)return 1;return 0});for(Q=0;Q<q;Q++)W.push(Q);var z,G;while(W.size){if(z=W.pop(),G=$[z][X[z]++],V.length===0||V[V.length-1]!==G)V.push(G);if(X[z]<$[z].length)W.push(z)}return V}XB.kWayIntersectionUniqueArrays=function($){var J=-1/0,Z=-1/0,Q=1/0,q,K,V,H,X;for(H=0,X=$.length;H<X;H++){if(V=$[H].length,V===0)return[];if(V>J)J=V;if(q=$[H][0],K=$[H][V-1],q>Z)Z=q;if(K<Q)Q=K}if(Z>Q)return[];if(Z===Q)return[Z];var W,z,G=$[0],Y,w,U,C,N,O,I=Z;for(H=1;H<X;H++){W=G,z=$[H],G=new Array,Y=0,w=S5.lowerBound(z,I),U=W.length,C=z.length;while(Y<U&&w<C)if(N=W[Y],O=z[w],N<O)Y=S5.lowerBound(W,O,Y+1);else if(N>O)w=S5.lowerBound(z,N,w+1);else G.push(N),Y++,w++;if(G.length===0)return G;I=G[0]}return G};XB.merge=function(){if(arguments.length===2){if(I6(arguments[0]))return AX(arguments[0],arguments[1])}else if(I6(arguments[0]))return VB(arguments);return null};XB.unionUnique=function(){if(arguments.length===2){if(I6(arguments[0]))return RX(arguments[0],arguments[1])}else if(I6(arguments[0]))return HB(arguments);return null};XB.intersectionUnique=function(){if(arguments.length===2){if(I6(arguments[0]))return XB.intersectionUniqueArrays(arguments[0],arguments[1])}else if(I6(arguments[0]))return XB.kWayIntersectionUniqueArrays(arguments);return null}});var bX=A((cp,SX)=>{var YB=u0(),wB=N0(),UB=hX();function TX($){return $}function C1($){if(this.clear(),Array.isArray($))this.documentTokenizer=$[0],this.queryTokenizer=$[1];else this.documentTokenizer=$,this.queryTokenizer=$;if(!this.documentTokenizer)this.documentTokenizer=TX;if(!this.queryTokenizer)this.queryTokenizer=TX;if(typeof this.documentTokenizer!=="function")throw new Error("mnemonist/InvertedIndex.constructor: document tokenizer is not a function.");if(typeof this.queryTokenizer!=="function")throw new Error("mnemonist/InvertedIndex.constructor: query tokenizer is not a function.")}C1.prototype.clear=function(){this.items=[],this.mapping=new Map,this.size=0,this.dimension=0};C1.prototype.add=function($){this.size++;var J=this.items.length;this.items.push($);var Z=this.documentTokenizer($);if(!Array.isArray(Z))throw new Error("mnemonist/InvertedIndex.add: tokenizer function should return an array of tokens.");var Q=new Set,q,K;for(var V=0,H=Z.length;V<H;V++){if(q=Z[V],Q.has(q))continue;if(Q.add(q),K=this.mapping.get(q),!K)K=[],this.mapping.set(q,K);K.push(J)}return this.dimension=this.mapping.size,this};C1.prototype.get=function($){if(!this.size)return[];var J=this.queryTokenizer($);if(!Array.isArray(J))throw new Error("mnemonist/InvertedIndex.query: tokenizer function should return an array of tokens.");if(!J.length)return[];var Z=this.mapping.get(J[0]),Q,q,K;if(typeof Z==="undefined"||Z.length===0)return[];if(J.length>1)for(q=1,K=J.length;q<K;q++){if(Q=this.mapping.get(J[q]),typeof Q==="undefined"||Q.length===0)return[];Z=UB.intersectionUniqueArrays(Z,Q)}var V=new Array(Z.length);for(q=0,K=V.length;q<K;q++)V[q]=this.items[Z[q]];return V};C1.prototype.forEach=function($,J){J=arguments.length>1?J:this;for(var Z=0,Q=this.documents.length;Z<Q;Z++)$.call(J,this.documents[Z],Z,this)};C1.prototype.documents=function(){var $=this.items,J=$.length,Z=0;return new YB(function(){if(Z>=J)return{done:!0};var Q=$[Z++];return{value:Q,done:!1}})};C1.prototype.tokens=function(){return this.mapping.keys()};if(typeof Symbol!=="undefined")C1.prototype[Symbol.iterator]=C1.prototype.documents;C1.prototype.inspect=function(){var $=this.items.slice();return Object.defineProperty($,"constructor",{value:C1,enumerable:!1}),$};if(typeof Symbol!=="undefined")C1.prototype[Symbol.for("nodejs.util.inspect.custom")]=C1.prototype.inspect;C1.from=function($,J){var Z=new C1(J);return wB($,function(Q){Z.add(Q)}),Z};SX.exports=C1});var TZ=A((BB)=>{var d0=new Float64Array(64),L0=new Float64Array(64);function CB($,J,Z){var Q,q,K,V,H;d0[0]=J,L0[0]=Z,q=0;while(q>=0)if(K=d0[q],V=L0[q]-1,K<V){Q=$[K];while(K<V){while($[V]>=Q&&K<V)V--;if(K<V)$[K++]=$[V];while($[K]<=Q&&K<V)K++;if(K<V)$[V--]=$[K]}if($[K]=Q,d0[q+1]=K+1,L0[q+1]=L0[q],L0[q++]=K,L0[q]-d0[q]>L0[q-1]-d0[q-1])H=d0[q],d0[q]=d0[q-1],d0[q-1]=H,H=L0[q],L0[q]=L0[q-1],L0[q-1]=H}else q--;return $}BB.inplaceQuickSort=CB;function NB($,J,Z,Q){var q,K,V,H,X,W;d0[0]=Z,L0[0]=Q,K=0;while(K>=0)if(V=d0[K],H=L0[K]-1,V<H){X=J[V],q=$[X];while(V<H){while($[J[H]]>=q&&V<H)H--;if(V<H)J[V++]=J[H];while($[J[V]]<=q&&V<H)V++;if(V<H)J[H--]=J[V]}if(J[V]=X,d0[K+1]=V+1,L0[K+1]=L0[K],L0[K++]=V,L0[K]-d0[K]>L0[K-1]-d0[K-1])W=d0[K],d0[K]=d0[K-1],d0[K-1]=W,W=L0[K],L0[K]=L0[K-1],L0[K-1]=W}else K--;return J}BB.inplaceQuickSortIndices=NB});var xX=A((up,gX)=>{var OB=D1(),b7=w1(),fX=y9().createTupleComparator,vX=T7(),jB=TZ().inplaceQuickSortIndices;function SZ($,J,Z,Q){var q,K=0,V;for(q=0;q<$;q++)V=J[q][Z]-Q[q],K+=V*V;return K}function _B($,J){var Z=J.length,Q=new Array($),q=new Array(Z),K,V=b7.getPointerArray(Z),H=new V(Z),X,W,z,G=!0;for(X=0;X<$;X++){K=new Float64Array(Z);for(W=0;W<Z;W++)if(z=J[W],K[W]=z[1][X],G)q[W]=z[0],H[W]=W;G=!1,Q[X]=K}return{axes:Q,ids:H,labels:q}}function yX($,J,Z,Q){var q=Q.length,K=b7.getPointerArray(q+1),V=new K(q),H=new K(q),X=new K(q),W=[[0,0,Z.length,-1,0]],z,G,Y,w,U,C,N,O,I=0;while(W.length!==0){if(z=W.pop(),O=z[0],C=z[1],N=z[2],G=z[3],Y=z[4],jB(J[O],Z,C,N),q=N-C,w=C+(q>>>1),U=Z[w],V[I]=U,G>-1)if(Y===0)H[G]=I+1;else X[G]=I+1;if(O=(O+1)%$,w!==C&&w!==N-1)W.push([O,w+1,N,I,1]);if(w!==C)W.push([O,C,w,I,0]);I++}return{axes:J,labels:Q,pivots:V,lefts:H,rights:X}}function p1($,J){this.dimensions=$,this.visited=0,this.axes=J.axes,this.labels=J.labels,this.pivots=J.pivots,this.lefts=J.lefts,this.rights=J.rights,this.size=this.labels.length}p1.prototype.nearestNeighbor=function($){var J=1/0,Z=null,Q=this.dimensions,q=this.axes,K=this.pivots,V=this.lefts,H=this.rights,X=0;function W(z,G){X++;var Y=V[G],w=H[G],U=K[G],C=SZ(Q,q,U,$);if(C<J){if(Z=U,J=C,C===0)return}var N=q[z][U]-$[z];if(z=(z+1)%Q,N>0){if(Y!==0)W(z,Y-1)}else if(w!==0)W(z,w-1);if(N*N<J){if(N>0){if(w!==0)W(z,w-1)}else if(Y!==0)W(z,Y-1)}}return W(0,0),this.visited=X,this.labels[Z]};var PB=fX(3),DB=fX(2);p1.prototype.kNearestNeighbors=function($,J){if($<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");if($=Math.min($,this.size),$===1)return[this.nearestNeighbor(J)];var Z=new vX(Array,PB,$),Q=this.dimensions,q=this.axes,K=this.pivots,V=this.lefts,H=this.rights,X=0;function W(Y,w){var U=V[w],C=H[w],N=K[w],O=SZ(Q,q,N,J);Z.push([O,X++,N]);var I=J[Y],B=q[Y][N],F=I-B;if(Y=(Y+1)%Q,I<B){if(U!==0)W(Y,U-1)}else if(C!==0)W(Y,C-1);if(F*F<Z.peek()[0]||Z.size<$){if(I<B){if(C!==0)W(Y,C-1)}else if(U!==0)W(Y,U-1)}}W(0,0),this.visited=X;var z=Z.consume();for(var G=0;G<z.length;G++)z[G]=this.labels[z[G][2]];return z};p1.prototype.linearKNearestNeighbors=function($,J){if($<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");$=Math.min($,this.size);var Z=new vX(Array,DB,$),Q,q,K;for(Q=0,q=this.size;Q<q;Q++)K=SZ(this.dimensions,this.axes,this.pivots[Q],J),Z.push([K,Q]);var V=Z.consume();for(Q=0;Q<V.length;Q++)V[Q]=this.labels[this.pivots[V[Q][1]]];return V};p1.prototype.inspect=function(){var $=new Map;$.dimensions=this.dimensions,Object.defineProperty($,"constructor",{value:p1,enumerable:!1});var J,Z,Q;for(J=0;J<this.size;J++){Q=new Array(this.dimensions);for(Z=0;Z<this.dimensions;Z++)Q[Z]=this.axes[Z][J];$.set(this.labels[J],Q)}return $};if(typeof Symbol!=="undefined")p1.prototype[Symbol.for("nodejs.util.inspect.custom")]=p1.prototype.inspect;p1.from=function($,J){var Z=OB.toArray($),Q=_B(J,Z),q=yX(J,Q.axes,Q.ids,Q.labels);return new p1(J,q)};p1.fromAxes=function($,J){if(!J)J=b7.indices($[0].length);var Z=$.length,Q=yX($.length,$,b7.indices(J.length),J);return new p1(Z,Q)};gX.exports=p1});var uX=A((dp,mX)=>{var cX=u0(),LB=N0();function _0(){this.clear()}_0.prototype.clear=function(){this.head=null,this.tail=null,this.size=0};_0.prototype.first=function(){return this.head?this.head.item:void 0};_0.prototype.peek=_0.prototype.first;_0.prototype.last=function(){return this.tail?this.tail.item:void 0};_0.prototype.push=function($){var J={item:$,next:null};if(!this.head)this.head=J,this.tail=J;else this.tail.next=J,this.tail=J;return this.size++,this.size};_0.prototype.unshift=function($){var J={item:$,next:null};if(!this.head)this.head=J,this.tail=J;else{if(!this.head.next)this.tail=this.head;J.next=this.head,this.head=J}return this.size++,this.size};_0.prototype.shift=function(){if(!this.size)return;var $=this.head;return this.head=$.next,this.size--,$.item};_0.prototype.forEach=function($,J){if(!this.size)return;J=arguments.length>1?J:this;var Z=this.head,Q=0;while(Z)$.call(J,Z.item,Q,this),Z=Z.next,Q++};_0.prototype.toArray=function(){if(!this.size)return[];var $=new Array(this.size);for(var J=0,Z=this.size,Q=this.head;J<Z;J++)$[J]=Q.item,Q=Q.next;return $};_0.prototype.values=function(){var $=this.head;return new cX(function(){if(!$)return{done:!0};var J=$.item;return $=$.next,{value:J,done:!1}})};_0.prototype.entries=function(){var $=this.head,J=0;return new cX(function(){if(!$)return{done:!0};var Z=$.item;return $=$.next,J++,{value:[J-1,Z],done:!1}})};if(typeof Symbol!=="undefined")_0.prototype[Symbol.iterator]=_0.prototype.values;_0.prototype.toString=function(){return this.toArray().join(",")};_0.prototype.toJSON=function(){return this.toArray()};_0.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:_0,enumerable:!1}),$};if(typeof Symbol!=="undefined")_0.prototype[Symbol.for("nodejs.util.inspect.custom")]=_0.prototype.inspect;_0.from=function($){var J=new _0;return LB($,function(Z){J.push(Z)}),J};mX.exports=_0});var f7=A((pp,dX)=>{var bZ=u0(),kB=N0(),AB=w1(),RB=D1();function T0($,J,Z){if(arguments.length<2)Z=$,$=null,J=null;if(this.capacity=Z,typeof this.capacity!=="number"||this.capacity<=0)throw new Error("mnemonist/lru-cache: capacity should be positive number.");else if(!isFinite(this.capacity)||Math.floor(this.capacity)!==this.capacity)throw new Error("mnemonist/lru-cache: capacity should be a finite positive integer.");var Q=AB.getPointerArray(Z);this.forward=new Q(Z),this.backward=new Q(Z),this.K=typeof $==="function"?new $(Z):new Array(Z),this.V=typeof J==="function"?new J(Z):new Array(Z),this.size=0,this.head=0,this.tail=0,this.items={}}T0.prototype.clear=function(){this.size=0,this.head=0,this.tail=0,this.items={}};T0.prototype.splayOnTop=function($){var J=this.head;if(this.head===$)return this;var Z=this.backward[$],Q=this.forward[$];if(this.tail===$)this.tail=Z;else this.backward[Q]=Z;return this.forward[Z]=Q,this.backward[J]=$,this.head=$,this.forward[$]=J,this};T0.prototype.set=function($,J){var Z=this.items[$];if(typeof Z!=="undefined"){this.splayOnTop(Z),this.V[Z]=J;return}if(this.size<this.capacity)Z=this.size++;else Z=this.tail,this.tail=this.backward[Z],delete this.items[this.K[Z]];this.items[$]=Z,this.K[Z]=$,this.V[Z]=J,this.forward[Z]=this.head,this.backward[this.head]=Z,this.head=Z};T0.prototype.setpop=function($,J){var Z=null,Q=null,q=this.items[$];if(typeof q!=="undefined")return this.splayOnTop(q),Z=this.V[q],this.V[q]=J,{evicted:!1,key:$,value:Z};if(this.size<this.capacity)q=this.size++;else q=this.tail,this.tail=this.backward[q],Z=this.V[q],Q=this.K[q],delete this.items[Q];if(this.items[$]=q,this.K[q]=$,this.V[q]=J,this.forward[q]=this.head,this.backward[this.head]=q,this.head=q,Q)return{evicted:!0,key:Q,value:Z};else return null};T0.prototype.has=function($){return $ in this.items};T0.prototype.get=function($){var J=this.items[$];if(typeof J==="undefined")return;return this.splayOnTop(J),this.V[J]};T0.prototype.peek=function($){var J=this.items[$];if(typeof J==="undefined")return;return this.V[J]};T0.prototype.forEach=function($,J){J=arguments.length>1?J:this;var Z=0,Q=this.size,q=this.head,K=this.K,V=this.V,H=this.forward;while(Z<Q)$.call(J,V[q],K[q],this),q=H[q],Z++};T0.prototype.keys=function(){var $=0,J=this.size,Z=this.head,Q=this.K,q=this.forward;return new bZ(function(){if($>=J)return{done:!0};var K=Q[Z];if($++,$<J)Z=q[Z];return{done:!1,value:K}})};T0.prototype.values=function(){var $=0,J=this.size,Z=this.head,Q=this.V,q=this.forward;return new bZ(function(){if($>=J)return{done:!0};var K=Q[Z];if($++,$<J)Z=q[Z];return{done:!1,value:K}})};T0.prototype.entries=function(){var $=0,J=this.size,Z=this.head,Q=this.K,q=this.V,K=this.forward;return new bZ(function(){if($>=J)return{done:!0};var V=Q[Z],H=q[Z];if($++,$<J)Z=K[Z];return{done:!1,value:[V,H]}})};if(typeof Symbol!=="undefined")T0.prototype[Symbol.iterator]=T0.prototype.entries;T0.prototype.inspect=function(){var $=new Map,J=this.entries(),Z;while(Z=J.next(),!Z.done)$.set(Z.value[0],Z.value[1]);return Object.defineProperty($,"constructor",{value:T0,enumerable:!1}),$};if(typeof Symbol!=="undefined")T0.prototype[Symbol.for("nodejs.util.inspect.custom")]=T0.prototype.inspect;T0.from=function($,J,Z,Q){if(arguments.length<2){if(Q=RB.guessLength($),typeof Q!=="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else if(arguments.length===2)Q=J,J=null,Z=null;var q=new T0(J,Z,Q);return kB($,function(K,V){q.set(V,K)}),q};dX.exports=T0});var lX=A((lp,pX)=>{var F6=f7(),MB=N0(),EB=w1(),hB=D1();function j8($,J,Z){if(arguments.length<2)F6.call(this,$);else F6.call(this,$,J,Z);var Q=EB.getPointerArray(this.capacity);this.deleted=new Q(this.capacity),this.deletedSize=0}for(v7 in F6.prototype)j8.prototype[v7]=F6.prototype[v7];var v7;if(typeof Symbol!=="undefined")j8.prototype[Symbol.iterator]=F6.prototype[Symbol.iterator];j8.prototype.clear=function(){F6.prototype.clear.call(this),this.deletedSize=0};j8.prototype.set=function($,J){var Z=this.items[$];if(typeof Z!=="undefined"){this.splayOnTop(Z),this.V[Z]=J;return}if(this.size<this.capacity){if(this.deletedSize>0)Z=this.deleted[--this.deletedSize];else Z=this.size;this.size++}else Z=this.tail,this.tail=this.backward[Z],delete this.items[this.K[Z]];this.items[$]=Z,this.K[Z]=$,this.V[Z]=J,this.forward[Z]=this.head,this.backward[this.head]=Z,this.head=Z};j8.prototype.setpop=function($,J){var Z=null,Q=null,q=this.items[$];if(typeof q!=="undefined")return this.splayOnTop(q),Z=this.V[q],this.V[q]=J,{evicted:!1,key:$,value:Z};if(this.size<this.capacity){if(this.deletedSize>0)q=this.deleted[--this.deletedSize];else q=this.size;this.size++}else q=this.tail,this.tail=this.backward[q],Z=this.V[q],Q=this.K[q],delete this.items[Q];if(this.items[$]=q,this.K[q]=$,this.V[q]=J,this.forward[q]=this.head,this.backward[this.head]=q,this.head=q,Q)return{evicted:!0,key:Q,value:Z};else return null};j8.prototype.delete=function($){var J=this.items[$];if(typeof J==="undefined")return!1;if(delete this.items[$],this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,!0;var Z=this.backward[J],Q=this.forward[J];if(this.head===J)this.head=Q;if(this.tail===J)this.tail=Z;return this.forward[Z]=Q,this.backward[Q]=Z,this.size--,this.deleted[this.deletedSize++]=J,!0};j8.prototype.remove=function($,J=void 0){var Z=this.items[$];if(typeof Z==="undefined")return J;var Q=this.V[Z];if(delete this.items[$],this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,Q;var q=this.backward[Z],K=this.forward[Z];if(this.head===Z)this.head=K;if(this.tail===Z)this.tail=q;return this.forward[q]=K,this.backward[K]=q,this.size--,this.deleted[this.deletedSize++]=Z,Q};j8.from=function($,J,Z,Q){if(arguments.length<2){if(Q=hB.guessLength($),typeof Q!=="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else if(arguments.length===2)Q=J,J=null,Z=null;var q=new j8(J,Z,Q);return MB($,function(K,V){q.set(V,K)}),q};pX.exports=j8});var fZ=A((np,nX)=>{var O6=f7(),TB=N0(),SB=w1(),bB=D1();function t0($,J,Z){if(arguments.length<2)Z=$,$=null,J=null;if(this.capacity=Z,typeof this.capacity!=="number"||this.capacity<=0)throw new Error("mnemonist/lru-map: capacity should be positive number.");else if(!isFinite(this.capacity)||Math.floor(this.capacity)!==this.capacity)throw new Error("mnemonist/lru-map: capacity should be a finite positive integer.");var Q=SB.getPointerArray(Z);this.forward=new Q(Z),this.backward=new Q(Z),this.K=typeof $==="function"?new $(Z):new Array(Z),this.V=typeof J==="function"?new J(Z):new Array(Z),this.size=0,this.head=0,this.tail=0,this.items=new Map}t0.prototype.clear=function(){this.size=0,this.head=0,this.tail=0,this.items.clear()};t0.prototype.set=function($,J){var Z=this.items.get($);if(typeof Z!=="undefined"){this.splayOnTop(Z),this.V[Z]=J;return}if(this.size<this.capacity)Z=this.size++;else Z=this.tail,this.tail=this.backward[Z],this.items.delete(this.K[Z]);this.items.set($,Z),this.K[Z]=$,this.V[Z]=J,this.forward[Z]=this.head,this.backward[this.head]=Z,this.head=Z};t0.prototype.setpop=function($,J){var Z=null,Q=null,q=this.items.get($);if(typeof q!=="undefined")return this.splayOnTop(q),Z=this.V[q],this.V[q]=J,{evicted:!1,key:$,value:Z};if(this.size<this.capacity)q=this.size++;else q=this.tail,this.tail=this.backward[q],Z=this.V[q],Q=this.K[q],this.items.delete(Q);if(this.items.set($,q),this.K[q]=$,this.V[q]=J,this.forward[q]=this.head,this.backward[this.head]=q,this.head=q,Q)return{evicted:!0,key:Q,value:Z};else return null};t0.prototype.has=function($){return this.items.has($)};t0.prototype.get=function($){var J=this.items.get($);if(typeof J==="undefined")return;return this.splayOnTop(J),this.V[J]};t0.prototype.peek=function($){var J=this.items.get($);if(typeof J==="undefined")return;return this.V[J]};t0.prototype.splayOnTop=O6.prototype.splayOnTop;t0.prototype.forEach=O6.prototype.forEach;t0.prototype.keys=O6.prototype.keys;t0.prototype.values=O6.prototype.values;t0.prototype.entries=O6.prototype.entries;if(typeof Symbol!=="undefined")t0.prototype[Symbol.iterator]=t0.prototype.entries;t0.prototype.inspect=O6.prototype.inspect;t0.from=function($,J,Z,Q){if(arguments.length<2){if(Q=bB.guessLength($),typeof Q!=="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else if(arguments.length===2)Q=J,J=null,Z=null;var q=new t0(J,Z,Q);return TB($,function(K,V){q.set(V,K)}),q};nX.exports=t0});var sX=A((op,oX)=>{var j6=fZ(),fB=N0(),vB=w1(),yB=D1();function _8($,J,Z){if(arguments.length<2)j6.call(this,$);else j6.call(this,$,J,Z);var Q=vB.getPointerArray(this.capacity);this.deleted=new Q(this.capacity),this.deletedSize=0}for(y7 in j6.prototype)_8.prototype[y7]=j6.prototype[y7];var y7;if(typeof Symbol!=="undefined")_8.prototype[Symbol.iterator]=j6.prototype[Symbol.iterator];_8.prototype.clear=function(){j6.prototype.clear.call(this),this.deletedSize=0};_8.prototype.set=function($,J){var Z=this.items.get($);if(typeof Z!=="undefined"){this.splayOnTop(Z),this.V[Z]=J;return}if(this.size<this.capacity){if(this.deletedSize>0)Z=this.deleted[--this.deletedSize];else Z=this.size;this.size++}else Z=this.tail,this.tail=this.backward[Z],this.items.delete(this.K[Z]);this.items.set($,Z),this.K[Z]=$,this.V[Z]=J,this.forward[Z]=this.head,this.backward[this.head]=Z,this.head=Z};_8.prototype.setpop=function($,J){var Z=null,Q=null,q=this.items.get($);if(typeof q!=="undefined")return this.splayOnTop(q),Z=this.V[q],this.V[q]=J,{evicted:!1,key:$,value:Z};if(this.size<this.capacity){if(this.deletedSize>0)q=this.deleted[--this.deletedSize];else q=this.size;this.size++}else q=this.tail,this.tail=this.backward[q],Z=this.V[q],Q=this.K[q],this.items.delete(Q);if(this.items.set($,q),this.K[q]=$,this.V[q]=J,this.forward[q]=this.head,this.backward[this.head]=q,this.head=q,Q)return{evicted:!0,key:Q,value:Z};else return null};_8.prototype.delete=function($){var J=this.items.get($);if(typeof J==="undefined")return!1;if(this.items.delete($),this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,!0;var Z=this.backward[J],Q=this.forward[J];if(this.head===J)this.head=Q;if(this.tail===J)this.tail=Z;return this.forward[Z]=Q,this.backward[Q]=Z,this.size--,this.deleted[this.deletedSize++]=J,!0};_8.prototype.remove=function($,J=void 0){var Z=this.items.get($);if(typeof Z==="undefined")return J;var Q=this.V[Z];if(this.items.delete($),this.size===1)return this.size=0,this.head=0,this.tail=0,this.deletedSize=0,Q;var q=this.backward[Z],K=this.forward[Z];if(this.head===Z)this.head=K;if(this.tail===Z)this.tail=q;return this.forward[q]=K,this.backward[K]=q,this.size--,this.deleted[this.deletedSize++]=Z,Q};_8.from=function($,J,Z,Q){if(arguments.length<2){if(Q=yB.guessLength($),typeof Q!=="number")throw new Error("mnemonist/lru-map.from: could not guess iterable length. Please provide desired capacity as last argument.")}else if(arguments.length===2)Q=J,J=null,Z=null;var q=new _8(J,Z,Q);return fB($,function(K,V){q.set(V,K)}),q};oX.exports=_8});var aX=A((sp,iX)=>{var gB=u0(),xB=N0(),cB=T7(),mB=function($,J){if($[1]>J[1])return-1;if($[1]<J[1])return 1;return 0};function q0(){this.items=new Map,Object.defineProperty(this.items,"constructor",{value:q0,enumerable:!1}),this.clear()}q0.prototype.clear=function(){this.size=0,this.dimension=0,this.items.clear()};q0.prototype.add=function($,J){if(J===0)return this;if(J<0)return this.remove($,-J);if(J=J||1,typeof J!=="number")throw new Error("mnemonist/multi-set.add: given count should be a number.");this.size+=J;let Z=this.items.get($);if(Z===void 0)this.dimension++;else J+=Z;return this.items.set($,J),this};q0.prototype.set=function($,J){var Z;if(typeof J!=="number")throw new Error("mnemonist/multi-set.set: given count should be a number.");if(J<=0){if(Z=this.items.get($),typeof Z!=="undefined")this.size-=Z,this.dimension--;return this.items.delete($),this}if(J=J||1,Z=this.items.get($),typeof Z==="number")this.items.set($,Z+J);else this.dimension++,this.items.set($,J);return this.size+=J,this};q0.prototype.has=function($){return this.items.has($)};q0.prototype.delete=function($){var J=this.items.get($);if(J===0)return!1;return this.size-=J,this.dimension--,this.items.delete($),!0};q0.prototype.remove=function($,J){if(J===0)return;if(J<0)return this.add($,-J);if(J=J||1,typeof J!=="number")throw new Error("mnemonist/multi-set.remove: given count should be a number.");var Z=this.items.get($);if(typeof Z==="undefined")return;var Q=Math.max(0,Z-J);if(Q===0)this.items.delete($),this.size-=Z,this.dimension--;else this.items.set($,Q),this.size-=J;return};q0.prototype.edit=function($,J){var Z=this.multiplicity($);if(Z===0)return;var Q=this.multiplicity(J);return this.items.set(J,Z+Q),this.items.delete($),this};q0.prototype.multiplicity=function($){var J=this.items.get($);if(typeof J==="undefined")return 0;return J};q0.prototype.get=q0.prototype.multiplicity;q0.prototype.count=q0.prototype.multiplicity;q0.prototype.frequency=function($){if(this.size===0)return 0;var J=this.multiplicity($);return J/this.size};q0.prototype.top=function($){if(typeof $!=="number"||$<=0)throw new Error("mnemonist/multi-set.top: n must be a number > 0.");var J=new cB(Array,mB,$),Z=this.items.entries(),Q;while(Q=Z.next(),!Q.done)J.push(Q.value);return J.consume()};q0.prototype.forEach=function($,J){J=arguments.length>1?J:this;var Z;this.items.forEach(function(Q,q){for(Z=0;Z<Q;Z++)$.call(J,q,q)})};q0.prototype.forEachMultiplicity=function($,J){J=arguments.length>1?J:this,this.items.forEach($,J)};q0.prototype.keys=function(){return this.items.keys()};q0.prototype.values=function(){var $=this.items.entries(),J=!1,Z,Q,q,K;return new gB(function V(){if(!J){if(Z=$.next(),Z.done)return{done:!0};J=!0,Q=Z.value[0],q=Z.value[1],K=0}if(K>=q)return J=!1,V();return K++,{done:!1,value:Q}})};q0.prototype.multiplicities=function(){return this.items.entries()};if(typeof Symbol!=="undefined")q0.prototype[Symbol.iterator]=q0.prototype.values;q0.prototype.inspect=function(){return this.items};if(typeof Symbol!=="undefined")q0.prototype[Symbol.for("nodejs.util.inspect.custom")]=q0.prototype.inspect;q0.prototype.toJSON=function(){return this.items};q0.from=function($){var J=new q0;return xB($,function(Z){J.add(Z)}),J};q0.isSubset=function($,J){var Z=$.multiplicities(),Q,q,K;if($===J)return!0;if($.dimension>J.dimension)return!1;while(Q=Z.next(),!Q.done)if(q=Q.value[0],K=Q.value[1],J.multiplicity(q)<K)return!1;return!0};q0.isSuperset=function($,J){return q0.isSubset(J,$)};iX.exports=q0});var ZW=A((ip,JW)=>{var uB=u0(),dB=N0();function pB($,J,Z){return((Math.pow($,2)-Math.pow(Math.abs(J-Z),2))/2|0)+$+1}function lB($,J){var Z=0;for(var Q=0,q=J+1;Q<q;Q++)Z+=pB($,J,Q);return Z}function nB($,J){if($.length>J.length)return-1;if($.length<J.length)return 1;if($<J)return-1;if($>J)return 1;return 0}function rX($,J){var Z=$+1,Q=J/Z|0,q=Q+1,K,V,H=J-Q*Z,X=Z-H,W=new Array($+1);for(K=0;K<X;K++)W[K]=[K*Q,Q];var z=(K-1)*Q+Q;for(V=0;V<H;V++)W[K+V]=[z+V*q,q];return W}function tX($,J){var Z=J.length,Q=$+1,q=Z/Q|0,K=q+1,V,H,X,W=Z-q*Q,z=Q-W,G=new Array($+1);for(H=0;H<z;H++)V=H*q,G[H]=J.slice(V,V+q);var Y=(H-1)*q+q;for(X=0;X<W;X++)V=Y+X*K,G[H+X]=J.slice(V,V+K);return G}function oB($,J,Z){if(J===0)return 0;var Q=Z.length,q=$+1,K=Q/q|0,V=K+1,H=Q-K*q,X=q-H;if(J<=X-1)return J*K;var W=J-X;return X*K+W*V}function eX($,J,Z,Q,q,K){var V=q-Z,H=q+Z,X=$-Z,W=q+J-X,z=q+J+X,G=Q-K;return[Math.max(0,V,W),Math.min(H,z,G)]}function $W($,J,Z,Q,q,K){var V=J.length,H=V-Z,X=eX($,H,Q,V,q,K),W=X[0],z=X[1],G="",Y=[],w,U,C;for(U=W,C=z+1;U<C;U++){if(w=J.slice(U,U+K),w===G)continue;Y.push(w),G=w}return Y}function A0($,J){if(typeof $!=="function")throw new Error("mnemonist/passjoin-index: `levenshtein` should be a function returning edit distance between two strings.");if(typeof J!=="number"||J<1)throw new Error("mnemonist/passjoin-index: `k` should be a number > 0");this.levenshtein=$,this.k=J,this.clear()}A0.prototype.clear=function(){this.size=0,this.strings=[],this.invertedIndices={}};A0.prototype.add=function($){var J=$.length,Z=this.size;this.strings.push($),this.size++;var Q=tX(this.k,$),q=this.invertedIndices[J];if(typeof q==="undefined")q={},this.invertedIndices[J]=q;var K,V,H,X,W;for(X=0,W=Q.length;X<W;X++)if(K=Q[X],H=K+X,V=q[H],typeof V==="undefined")V=[Z],q[H]=V;else V.push(Z);return this};A0.prototype.search=function($){var J=$.length,Z=this.k,Q=new Set,q,K,V,H,X,W,z,G,Y,w,U,C,N,O,I;for(G=Math.max(0,J-Z),Y=J+Z+1;G<Y;G++){var B=this.invertedIndices[G];if(typeof B==="undefined")continue;z=rX(Z,G);for(w=0,U=z.length;w<U;w++){if(V=z[w][0],H=z[w][1],W=$W(Z,$,G,w,V,H),!W.length)W=[""];for(C=0,N=W.length;C<N;C++){if(X=W[C]+w,q=B[X],typeof q==="undefined")continue;for(O=0,I=q.length;O<I;O++)if(K=this.strings[q[O]],J<=Z&&G<=Z||!Q.has(K)&&this.levenshtein($,K)<=Z)Q.add(K)}}}return Q};A0.prototype.forEach=function($,J){J=arguments.length>1?J:this;for(var Z=0,Q=this.strings.length;Z<Q;Z++)$.call(J,this.strings[Z],Z,this)};A0.prototype.values=function(){var $=this.strings,J=$.length,Z=0;return new uB(function(){if(Z>=J)return{done:!0};var Q=$[Z];return Z++,{value:Q,done:!1}})};if(typeof Symbol!=="undefined")A0.prototype[Symbol.iterator]=A0.prototype.values;A0.prototype.inspect=function(){var $=this.strings.slice();return Object.defineProperty($,"constructor",{value:A0,enumerable:!1}),$};if(typeof Symbol!=="undefined")A0.prototype[Symbol.for("nodejs.util.inspect.custom")]=A0.prototype.inspect;A0.from=function($,J,Z){var Q=new A0(J,Z);return dB($,function(q){Q.add(q)}),Q};A0.countKeys=lB;A0.comparator=nB;A0.partition=rX;A0.segments=tX;A0.segmentPos=oB;A0.multiMatchAwareInterval=eX;A0.multiMatchAwareSubstrings=$W;JW.exports=A0});var KW=A((ap,qW)=>{var QW=u0(),sB=N0();function R0(){this.clear()}R0.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};R0.prototype.enqueue=function($){return this.items.push($),++this.size};R0.prototype.dequeue=function(){if(!this.size)return;var $=this.items[this.offset];if(++this.offset*2>=this.items.length)this.items=this.items.slice(this.offset),this.offset=0;return this.size--,$};R0.prototype.peek=function(){if(!this.size)return;return this.items[this.offset]};R0.prototype.forEach=function($,J){J=arguments.length>1?J:this;for(var Z=this.offset,Q=0,q=this.items.length;Z<q;Z++,Q++)$.call(J,this.items[Z],Q,this)};R0.prototype.toArray=function(){return this.items.slice(this.offset)};R0.prototype.values=function(){var $=this.items,J=this.offset;return new QW(function(){if(J>=$.length)return{done:!0};var Z=$[J];return J++,{value:Z,done:!1}})};R0.prototype.entries=function(){var $=this.items,J=this.offset,Z=0;return new QW(function(){if(J>=$.length)return{done:!0};var Q=$[J];return J++,{value:[Z++,Q],done:!1}})};if(typeof Symbol!=="undefined")R0.prototype[Symbol.iterator]=R0.prototype.values;R0.prototype.toString=function(){return this.toArray().join(",")};R0.prototype.toJSON=function(){return this.toArray()};R0.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:R0,enumerable:!1}),$};if(typeof Symbol!=="undefined")R0.prototype[Symbol.for("nodejs.util.inspect.custom")]=R0.prototype.inspect;R0.from=function($){var J=new R0;return sB($,function(Z){J.enqueue(Z)}),J};R0.of=function(){return R0.from(arguments)};qW.exports=R0});var XW=A((rp,HW)=>{var VW=u0(),iB=N0();function M0(){this.clear()}M0.prototype.clear=function(){this.items=[],this.size=0};M0.prototype.push=function($){return this.items.push($),++this.size};M0.prototype.pop=function(){if(this.size===0)return;return this.size--,this.items.pop()};M0.prototype.peek=function(){return this.items[this.size-1]};M0.prototype.forEach=function($,J){J=arguments.length>1?J:this;for(var Z=0,Q=this.items.length;Z<Q;Z++)$.call(J,this.items[Q-Z-1],Z,this)};M0.prototype.toArray=function(){var $=new Array(this.size),J=this.size-1,Z=this.size;while(Z--)$[Z]=this.items[J-Z];return $};M0.prototype.values=function(){var $=this.items,J=$.length,Z=0;return new VW(function(){if(Z>=J)return{done:!0};var Q=$[J-Z-1];return Z++,{value:Q,done:!1}})};M0.prototype.entries=function(){var $=this.items,J=$.length,Z=0;return new VW(function(){if(Z>=J)return{done:!0};var Q=$[J-Z-1];return{value:[Z++,Q],done:!1}})};if(typeof Symbol!=="undefined")M0.prototype[Symbol.iterator]=M0.prototype.values;M0.prototype.toString=function(){return this.toArray().join(",")};M0.prototype.toJSON=function(){return this.toArray()};M0.prototype.inspect=function(){var $=this.toArray();return Object.defineProperty($,"constructor",{value:M0,enumerable:!1}),$};if(typeof Symbol!=="undefined")M0.prototype[Symbol.for("nodejs.util.inspect.custom")]=M0.prototype.inspect;M0.from=function($){var J=new M0;return iB($,function(Z){J.push(Z)}),J};M0.of=function(){return M0.from(arguments)};HW.exports=M0});var zW=A((aB)=>{aB.intersection=function(){if(arguments.length<2)throw new Error("mnemonist/Set.intersection: needs at least two arguments.");var $=new Set,J=1/0,Z=null,Q,q,K=arguments.length;for(q=0;q<K;q++){if(Q=arguments[q],Q.size===0)return $;if(Q.size<J)J=Q.size,Z=Q}var V=Z.values(),H,X,W,z;while(H=V.next(),!H.done){X=H.value,W=!0;for(q=0;q<K;q++){if(z=arguments[q],z===Z)continue;if(!z.has(X)){W=!1;break}}if(W)$.add(X)}return $};aB.union=function(){if(arguments.length<2)throw new Error("mnemonist/Set.union: needs at least two arguments.");var $=new Set,J,Z=arguments.length,Q,q;for(J=0;J<Z;J++){Q=arguments[J].values();while(q=Q.next(),!q.done)$.add(q.value)}return $};aB.difference=function($,J){if(!$.size)return new Set;if(!J.size)return new Set($);var Z=new Set,Q=$.values(),q;while(q=Q.next(),!q.done)if(!J.has(q.value))Z.add(q.value);return Z};aB.symmetricDifference=function($,J){var Z=new Set,Q=$.values(),q;while(q=Q.next(),!q.done)if(!J.has(q.value))Z.add(q.value);Q=J.values();while(q=Q.next(),!q.done)if(!$.has(q.value))Z.add(q.value);return Z};aB.isSubset=function($,J){var Z=$.values(),Q;if($===J)return!0;if($.size>J.size)return!1;while(Q=Z.next(),!Q.done)if(!J.has(Q.value))return!1;return!0};aB.isSuperset=function($,J){return aB.isSubset(J,$)};aB.add=function($,J){var Z=J.values(),Q;while(Q=Z.next(),!Q.done)$.add(Q.value);return};aB.subtract=function($,J){var Z=J.values(),Q;while(Q=Z.next(),!Q.done)$.delete(Q.value);return};aB.intersect=function($,J){var Z=$.values(),Q;while(Q=Z.next(),!Q.done)if(!J.has(Q.value))$.delete(Q.value);return};aB.disjunct=function($,J){var Z=$.values(),Q,q=[];while(Q=Z.next(),!Q.done)if(J.has(Q.value))q.push(Q.value);Z=J.values();while(Q=Z.next(),!Q.done)if(!$.has(Q.value))$.add(Q.value);for(var K=0,V=q.length;K<V;K++)$.delete(q[K]);return};aB.intersectionSize=function($,J){var Z;if($.size>J.size)Z=$,$=J,J=Z;if($.size===0)return 0;if($===J)return $.size;var Q=$.values(),q,K=0;while(q=Q.next(),!q.done)if(J.has(q.value))K++;return K};aB.unionSize=function($,J){var Z=aB.intersectionSize($,J);return $.size+J.size-Z};aB.jaccard=function($,J){var Z=aB.intersectionSize($,J);if(Z===0)return 0;var Q=$.size+J.size-Z;return Z/Q};aB.overlap=function($,J){var Z=aB.intersectionSize($,J);if(Z===0)return 0;return Z/Math.min($.size,J.size)}});var YW=A((ep,GW)=>{var WI=u0(),zI=w1().getPointerArray;function h1($){var J=zI($);this.start=0,this.size=0,this.capacity=$,this.dense=new J($),this.sparse=new J($)}h1.prototype.clear=function(){this.start=0,this.size=0};h1.prototype.has=function($){if(this.size===0)return!1;var J=this.sparse[$],Z=J<this.capacity&&(J>=this.start&&J<this.start+this.size)||J<(this.start+this.size)%this.capacity;return Z&&this.dense[J]===$};h1.prototype.enqueue=function($){var J=this.sparse[$];if(this.size!==0){var Z=J<this.capacity&&(J>=this.start&&J<this.start+this.size)||J<(this.start+this.size)%this.capacity;if(Z&&this.dense[J]===$)return this}return J=(this.start+this.size)%this.capacity,this.dense[J]=$,this.sparse[$]=J,this.size++,this};h1.prototype.dequeue=function(){if(this.size===0)return;var $=this.start;if(this.size--,this.start++,this.start===this.capacity)this.start=0;var J=this.dense[$];return this.sparse[J]=this.capacity,J};h1.prototype.forEach=function($,J){J=arguments.length>1?J:this;var Z=this.capacity,Q=this.size,q=this.start,K=0;while(K<Q)if($.call(J,this.dense[q],K,this),q++,K++,q===Z)q=0};h1.prototype.values=function(){var $=this.dense,J=this.capacity,Z=this.size,Q=this.start,q=0;return new WI(function(){if(q>=Z)return{done:!0};var K=$[Q];if(Q++,q++,Q===J)Q=0;return{value:K,done:!1}})};if(typeof Symbol!=="undefined")h1.prototype[Symbol.iterator]=h1.prototype.values;h1.prototype.inspect=function(){var $=[];return this.forEach(function(J){$.push(J)}),Object.defineProperty($,"constructor",{value:h1,enumerable:!1}),$.capacity=this.capacity,$};if(typeof Symbol!=="undefined")h1.prototype[Symbol.for("nodejs.util.inspect.custom")]=h1.prototype.inspect;GW.exports=h1});var UW=A(($l,wW)=>{var vZ=u0(),GI=w1().getPointerArray;function K1($,J){if(arguments.length<2)J=$,$=Array;var Z=GI(J);this.size=0,this.length=J,this.dense=new Z(J),this.sparse=new Z(J),this.vals=new $(J)}K1.prototype.clear=function(){this.size=0};K1.prototype.has=function($){var J=this.sparse[$];return J<this.size&&this.dense[J]===$};K1.prototype.get=function($){var J=this.sparse[$];if(J<this.size&&this.dense[J]===$)return this.vals[J];return};K1.prototype.set=function($,J){var Z=this.sparse[$];if(Z<this.size&&this.dense[Z]===$)return this.vals[Z]=J,this;return this.dense[this.size]=$,this.sparse[$]=this.size,this.vals[this.size]=J,this.size++,this};K1.prototype.delete=function($){var J=this.sparse[$];if(J>=this.size||this.dense[J]!==$)return!1;return J=this.dense[this.size-1],this.dense[this.sparse[$]]=J,this.sparse[J]=this.sparse[$],this.size--,!0};K1.prototype.forEach=function($,J){J=arguments.length>1?J:this;for(var Z=0;Z<this.size;Z++)$.call(J,this.vals[Z],this.dense[Z])};K1.prototype.keys=function(){var $=this.size,J=this.dense,Z=0;return new vZ(function(){if(Z<$){var Q=J[Z];return Z++,{value:Q}}return{done:!0}})};K1.prototype.values=function(){var $=this.size,J=this.vals,Z=0;return new vZ(function(){if(Z<$){var Q=J[Z];return Z++,{value:Q}}return{done:!0}})};K1.prototype.entries=function(){var $=this.size,J=this.dense,Z=this.vals,Q=0;return new vZ(function(){if(Q<$){var q=[J[Q],Z[Q]];return Q++,{value:q}}return{done:!0}})};if(typeof Symbol!=="undefined")K1.prototype[Symbol.iterator]=K1.prototype.entries;K1.prototype.inspect=function(){var $=new Map;for(var J=0;J<this.size;J++)$.set(this.dense[J],this.vals[J]);if(Object.defineProperty($,"constructor",{value:K1,enumerable:!1}),$.length=this.length,this.vals.constructor!==Array)$.type=this.vals.constructor.name;return $};if(typeof Symbol!=="undefined")K1.prototype[Symbol.for("nodejs.util.inspect.custom")]=K1.prototype.inspect;wW.exports=K1});var NW=A((Jl,CW)=>{var YI=u0(),wI=w1().getPointerArray;function T1($){var J=wI($);this.size=0,this.length=$,this.dense=new J($),this.sparse=new J($)}T1.prototype.clear=function(){this.size=0};T1.prototype.has=function($){var J=this.sparse[$];return J<this.size&&this.dense[J]===$};T1.prototype.add=function($){var J=this.sparse[$];if(J<this.size&&this.dense[J]===$)return this;return this.dense[this.size]=$,this.sparse[$]=this.size,this.size++,this};T1.prototype.delete=function($){var J=this.sparse[$];if(J>=this.size||this.dense[J]!==$)return!1;return J=this.dense[this.size-1],this.dense[this.sparse[$]]=J,this.sparse[J]=this.sparse[$],this.size--,!0};T1.prototype.forEach=function($,J){J=arguments.length>1?J:this;var Z;for(var Q=0;Q<this.size;Q++)Z=this.dense[Q],$.call(J,Z,Z)};T1.prototype.values=function(){var $=this.size,J=this.dense,Z=0;return new YI(function(){if(Z<$){var Q=J[Z];return Z++,{value:Q}}return{done:!0}})};if(typeof Symbol!=="undefined")T1.prototype[Symbol.iterator]=T1.prototype.values;T1.prototype.inspect=function(){var $=new Set;for(var J=0;J<this.size;J++)$.add(this.dense[J]);return Object.defineProperty($,"constructor",{value:T1,enumerable:!1}),$.length=this.length,$};if(typeof Symbol!=="undefined")T1.prototype[Symbol.for("nodejs.util.inspect.custom")]=T1.prototype.inspect;CW.exports=T1});var jW=A((Zl,OW)=>{var UI=N0(),CI=2,NI=2,BI=new Set([0,1,2]),II={0:"Returns only the top suggestion",1:"Returns suggestions with the smallest edit distance",2:"Returns every suggestion (no early termination)"};function x7($){var J=new Set;if(typeof $==="number")J.add($);return{suggestions:J,count:0}}function BW($,J,Z){return{term:$||"",distance:J||0,count:Z||0}}function FW($,J,Z,Q){Q=Q||new Set,J++;var q,K=$.length,V;if(K>1){for(V=0;V<K;V++)if(q=$.substring(0,V)+$.substring(V+1),!Q.has(q)){if(Q.add(q),J<Z)FW(q,J,Z,Q)}}return Q}function FI($,J,Z,Q,q,K){var V=Z.suggestions.values().next().value;if(J<2&&Z.suggestions.size>0&&$[V].length-K.length>Q.length-K.length)Z.suggestions=new Set,Z.count=0;if(J===2||!Z.suggestions.size||$[V].length-K.length>=Q.length-K.length)Z.suggestions.add(q)}function IW($,J){var Z=$.length,Q=J.length,q=[[]],K=Z+Q,V=new Map,H,X,W;q[0][0]=K;for(H=0;H<=Z;H++){if(!q[H+1])q[H+1]=[];q[H+1][1]=H,q[H+1][0]=K}for(W=0;W<=Q;W++)q[1][W+1]=W,q[0][W+1]=K;var z=$+J,G;for(H=0,X=z.length;H<X;H++)if(G=z[H],!V.has(G))V.set(G,0);for(H=1;H<=Z;H++){var Y=0;for(W=1;W<=Q;W++){var w=V.get(J[W-1]),U=Y;if($[H-1]===J[W-1])q[H+1][W+1]=q[H][W],Y=W;else q[H+1][W+1]=Math.min(q[H][W],q[H+1][W],q[H][W+1])+1;q[H+1][W+1]=Math.min(q[H+1][W+1],q[w][U]+(H-w-1)+1+(W-U-1))}V.set($[H-1],H)}return q[Z+1][Q+1]}function OI($,J,Z,Q,q,K){var V=K.length;if(V-Q>q)return[];var H=[K],X=new Set,W=new Set,z=[],G,Y;while(H.length>0){if(G=H.shift(),Z<2&&z.length>0&&V-G.length>z[0].distance)break;if(Y=$[G],Y!==void 0){if(typeof Y==="number")Y=x7(Y);if(Y.count>0&&!W.has(G)){W.add(G);var w=BW(G,V-G.length,Y.count);if(z.push(w),Z<2&&V-G.length===0)break}Y.suggestions.forEach((O)=>{var I=J[O];if(W.has(I))return;W.add(I);var B=0;if(K!==I)if(I.length===G.length)B=V-G.length;else if(V===G.length)B=I.length-G.length;else{var F=0,P=0,L=I.length;while(F<L&&F<V&&I[F]===K[F])F++;while(P<L-F&&P<V&&I[L-P-1]===K[V-P-1])P++;if(F>0||P>0)B=IW(I.substr(F,L-F-P),K.substr(F,V-F-P));else B=IW(I,K)}if(Z<2&&z.length>0&&z[0].distance>B)z=[];if(Z<2&&z.length>0&&B>z[0].distance)return;if(B<=Q){var M=$[I];if(M!==void 0)z.push(BW(I,B,M.count))}})}if(V-G.length<Q){if(Z<2&&z.length>0&&V-G.length>=z[0].distance)continue;for(var U=0,C=G.length;U<C;U++){var N=G.substring(0,U)+G.substring(U+1);if(!X.has(N))X.add(N),H.push(N)}}}if(Z===0)return z.slice(0,1);return z}function P8($){if($=$||{},this.clear(),this.maxDistance=typeof $.maxDistance==="number"?$.maxDistance:CI,this.verbosity=typeof $.verbosity==="number"?$.verbosity:NI,typeof this.maxDistance!=="number"||this.maxDistance<=0)throw Error("mnemonist/SymSpell.constructor: invalid `maxDistance` option. Should be a integer greater than 0.");if(!BI.has(this.verbosity))throw Error("mnemonist/SymSpell.constructor: invalid `verbosity` option. Should be either 0, 1 or 2.")}P8.prototype.clear=function(){this.size=0,this.dictionary=Object.create(null),this.maxLength=0,this.words=[]};P8.prototype.add=function($){var J=this.dictionary[$];if(J!==void 0){if(typeof J==="number")J=x7(J),this.dictionary[$]=J;J.count++}else if(J=x7(),J.count++,this.dictionary[$]=J,$.length>this.maxLength)this.maxLength=$.length;if(J.count===1){var Z=this.words.length;this.words.push($);var Q=FW($,0,this.maxDistance);Q.forEach((q)=>{var K=this.dictionary[q];if(K!==void 0){if(typeof K==="number")K=x7(K),this.dictionary[q]=K;if(!K.suggestions.has(Z))FI(this.words,this.verbosity,K,$,Z,q)}else this.dictionary[q]=Z})}return this.size++,this};P8.prototype.search=function($){return OI(this.dictionary,this.words,this.verbosity,this.maxDistance,this.maxLength,$)};P8.prototype.inspect=function(){var $=[];$.size=this.size,$.maxDistance=this.maxDistance,$.verbosity=this.verbosity,$.behavior=II[this.verbosity];for(var J in this.dictionary)if(typeof this.dictionary[J]==="object"&&this.dictionary[J].count)$.push([J,this.dictionary[J].count]);return Object.defineProperty($,"constructor",{value:P8,enumerable:!1}),$};if(typeof Symbol!=="undefined")P8.prototype[Symbol.for("nodejs.util.inspect.custom")]=P8.prototype.inspect;P8.from=function($,J){var Z=new P8(J);return UI($,function(Q){Z.add(Q)}),Z};OW.exports=P8});var yZ=A((Ql,_W)=>{var jI=N0(),_6=u0(),p0=String.fromCharCode(0);function P0($){this.mode=$===Array?"array":"string",this.clear()}P0.prototype.clear=function(){this.root={},this.size=0};P0.prototype.set=function($,J){var Z=this.root,Q;for(var q=0,K=$.length;q<K;q++)Q=$[q],Z=Z[Q]||(Z[Q]={});if(!(p0 in Z))this.size++;return Z[p0]=J,this};P0.prototype.update=function($,J){var Z=this.root,Q;for(var q=0,K=$.length;q<K;q++)Q=$[q],Z=Z[Q]||(Z[Q]={});if(!(p0 in Z))this.size++;return Z[p0]=J(Z[p0]),this};P0.prototype.get=function($){var J=this.root,Z,Q,q;for(Q=0,q=$.length;Q<q;Q++)if(Z=$[Q],J=J[Z],typeof J==="undefined")return;if(!(p0 in J))return;return J[p0]};P0.prototype.delete=function($){var J=this.root,Z=null,Q=null,q,K,V,H;for(V=0,H=$.length;V<H;V++){if(K=$[V],q=J,J=J[K],typeof J==="undefined")return!1;if(Z!==null){if(Object.keys(J).length>1)Z=null,Q=null}else if(Object.keys(J).length<2)Z=q,Q=K}if(!(p0 in J))return!1;if(this.size--,Z)delete Z[Q];else delete J[p0];return!0};P0.prototype.has=function($){var J=this.root,Z;for(var Q=0,q=$.length;Q<q;Q++)if(Z=$[Q],J=J[Z],typeof J==="undefined")return!1;return p0 in J};P0.prototype.find=function($){var J=typeof $==="string",Z=this.root,Q=[],q,K,V;for(K=0,V=$.length;K<V;K++)if(q=$[K],Z=Z[q],typeof Z==="undefined")return Q;var H=[Z],X=[$],W;while(H.length){$=X.pop(),Z=H.pop();for(W in Z){if(W===p0){Q.push([$,Z[p0]]);continue}H.push(Z[W]),X.push(J?$+W:$.concat(W))}}return Q};P0.prototype.values=function($){var J=this.root,Z=[],Q,q,K;if($){for(q=0,K=$.length;q<K;q++)if(Q=$[q],J=J[Q],typeof J==="undefined")return _6.empty()}return Z.push(J),new _6(function(){var V,H=!1,X;while(Z.length){V=Z.pop();for(X in V){if(X===p0){H=!0;continue}Z.push(V[X])}if(H)return{done:!1,value:V[p0]}}return{done:!0}})};P0.prototype.prefixes=function($){var J=this.root,Z=[],Q=[],q,K,V,H=this.mode==="string";if($){for(K=0,V=$.length;K<V;K++)if(q=$[K],J=J[q],typeof J==="undefined")return _6.empty()}else $=H?"":[];return Z.push(J),Q.push($),new _6(function(){var X,W,z=!1,G;while(Z.length){X=Z.pop(),W=Q.pop();for(G in X){if(G===p0){z=!0;continue}Z.push(X[G]),Q.push(H?W+G:W.concat(G))}if(z)return{done:!1,value:W}}return{done:!0}})};P0.prototype.keys=P0.prototype.prefixes;P0.prototype.entries=function($){var J=this.root,Z=[],Q=[],q,K,V,H=this.mode==="string";if($){for(K=0,V=$.length;K<V;K++)if(q=$[K],J=J[q],typeof J==="undefined")return _6.empty()}else $=H?"":[];return Z.push(J),Q.push($),new _6(function(){var X,W,z=!1,G;while(Z.length){X=Z.pop(),W=Q.pop();for(G in X){if(G===p0){z=!0;continue}Z.push(X[G]),Q.push(H?W+G:W.concat(G))}if(z)return{done:!1,value:[W,X[p0]]}}return{done:!0}})};if(typeof Symbol!=="undefined")P0.prototype[Symbol.iterator]=P0.prototype.entries;P0.prototype.inspect=function(){var $=new Array(this.size),J=this.entries(),Z,Q=0;while(Z=J.next(),!Z.done)$[Q++]=Z.value;return Object.defineProperty($,"constructor",{value:P0,enumerable:!1}),$};if(typeof Symbol!=="undefined")P0.prototype[Symbol.for("nodejs.util.inspect.custom")]=P0.prototype.inspect;P0.prototype.toJSON=function(){return this.root};P0.from=function($){var J=new P0;return jI($,function(Z,Q){J.set(Q,Z)}),J};P0.SENTINEL=p0;_W.exports=P0});var LW=A((ql,DW)=>{var _I=N0(),PW=yZ(),m7=String.fromCharCode(0);function l0($){this.mode=$===Array?"array":"string",this.clear()}for(c7 in PW.prototype)l0.prototype[c7]=PW.prototype[c7];var c7;delete l0.prototype.set;delete l0.prototype.get;delete l0.prototype.values;delete l0.prototype.entries;l0.prototype.add=function($){var J=this.root,Z;for(var Q=0,q=$.length;Q<q;Q++)Z=$[Q],J=J[Z]||(J[Z]={});if(!(m7 in J))this.size++;return J[m7]=!0,this};l0.prototype.find=function($){var J=typeof $==="string",Z=this.root,Q=[],q,K,V;for(K=0,V=$.length;K<V;K++)if(q=$[K],Z=Z[q],typeof Z==="undefined")return Q;var H=[Z],X=[$],W;while(H.length){$=X.pop(),Z=H.pop();for(W in Z){if(W===m7){Q.push($);continue}H.push(Z[W]),X.push(J?$+W:$.concat(W))}}return Q};if(typeof Symbol!=="undefined")l0.prototype[Symbol.iterator]=l0.prototype.keys;l0.prototype.inspect=function(){var $=new Set,J=this.keys(),Z;while(Z=J.next(),!Z.done)$.add(Z.value);return Object.defineProperty($,"constructor",{value:l0,enumerable:!1}),$};if(typeof Symbol!=="undefined")l0.prototype[Symbol.for("nodejs.util.inspect.custom")]=l0.prototype.inspect;l0.prototype.toJSON=function(){return this.root};l0.from=function($){var J=new l0;return _I($,function(Z){J.add(Z)}),J};l0.SENTINEL=m7;DW.exports=l0});var MW=A((Kl,RW)=>{var kW=u0(),PI=N0(),DI=D1(),AW=w1(),LI=function($){return Math.max(1,Math.ceil($*1.5))},kI=function($){var J=AW.getPointerArray($);return new J($)};function Q0($,J){if(arguments.length<1)throw new Error("mnemonist/vector: expecting at least a byte array constructor.");var Z=J||0,Q=LI,q=0,K=!1;if(typeof J==="object")Z=J.initialCapacity||0,q=J.initialLength||0,Q=J.policy||Q,K=J.factory===!0;this.factory=K?$:null,this.ArrayClass=$,this.length=q,this.capacity=Math.max(q,Z),this.policy=Q,this.array=new $(this.capacity)}Q0.prototype.set=function($,J){if(this.length<$)throw new Error("Vector("+this.ArrayClass.name+").set: index out of bounds.");return this.array[$]=J,this};Q0.prototype.get=function($){if(this.length<$)return;return this.array[$]};Q0.prototype.applyPolicy=function($){var J=this.policy($||this.capacity);if(typeof J!=="number"||J<0)throw new Error("mnemonist/vector.applyPolicy: policy returned an invalid value (expecting a positive integer).");if(J<=this.capacity)throw new Error("mnemonist/vector.applyPolicy: policy returned a less or equal capacity to allocate.");return J};Q0.prototype.reallocate=function($){if($===this.capacity)return this;var J=this.array;if($<this.length)this.length=$;if($>this.capacity){if(this.factory===null)this.array=new this.ArrayClass($);else this.array=this.factory($);if(AW.isTypedArray(this.array))this.array.set(J,0);else for(var Z=0,Q=this.length;Z<Q;Z++)this.array[Z]=J[Z]}else this.array=J.slice(0,$);return this.capacity=$,this};Q0.prototype.grow=function($){var J;if(typeof $==="number"){if(this.capacity>=$)return this;J=this.capacity;while(J<$)J=this.applyPolicy(J);return this.reallocate(J),this}return J=this.applyPolicy(),this.reallocate(J),this};Q0.prototype.resize=function($){if($===this.length)return this;if($<this.length)return this.length=$,this;return this.length=$,this.reallocate($),this};Q0.prototype.push=function($){if(this.capacity===this.length)this.grow();return this.array[this.length++]=$,this.length};Q0.prototype.pop=function(){if(this.length===0)return;return this.array[--this.length]};Q0.prototype.values=function(){var $=this.array,J=this.length,Z=0;return new kW(function(){if(Z>=J)return{done:!0};var Q=$[Z];return Z++,{value:Q,done:!1}})};Q0.prototype.entries=function(){var $=this.array,J=this.length,Z=0;return new kW(function(){if(Z>=J)return{done:!0};var Q=$[Z];return{value:[Z++,Q],done:!1}})};if(typeof Symbol!=="undefined")Q0.prototype[Symbol.iterator]=Q0.prototype.values;Q0.prototype.inspect=function(){var $=this.array.slice(0,this.length);return $.type=this.array.constructor.name,$.items=this.length,$.capacity=this.capacity,Object.defineProperty($,"constructor",{value:Q0,enumerable:!1}),$};if(typeof Symbol!=="undefined")Q0.prototype[Symbol.for("nodejs.util.inspect.custom")]=Q0.prototype.inspect;Q0.from=function($,J,Z){if(arguments.length<3){if(Z=DI.guessLength($),typeof Z!=="number")throw new Error("mnemonist/vector.from: could not guess iterable length. Please provide desired capacity as last argument.")}var Q=new Q0(J,Z);return PI($,function(q){Q.push(q)}),Q};function D8($){var J=function(Q){Q0.call(this,$,Q)};for(var Z in Q0.prototype)if(Q0.prototype.hasOwnProperty(Z))J.prototype[Z]=Q0.prototype[Z];if(J.from=function(Q,q){return Q0.from(Q,$,q)},typeof Symbol!=="undefined")J.prototype[Symbol.iterator]=J.prototype.values;return J}Q0.Int8Vector=D8(Int8Array);Q0.Uint8Vector=D8(Uint8Array);Q0.Uint8ClampedVector=D8(Uint8ClampedArray);Q0.Int16Vector=D8(Int16Array);Q0.Uint16Vector=D8(Uint16Array);Q0.Int32Vector=D8(Int32Array);Q0.Uint32Vector=D8(Uint32Array);Q0.Float32Vector=D8(Float32Array);Q0.Float64Vector=D8(Float64Array);Q0.PointerVector=D8(kI);RW.exports=Q0});var hW=A((Vl,EW)=>{var AI=D1(),RI=w1(),MI=TZ().inplaceQuickSortIndices,EI=hZ().lowerBoundIndices,hI=E7(),TI=RI.getPointerArray;function SI($,J){if($.distance<J.distance)return 1;if($.distance>J.distance)return-1;return 0}function bI($,J,Z){var Q=Z.length,q=TI(Q),K=0,V=new q(Q),H=new q(Q),X=new q(Q),W=new Float64Array(Q),z=[0,0,Q],G=new Float64Array(Q),Y,w,U,C,N,O,I,B,F;while(z.length){if(N=z.pop(),C=z.pop(),Y=z.pop(),w=Z[N-1],N--,F=N-C,V[Y]=w,F===0)continue;if(F===1){I=$(J[w],J[Z[C]]),W[Y]=I,K++,X[Y]=K,V[K]=Z[C];continue}for(B=C;B<N;B++)G[Z[B]]=$(J[w],J[Z[B]]);if(MI(G,Z,C,N),U=C+F/2-1,U===(U|0))I=(G[Z[U]]+G[Z[U+1]])/2;else I=G[Z[Math.ceil(U)]];if(W[Y]=I,O=EI(G,Z,I,C,N),N-O>0)K++,X[Y]=K,z.push(K,O,N);if(O-C>0)K++,H[Y]=K,z.push(K,C,O)}return{nodes:V,lefts:H,rights:X,mus:W}}function v8($,J){if(typeof $!=="function")throw new Error("mnemonist/VPTree.constructor: given `distance` must be a function.");if(!J)throw new Error("mnemonist/VPTree.constructor: you must provide items to the tree. A VPTree cannot be updated after its creation.");this.distance=$,this.heap=new hI(SI),this.D=0;var Z=AI.toArrayWithIndices(J);this.items=Z[0];var Q=Z[1];this.size=Q.length;var q=bI($,this.items,Q);this.nodes=q.nodes,this.lefts=q.lefts,this.rights=q.rights,this.mus=q.mus}v8.prototype.nearestNeighbors=function($,J){var Z=this.heap,Q=[0],q=1/0,K,V,H,X,W,z,G;this.D=0;while(Q.length){if(K=Q.pop(),V=this.nodes[K],H=this.items[V],G=this.distance(H,J),this.D++,G<q){if(Z.push({distance:G,item:H}),Z.size>$)Z.pop();if(Z.size>=$)q=Z.peek().distance}if(X=this.lefts[K],W=this.rights[K],!X&&!W)continue;if(z=this.mus[K],G<z){if(X&&G<z+q)Q.push(X);if(W&&G>=z-q)Q.push(W)}else{if(W&&G>=z-q)Q.push(W);if(X&&G<z+q)Q.push(X)}}var Y=new Array(Z.size);for(var w=Z.size-1;w>=0;w--)Y[w]=Z.pop();return Y};v8.prototype.neighbors=function($,J){var Z=[],Q=[0],q,K,V,H,X,W,z;this.D=0;while(Q.length){if(q=Q.pop(),K=this.nodes[q],V=this.items[K],z=this.distance(V,J),this.D++,z<=$)Z.push({distance:z,item:V});if(H=this.lefts[q],X=this.rights[q],!H&&!X)continue;if(W=this.mus[q],z<W){if(H&&z<W+$)Q.push(H);if(X&&z>=W-$)Q.push(X)}else{if(X&&z>=W-$)Q.push(X);if(H&&z<W+$)Q.push(H)}}return Z};v8.prototype.inspect=function(){var $=this.items.slice();return Object.defineProperty($,"constructor",{value:v8,enumerable:!1}),$};if(typeof Symbol!=="undefined")v8.prototype[Symbol.for("nodejs.util.inspect.custom")]=v8.prototype.inspect;v8.from=function($,J){return new v8(J,$)};EW.exports=v8});var bW=A((Hl,SW)=>{var gZ=E7(),xZ=CZ(),TW=AH();SW.exports={BiMap:TH(),BitSet:xH(),BitVector:dH(),BloomFilter:iH(),BKTree:rH(),CircularBuffer:ZX(),DefaultMap:qX(),DefaultWeakMap:VX(),FixedDeque:_Z(),StaticDisjointSet:XX(),FibonacciHeap:xZ,MinFibonacciHeap:xZ.MinFibonacciHeap,MaxFibonacciHeap:xZ.MaxFibonacciHeap,FixedReverseHeap:T7(),FuzzyMap:UX(),FuzzyMultiMap:IX(),HashedArrayTree:jX(),Heap:gZ,MinHeap:gZ.MinHeap,MaxHeap:gZ.MaxHeap,StaticIntervalTree:LX(),InvertedIndex:bX(),KDTree:xX(),LinkedList:uX(),LRUCache:f7(),LRUCacheWithDelete:lX(),LRUMap:fZ(),LRUMapWithDelete:sX(),MultiMap:AZ(),MultiSet:aX(),PassjoinIndex:ZW(),Queue:KW(),FixedStack:MZ(),Stack:XW(),SuffixArray:TW,GeneralizedSuffixArray:TW.GeneralizedSuffixArray,Set:zW(),SparseQueueSet:YW(),SparseMap:UW(),SparseSet:NW(),SymSpell:jW(),Trie:LW(),TrieMap:yZ(),Vector:MW(),VPTree:hW()}});var vW=f5(Z$(),1);class S6{events={};on=($,J)=>{if(this.events[$]===void 0)this.events[$]=new Array;this.events[$].push(J)};off=($,J)=>{if(this.events[$]===void 0||this.events[$].indexOf(J)===-1)return;this.events[$].splice(this.events[$].indexOf(J),1)};fire($,J){if(this.events[$]===void 0)return;for(let Z of this.events[$])setTimeout(()=>Z(J),0)}}class v{static controls=new S6;static skill_tree=new S6;static node=new S6;static viewport=new S6}class b6{DRAG_THRESHOLD_SQUARED=16;dragTimeoutActive=!1;dragTimeout=50;start={x:0,y:0};dragged=!1;hovered=[];skillTreeData;skillTreeDataCompare;constructor($,J){this.skillTreeData=$,this.skillTreeDataCompare=J,v.viewport.on("up",this.up),v.viewport.on("rightup",this.rightup),v.viewport.on("move",this.move),v.viewport.on("down",this.down),v.viewport.on("cancel",()=>setTimeout(()=>this.cancelDrag(),this.dragTimeout))}skillTrees=()=>{let $=[this.skillTreeData];if(this.skillTreeDataCompare!==void 0)$.push(this.skillTreeDataCompare);return $};up=($)=>{if(!this.dragged)b6.clickSkillTree($,this.skillTreeData);if(!this.dragTimeoutActive)setTimeout(()=>this.cancelDrag(),this.dragTimeout),this.dragTimeoutActive=!0};rightup=($)=>{if(!this.dragged)b6.rightClickSkillTree($,this.skillTreeData);if(!this.dragTimeoutActive)setTimeout(()=>this.cancelDrag(),this.dragTimeout),this.dragTimeoutActive=!0};static clickSkillTree=($,J)=>{let Z=J.getNodeAtPoint($);if(Z===null)return;v.node.fire("click",Z)};static rightClickSkillTree=($,J)=>{let Z=J.getNodeAtPoint($);if(Z===null)return;v.node.fire("rightclick",Z)};cancelDrag=()=>{this.start={x:0,y:0},this.dragged=!1,this.dragTimeoutActive=!1};down=($)=>{this.start={x:$.x,y:$.y}};move=($)=>{let J=$[0],Z=$[1];if(!this.dragged&&this.start.x!==0&&this.start.y!==0){let K={x:this.start.x-Z.x,y:this.start.y-Z.y};this.dragged=this.dragged||K.x*K.x+K.y*K.y>this.DRAG_THRESHOLD_SQUARED}let Q=new Array;for(let K of this.skillTrees()){let V=K.getNodeAtPoint(J);if(V!==null){Q.push(V);break}}let q=this.hovered.filter((K)=>!Q.includes(K));for(let K of q)v.node.fire("out",K);this.hovered=Q;for(let K of this.hovered)v.node.fire("in",K)}}var fW=f5(Z$(),1);var y8=Math.PI*2,qJ=180/Math.PI,KJ=Math.PI/180,z0=(($)=>($[$.POLY=0]="POLY",$[$.RECT=1]="RECT",$[$.CIRC=2]="CIRC",$[$.ELIP=3]="ELIP",$[$.RREC=4]="RREC",$))(z0||{});class d{constructor($=0,J=0){this.x=0,this.y=0,this.x=$,this.y=J}clone(){return new d(this.x,this.y)}copyFrom($){return this.set($.x,$.y),this}copyTo($){return $.set(this.x,this.y),$}equals($){return $.x===this.x&&$.y===this.y}set($=0,J=$){return this.x=$,this.y=J,this}}d.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};var Q$=[new d,new d,new d,new d];class y{constructor($=0,J=0,Z=0,Q=0){this.x=Number($),this.y=Number(J),this.width=Number(Z),this.height=Number(Q),this.type=z0.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new y(0,0,0,0)}clone(){return new y(this.x,this.y,this.width,this.height)}copyFrom($){return this.x=$.x,this.y=$.y,this.width=$.width,this.height=$.height,this}copyTo($){return $.x=this.x,$.y=this.y,$.width=this.width,$.height=this.height,$}contains($,J){return this.width<=0||this.height<=0?!1:$>=this.x&&$<this.x+this.width&&J>=this.y&&J<this.y+this.height}intersects($,J){if(!J){let M=this.x<$.x?$.x:this.x;if((this.right>$.right?$.right:this.right)<=M)return!1;let E=this.y<$.y?$.y:this.y;return(this.bottom>$.bottom?$.bottom:this.bottom)>E}let Z=this.left,Q=this.right,q=this.top,K=this.bottom;if(Q<=Z||K<=q)return!1;let V=Q$[0].set($.left,$.top),H=Q$[1].set($.left,$.bottom),X=Q$[2].set($.right,$.top),W=Q$[3].set($.right,$.bottom);if(X.x<=V.x||H.y<=V.y)return!1;let z=Math.sign(J.a*J.d-J.b*J.c);if(z===0||(J.apply(V,V),J.apply(H,H),J.apply(X,X),J.apply(W,W),Math.max(V.x,H.x,X.x,W.x)<=Z||Math.min(V.x,H.x,X.x,W.x)>=Q||Math.max(V.y,H.y,X.y,W.y)<=q||Math.min(V.y,H.y,X.y,W.y)>=K))return!1;let G=z*(H.y-V.y),Y=z*(V.x-H.x),w=G*Z+Y*q,U=G*Q+Y*q,C=G*Z+Y*K,N=G*Q+Y*K;if(Math.max(w,U,C,N)<=G*V.x+Y*V.y||Math.min(w,U,C,N)>=G*W.x+Y*W.y)return!1;let O=z*(V.y-X.y),I=z*(X.x-V.x),B=O*Z+I*q,F=O*Q+I*q,P=O*Z+I*K,L=O*Q+I*K;return!(Math.max(B,F,P,L)<=O*V.x+I*V.y||Math.min(B,F,P,L)>=O*W.x+I*W.y)}pad($=0,J=$){return this.x-=$,this.y-=J,this.width+=$*2,this.height+=J*2,this}fit($){let J=Math.max(this.x,$.x),Z=Math.min(this.x+this.width,$.x+$.width),Q=Math.max(this.y,$.y),q=Math.min(this.y+this.height,$.y+$.height);return this.x=J,this.width=Math.max(Z-J,0),this.y=Q,this.height=Math.max(q-Q,0),this}ceil($=1,J=0.001){let Z=Math.ceil((this.x+this.width-J)*$)/$,Q=Math.ceil((this.y+this.height-J)*$)/$;return this.x=Math.floor((this.x+J)*$)/$,this.y=Math.floor((this.y+J)*$)/$,this.width=Z-this.x,this.height=Q-this.y,this}enlarge($){let J=Math.min(this.x,$.x),Z=Math.max(this.x+this.width,$.x+$.width),Q=Math.min(this.y,$.y),q=Math.max(this.y+this.height,$.y+$.height);return this.x=J,this.width=Z-J,this.y=Q,this.height=q-Q,this}}y.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class g5{constructor($=0,J=0,Z=0){this.x=$,this.y=J,this.radius=Z,this.type=z0.CIRC}clone(){return new g5(this.x,this.y,this.radius)}contains($,J){if(this.radius<=0)return!1;let Z=this.radius*this.radius,Q=this.x-$,q=this.y-J;return Q*=Q,q*=q,Q+q<=Z}getBounds(){return new y(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}g5.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class x5{constructor($=0,J=0,Z=0,Q=0){this.x=$,this.y=J,this.width=Z,this.height=Q,this.type=z0.ELIP}clone(){return new x5(this.x,this.y,this.width,this.height)}contains($,J){if(this.width<=0||this.height<=0)return!1;let Z=($-this.x)/this.width,Q=(J-this.y)/this.height;return Z*=Z,Q*=Q,Z+Q<=1}getBounds(){return new y(this.x-this.width,this.y-this.height,this.width,this.height)}}x5.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class q8{constructor(...$){let J=Array.isArray($[0])?$[0]:$;if(typeof J[0]!="number"){let Z=[];for(let Q=0,q=J.length;Q<q;Q++)Z.push(J[Q].x,J[Q].y);J=Z}this.points=J,this.type=z0.POLY,this.closeStroke=!0}clone(){let $=this.points.slice(),J=new q8($);return J.closeStroke=this.closeStroke,J}contains($,J){let Z=!1,Q=this.points.length/2;for(let q=0,K=Q-1;q<Q;K=q++){let V=this.points[q*2],H=this.points[q*2+1],X=this.points[K*2],W=this.points[K*2+1];H>J!=W>J&&$<(X-V)*((J-H)/(W-H))+V&&(Z=!Z)}return Z}}q8.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce(($,J)=>`${$}, ${J}`,"")}]`};class c5{constructor($=0,J=0,Z=0,Q=0,q=20){this.x=$,this.y=J,this.width=Z,this.height=Q,this.radius=q,this.type=z0.RREC}clone(){return new c5(this.x,this.y,this.width,this.height,this.radius)}contains($,J){if(this.width<=0||this.height<=0)return!1;if($>=this.x&&$<=this.x+this.width&&J>=this.y&&J<=this.y+this.height){let Z=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(J>=this.y+Z&&J<=this.y+this.height-Z||$>=this.x+Z&&$<=this.x+this.width-Z)return!0;let Q=$-(this.x+Z),q=J-(this.y+Z),K=Z*Z;if(Q*Q+q*q<=K||(Q=$-(this.x+this.width-Z),Q*Q+q*q<=K)||(q=J-(this.y+this.height-Z),Q*Q+q*q<=K)||(Q=$-(this.x+Z),Q*Q+q*q<=K))return!0}return!1}}c5.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class $0{constructor($=1,J=0,Z=0,Q=1,q=0,K=0){this.array=null,this.a=$,this.b=J,this.c=Z,this.d=Q,this.tx=q,this.ty=K}fromArray($){this.a=$[0],this.b=$[1],this.c=$[3],this.d=$[4],this.tx=$[2],this.ty=$[5]}set($,J,Z,Q,q,K){return this.a=$,this.b=J,this.c=Z,this.d=Q,this.tx=q,this.ty=K,this}toArray($,J){this.array||(this.array=new Float32Array(9));let Z=J||this.array;return $?(Z[0]=this.a,Z[1]=this.b,Z[2]=0,Z[3]=this.c,Z[4]=this.d,Z[5]=0,Z[6]=this.tx,Z[7]=this.ty,Z[8]=1):(Z[0]=this.a,Z[1]=this.c,Z[2]=this.tx,Z[3]=this.b,Z[4]=this.d,Z[5]=this.ty,Z[6]=0,Z[7]=0,Z[8]=1),Z}apply($,J){J=J||new d;let{x:Z,y:Q}=$;return J.x=this.a*Z+this.c*Q+this.tx,J.y=this.b*Z+this.d*Q+this.ty,J}applyInverse($,J){J=J||new d;let Z=1/(this.a*this.d+this.c*-this.b),Q=$.x,q=$.y;return J.x=this.d*Z*Q+-this.c*Z*q+(this.ty*this.c-this.tx*this.d)*Z,J.y=this.a*Z*q+-this.b*Z*Q+(-this.ty*this.a+this.tx*this.b)*Z,J}translate($,J){return this.tx+=$,this.ty+=J,this}scale($,J){return this.a*=$,this.d*=J,this.c*=$,this.b*=J,this.tx*=$,this.ty*=J,this}rotate($){let J=Math.cos($),Z=Math.sin($),Q=this.a,q=this.c,K=this.tx;return this.a=Q*J-this.b*Z,this.b=Q*Z+this.b*J,this.c=q*J-this.d*Z,this.d=q*Z+this.d*J,this.tx=K*J-this.ty*Z,this.ty=K*Z+this.ty*J,this}append($){let J=this.a,Z=this.b,Q=this.c,q=this.d;return this.a=$.a*J+$.b*Q,this.b=$.a*Z+$.b*q,this.c=$.c*J+$.d*Q,this.d=$.c*Z+$.d*q,this.tx=$.tx*J+$.ty*Q+this.tx,this.ty=$.tx*Z+$.ty*q+this.ty,this}setTransform($,J,Z,Q,q,K,V,H,X){return this.a=Math.cos(V+X)*q,this.b=Math.sin(V+X)*q,this.c=-Math.sin(V-H)*K,this.d=Math.cos(V-H)*K,this.tx=$-(Z*this.a+Q*this.c),this.ty=J-(Z*this.b+Q*this.d),this}prepend($){let J=this.tx;if($.a!==1||$.b!==0||$.c!==0||$.d!==1){let Z=this.a,Q=this.c;this.a=Z*$.a+this.b*$.c,this.b=Z*$.b+this.b*$.d,this.c=Q*$.a+this.d*$.c,this.d=Q*$.b+this.d*$.d}return this.tx=J*$.a+this.ty*$.c+$.tx,this.ty=J*$.b+this.ty*$.d+$.ty,this}decompose($){let J=this.a,Z=this.b,Q=this.c,q=this.d,K=$.pivot,V=-Math.atan2(-Q,q),H=Math.atan2(Z,J),X=Math.abs(V+H);return X<0.00001||Math.abs(y8-X)<0.00001?($.rotation=H,$.skew.x=$.skew.y=0):($.rotation=0,$.skew.x=V,$.skew.y=H),$.scale.x=Math.sqrt(J*J+Z*Z),$.scale.y=Math.sqrt(Q*Q+q*q),$.position.x=this.tx+(K.x*J+K.y*Q),$.position.y=this.ty+(K.x*Z+K.y*q),$}invert(){let $=this.a,J=this.b,Z=this.c,Q=this.d,q=this.tx,K=$*Q-J*Z;return this.a=Q/K,this.b=-J/K,this.c=-Z/K,this.d=$/K,this.tx=(Z*this.ty-Q*q)/K,this.ty=-($*this.ty-J*q)/K,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let $=new $0;return $.a=this.a,$.b=this.b,$.c=this.c,$.d=this.d,$.tx=this.tx,$.ty=this.ty,$}copyTo($){return $.a=this.a,$.b=this.b,$.c=this.c,$.d=this.d,$.tx=this.tx,$.ty=this.ty,$}copyFrom($){return this.a=$.a,this.b=$.b,this.c=$.c,this.d=$.d,this.tx=$.tx,this.ty=$.ty,this}static get IDENTITY(){return new $0}static get TEMP_MATRIX(){return new $0}}$0.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};var H5=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],X5=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],W5=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],z5=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],VJ=[],qK=[],q$=Math.sign;function yY(){for(let $=0;$<16;$++){let J=[];VJ.push(J);for(let Z=0;Z<16;Z++){let Q=q$(H5[$]*H5[Z]+W5[$]*X5[Z]),q=q$(X5[$]*H5[Z]+z5[$]*X5[Z]),K=q$(H5[$]*W5[Z]+W5[$]*z5[Z]),V=q$(X5[$]*W5[Z]+z5[$]*z5[Z]);for(let H=0;H<16;H++)if(H5[H]===Q&&X5[H]===q&&W5[H]===K&&z5[H]===V){J.push(H);break}}}for(let $=0;$<16;$++){let J=new $0;J.set(H5[$],X5[$],W5[$],z5[$],0,0),qK.push(J)}}yY();var U0={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:($)=>H5[$],uY:($)=>X5[$],vX:($)=>W5[$],vY:($)=>z5[$],inv:($)=>$&8?$&15:-$&7,add:($,J)=>VJ[$][J],sub:($,J)=>VJ[$][U0.inv(J)],rotate180:($)=>$^4,isVertical:($)=>($&3)===2,byDirection:($,J)=>Math.abs($)*2<=Math.abs(J)?J>=0?U0.S:U0.N:Math.abs(J)*2<=Math.abs($)?$>0?U0.E:U0.W:J>0?$>0?U0.SE:U0.SW:$>0?U0.NE:U0.NW,matrixAppendRotationInv:($,J,Z=0,Q=0)=>{let q=qK[U0.inv(J)];q.tx=Z,q.ty=Q,$.append(q)}};class L1{constructor($,J,Z=0,Q=0){this._x=Z,this._y=Q,this.cb=$,this.scope=J}clone($=this.cb,J=this.scope){return new L1($,J,this._x,this._y)}set($=0,J=$){return(this._x!==$||this._y!==J)&&(this._x=$,this._y=J,this.cb.call(this.scope)),this}copyFrom($){return(this._x!==$.x||this._y!==$.y)&&(this._x=$.x,this._y=$.y,this.cb.call(this.scope)),this}copyTo($){return $.set(this._x,this._y),$}equals($){return $.x===this._x&&$.y===this._y}get x(){return this._x}set x($){this._x!==$&&(this._x=$,this.cb.call(this.scope))}get y(){return this._y}set y($){this._y!==$&&(this._y=$,this.cb.call(this.scope))}}L1.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};var HJ=class{constructor(){this.worldTransform=new $0,this.localTransform=new $0,this.position=new L1(this.onChange,this,0,0),this.scale=new L1(this.onChange,this,1,1),this.pivot=new L1(this.onChange,this,0,0),this.skew=new L1(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){let $=this.localTransform;this._localID!==this._currentLocalID&&($.a=this._cx*this.scale.x,$.b=this._sx*this.scale.x,$.c=this._cy*this.scale.y,$.d=this._sy*this.scale.y,$.tx=this.position.x-(this.pivot.x*$.a+this.pivot.y*$.c),$.ty=this.position.y-(this.pivot.x*$.b+this.pivot.y*$.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform($){let J=this.localTransform;if(this._localID!==this._currentLocalID&&(J.a=this._cx*this.scale.x,J.b=this._sx*this.scale.x,J.c=this._cy*this.scale.y,J.d=this._sy*this.scale.y,J.tx=this.position.x-(this.pivot.x*J.a+this.pivot.y*J.c),J.ty=this.position.y-(this.pivot.x*J.b+this.pivot.y*J.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==$._worldID){let Z=$.worldTransform,Q=this.worldTransform;Q.a=J.a*Z.a+J.b*Z.c,Q.b=J.a*Z.b+J.b*Z.d,Q.c=J.c*Z.a+J.d*Z.c,Q.d=J.c*Z.b+J.d*Z.d,Q.tx=J.tx*Z.a+J.ty*Z.c+Z.tx,Q.ty=J.tx*Z.b+J.ty*Z.d+Z.ty,this._parentID=$._worldID,this._worldID++}}setFromMatrix($){$.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation($){this._rotation!==$&&(this._rotation=$,this.updateSkew())}};HJ.IDENTITY=new HJ;var g8=HJ;g8.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};/*!
 * @pixi-essentials/cull - v1.1.0
 * Compiled Sun, 05 Mar 2023 03:07:48 UTC
 *
 * @pixi-essentials/cull is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2020, Shukant Pal <shukantpal@outlook.com>, All Rights Reserved
 */var G5=new y;class XJ{constructor($={}){this._recursive=typeof $.recursive==="boolean"?$.recursive:!0,this._toggle=$.toggle||"visible",this._targetList=new Set}add($){return this._targetList.add($),this}addAll($){for(let J=0,Z=$.length;J<Z;J++)this._targetList.add($[J]);return this}remove($){return this._targetList.delete($),this}removeAll($){for(let J=0,Z=$.length;J<Z;J++)this._targetList.delete($[J]);return this}clear(){return this._targetList.clear(),this}cull($,J=!1){if(!J)this.uncull();return this._targetList.forEach((Z)=>{if(!J)Z.getBounds(!1,G5);if(this._recursive)this.cullRecursive($,Z,J);else{if(J)Z._bounds.getRectangle($);Z[this._toggle]=G5.right>$.left&&G5.left<$.right&&G5.bottom>$.top&&G5.top<$.bottom}}),this}uncull(){return this._targetList.forEach(($)=>{if(this._recursive)this.uncullRecursive($);else $[this._toggle]=!1}),this}cullRecursive($,J,Z){let Q=Z?J._bounds.getRectangle(G5):J.getBounds(!0,G5);if(J[this._toggle]=Q.right>$.left&&Q.left<$.right&&Q.bottom>$.top&&Q.top<$.bottom,!(Q.left>=$.left&&Q.top>=$.top&&Q.right<=$.right&&Q.bottom<=$.bottom)&&J[this._toggle]&&J.children&&J.children.length){let K=J.children;for(let V=0,H=K.length;V<H;V++)this.cullRecursive($,K[V])}}uncullRecursive($){if($[this._toggle]=!0,$.children&&$.children.length){let J=$.children;for(let Z=0,Q=J.length;Z<Q;Z++)this.uncullRecursive(J[Z])}}}var k1=(($)=>($[$.WEBGL_LEGACY=0]="WEBGL_LEGACY",$[$.WEBGL=1]="WEBGL",$[$.WEBGL2=2]="WEBGL2",$))(k1||{}),WJ=(($)=>($[$.UNKNOWN=0]="UNKNOWN",$[$.WEBGL=1]="WEBGL",$[$.CANVAS=2]="CANVAS",$))(WJ||{}),K$=(($)=>($[$.COLOR=16384]="COLOR",$[$.DEPTH=256]="DEPTH",$[$.STENCIL=1024]="STENCIL",$))(K$||{}),s=(($)=>($[$.NORMAL=0]="NORMAL",$[$.ADD=1]="ADD",$[$.MULTIPLY=2]="MULTIPLY",$[$.SCREEN=3]="SCREEN",$[$.OVERLAY=4]="OVERLAY",$[$.DARKEN=5]="DARKEN",$[$.LIGHTEN=6]="LIGHTEN",$[$.COLOR_DODGE=7]="COLOR_DODGE",$[$.COLOR_BURN=8]="COLOR_BURN",$[$.HARD_LIGHT=9]="HARD_LIGHT",$[$.SOFT_LIGHT=10]="SOFT_LIGHT",$[$.DIFFERENCE=11]="DIFFERENCE",$[$.EXCLUSION=12]="EXCLUSION",$[$.HUE=13]="HUE",$[$.SATURATION=14]="SATURATION",$[$.COLOR=15]="COLOR",$[$.LUMINOSITY=16]="LUMINOSITY",$[$.NORMAL_NPM=17]="NORMAL_NPM",$[$.ADD_NPM=18]="ADD_NPM",$[$.SCREEN_NPM=19]="SCREEN_NPM",$[$.NONE=20]="NONE",$[$.SRC_OVER=0]="SRC_OVER",$[$.SRC_IN=21]="SRC_IN",$[$.SRC_OUT=22]="SRC_OUT",$[$.SRC_ATOP=23]="SRC_ATOP",$[$.DST_OVER=24]="DST_OVER",$[$.DST_IN=25]="DST_IN",$[$.DST_OUT=26]="DST_OUT",$[$.DST_ATOP=27]="DST_ATOP",$[$.ERASE=26]="ERASE",$[$.SUBTRACT=28]="SUBTRACT",$[$.XOR=29]="XOR",$))(s||{}),B1=(($)=>($[$.POINTS=0]="POINTS",$[$.LINES=1]="LINES",$[$.LINE_LOOP=2]="LINE_LOOP",$[$.LINE_STRIP=3]="LINE_STRIP",$[$.TRIANGLES=4]="TRIANGLES",$[$.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",$[$.TRIANGLE_FAN=6]="TRIANGLE_FAN",$))(B1||{}),h=(($)=>($[$.RGBA=6408]="RGBA",$[$.RGB=6407]="RGB",$[$.RG=33319]="RG",$[$.RED=6403]="RED",$[$.RGBA_INTEGER=36249]="RGBA_INTEGER",$[$.RGB_INTEGER=36248]="RGB_INTEGER",$[$.RG_INTEGER=33320]="RG_INTEGER",$[$.RED_INTEGER=36244]="RED_INTEGER",$[$.ALPHA=6406]="ALPHA",$[$.LUMINANCE=6409]="LUMINANCE",$[$.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",$[$.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",$[$.DEPTH_STENCIL=34041]="DEPTH_STENCIL",$))(h||{}),L8=(($)=>($[$.TEXTURE_2D=3553]="TEXTURE_2D",$[$.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",$[$.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",$[$.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",$[$.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",$[$.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",$[$.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",$))(L8||{}),p=(($)=>($[$.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",$[$.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",$[$.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",$[$.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",$[$.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",$[$.UNSIGNED_INT=5125]="UNSIGNED_INT",$[$.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",$[$.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",$[$.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",$[$.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",$[$.BYTE=5120]="BYTE",$[$.SHORT=5122]="SHORT",$[$.INT=5124]="INT",$[$.FLOAT=5126]="FLOAT",$[$.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",$[$.HALF_FLOAT=36193]="HALF_FLOAT",$))(p||{}),c=(($)=>($[$.FLOAT=0]="FLOAT",$[$.INT=1]="INT",$[$.UINT=2]="UINT",$))(c||{}),I1=(($)=>($[$.NEAREST=0]="NEAREST",$[$.LINEAR=1]="LINEAR",$))(I1||{}),X1=(($)=>($[$.CLAMP=33071]="CLAMP",$[$.REPEAT=10497]="REPEAT",$[$.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",$))(X1||{}),n0=(($)=>($[$.OFF=0]="OFF",$[$.POW2=1]="POW2",$[$.ON=2]="ON",$[$.ON_MANUAL=3]="ON_MANUAL",$))(n0||{}),F0=(($)=>($[$.NPM=0]="NPM",$[$.UNPACK=1]="UNPACK",$[$.PMA=2]="PMA",$[$.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",$[$.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",$[$.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",$))(F0||{}),A1=(($)=>($[$.NO=0]="NO",$[$.YES=1]="YES",$[$.AUTO=2]="AUTO",$[$.BLEND=0]="BLEND",$[$.CLEAR=1]="CLEAR",$[$.BLIT=2]="BLIT",$))(A1||{}),V$=(($)=>($[$.AUTO=0]="AUTO",$[$.MANUAL=1]="MANUAL",$))(V$||{}),W1=(($)=>($.LOW="lowp",$.MEDIUM="mediump",$.HIGH="highp",$))(W1||{}),D0=(($)=>($[$.NONE=0]="NONE",$[$.SCISSOR=1]="SCISSOR",$[$.STENCIL=2]="STENCIL",$[$.SPRITE=3]="SPRITE",$[$.COLOR=4]="COLOR",$))(D0||{});var H0=(($)=>($[$.NONE=0]="NONE",$[$.LOW=2]="LOW",$[$.MEDIUM=4]="MEDIUM",$[$.HIGH=8]="HIGH",$))(H0||{}),F1=(($)=>($[$.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",$[$.ARRAY_BUFFER=34962]="ARRAY_BUFFER",$[$.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",$))(F1||{});var zJ={createCanvas:($,J)=>{let Z=document.createElement("canvas");return Z.width=$,Z.height=J,Z},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:($,J)=>fetch($,J),parseXML:($)=>new DOMParser().parseFromString($,"text/xml")};var _={ADAPTER:zJ,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var GJ=/iPhone/i,KK=/iPod/i,VK=/iPad/i,HK=/\biOS-universal(?:.+)Mac\b/i,YJ=/\bAndroid(?:.+)Mobile\b/i,XK=/Android/i,m5=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,H$=/Silk/i,k8=/Windows Phone/i,WK=/\bWindows(?:.+)ARM\b/i,zK=/BlackBerry/i,GK=/BB10/i,YK=/Opera Mini/i,wK=/\b(CriOS|Chrome)(?:.+)Mobile/i,UK=/Mobile(?:.+)Firefox\b/i,CK=function($){return typeof $!=="undefined"&&$.platform==="MacIntel"&&typeof $.maxTouchPoints==="number"&&$.maxTouchPoints>1&&typeof MSStream==="undefined"};function gY($){return function(J){return J.test($)}}function f6($){var J={userAgent:"",platform:"",maxTouchPoints:0};if(!$&&typeof navigator!=="undefined")J={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};else if(typeof $==="string")J.userAgent=$;else if($&&$.userAgent)J={userAgent:$.userAgent,platform:$.platform,maxTouchPoints:$.maxTouchPoints||0};var Z=J.userAgent,Q=Z.split("[FBAN");if(typeof Q[1]!=="undefined")Z=Q[0];if(Q=Z.split("Twitter"),typeof Q[1]!=="undefined")Z=Q[0];var q=gY(Z),K={apple:{phone:q(GJ)&&!q(k8),ipod:q(KK),tablet:!q(GJ)&&(q(VK)||CK(J))&&!q(k8),universal:q(HK),device:(q(GJ)||q(KK)||q(VK)||q(HK)||CK(J))&&!q(k8)},amazon:{phone:q(m5),tablet:!q(m5)&&q(H$),device:q(m5)||q(H$)},android:{phone:!q(k8)&&q(m5)||!q(k8)&&q(YJ),tablet:!q(k8)&&!q(m5)&&!q(YJ)&&(q(H$)||q(XK)),device:!q(k8)&&(q(m5)||q(H$)||q(YJ)||q(XK))||q(/\bokhttp\b/i)},windows:{phone:q(k8),tablet:q(WK),device:q(k8)||q(WK)},other:{blackberry:q(zK),blackberry10:q(GK),opera:q(YK),firefox:q(UK),chrome:q(wK),device:q(zK)||q(GK)||q(YK)||q(UK)||q(wK)},any:!1,phone:!1,tablet:!1};return K.any=K.apple.device||K.android.device||K.windows.device||K.other.device,K.phone=K.apple.phone||K.android.phone||K.windows.phone,K.tablet=K.apple.tablet||K.android.tablet||K.windows.tablet,K}var xY=f6.default??f6,f1=xY(globalThis.navigator);var R={};pW(R,{url:()=>EK,uid:()=>K8,trimCanvas:()=>VV,string2hex:()=>oK,skipHello:()=>TK,sign:()=>JV,sayHello:()=>SK,rgb2hex:()=>sK,removeItems:()=>B$,premultiplyTintToRgba:()=>tK,premultiplyTint:()=>rK,premultiplyRgba:()=>aK,premultiplyBlendMode:()=>d6,path:()=>_J,nextPow2:()=>c8,log2:()=>l6,isWebGLSupported:()=>U$,isPow2:()=>p6,isMobile:()=>f1,interleaveTypedArrays:()=>$V,hex2string:()=>nK,hex2rgb:()=>lK,getResolutionOfUrl:()=>s6,getCanvasBoundingBox:()=>I$,getBufferType:()=>x8,earcut:()=>XV.default,determineCrossOrigin:()=>F$,detectVideoAlphaMode:()=>hK,destroyTextureCache:()=>ZV,deprecation:()=>a,decomposeDataUri:()=>HV,createIndicesForQuads:()=>eK,correctBlendMode:()=>iK,clearTextureCache:()=>QV,TextureCache:()=>y0,ProgramCache:()=>o6,EventEmitter:()=>m8.default,DATA_URI:()=>N$,CanvasRenderTarget:()=>TJ,BoundingBox:()=>n6,BaseTextureCache:()=>G1});_.RETINA_PREFIX=/@([0-9\.]+)x/;_.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var m8=f5(BK(),1),XV=f5(_K(),1);var{URL:Qw,URLSearchParams:xO}=globalThis;function jJ($){return typeof $==="string"}function kK($){return typeof $==="object"&&$!==null}function w$($){return $===null}function qw($){return $==null}function n1(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Kw=/^([a-z0-9.+-]+:)/i,Vw=/:[0-9]*$/,Hw=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Xw=["<",">",'"',"`"," ","\r",`
`,"\t"],Ww=["{","}","|","\\","^","`"].concat(Xw),IJ=["'"].concat(Ww),PK=["%","/","?",";","#"].concat(IJ),DK=["/","?","#"],zw=255,LK=/^[+a-z0-9A-Z_-]{0,63}$/,Gw=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Yw={javascript:!0,"javascript:":!0},FJ={javascript:!0,"javascript:":!0},d5={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},OJ={parse($){var J=decodeURIComponent;return($+"").replace(/\+/g," ").split("&").filter(Boolean).reduce(function(Z,Q,q){var K=Q.split("="),V=J(K[0]||""),H=J(K[1]||""),X=Z[V];return Z[V]=X===void 0?H:[].concat(X,H),Z},{})},stringify($){var J=encodeURIComponent;return Object.keys($||{}).reduce(function(Z,Q){return[].concat($[Q]).forEach(function(q){Z.push(J(Q)+"="+J(q))}),Z},[]).join("&").replace(/\s/g,"+")}};function c6($,J,Z){if($&&kK($)&&$ instanceof n1)return $;var Q=new n1;return Q.parse($,J,Z),Q}n1.prototype.parse=function($,J,Z){if(!jJ($))throw new TypeError("Parameter 'url' must be a string, not "+typeof $);var Q=$.indexOf("?"),q=Q!==-1&&Q<$.indexOf("#")?"?":"#",K=$.split(q),V=/\\/g;K[0]=K[0].replace(V,"/"),$=K.join(q);var H=$;if(H=H.trim(),!Z&&$.split("#").length===1){var X=Hw.exec(H);if(X){if(this.path=H,this.href=H,this.pathname=X[1],X[2])if(this.search=X[2],J)this.query=OJ.parse(this.search.substr(1));else this.query=this.search.substr(1);else if(J)this.search="",this.query={};return this}}var W=Kw.exec(H);if(W){W=W[0];var z=W.toLowerCase();this.protocol=z,H=H.substr(W.length)}if(Z||W||H.match(/^\/\/[^@\/]+@[^@\/]+/)){var G=H.substr(0,2)==="//";if(G&&!(W&&FJ[W]))H=H.substr(2),this.slashes=!0}if(!FJ[W]&&(G||W&&!d5[W])){var Y=-1;for(var w=0;w<DK.length;w++){var U=H.indexOf(DK[w]);if(U!==-1&&(Y===-1||U<Y))Y=U}var C,N;if(Y===-1)N=H.lastIndexOf("@");else N=H.lastIndexOf("@",Y);if(N!==-1)C=H.slice(0,N),H=H.slice(N+1),this.auth=decodeURIComponent(C);Y=-1;for(var w=0;w<PK.length;w++){var U=H.indexOf(PK[w]);if(U!==-1&&(Y===-1||U<Y))Y=U}if(Y===-1)Y=H.length;this.host=H.slice(0,Y),H=H.slice(Y),this.parseHost(),this.hostname=this.hostname||"";var O=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!O){var I=this.hostname.split(/\./);for(var w=0,B=I.length;w<B;w++){var F=I[w];if(!F)continue;if(!F.match(LK)){var P="";for(var L=0,M=F.length;L<M;L++)if(F.charCodeAt(L)>127)P+="x";else P+=F[L];if(!P.match(LK)){var E=I.slice(0,w),g=I.slice(w+1),o=F.match(Gw);if(o)E.push(o[1]),g.unshift(o[2]);if(g.length)H="/"+g.join(".")+H;this.hostname=E.join(".");break}}}}if(this.hostname.length>zw)this.hostname="";else this.hostname=this.hostname.toLowerCase();if(!O)this.hostname=new Qw(`https://${this.hostname}`).hostname;var f=this.port?":"+this.port:"",x=this.hostname||"";if(this.host=x+f,this.href+=this.host,O){if(this.hostname=this.hostname.substr(1,this.hostname.length-2),H[0]!=="/")H="/"+H}}if(!Yw[z])for(var w=0,B=IJ.length;w<B;w++){var k=IJ[w];if(H.indexOf(k)===-1)continue;var T=encodeURIComponent(k);if(T===k)T=escape(k);H=H.split(k).join(T)}var J0=H.indexOf("#");if(J0!==-1)this.hash=H.substr(J0),H=H.slice(0,J0);var n=H.indexOf("?");if(n!==-1){if(this.search=H.substr(n),this.query=H.substr(n+1),J)this.query=OJ.parse(this.query);H=H.slice(0,n)}else if(J)this.search="",this.query={};if(H)this.pathname=H;if(d5[z]&&this.hostname&&!this.pathname)this.pathname="/";if(this.pathname||this.search){var f=this.pathname||"",S=this.search||"";this.path=f+S}return this.href=this.format(),this};function AK($){if(jJ($))$=c6($);if(!($ instanceof n1))return n1.prototype.format.call($);return $.format()}n1.prototype.format=function(){var $=this.auth||"";if($)$=encodeURIComponent($),$=$.replace(/%3A/i,":"),$+="@";var J=this.protocol||"",Z=this.pathname||"",Q=this.hash||"",q=!1,K="";if(this.host)q=$+this.host;else if(this.hostname){if(q=$+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port)q+=":"+this.port}if(this.query&&kK(this.query)&&Object.keys(this.query).length)K=OJ.stringify(this.query);var V=this.search||K&&"?"+K||"";if(J&&J.substr(-1)!==":")J+=":";if(this.slashes||(!J||d5[J])&&q!==!1){if(q="//"+(q||""),Z&&Z.charAt(0)!=="/")Z="/"+Z}else if(!q)q="";if(Q&&Q.charAt(0)!=="#")Q="#"+Q;if(V&&V.charAt(0)!=="?")V="?"+V;return Z=Z.replace(/[?#]/g,function(H){return encodeURIComponent(H)}),V=V.replace("#","%23"),J+q+Z+V+Q};function RK($,J){return c6($,!1,!0).resolve(J)}n1.prototype.resolve=function($){return this.resolveObject(c6($,!1,!0)).format()};n1.prototype.resolveObject=function($){if(jJ($)){var J=new n1;J.parse($,!1,!0),$=J}var Z=new n1,Q=Object.keys(this);for(var q=0;q<Q.length;q++){var K=Q[q];Z[K]=this[K]}if(Z.hash=$.hash,$.href==="")return Z.href=Z.format(),Z;if($.slashes&&!$.protocol){var V=Object.keys($);for(var H=0;H<V.length;H++){var X=V[H];if(X!=="protocol")Z[X]=$[X]}if(d5[Z.protocol]&&Z.hostname&&!Z.pathname)Z.path=Z.pathname="/";return Z.href=Z.format(),Z}if($.protocol&&$.protocol!==Z.protocol){if(!d5[$.protocol]){var W=Object.keys($);for(var z=0;z<W.length;z++){var G=W[z];Z[G]=$[G]}return Z.href=Z.format(),Z}if(Z.protocol=$.protocol,!$.host&&!FJ[$.protocol]){var B=($.pathname||"").split("/");while(B.length&&!($.host=B.shift()));if(!$.host)$.host="";if(!$.hostname)$.hostname="";if(B[0]!=="")B.unshift("");if(B.length<2)B.unshift("");Z.pathname=B.join("/")}else Z.pathname=$.pathname;if(Z.search=$.search,Z.query=$.query,Z.host=$.host||"",Z.auth=$.auth,Z.hostname=$.hostname||$.host,Z.port=$.port,Z.pathname||Z.search){var Y=Z.pathname||"",w=Z.search||"";Z.path=Y+w}return Z.slashes=Z.slashes||$.slashes,Z.href=Z.format(),Z}var U=Z.pathname&&Z.pathname.charAt(0)==="/",C=$.host||$.pathname&&$.pathname.charAt(0)==="/",N=C||U||Z.host&&$.pathname,O=N,I=Z.pathname&&Z.pathname.split("/")||[],B=$.pathname&&$.pathname.split("/")||[],F=Z.protocol&&!d5[Z.protocol];if(F){if(Z.hostname="",Z.port=null,Z.host)if(I[0]==="")I[0]=Z.host;else I.unshift(Z.host);if(Z.host="",$.protocol){if($.hostname=null,$.port=null,$.host)if(B[0]==="")B[0]=$.host;else B.unshift($.host);$.host=null}N=N&&(B[0]===""||I[0]==="")}if(C)Z.host=$.host||$.host===""?$.host:Z.host,Z.hostname=$.hostname||$.hostname===""?$.hostname:Z.hostname,Z.search=$.search,Z.query=$.query,I=B;else if(B.length){if(!I)I=[];I.pop(),I=I.concat(B),Z.search=$.search,Z.query=$.query}else if(!qw($.search)){if(F){Z.hostname=Z.host=I.shift();var P=Z.host&&Z.host.indexOf("@")>0?Z.host.split("@"):!1;if(P)Z.auth=P.shift(),Z.host=Z.hostname=P.shift()}if(Z.search=$.search,Z.query=$.query,!w$(Z.pathname)||!w$(Z.search))Z.path=(Z.pathname?Z.pathname:"")+(Z.search?Z.search:"");return Z.href=Z.format(),Z}if(!I.length){if(Z.pathname=null,Z.search)Z.path="/"+Z.search;else Z.path=null;return Z.href=Z.format(),Z}var L=I.slice(-1)[0],M=(Z.host||$.host||I.length>1)&&(L==="."||L==="..")||L==="",E=0;for(var g=I.length;g>=0;g--)if(L=I[g],L===".")I.splice(g,1);else if(L==="..")I.splice(g,1),E++;else if(E)I.splice(g,1),E--;if(!N&&!O)for(;E--;E)I.unshift("..");if(N&&I[0]!==""&&(!I[0]||I[0].charAt(0)!=="/"))I.unshift("");if(M&&I.join("/").substr(-1)!=="/")I.push("");var o=I[0]===""||I[0]&&I[0].charAt(0)==="/";if(F){Z.hostname=Z.host=o?"":I.length?I.shift():"";var P=Z.host&&Z.host.indexOf("@")>0?Z.host.split("@"):!1;if(P)Z.auth=P.shift(),Z.host=Z.hostname=P.shift()}if(N=N||Z.host&&I.length,N&&!o)I.unshift("");if(!I.length)Z.pathname=null,Z.path=null;else Z.pathname=I.join("/");if(!w$(Z.pathname)||!w$(Z.search))Z.path=(Z.pathname?Z.pathname:"")+(Z.search?Z.search:"");return Z.auth=$.auth||Z.auth,Z.slashes=Z.slashes||$.slashes,Z.href=Z.format(),Z};n1.prototype.parseHost=function(){var $=this.host,J=Vw.exec($);if(J){if(J=J[0],J!==":")this.port=J.substr(1);$=$.substr(0,$.length-J.length)}if($)this.hostname=$};var MK={};function a($,J,Z=3){if(MK[J])return;let Q=new Error().stack;typeof Q>"u"?console.warn("PixiJS Deprecation Warning: ",`${J}
Deprecated since v${$}`):(Q=Q.split(`
`).splice(Z).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${J}
Deprecated since v${$}`),console.warn(Q),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${J}
Deprecated since v${$}`),console.warn(Q))),MK[J]=!0}var EK={get parse(){return a("7.3.0","utils.url.parse is deprecated, use native URL API instead."),c6},get format(){return a("7.3.0","utils.url.format is deprecated, use native URL API instead."),AK},get resolve(){return a("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),RK}};function o1($){if(typeof $!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify($)}`)}function m6($){return $.split("?")[0].split("#")[0]}function ww($){return $.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Uw($,J,Z){return $.replace(new RegExp(ww(J),"g"),Z)}function Cw($,J){let Z="",Q=0,q=-1,K=0,V=-1;for(let H=0;H<=$.length;++H){if(H<$.length)V=$.charCodeAt(H);else{if(V===47)break;V=47}if(V===47){if(!(q===H-1||K===1))if(q!==H-1&&K===2){if(Z.length<2||Q!==2||Z.charCodeAt(Z.length-1)!==46||Z.charCodeAt(Z.length-2)!==46){if(Z.length>2){let X=Z.lastIndexOf("/");if(X!==Z.length-1){X===-1?(Z="",Q=0):(Z=Z.slice(0,X),Q=Z.length-1-Z.lastIndexOf("/")),q=H,K=0;continue}}else if(Z.length===2||Z.length===1){Z="",Q=0,q=H,K=0;continue}}J&&(Z.length>0?Z+="/..":Z="..",Q=2)}else Z.length>0?Z+=`/${$.slice(q+1,H)}`:Z=$.slice(q+1,H),Q=H-q-1;q=H,K=0}else V===46&&K!==-1?++K:K=-1}return Z}var _J={toPosix($){return Uw($,"\\","/")},isUrl($){return/^https?:/.test(this.toPosix($))},isDataUrl($){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test($)},isBlobUrl($){return $.startsWith("blob:")},hasProtocol($){return/^[^/:]+:/.test(this.toPosix($))},getProtocol($){o1($),$=this.toPosix($);let J=/^file:\/\/\//.exec($);if(J)return J[0];let Z=/^[^/:]+:\/{0,2}/.exec($);return Z?Z[0]:""},toAbsolute($,J,Z){if(o1($),this.isDataUrl($)||this.isBlobUrl($))return $;let Q=m6(this.toPosix(J??_.ADAPTER.getBaseUrl())),q=m6(this.toPosix(Z??this.rootname(Q)));return $=this.toPosix($),$.startsWith("/")?_J.join(q,$.slice(1)):this.isAbsolute($)?$:this.join(Q,$)},normalize($){if(o1($),$.length===0)return".";if(this.isDataUrl($)||this.isBlobUrl($))return $;$=this.toPosix($);let J="",Z=$.startsWith("/");this.hasProtocol($)&&(J=this.rootname($),$=$.slice(J.length));let Q=$.endsWith("/");return $=Cw($,!1),$.length>0&&Q&&($+="/"),Z?`/${$}`:J+$},isAbsolute($){return o1($),$=this.toPosix($),this.hasProtocol($)?!0:$.startsWith("/")},join(...$){if($.length===0)return".";let J;for(let Z=0;Z<$.length;++Z){let Q=$[Z];if(o1(Q),Q.length>0)if(J===void 0)J=Q;else{let q=$[Z-1]??"";this.joinExtensions.includes(this.extname(q).toLowerCase())?J+=`/../${Q}`:J+=`/${Q}`}}return J===void 0?".":this.normalize(J)},dirname($){if(o1($),$.length===0)return".";$=this.toPosix($);let J=$.charCodeAt(0),Z=J===47,Q=-1,q=!0,K=this.getProtocol($),V=$;$=$.slice(K.length);for(let H=$.length-1;H>=1;--H)if(J=$.charCodeAt(H),J===47){if(!q){Q=H;break}}else q=!1;return Q===-1?Z?"/":this.isUrl(V)?K+$:K:Z&&Q===1?"//":K+$.slice(0,Q)},rootname($){o1($),$=this.toPosix($);let J="";if($.startsWith("/")?J="/":J=this.getProtocol($),this.isUrl($)){let Z=$.indexOf("/",J.length);Z!==-1?J=$.slice(0,Z):J=$,J.endsWith("/")||(J+="/")}return J},basename($,J){o1($),J&&o1(J),$=m6(this.toPosix($));let Z=0,Q=-1,q=!0,K;if(J!==void 0&&J.length>0&&J.length<=$.length){if(J.length===$.length&&J===$)return"";let V=J.length-1,H=-1;for(K=$.length-1;K>=0;--K){let X=$.charCodeAt(K);if(X===47){if(!q){Z=K+1;break}}else H===-1&&(q=!1,H=K+1),V>=0&&(X===J.charCodeAt(V)?--V===-1&&(Q=K):(V=-1,Q=H))}return Z===Q?Q=H:Q===-1&&(Q=$.length),$.slice(Z,Q)}for(K=$.length-1;K>=0;--K)if($.charCodeAt(K)===47){if(!q){Z=K+1;break}}else Q===-1&&(q=!1,Q=K+1);return Q===-1?"":$.slice(Z,Q)},extname($){o1($),$=m6(this.toPosix($));let J=-1,Z=0,Q=-1,q=!0,K=0;for(let V=$.length-1;V>=0;--V){let H=$.charCodeAt(V);if(H===47){if(!q){Z=V+1;break}continue}Q===-1&&(q=!1,Q=V+1),H===46?J===-1?J=V:K!==1&&(K=1):J!==-1&&(K=-1)}return J===-1||Q===-1||K===0||K===1&&J===Q-1&&J===Z+1?"":$.slice(J,Q)},parse($){o1($);let J={root:"",dir:"",base:"",ext:"",name:""};if($.length===0)return J;$=m6(this.toPosix($));let Z=$.charCodeAt(0),Q=this.isAbsolute($),q,K="";J.root=this.rootname($),Q||this.hasProtocol($)?q=1:q=0;let V=-1,H=0,X=-1,W=!0,z=$.length-1,G=0;for(;z>=q;--z){if(Z=$.charCodeAt(z),Z===47){if(!W){H=z+1;break}continue}X===-1&&(W=!1,X=z+1),Z===46?V===-1?V=z:G!==1&&(G=1):V!==-1&&(G=-1)}return V===-1||X===-1||G===0||G===1&&V===X-1&&V===H+1?X!==-1&&(H===0&&Q?J.base=J.name=$.slice(1,X):J.base=J.name=$.slice(H,X)):(H===0&&Q?(J.name=$.slice(1,V),J.base=$.slice(1,X)):(J.name=$.slice(H,V),J.base=$.slice(H,X)),J.ext=$.slice(V,X)),J.dir=this.dirname($),K&&(J.dir=K+J.dir),J},sep:"/",delimiter:":",joinExtensions:[".html"]};var PJ;async function hK(){return PJ??(PJ=(async()=>{let $=document.createElement("canvas").getContext("webgl");if(!$)return F0.UNPACK;let J=await new Promise((K)=>{let V=document.createElement("video");V.onloadeddata=()=>K(V),V.onerror=()=>K(null),V.autoplay=!1,V.crossOrigin="anonymous",V.preload="auto",V.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",V.load()});if(!J)return F0.UNPACK;let Z=$.createTexture();$.bindTexture($.TEXTURE_2D,Z);let Q=$.createFramebuffer();$.bindFramebuffer($.FRAMEBUFFER,Q),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,Z,0),$.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),$.pixelStorei($.UNPACK_COLORSPACE_CONVERSION_WEBGL,$.NONE),$.texImage2D($.TEXTURE_2D,0,$.RGBA,$.RGBA,$.UNSIGNED_BYTE,J);let q=new Uint8Array(4);return $.readPixels(0,0,1,1,$.RGBA,$.UNSIGNED_BYTE,q),$.deleteFramebuffer(Q),$.deleteTexture(Z),$.getExtension("WEBGL_lose_context")?.loseContext(),q[0]<=q[3]?F0.PMA:F0.UNPACK})()),PJ}function TK(){a("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function SK(){a("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}var DJ;function U$(){return typeof DJ>"u"&&(DJ=function(){let $={stencil:!0,failIfMajorPerformanceCaveat:_.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!_.ADAPTER.getWebGLRenderingContext())return!1;let J=_.ADAPTER.createCanvas(),Z=J.getContext("webgl",$)||J.getContext("experimental-webgl",$),Q=!!Z?.getContextAttributes()?.stencil;if(Z){let q=Z.getExtension("WEBGL_lose_context");q&&q.loseContext()}return Z=null,Q}catch{return!1}}()),DJ}var Nw={grad:0.9,turn:360,rad:360/(2*Math.PI)},A8=function($){return typeof $=="string"?$.length>0:typeof $=="number"},v0=function($,J,Z){return J===void 0&&(J=0),Z===void 0&&(Z=Math.pow(10,J)),Math.round(Z*$)/Z+0},v1=function($,J,Z){return J===void 0&&(J=0),Z===void 0&&(Z=1),$>Z?Z:$>J?$:J},mK=function($){return($=isFinite($)?$%360:0)>0?$:$+360},bK=function($){return{r:v1($.r,0,255),g:v1($.g,0,255),b:v1($.b,0,255),a:v1($.a)}},LJ=function($){return{r:v0($.r),g:v0($.g),b:v0($.b),a:v0($.a,3)}},Bw=/^#([0-9a-f]{3,8})$/i,C$=function($){var J=$.toString(16);return J.length<2?"0"+J:J},uK=function($){var{r:J,g:Z,b:Q,a:q}=$,K=Math.max(J,Z,Q),V=K-Math.min(J,Z,Q),H=V?K===J?(Z-Q)/V:K===Z?2+(Q-J)/V:4+(J-Z)/V:0;return{h:60*(H<0?H+6:H),s:K?V/K*100:0,v:K/255*100,a:q}},dK=function($){var{h:J,s:Z,v:Q,a:q}=$;J=J/360*6,Z/=100,Q/=100;var K=Math.floor(J),V=Q*(1-Z),H=Q*(1-(J-K)*Z),X=Q*(1-(1-J+K)*Z),W=K%6;return{r:255*[Q,H,V,V,X,Q][W],g:255*[X,Q,Q,H,V,V][W],b:255*[V,V,X,Q,Q,H][W],a:q}},fK=function($){return{h:mK($.h),s:v1($.s,0,100),l:v1($.l,0,100),a:v1($.a)}},vK=function($){return{h:v0($.h),s:v0($.s),l:v0($.l),a:v0($.a,3)}},yK=function($){return dK((Z=(J=$).s,{h:J.h,s:(Z*=((Q=J.l)<50?Q:100-Q)/100)>0?2*Z/(Q+Z)*100:0,v:Q+Z,a:J.a}));var J,Z,Q},u6=function($){return{h:(J=uK($)).h,s:(q=(200-(Z=J.s))*(Q=J.v)/100)>0&&q<200?Z*Q/100/(q<=100?q:200-q)*100:0,l:q/2,a:J.a};var J,Z,Q,q},Iw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Fw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ow=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,jw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,RJ={string:[[function($){var J=Bw.exec($);return J?($=J[1]).length<=4?{r:parseInt($[0]+$[0],16),g:parseInt($[1]+$[1],16),b:parseInt($[2]+$[2],16),a:$.length===4?v0(parseInt($[3]+$[3],16)/255,2):1}:$.length===6||$.length===8?{r:parseInt($.substr(0,2),16),g:parseInt($.substr(2,2),16),b:parseInt($.substr(4,2),16),a:$.length===8?v0(parseInt($.substr(6,2),16)/255,2):1}:null:null},"hex"],[function($){var J=Ow.exec($)||jw.exec($);return J?J[2]!==J[4]||J[4]!==J[6]?null:bK({r:Number(J[1])/(J[2]?0.39215686274509803:1),g:Number(J[3])/(J[4]?0.39215686274509803:1),b:Number(J[5])/(J[6]?0.39215686274509803:1),a:J[7]===void 0?1:Number(J[7])/(J[8]?100:1)}):null},"rgb"],[function($){var J=Iw.exec($)||Fw.exec($);if(!J)return null;var Z,Q,q=fK({h:(Z=J[1],Q=J[2],Q===void 0&&(Q="deg"),Number(Z)*(Nw[Q]||1)),s:Number(J[3]),l:Number(J[4]),a:J[5]===void 0?1:Number(J[5])/(J[6]?100:1)});return yK(q)},"hsl"]],object:[[function($){var{r:J,g:Z,b:Q,a:q}=$,K=q===void 0?1:q;return A8(J)&&A8(Z)&&A8(Q)?bK({r:Number(J),g:Number(Z),b:Number(Q),a:Number(K)}):null},"rgb"],[function($){var{h:J,s:Z,l:Q,a:q}=$,K=q===void 0?1:q;if(!A8(J)||!A8(Z)||!A8(Q))return null;var V=fK({h:Number(J),s:Number(Z),l:Number(Q),a:Number(K)});return yK(V)},"hsl"],[function($){var{h:J,s:Z,v:Q,a:q}=$,K=q===void 0?1:q;if(!A8(J)||!A8(Z)||!A8(Q))return null;var V=function(H){return{h:mK(H.h),s:v1(H.s,0,100),v:v1(H.v,0,100),a:v1(H.a)}}({h:Number(J),s:Number(Z),v:Number(Q),a:Number(K)});return dK(V)},"hsv"]]},gK=function($,J){for(var Z=0;Z<J.length;Z++){var Q=J[Z][0]($);if(Q)return[Q,J[Z][1]]}return[null,void 0]},_w=function($){return typeof $=="string"?gK($.trim(),RJ.string):typeof $=="object"&&$!==null?gK($,RJ.object):[null,void 0]};var kJ=function($,J){var Z=u6($);return{h:Z.h,s:v1(Z.s+100*J,0,100),l:Z.l,a:Z.a}},AJ=function($){return(299*$.r+587*$.g+114*$.b)/1000/255},xK=function($,J){var Z=u6($);return{h:Z.h,s:Z.s,l:v1(Z.l+100*J,0,100),a:Z.a}},MJ=function(){function $(J){this.parsed=_w(J)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return $.prototype.isValid=function(){return this.parsed!==null},$.prototype.brightness=function(){return v0(AJ(this.rgba),2)},$.prototype.isDark=function(){return AJ(this.rgba)<0.5},$.prototype.isLight=function(){return AJ(this.rgba)>=0.5},$.prototype.toHex=function(){return J=LJ(this.rgba),Z=J.r,Q=J.g,q=J.b,V=(K=J.a)<1?C$(v0(255*K)):"","#"+C$(Z)+C$(Q)+C$(q)+V;var J,Z,Q,q,K,V},$.prototype.toRgb=function(){return LJ(this.rgba)},$.prototype.toRgbString=function(){return J=LJ(this.rgba),Z=J.r,Q=J.g,q=J.b,(K=J.a)<1?"rgba("+Z+", "+Q+", "+q+", "+K+")":"rgb("+Z+", "+Q+", "+q+")";var J,Z,Q,q,K},$.prototype.toHsl=function(){return vK(u6(this.rgba))},$.prototype.toHslString=function(){return J=vK(u6(this.rgba)),Z=J.h,Q=J.s,q=J.l,(K=J.a)<1?"hsla("+Z+", "+Q+"%, "+q+"%, "+K+")":"hsl("+Z+", "+Q+"%, "+q+"%)";var J,Z,Q,q,K},$.prototype.toHsv=function(){return J=uK(this.rgba),{h:v0(J.h),s:v0(J.s),v:v0(J.v),a:v0(J.a,3)};var J},$.prototype.invert=function(){return s1({r:255-(J=this.rgba).r,g:255-J.g,b:255-J.b,a:J.a});var J},$.prototype.saturate=function(J){return J===void 0&&(J=0.1),s1(kJ(this.rgba,J))},$.prototype.desaturate=function(J){return J===void 0&&(J=0.1),s1(kJ(this.rgba,-J))},$.prototype.grayscale=function(){return s1(kJ(this.rgba,-1))},$.prototype.lighten=function(J){return J===void 0&&(J=0.1),s1(xK(this.rgba,J))},$.prototype.darken=function(J){return J===void 0&&(J=0.1),s1(xK(this.rgba,-J))},$.prototype.rotate=function(J){return J===void 0&&(J=15),this.hue(this.hue()+J)},$.prototype.alpha=function(J){return typeof J=="number"?s1({r:(Z=this.rgba).r,g:Z.g,b:Z.b,a:J}):v0(this.rgba.a,3);var Z},$.prototype.hue=function(J){var Z=u6(this.rgba);return typeof J=="number"?s1({h:J,s:Z.s,l:Z.l,a:Z.a}):v0(Z.h)},$.prototype.isEqual=function(J){return this.toHex()===s1(J).toHex()},$}(),s1=function($){return $ instanceof MJ?$:new MJ($)},cK=[],pK=function($){$.forEach(function(J){cK.indexOf(J)<0&&(J(MJ,RJ),cK.push(J))})};function EJ($,J){var Z={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},Q={};for(var q in Z)Q[Z[q]]=q;var K={};$.prototype.toName=function(V){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var H,X,W=Q[this.toHex()];if(W)return W;if(V==null?void 0:V.closest){var z=this.toRgb(),G=1/0,Y="black";if(!K.length)for(var w in Z)K[w]=new $(Z[w]).toRgb();for(var U in Z){var C=(H=z,X=K[U],Math.pow(H.r-X.r,2)+Math.pow(H.g-X.g,2)+Math.pow(H.b-X.b,2));C<G&&(G=C,Y=U)}return Y}},J.string.push([function(V){var H=V.toLowerCase(),X=H==="transparent"?"#0000":Z[H];return X?new $(X).toRgb():null},"name"])}pK([EJ]);var p5=class ${constructor(J=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=J}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(J){return this.value=J,this}set value(J){if(J instanceof $)this._value=this.cloneSource(J._value),this._int=J._int,this._components.set(J._components);else{if(J===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,J))&&(this.normalize(J),this._value=this.cloneSource(J))}}get value(){return this._value}cloneSource(J){return typeof J=="string"||typeof J=="number"||J instanceof Number||J===null?J:Array.isArray(J)||ArrayBuffer.isView(J)?J.slice(0):typeof J=="object"&&J!==null?{...J}:J}isSourceEqual(J,Z){let Q=typeof J;if(Q!==typeof Z)return!1;if(Q==="number"||Q==="string"||J instanceof Number)return J===Z;if(Array.isArray(J)&&Array.isArray(Z)||ArrayBuffer.isView(J)&&ArrayBuffer.isView(Z))return J.length!==Z.length?!1:J.every((q,K)=>q===Z[K]);if(J!==null&&Z!==null){let q=Object.keys(J),K=Object.keys(Z);return q.length!==K.length?!1:q.every((V)=>J[V]===Z[V])}return J===Z}toRgba(){let[J,Z,Q,q]=this._components;return{r:J,g:Z,b:Q,a:q}}toRgb(){let[J,Z,Q]=this._components;return{r:J,g:Z,b:Q}}toRgbaString(){let[J,Z,Q]=this.toUint8RgbArray();return`rgba(${J},${Z},${Q},${this.alpha})`}toUint8RgbArray(J){let[Z,Q,q]=this._components;return J=J??[],J[0]=Math.round(Z*255),J[1]=Math.round(Q*255),J[2]=Math.round(q*255),J}toRgbArray(J){J=J??[];let[Z,Q,q]=this._components;return J[0]=Z,J[1]=Q,J[2]=q,J}toNumber(){return this._int}toLittleEndianNumber(){let J=this._int;return(J>>16)+(J&65280)+((J&255)<<16)}multiply(J){let[Z,Q,q,K]=$.temp.setValue(J)._components;return this._components[0]*=Z,this._components[1]*=Q,this._components[2]*=q,this._components[3]*=K,this.refreshInt(),this._value=null,this}premultiply(J,Z=!0){return Z&&(this._components[0]*=J,this._components[1]*=J,this._components[2]*=J),this._components[3]=J,this.refreshInt(),this._value=null,this}toPremultiplied(J,Z=!0){if(J===1)return-16777216+this._int;if(J===0)return Z?0:this._int;let Q=this._int>>16&255,q=this._int>>8&255,K=this._int&255;return Z&&(Q=Q*J+0.5|0,q=q*J+0.5|0,K=K*J+0.5|0),(J*255<<24)+(Q<<16)+(q<<8)+K}toHex(){let J=this._int.toString(16);return`#${"000000".substring(0,6-J.length)+J}`}toHexa(){let J=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-J.length)+J}setAlpha(J){return this._components[3]=this._clamp(J),this}round(J){let[Z,Q,q]=this._components;return this._components[0]=Math.round(Z*J)/J,this._components[1]=Math.round(Q*J)/J,this._components[2]=Math.round(q*J)/J,this.refreshInt(),this._value=null,this}toArray(J){J=J??[];let[Z,Q,q,K]=this._components;return J[0]=Z,J[1]=Q,J[2]=q,J[3]=K,J}normalize(J){let Z,Q,q,K;if((typeof J=="number"||J instanceof Number)&&J>=0&&J<=16777215){let V=J;Z=(V>>16&255)/255,Q=(V>>8&255)/255,q=(V&255)/255,K=1}else if((Array.isArray(J)||J instanceof Float32Array)&&J.length>=3&&J.length<=4)J=this._clamp(J),[Z,Q,q,K=1]=J;else if((J instanceof Uint8Array||J instanceof Uint8ClampedArray)&&J.length>=3&&J.length<=4)J=this._clamp(J,0,255),[Z,Q,q,K=255]=J,Z/=255,Q/=255,q/=255,K/=255;else if(typeof J=="string"||typeof J=="object"){if(typeof J=="string"){let H=$.HEX_PATTERN.exec(J);H&&(J=`#${H[2]}`)}let V=s1(J);V.isValid()&&({r:Z,g:Q,b:q,a:K}=V.rgba,Z/=255,Q/=255,q/=255)}if(Z!==void 0)this._components[0]=Z,this._components[1]=Q,this._components[2]=q,this._components[3]=K,this.refreshInt();else throw new Error(`Unable to convert color ${J}`)}refreshInt(){this._clamp(this._components);let[J,Z,Q]=this._components;this._int=(J*255<<16)+(Z*255<<8)+(Q*255|0)}_clamp(J,Z=0,Q=1){return typeof J=="number"?Math.min(Math.max(J,Z),Q):(J.forEach((q,K)=>{J[K]=Math.min(Math.max(q,Z),Q)}),J)}};p5.shared=new p5,p5.temp=new p5,p5.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;var r=p5;function lK($,J=[]){return a("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),r.shared.setValue($).toRgbArray(J)}function nK($){return a("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),r.shared.setValue($).toHex()}function oK($){return a("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),r.shared.setValue($).toNumber()}function sK($){return a("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),r.shared.setValue($).toNumber()}function Pw(){let $=[],J=[];for(let Q=0;Q<32;Q++)$[Q]=Q,J[Q]=Q;$[s.NORMAL_NPM]=s.NORMAL,$[s.ADD_NPM]=s.ADD,$[s.SCREEN_NPM]=s.SCREEN,J[s.NORMAL]=s.NORMAL_NPM,J[s.ADD]=s.ADD_NPM,J[s.SCREEN]=s.SCREEN_NPM;let Z=[];return Z.push(J),Z.push($),Z}var d6=Pw();function iK($,J){return d6[J?1:0][$]}function aK($,J,Z,Q=!0){return a("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),r.shared.setValue($).premultiply(J,Q).toArray(Z??new Float32Array(4))}function rK($,J){return a("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),r.shared.setValue($).toPremultiplied(J)}function tK($,J,Z,Q=!0){return a("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),r.shared.setValue($).premultiply(J,Q).toArray(Z??new Float32Array(4))}var N$=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function eK($,J=null){let Z=$*6;if(J=J||new Uint16Array(Z),J.length!==Z)throw new Error(`Out buffer length is incorrect, got ${J.length} and expected ${Z}`);for(let Q=0,q=0;Q<Z;Q+=6,q+=4)J[Q+0]=q+0,J[Q+1]=q+1,J[Q+2]=q+2,J[Q+3]=q+0,J[Q+4]=q+2,J[Q+5]=q+3;return J}function x8($){if($.BYTES_PER_ELEMENT===4)return $ instanceof Float32Array?"Float32Array":$ instanceof Uint32Array?"Uint32Array":"Int32Array";if($.BYTES_PER_ELEMENT===2){if($ instanceof Uint16Array)return"Uint16Array"}else if($.BYTES_PER_ELEMENT===1&&$ instanceof Uint8Array)return"Uint8Array";return null}var Dw={Float32Array,Uint32Array,Int32Array,Uint8Array};function $V($,J){let Z=0,Q=0,q={};for(let X=0;X<$.length;X++)Q+=J[X],Z+=$[X].length;let K=new ArrayBuffer(Z*4),V=null,H=0;for(let X=0;X<$.length;X++){let W=J[X],z=$[X],G=x8(z);q[G]||(q[G]=new Dw[G](K)),V=q[G];for(let Y=0;Y<z.length;Y++){let w=(Y/W|0)*Q+H,U=Y%W;V[w+U]=z[Y]}H+=W}return new Float32Array(K)}function c8($){return $+=$===0?1:0,--$,$|=$>>>1,$|=$>>>2,$|=$>>>4,$|=$>>>8,$|=$>>>16,$+1}function p6($){return!($&$-1)&&!!$}function l6($){let J=($>65535?1:0)<<4;$>>>=J;let Z=($>255?1:0)<<3;return $>>>=Z,J|=Z,Z=($>15?1:0)<<2,$>>>=Z,J|=Z,Z=($>3?1:0)<<1,$>>>=Z,J|=Z,J|$>>1}function B$($,J,Z){let Q=$.length,q;if(J>=Q||Z===0)return;Z=J+Z>Q?Q-J:Z;let K=Q-Z;for(q=J;q<K;++q)$[q]=$[q+Z];$.length=K}function JV($){return $===0?0:$<0?-1:1}var Lw=0;function K8(){return++Lw}var hJ=class{constructor($,J,Z,Q){this.left=$,this.top=J,this.right=Z,this.bottom=Q}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};hJ.EMPTY=new hJ(0,0,0,0);var n6=hJ;var o6={},y0=Object.create(null),G1=Object.create(null);function ZV(){let $;for($ in y0)y0[$].destroy();for($ in G1)G1[$].destroy()}function QV(){let $;for($ in y0)delete y0[$];for($ in G1)delete G1[$]}class TJ{constructor($,J,Z){this._canvas=_.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=Z||_.RESOLUTION,this.resize($,J)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize($,J){this._checkDestroyed(),this._canvas.width=Math.round($*this.resolution),this._canvas.height=Math.round(J*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width($){this._checkDestroyed(),this._canvas.width=Math.round($)}get height(){return this._checkDestroyed(),this._canvas.height}set height($){this._checkDestroyed(),this._canvas.height=Math.round($)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function qV($,J,Z){for(let Q=0,q=4*Z*J;Q<J;++Q,q+=4)if($[q+3]!==0)return!1;return!0}function KV($,J,Z,Q,q){let K=4*J;for(let V=Q,H=Q*K+4*Z;V<=q;++V,H+=K)if($[H+3]!==0)return!1;return!0}function I$($){let{width:J,height:Z}=$,Q=$.getContext("2d",{willReadFrequently:!0});if(Q===null)throw new TypeError("Failed to get canvas 2D context");let q=Q.getImageData(0,0,J,Z).data,K=0,V=0,H=J-1,X=Z-1;for(;V<Z&&qV(q,J,V);)++V;if(V===Z)return n6.EMPTY;for(;qV(q,J,X);)--X;for(;KV(q,J,K,V,X);)++K;for(;KV(q,J,H,V,X);)--H;return++H,++X,new n6(K,V,H,X)}function VV($){let J=I$($),{width:Z,height:Q}=J,q=null;if(!J.isEmpty()){let K=$.getContext("2d");if(K===null)throw new TypeError("Failed to get canvas 2D context");q=K.getImageData(J.left,J.top,Z,Q)}return{width:Z,height:Q,data:q}}function HV($){let J=N$.exec($);if(J)return{mediaType:J[1]?J[1].toLowerCase():void 0,subType:J[2]?J[2].toLowerCase():void 0,charset:J[3]?J[3].toLowerCase():void 0,encoding:J[4]?J[4].toLowerCase():void 0,data:J[5]}}function F$($,J=globalThis.location){if($.startsWith("data:"))return"";J=J||globalThis.location;let Z=new URL($,document.baseURI);return Z.hostname!==J.hostname||Z.port!==J.port||Z.protocol!==J.protocol?"anonymous":""}function s6($,J=1){let Z=_.RETINA_PREFIX?.exec($);return Z?parseFloat(Z[1]):J}var j=(($)=>($.Renderer="renderer",$.Application="application",$.RendererSystem="renderer-webgl-system",$.RendererPlugin="renderer-webgl-plugin",$.CanvasRendererSystem="renderer-canvas-system",$.CanvasRendererPlugin="renderer-canvas-plugin",$.Asset="asset",$.LoadParser="load-parser",$.ResolveParser="resolve-parser",$.CacheParser="cache-parser",$.DetectionParser="detection-parser",$))(j||{}),SJ=($)=>{if(typeof $=="function"||typeof $=="object"&&$.extension){if(!$.extension)throw new Error("Extension class must have an extension object");$={...typeof $.extension!="object"?{type:$.extension}:$.extension,ref:$}}if(typeof $=="object")$={...$};else throw new Error("Invalid extension type");return typeof $.type=="string"&&($.type=[$.type]),$},WV=($,J)=>SJ($).priority??J,D={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...$){return $.map(SJ).forEach((J)=>{J.type.forEach((Z)=>this._removeHandlers[Z]?.(J))}),this},add(...$){return $.map(SJ).forEach((J)=>{J.type.forEach((Z)=>{let Q=this._addHandlers,q=this._queue;Q[Z]?Q[Z]?.(J):(q[Z]=q[Z]||[],q[Z]?.push(J))})}),this},handle($,J,Z){let Q=this._addHandlers,q=this._removeHandlers;if(Q[$]||q[$])throw new Error(`Extension type ${$} already has a handler`);Q[$]=J,q[$]=Z;let K=this._queue;return K[$]&&(K[$]?.forEach((V)=>J(V)),delete K[$]),this},handleByMap($,J){return this.handle($,(Z)=>{Z.name&&(J[Z.name]=Z.ref)},(Z)=>{Z.name&&delete J[Z.name]})},handleByList($,J,Z=-1){return this.handle($,(Q)=>{J.includes(Q.ref)||(J.push(Q.ref),J.sort((q,K)=>WV(K,Z)-WV(q,Z)))},(Q)=>{let q=J.indexOf(Q.ref);q!==-1&&J.splice(q,1)})}};class w5{constructor($){typeof $=="number"?this.rawBinaryData=new ArrayBuffer($):$ instanceof Uint8Array?this.rawBinaryData=$.buffer:this.rawBinaryData=$,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view($){return this[`${$}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf($){switch($){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${$} isn't a valid view type`)}}}var kw=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Aw($){let J="";for(let Z=0;Z<$;++Z)Z>0&&(J+=`
else `),Z<$-1&&(J+=`if(test == ${Z}.0){}`);return J}function O$($,J){if($===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let Z=J.createShader(J.FRAGMENT_SHADER);for(;;){let Q=kw.replace(/%forloop%/gi,Aw($));if(J.shaderSource(Z,Q),J.compileShader(Z),!J.getShaderParameter(Z,J.COMPILE_STATUS))$=$/2|0;else break}return $}var bJ=0,fJ=1,vJ=2,yJ=3,gJ=4,xJ=5;class g0{constructor(){this.data=0,this.blendMode=s.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<bJ)}set blend($){!!(this.data&1<<bJ)!==$&&(this.data^=1<<bJ)}get offsets(){return!!(this.data&1<<fJ)}set offsets($){!!(this.data&1<<fJ)!==$&&(this.data^=1<<fJ)}get culling(){return!!(this.data&1<<vJ)}set culling($){!!(this.data&1<<vJ)!==$&&(this.data^=1<<vJ)}get depthTest(){return!!(this.data&1<<yJ)}set depthTest($){!!(this.data&1<<yJ)!==$&&(this.data^=1<<yJ)}get depthMask(){return!!(this.data&1<<xJ)}set depthMask($){!!(this.data&1<<xJ)!==$&&(this.data^=1<<xJ)}get clockwiseFrontFace(){return!!(this.data&1<<gJ)}set clockwiseFrontFace($){!!(this.data&1<<gJ)!==$&&(this.data^=1<<gJ)}get blendMode(){return this._blendMode}set blendMode($){this.blend=$!==s.NONE,this._blendMode=$}get polygonOffset(){return this._polygonOffset}set polygonOffset($){this.offsets=!!$,this._polygonOffset=$}static for2d(){let $=new g0;return $.depthTest=!1,$.blend=!0,$}}g0.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};var i6=[];function l5($,J){if(!$)return null;let Z="";if(typeof $=="string"){let Q=/\.(\w{3,4})(?:$|\?|#)/i.exec($);Q&&(Z=Q[1].toLowerCase())}for(let Q=i6.length-1;Q>=0;--Q){let q=i6[Q];if(q.test&&q.test($,Z))return new q($,J)}throw new Error("Unrecognized source type to auto-detect Resource")}class E0{constructor($){this.items=[],this._name=$,this._aliasCount=0}emit($,J,Z,Q,q,K,V,H){if(arguments.length>8)throw new Error("max arguments reached");let{name:X,items:W}=this;this._aliasCount++;for(let z=0,G=W.length;z<G;z++)W[z][X]($,J,Z,Q,q,K,V,H);return W===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add($){return $[this._name]&&(this.ensureNonAliasedItems(),this.remove($),this.items.push($)),this}remove($){let J=this.items.indexOf($);return J!==-1&&(this.ensureNonAliasedItems(),this.items.splice(J,1)),this}contains($){return this.items.includes($)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(E0.prototype,{dispatch:{value:E0.prototype.emit},run:{value:E0.prototype.emit}});class y1{constructor($=0,J=0){this._width=$,this._height=J,this.destroyed=!1,this.internal=!1,this.onResize=new E0("setRealSize"),this.onUpdate=new E0("update"),this.onError=new E0("onError")}bind($){this.onResize.add($),this.onUpdate.add($),this.onError.add($),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind($){this.onResize.remove($),this.onUpdate.remove($),this.onError.remove($)}resize($,J){($!==this._width||J!==this._height)&&(this._width=$,this._height=J,this.onResize.emit($,J))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style($,J,Z){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test($,J){return!1}}class V8 extends y1{constructor($,J){let{width:Z,height:Q}=J||{};if(!Z||!Q)throw new Error("BufferResource width or height invalid");super(Z,Q),this.data=$,this.unpackAlignment=J.unpackAlignment??4}upload($,J,Z){let Q=$.gl;Q.pixelStorei(Q.UNPACK_ALIGNMENT,this.unpackAlignment),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.alphaMode===F0.UNPACK);let{realWidth:q,realHeight:K}=J;return Z.width===q&&Z.height===K?Q.texSubImage2D(J.target,0,0,0,q,K,J.format,Z.type,this.data):(Z.width=q,Z.height=K,Q.texImage2D(J.target,0,Z.internalFormat,q,K,0,J.format,Z.type,this.data)),!0}dispose(){this.data=null}static test($){return $===null||$ instanceof Int8Array||$ instanceof Uint8Array||$ instanceof Uint8ClampedArray||$ instanceof Int16Array||$ instanceof Uint16Array||$ instanceof Int32Array||$ instanceof Uint32Array||$ instanceof Float32Array}}var Rw={scaleMode:I1.NEAREST,alphaMode:F0.NPM},cJ=class $ extends m8.default{constructor(J=null,Z=null){super(),Z=Object.assign({},$.defaultOptions,Z);let{alphaMode:Q,mipmap:q,anisotropicLevel:K,scaleMode:V,width:H,height:X,wrapMode:W,format:z,type:G,target:Y,resolution:w,resourceOptions:U}=Z;J&&!(J instanceof y1)&&(J=l5(J,U),J.internal=!0),this.resolution=w||_.RESOLUTION,this.width=Math.round((H||0)*this.resolution)/this.resolution,this.height=Math.round((X||0)*this.resolution)/this.resolution,this._mipmap=q,this.anisotropicLevel=K,this._wrapMode=W,this._scaleMode=V,this.format=z,this.type=G,this.target=Y,this.alphaMode=Q,this.uid=K8(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=H>0&&X>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(J)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(J){this._mipmap!==J&&(this._mipmap=J,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(J){this._scaleMode!==J&&(this._scaleMode=J,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(J){this._wrapMode!==J&&(this._wrapMode=J,this.dirtyStyleId++)}setStyle(J,Z){let Q;return J!==void 0&&J!==this.scaleMode&&(this.scaleMode=J,Q=!0),Z!==void 0&&Z!==this.mipmap&&(this.mipmap=Z,Q=!0),Q&&this.dirtyStyleId++,this}setSize(J,Z,Q){return Q=Q||this.resolution,this.setRealSize(J*Q,Z*Q,Q)}setRealSize(J,Z,Q){return this.resolution=Q||this.resolution,this.width=Math.round(J)/this.resolution,this.height=Math.round(Z)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=p6(this.realWidth)&&p6(this.realHeight)}setResolution(J){let Z=this.resolution;return Z===J?this:(this.resolution=J,this.valid&&(this.width=Math.round(this.width*Z)/J,this.height=Math.round(this.height*Z)/J,this.emit("update",this)),this._refreshPOT(),this)}setResource(J){if(this.resource===J)return this;if(this.resource)throw new Error("Resource can be set only once");return J.bind(this),this.resource=J,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(J){this.emit("error",this,J)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete G1[this.cacheId],delete y0[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),$.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(J,Z,Q=_.STRICT_TEXTURE_CACHE){let q=typeof J=="string",K=null;if(q)K=J;else{if(!J._pixiId){let H=Z?.pixiIdPrefix||"pixiid";J._pixiId=`${H}_${K8()}`}K=J._pixiId}let V=G1[K];if(q&&Q&&!V)throw new Error(`The cacheId "${K}" does not exist in BaseTextureCache.`);return V||(V=new $(J,Z),V.cacheId=K,$.addToCache(V,K)),V}static fromBuffer(J,Z,Q,q){J=J||new Float32Array(Z*Q*4);let K=new V8(J,{width:Z,height:Q,...q?.resourceOptions}),V,H;return J instanceof Float32Array?(V=h.RGBA,H=p.FLOAT):J instanceof Int32Array?(V=h.RGBA_INTEGER,H=p.INT):J instanceof Uint32Array?(V=h.RGBA_INTEGER,H=p.UNSIGNED_INT):J instanceof Int16Array?(V=h.RGBA_INTEGER,H=p.SHORT):J instanceof Uint16Array?(V=h.RGBA_INTEGER,H=p.UNSIGNED_SHORT):J instanceof Int8Array?(V=h.RGBA,H=p.BYTE):(V=h.RGBA,H=p.UNSIGNED_BYTE),K.internal=!0,new $(K,Object.assign({},Rw,{type:H,format:V},q))}static addToCache(J,Z){Z&&(J.textureCacheIds.includes(Z)||J.textureCacheIds.push(Z),G1[Z]&&G1[Z]!==J&&console.warn(`BaseTexture added to the cache with an id [${Z}] that already had an entry`),G1[Z]=J)}static removeFromCache(J){if(typeof J=="string"){let Z=G1[J];if(Z){let Q=Z.textureCacheIds.indexOf(J);return Q>-1&&Z.textureCacheIds.splice(Q,1),delete G1[J],Z}}else if(J?.textureCacheIds){for(let Z=0;Z<J.textureCacheIds.length;++Z)delete G1[J.textureCacheIds[Z]];return J.textureCacheIds.length=0,J}return null}};cJ.defaultOptions={mipmap:n0.POW2,anisotropicLevel:0,scaleMode:I1.LINEAR,wrapMode:X1.CLAMP,alphaMode:F0.UNPACK,target:L8.TEXTURE_2D,format:h.RGBA,type:p.UNSIGNED_BYTE},cJ._globalBatch=0;var l=cJ;class U5{constructor(){this.texArray=null,this.blend=0,this.type=B1.TRIANGLES,this.start=0,this.size=0,this.data=null}}var Mw=0;class W0{constructor($,J=!0,Z=!1){this.data=$||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=Z,this.static=J,this.id=Mw++,this.disposeRunner=new E0("disposeBuffer")}update($){$ instanceof Array&&($=new Float32Array($)),this.data=$||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index($){this.type=$?F1.ELEMENT_ARRAY_BUFFER:F1.ARRAY_BUFFER}get index(){return this.type===F1.ELEMENT_ARRAY_BUFFER}static from($){return $ instanceof Array&&($=new Float32Array($)),new W0($)}}class n5{constructor($,J=0,Z=!1,Q=p.FLOAT,q,K,V,H=1){this.buffer=$,this.size=J,this.normalized=Z,this.type=Q,this.stride=q,this.start=K,this.instance=V,this.divisor=H}destroy(){this.buffer=null}static from($,J,Z,Q,q){return new n5($,J,Z,Q,q)}}var Ew={Float32Array,Uint32Array,Int32Array,Uint8Array};function zV($,J){let Z=0,Q=0,q={};for(let X=0;X<$.length;X++)Q+=J[X],Z+=$[X].length;let K=new ArrayBuffer(Z*4),V=null,H=0;for(let X=0;X<$.length;X++){let W=J[X],z=$[X],G=x8(z);q[G]||(q[G]=new Ew[G](K)),V=q[G];for(let Y=0;Y<z.length;Y++){let w=(Y/W|0)*Q+H,U=Y%W;V[w+U]=z[Y]}H+=W}return new Float32Array(K)}var GV={5126:4,5123:2,5121:1},hw=0,Tw={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class O1{constructor($=[],J={}){this.buffers=$,this.indexBuffer=null,this.attributes=J,this.glVertexArrayObjects={},this.id=hw++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new E0("disposeGeometry"),this.refCount=0}addAttribute($,J,Z=0,Q=!1,q,K,V,H=!1){if(!J)throw new Error("You must pass a buffer when creating an attribute");J instanceof W0||(J instanceof Array&&(J=new Float32Array(J)),J=new W0(J));let X=$.split("|");if(X.length>1){for(let z=0;z<X.length;z++)this.addAttribute(X[z],J,Z,Q,q);return this}let W=this.buffers.indexOf(J);return W===-1&&(this.buffers.push(J),W=this.buffers.length-1),this.attributes[$]=new n5(W,Z,Q,q,K,V,H),this.instanced=this.instanced||H,this}getAttribute($){return this.attributes[$]}getBuffer($){return this.buffers[this.getAttribute($).buffer]}addIndex($){return $ instanceof W0||($ instanceof Array&&($=new Uint16Array($)),$=new W0($)),$.type=F1.ELEMENT_ARRAY_BUFFER,this.indexBuffer=$,this.buffers.includes($)||this.buffers.push($),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let $=[],J=[],Z=new W0,Q;for(Q in this.attributes){let q=this.attributes[Q],K=this.buffers[q.buffer];$.push(K.data),J.push(q.size*GV[q.type]/4),q.buffer=0}for(Z.data=zV($,J),Q=0;Q<this.buffers.length;Q++)this.buffers[Q]!==this.indexBuffer&&this.buffers[Q].destroy();return this.buffers=[Z],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let $ in this.attributes){let J=this.attributes[$];return this.buffers[J.buffer].data.length/(J.stride/4||J.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let $=new O1;for(let J=0;J<this.buffers.length;J++)$.buffers[J]=new W0(this.buffers[J].data.slice(0));for(let J in this.attributes){let Z=this.attributes[J];$.attributes[J]=new n5(Z.buffer,Z.size,Z.normalized,Z.type,Z.stride,Z.start,Z.instance)}return this.indexBuffer&&($.indexBuffer=$.buffers[this.buffers.indexOf(this.indexBuffer)],$.indexBuffer.type=F1.ELEMENT_ARRAY_BUFFER),$}static merge($){let J=new O1,Z=[],Q=[],q=[],K;for(let V=0;V<$.length;V++){K=$[V];for(let H=0;H<K.buffers.length;H++)Q[H]=Q[H]||0,Q[H]+=K.buffers[H].data.length,q[H]=0}for(let V=0;V<K.buffers.length;V++)Z[V]=new Tw[x8(K.buffers[V].data)](Q[V]),J.buffers[V]=new W0(Z[V]);for(let V=0;V<$.length;V++){K=$[V];for(let H=0;H<K.buffers.length;H++)Z[H].set(K.buffers[H].data,q[H]),q[H]+=K.buffers[H].data.length}if(J.attributes=K.attributes,K.indexBuffer){J.indexBuffer=J.buffers[K.buffers.indexOf(K.indexBuffer)],J.indexBuffer.type=F1.ELEMENT_ARRAY_BUFFER;let V=0,H=0,X=0,W=0;for(let z=0;z<K.buffers.length;z++)if(K.buffers[z]!==K.indexBuffer){W=z;break}for(let z in K.attributes){let G=K.attributes[z];(G.buffer|0)===W&&(H+=G.size*GV[G.type]/4)}for(let z=0;z<$.length;z++){let G=$[z].indexBuffer.data;for(let Y=0;Y<G.length;Y++)J.indexBuffer.data[Y+X]+=V;V+=$[z].buffers[W].data.length/H,X+=G.length}}return J}}class o5 extends O1{constructor($=!1){super(),this._buffer=new W0(null,$,!1),this._indexBuffer=new W0(null,$,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,p.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,p.FLOAT).addAttribute("aColor",this._buffer,4,!0,p.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,p.FLOAT).addIndex(this._indexBuffer)}}var YV=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var wV=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function j$($,J,Z){let Q=$.createShader(J);return $.shaderSource(Q,Z),$.compileShader(Q),Q}function mJ($){let J=new Array($);for(let Z=0;Z<J.length;Z++)J[Z]=!1;return J}function a6($,J){switch($){case"float":return 0;case"vec2":return new Float32Array(2*J);case"vec3":return new Float32Array(3*J);case"vec4":return new Float32Array(4*J);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*J);case"ivec3":return new Int32Array(3*J);case"ivec4":return new Int32Array(4*J);case"uvec2":return new Uint32Array(2*J);case"uvec3":return new Uint32Array(3*J);case"uvec4":return new Uint32Array(4*J);case"bool":return!1;case"bvec2":return mJ(2*J);case"bvec3":return mJ(3*J);case"bvec4":return mJ(4*J);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var H8=[{test:($)=>$.type==="float"&&$.size===1&&!$.isArray,code:($)=>`
            if(uv["${$}"] !== ud["${$}"].value)
            {
                ud["${$}"].value = uv["${$}"]
                gl.uniform1f(ud["${$}"].location, uv["${$}"])
            }
            `},{test:($,J)=>($.type==="sampler2D"||$.type==="samplerCube"||$.type==="sampler2DArray")&&$.size===1&&!$.isArray&&(J==null||J.castToBaseTexture!==void 0),code:($)=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${$}"], t);

            if(ud["${$}"].value !== t)
            {
                ud["${$}"].value = t;
                gl.uniform1i(ud["${$}"].location, t);
; // eslint-disable-line max-len
            }`},{test:($,J)=>$.type==="mat3"&&$.size===1&&!$.isArray&&J.a!==void 0,code:($)=>`
            gl.uniformMatrix3fv(ud["${$}"].location, false, uv["${$}"].toArray(true));
            `,codeUbo:($)=>`
                var ${$}_matrix = uv.${$}.toArray(true);

                data[offset] = ${$}_matrix[0];
                data[offset+1] = ${$}_matrix[1];
                data[offset+2] = ${$}_matrix[2];
        
                data[offset + 4] = ${$}_matrix[3];
                data[offset + 5] = ${$}_matrix[4];
                data[offset + 6] = ${$}_matrix[5];
        
                data[offset + 8] = ${$}_matrix[6];
                data[offset + 9] = ${$}_matrix[7];
                data[offset + 10] = ${$}_matrix[8];
            `},{test:($,J)=>$.type==="vec2"&&$.size===1&&!$.isArray&&J.x!==void 0,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${$}"].location, v.x, v.y);
                }`,codeUbo:($)=>`
                v = uv.${$};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:($)=>$.type==="vec2"&&$.size===1&&!$.isArray,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${$}"].location, v[0], v[1]);
                }
            `},{test:($,J)=>$.type==="vec4"&&$.size===1&&!$.isArray&&J.width!==void 0,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${$}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:($)=>`
                    v = uv.${$};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:($,J)=>$.type==="vec4"&&$.size===1&&!$.isArray&&J.red!==void 0,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${$}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:($)=>`
                    v = uv.${$};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:($,J)=>$.type==="vec3"&&$.size===1&&!$.isArray&&J.red!==void 0,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${$}"].location, v.red, v.green, v.blue)
                }`,codeUbo:($)=>`
                    v = uv.${$};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:($)=>$.type==="vec4"&&$.size===1&&!$.isArray,code:($)=>`
                cv = ud["${$}"].value;
                v = uv["${$}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${$}"].location, v[0], v[1], v[2], v[3])
                }`}];var Sw={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},bw={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function uJ($,J){let Z=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let Q in $.uniforms){let q=J[Q];if(!q){$.uniforms[Q]?.group===!0&&($.uniforms[Q].ubo?Z.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${Q}, '${Q}');
                    `):Z.push(`
                        renderer.shader.syncUniformGroup(uv.${Q}, syncData);
                    `));continue}let K=$.uniforms[Q],V=!1;for(let H=0;H<H8.length;H++)if(H8[H].test(q,K)){Z.push(H8[H].code(Q,K)),V=!0;break}if(!V){let H=(q.size===1&&!q.isArray?Sw:bw)[q.type].replace("location",`ud["${Q}"].location`);Z.push(`
            cu = ud["${Q}"];
            cv = cu.value;
            v = uv["${Q}"];
            ${H};`)}}return new Function("ud","uv","renderer","syncData",Z.join(`
`))}var UV={},_$=UV;function P$(){if(_$===UV||_$?.isContextLost()){let $=_.ADAPTER.createCanvas(),J;_.PREFER_ENV>=k1.WEBGL2&&(J=$.getContext("webgl2",{})),J||(J=$.getContext("webgl",{})||$.getContext("experimental-webgl",{}),J?J.getExtension("WEBGL_draw_buffers"):J=null),_$=J}return _$}var D$;function dJ(){if(!D$){D$=W1.MEDIUM;let $=P$();if($&&$.getShaderPrecisionFormat){let J=$.getShaderPrecisionFormat($.FRAGMENT_SHADER,$.HIGH_FLOAT);J&&(D$=J.precision?W1.HIGH:W1.MEDIUM)}}return D$}function CV($,J){let Z=$.getShaderSource(J).split(`
`).map((W,z)=>`${z}: ${W}`),Q=$.getShaderInfoLog(J),q=Q.split(`
`),K={},V=q.map((W)=>parseFloat(W.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter((W)=>W&&!K[W]?(K[W]=!0,!0):!1),H=[""];V.forEach((W)=>{Z[W-1]=`%c${Z[W-1]}%c`,H.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let X=Z.join(`
`);H[0]=X,console.error(Q),console.groupCollapsed("click to view full shader code"),console.warn(...H),console.groupEnd()}function pJ($,J,Z,Q){$.getProgramParameter(J,$.LINK_STATUS)||($.getShaderParameter(Z,$.COMPILE_STATUS)||CV($,Z),$.getShaderParameter(Q,$.COMPILE_STATUS)||CV($,Q),console.error("PixiJS Error: Could not initialize shader."),$.getProgramInfoLog(J)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",$.getProgramInfoLog(J)))}var fw={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function r6($){return fw[$]}var L$=null,NV={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function t6($,J){if(!L$){let Z=Object.keys(NV);L$={};for(let Q=0;Q<Z.length;++Q){let q=Z[Q];L$[$[q]]=NV[q]}}return L$[J]}function k$($,J,Z){if($.substring(0,9)!=="precision"){let Q=J;return J===W1.HIGH&&Z!==W1.HIGH&&(Q=W1.MEDIUM),`precision ${Q} float;
${$}`}else if(Z!==W1.HIGH&&$.substring(0,15)==="precision highp")return $.replace("precision highp","precision mediump");return $}var e6;function A$(){if(typeof e6=="boolean")return e6;try{e6=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{e6=!1}return e6}var vw=0,R$={},lJ=class ${constructor(J,Z,Q="pixi-shader",q={}){this.extra={},this.id=vw++,this.vertexSrc=J||$.defaultVertexSrc,this.fragmentSrc=Z||$.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=q,this.vertexSrc.substring(0,8)!=="#version"&&(Q=Q.replace(/\s+/g,"-"),R$[Q]?(R$[Q]++,Q+=`-${R$[Q]}`):R$[Q]=1,this.vertexSrc=`#define SHADER_NAME ${Q}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${Q}
${this.fragmentSrc}`,this.vertexSrc=k$(this.vertexSrc,$.defaultVertexPrecision,W1.HIGH),this.fragmentSrc=k$(this.fragmentSrc,$.defaultFragmentPrecision,dJ())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return wV}static get defaultFragmentSrc(){return YV}static from(J,Z,Q){let q=J+Z,K=o6[q];return K||(o6[q]=K=new $(J,Z,Q)),K}};lJ.defaultVertexPrecision=W1.HIGH,lJ.defaultFragmentPrecision=f1.apple.device?W1.HIGH:W1.MEDIUM;var J1=lJ;var yw=0;class o0{constructor($,J,Z){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=yw++,this.static=!!J,this.ubo=!!Z,$ instanceof W0?(this.buffer=$,this.buffer.type=F1.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=$,this.ubo&&(this.buffer=new W0(new Float32Array(1)),this.buffer.type=F1.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add($,J,Z){if(!this.ubo)this.uniforms[$]=new o0(J,Z);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from($,J,Z){return new o0($,J,Z)}static uboFrom($,J){return new o0($,J??!0,!0)}}class s0{constructor($,J){this.uniformBindCount=0,this.program=$,J?J instanceof o0?this.uniformGroup=J:this.uniformGroup=new o0(J):this.uniformGroup=new o0({}),this.disposeRunner=new E0("disposeShader")}checkUniformExists($,J){if(J.uniforms[$])return!0;for(let Z in J.uniforms){let Q=J.uniforms[Z];if(Q.group===!0&&this.checkUniformExists($,Q))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from($,J,Z){let Q=J1.from($,J);return new s0(Q,Z)}}class M${constructor($,J){if(this.vertexSrc=$,this.fragTemplate=J,this.programCache={},this.defaultGroupCache={},!J.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!J.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader($){if(!this.programCache[$]){let Z=new Int32Array($);for(let q=0;q<$;q++)Z[q]=q;this.defaultGroupCache[$]=o0.from({uSamplers:Z},!0);let Q=this.fragTemplate;Q=Q.replace(/%count%/gi,`${$}`),Q=Q.replace(/%forloop%/gi,this.generateSampleSrc($)),this.programCache[$]=new J1(this.vertexSrc,Q)}let J={tint:new Float32Array([1,1,1,1]),translationMatrix:new $0,default:this.defaultGroupCache[$]};return new s0(this.programCache[$],J)}generateSampleSrc($){let J="";J+=`
`,J+=`
`;for(let Z=0;Z<$;Z++)Z>0&&(J+=`
else `),Z<$-1&&(J+=`if(vTextureId < ${Z}.5)`),J+=`
{`,J+=`
	color = texture2D(uSamplers[${Z}], vTextureCoord);`,J+=`
}`;return J+=`
`,J+=`
`,J}}class C5{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let $=0;$<this.count;$++)this.elements[$]=null;this.count=0}}function BV(){return!f1.apple.device}function IV($){let J=!0,Z=_.ADAPTER.getNavigator();if(f1.tablet||f1.phone){if(f1.apple.device){let Q=Z.userAgent.match(/OS (\d+)_(\d+)?/);Q&&parseInt(Q[1],10)<11&&(J=!1)}if(f1.android.device){let Q=Z.userAgent.match(/Android\s([0-9.]*)/);Q&&parseInt(Q[1],10)<7&&(J=!1)}}return J?$:4}class X8{constructor($){this.renderer=$}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render($){}}var FV=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var OV=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var $9=class $ extends X8{constructor(J){super(J),this.setShaderGenerator(),this.geometryClass=o5,this.vertexSize=6,this.state=g0.for2d(),this.size=$.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),J.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??IV(32),this._defaultMaxTextures}static set defaultMaxTextures(J){this._defaultMaxTextures=J}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??BV(),this._canUploadSameBuffer}static set canUploadSameBuffer(J){this._canUploadSameBuffer=J}get MAX_TEXTURES(){return a("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return OV}static get defaultFragmentTemplate(){return FV}setShaderGenerator({vertex:J=$.defaultVertexSrc,fragment:Z=$.defaultFragmentTemplate}={}){this.shaderGenerator=new M$(J,Z)}contextChange(){let J=this.renderer.gl;_.PREFER_ENV===k1.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(J.getParameter(J.MAX_TEXTURE_IMAGE_UNITS),$.defaultMaxTextures),this.maxTextures=O$(this.maxTextures,J)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let Z=0;Z<this._packedGeometryPoolSize;Z++)this._packedGeometries[Z]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:J,_textureArrayPool:Z}=$,Q=this.size/4,q=Math.floor(Q/this.maxTextures)+1;for(;J.length<Q;)J.push(new U5);for(;Z.length<q;)Z.push(new C5);for(let K=0;K<this.maxTextures;K++)this._tempBoundTextures[K]=null}onPrerender(){this._flushId=0}render(J){J._texture.valid&&(this._vertexCount+J.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=J.vertexData.length/2,this._indexCount+=J.indices.length,this._bufferedTextures[this._bufferSize]=J._texture.baseTexture,this._bufferedElements[this._bufferSize++]=J)}buildTexturesAndDrawCalls(){let{_bufferedTextures:J,maxTextures:Z}=this,Q=$._textureArrayPool,q=this.renderer.batch,K=this._tempBoundTextures,V=this.renderer.textureGC.count,H=++l._globalBatch,X=0,W=Q[0],z=0;q.copyBoundTextures(K,Z);for(let G=0;G<this._bufferSize;++G){let Y=J[G];J[G]=null,Y._batchEnabled!==H&&(W.count>=Z&&(q.boundArray(W,K,H,Z),this.buildDrawCalls(W,z,G),z=G,W=Q[++X],++H),Y._batchEnabled=H,Y.touched=V,W.elements[W.count++]=Y)}W.count>0&&(q.boundArray(W,K,H,Z),this.buildDrawCalls(W,z,this._bufferSize),++X,++H);for(let G=0;G<K.length;G++)K[G]=null;l._globalBatch=H}buildDrawCalls(J,Z,Q){let{_bufferedElements:q,_attributeBuffer:K,_indexBuffer:V,vertexSize:H}=this,X=$._drawCallPool,W=this._dcIndex,z=this._aIndex,G=this._iIndex,Y=X[W];Y.start=this._iIndex,Y.texArray=J;for(let w=Z;w<Q;++w){let U=q[w],C=U._texture.baseTexture,N=d6[C.alphaMode?1:0][U.blendMode];q[w]=null,Z<w&&Y.blend!==N&&(Y.size=G-Y.start,Z=w,Y=X[++W],Y.texArray=J,Y.start=G),this.packInterleavedGeometry(U,K,V,z,G),z+=U.vertexData.length/2*H,G+=U.indices.length,Y.blend=N}Z<Q&&(Y.size=G-Y.start,++W),this._dcIndex=W,this._aIndex=z,this._iIndex=G}bindAndClearTexArray(J){let Z=this.renderer.texture;for(let Q=0;Q<J.count;Q++)Z.bind(J.elements[Q],J.ids[Q]),J.elements[Q]=null;J.count=0}updateGeometry(){let{_packedGeometries:J,_attributeBuffer:Z,_indexBuffer:Q}=this;$.canUploadSameBuffer?(J[this._flushId]._buffer.update(Z.rawBinaryData),J[this._flushId]._indexBuffer.update(Q),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,J[this._flushId]=new this.geometryClass),J[this._flushId]._buffer.update(Z.rawBinaryData),J[this._flushId]._indexBuffer.update(Q),this.renderer.geometry.bind(J[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let J=this._dcIndex,{gl:Z,state:Q}=this.renderer,q=$._drawCallPool,K=null;for(let V=0;V<J;V++){let{texArray:H,type:X,size:W,start:z,blend:G}=q[V];K!==H&&(K=H,this.bindAndClearTexArray(H)),this.state.blendMode=G,Q.set(this.state),Z.drawElements(X,W,Z.UNSIGNED_SHORT,z*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),$.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let J=0;J<this._packedGeometryPoolSize;J++)this._packedGeometries[J]&&this._packedGeometries[J].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(J){let Z=c8(Math.ceil(J/8)),Q=l6(Z),q=Z*8;this._aBuffers.length<=Q&&(this._iBuffers.length=Q+1);let K=this._aBuffers[q];return K||(this._aBuffers[q]=K=new w5(q*this.vertexSize*4)),K}getIndexBuffer(J){let Z=c8(Math.ceil(J/12)),Q=l6(Z),q=Z*12;this._iBuffers.length<=Q&&(this._iBuffers.length=Q+1);let K=this._iBuffers[Q];return K||(this._iBuffers[Q]=K=new Uint16Array(q)),K}packInterleavedGeometry(J,Z,Q,q,K){let{uint32View:V,float32View:H}=Z,X=q/this.vertexSize,W=J.uvs,z=J.indices,G=J.vertexData,Y=J._texture.baseTexture._batchLocation,w=Math.min(J.worldAlpha,1),U=r.shared.setValue(J._tintRGB).toPremultiplied(w,J._texture.baseTexture.alphaMode>0);for(let C=0;C<G.length;C+=2)H[q++]=G[C],H[q++]=G[C+1],H[q++]=W[C],H[q++]=W[C+1],V[q++]=U,H[q++]=Y;for(let C=0;C<z.length;C++)Q[K++]=X+z[C]}};$9.defaultBatchSize=4096,$9.extension={name:"batch",type:j.RendererPlugin},$9._drawCallPool=[],$9._textureArrayPool=[];var R8=$9;D.add(R8);var jV=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var _V=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var nJ=class $ extends s0{constructor(J,Z,Q){let q=J1.from(J||$.defaultVertexSrc,Z||$.defaultFragmentSrc);super(q,Q),this.padding=0,this.resolution=$.defaultResolution,this.multisample=$.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new g0}apply(J,Z,Q,q,K){J.applyFilter(this,Z,Q,q)}get blendMode(){return this.state.blendMode}set blendMode(J){this.state.blendMode=J}get resolution(){return this._resolution}set resolution(J){this._resolution=J}static get defaultVertexSrc(){return _V}static get defaultFragmentSrc(){return jV}};nJ.defaultResolution=1,nJ.defaultMultisample=H0.NONE;var G0=nJ;class u8{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new r(0),this.alpha=1}init($){this.clearBeforeRender=$.clearBeforeRender;let{backgroundColor:J,background:Z,backgroundAlpha:Q}=$,q=Z??J;q!==void 0&&(this.color=q),this.alpha=Q}get color(){return this._backgroundColor.value}set color($){this._backgroundColor.setValue($)}get alpha(){return this._backgroundColor.alpha}set alpha($){this._backgroundColor.setAlpha($)}get backgroundColor(){return this._backgroundColor}destroy(){}}u8.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},u8.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"background"};D.add(u8);class J9{constructor($){this.renderer=$,this.emptyRenderer=new X8($),this.currentRenderer=this.emptyRenderer}setObjectRenderer($){this.currentRenderer!==$&&(this.currentRenderer.stop(),this.currentRenderer=$,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures($,J){let{boundTextures:Z}=this.renderer.texture;for(let Q=J-1;Q>=0;--Q)$[Q]=Z[Q]||null,$[Q]&&($[Q]._batchLocation=Q)}boundArray($,J,Z,Q){let{elements:q,ids:K,count:V}=$,H=0;for(let X=0;X<V;X++){let W=q[X],z=W._batchLocation;if(z>=0&&z<Q&&J[z]===W){K[X]=z;continue}for(;H<Q;){let G=J[H];if(G&&G._batchEnabled===Z&&G._batchLocation===H){H++;continue}K[X]=H,W._batchLocation=H,J[H]=W;break}}}destroy(){this.renderer=null}}J9.extension={type:j.RendererSystem,name:"batch"};D.add(J9);var PV=0;class d8{constructor($){this.renderer=$,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange($){this.gl=$,this.renderer.gl=$,this.renderer.CONTEXT_UID=PV++}init($){if($.context)this.initFromContext($.context);else{let J=this.renderer.background.alpha<1,Z=$.premultipliedAlpha;this.preserveDrawingBuffer=$.preserveDrawingBuffer,this.useContextAlpha=$.useContextAlpha,this.powerPreference=$.powerPreference,this.initFromOptions({alpha:J,premultipliedAlpha:Z,antialias:$.antialias,stencil:!0,preserveDrawingBuffer:$.preserveDrawingBuffer,powerPreference:$.powerPreference})}}initFromContext($){this.gl=$,this.validateContext($),this.renderer.gl=$,this.renderer.CONTEXT_UID=PV++,this.renderer.runners.contextChange.emit($);let J=this.renderer.view;J.addEventListener!==void 0&&(J.addEventListener("webglcontextlost",this.handleContextLost,!1),J.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions($){let J=this.createContext(this.renderer.view,$);this.initFromContext(J)}createContext($,J){let Z;if(_.PREFER_ENV>=k1.WEBGL2&&(Z=$.getContext("webgl2",J)),Z)this.webGLVersion=2;else if(this.webGLVersion=1,Z=$.getContext("webgl",J)||$.getContext("experimental-webgl",J),!Z)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=Z,this.getExtensions(),this.gl}getExtensions(){let{gl:$}=this,J={loseContext:$.getExtension("WEBGL_lose_context"),anisotropicFiltering:$.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:$.getExtension("OES_texture_float_linear"),s3tc:$.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:$.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:$.getExtension("WEBGL_compressed_texture_etc"),etc1:$.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:$.getExtension("WEBGL_compressed_texture_pvrtc")||$.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:$.getExtension("WEBGL_compressed_texture_atc"),astc:$.getExtension("WEBGL_compressed_texture_astc"),bptc:$.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,J,{drawBuffers:$.getExtension("WEBGL_draw_buffers"),depthTexture:$.getExtension("WEBGL_depth_texture"),vertexArrayObject:$.getExtension("OES_vertex_array_object")||$.getExtension("MOZ_OES_vertex_array_object")||$.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:$.getExtension("OES_element_index_uint"),floatTexture:$.getExtension("OES_texture_float"),floatTextureLinear:$.getExtension("OES_texture_float_linear"),textureHalfFloat:$.getExtension("OES_texture_half_float"),textureHalfFloatLinear:$.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,J,{colorBufferFloat:$.getExtension("EXT_color_buffer_float")})}handleContextLost($){$.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let $=this.renderer.view;this.renderer=null,$.removeEventListener!==void 0&&($.removeEventListener("webglcontextlost",this.handleContextLost),$.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext($){let J=$.getContextAttributes(),Z="WebGL2RenderingContext"in globalThis&&$ instanceof globalThis.WebGL2RenderingContext;Z&&(this.webGLVersion=2),J&&!J.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let Q=Z||!!$.getExtension("OES_element_index_uint");this.supports.uint32Indices=Q,Q||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}d8.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},d8.extension={type:j.RendererSystem,name:"context"};D.add(d8);class N5{constructor($,J){if(this.width=Math.round($),this.height=Math.round(J),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new E0("disposeFramebuffer"),this.multisample=H0.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture($=0,J){return this.colorTextures[$]=J||new l(null,{scaleMode:I1.NEAREST,resolution:1,mipmap:n0.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture($){return this.depthTexture=$||new l(null,{scaleMode:I1.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:n0.OFF,format:h.DEPTH_COMPONENT,type:p.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize($,J){if($=Math.round($),J=Math.round(J),!$||!J)throw new Error("Framebuffer width and height must not be zero");if(!($===this.width&&J===this.height)){this.width=$,this.height=J,this.dirtyId++,this.dirtySize++;for(let Z=0;Z<this.colorTextures.length;Z++){let Q=this.colorTextures[Z],q=Q.resolution;Q.setSize($/q,J/q)}if(this.depthTexture){let Z=this.depthTexture.resolution;this.depthTexture.setSize($/Z,J/Z)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class s5 extends l{constructor($={}){if(typeof $=="number"){let J=arguments[0],Z=arguments[1],Q=arguments[2],q=arguments[3];$={width:J,height:Z,scaleMode:Q,resolution:q}}$.width=$.width??100,$.height=$.height??100,$.multisample??($.multisample=H0.NONE),super(null,$),this.mipmap=n0.OFF,this.valid=!0,this._clear=new r([0,0,0,0]),this.framebuffer=new N5(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=$.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor($){this._clear.setValue($)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample($){this.framebuffer.multisample=$}resize($,J){this.framebuffer.resize($*this.resolution,J*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class x0 extends y1{constructor($){let J=$,Z=J.naturalWidth||J.videoWidth||J.displayWidth||J.width,Q=J.naturalHeight||J.videoHeight||J.displayHeight||J.height;super(Z,Q),this.source=$,this.noSubImage=!1}static crossOrigin($,J,Z){Z===void 0&&!J.startsWith("data:")?$.crossOrigin=F$(J):Z!==!1&&($.crossOrigin=typeof Z=="string"?Z:"anonymous")}upload($,J,Z,Q){let q=$.gl,K=J.realWidth,V=J.realHeight;if(Q=Q||this.source,typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement){if(!Q.complete||Q.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&Q instanceof HTMLVideoElement&&Q.readyState<=1)return!1;return q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.alphaMode===F0.UNPACK),!this.noSubImage&&J.target===q.TEXTURE_2D&&Z.width===K&&Z.height===V?q.texSubImage2D(q.TEXTURE_2D,0,0,0,J.format,Z.type,Q):(Z.width=K,Z.height=V,q.texImage2D(J.target,0,Z.internalFormat,J.format,Z.type,Q)),!0}update(){if(this.destroyed)return;let $=this.source,J=$.naturalWidth||$.videoWidth||$.width,Z=$.naturalHeight||$.videoHeight||$.height;this.resize(J,Z),super.update()}dispose(){this.source=null}}class i5 extends x0{constructor($,J){if(J=J||{},typeof $=="string"){let Z=new Image;x0.crossOrigin(Z,$,J.crossorigin),Z.src=$,$=Z}super($),!$.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=$.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(J.createBitmap??_.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof J.alphaMode=="number"?J.alphaMode:null,this.bitmap=null,this._load=null,J.autoLoad!==!1&&this.load()}load($){return this._load?this._load:($!==void 0&&(this.createBitmap=$),this._load=new Promise((J,Z)=>{let Q=this.source;this.url=Q.src;let q=()=>{this.destroyed||(Q.onload=null,Q.onerror=null,this.update(),this._load=null,this.createBitmap?J(this.process()):J(this))};Q.complete&&Q.src?q():(Q.onload=q,Q.onerror=(K)=>{Z(K),this.onError.emit(K)})}),this._load)}process(){let $=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let J=globalThis.createImageBitmap,Z=!$.crossOrigin||$.crossOrigin==="anonymous";return this._process=fetch($.src,{mode:Z?"cors":"no-cors"}).then((Q)=>Q.blob()).then((Q)=>J(Q,0,0,$.width,$.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===F0.UNPACK?"premultiply":"none"})).then((Q)=>this.destroyed?Promise.reject():(this.bitmap=Q,this.update(),this._process=null,Promise.resolve(this))),this._process}upload($,J,Z){if(typeof this.alphaMode=="number"&&(J.alphaMode=this.alphaMode),!this.createBitmap)return super.upload($,J,Z);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload($,J,Z,this.bitmap),!this.preserveBitmap){let Q=!0,q=J._glTextures;for(let K in q){let V=q[K];if(V!==Z&&V.dirtyId!==J.dirtyId){Q=!1;break}}Q&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test($){return typeof HTMLImageElement<"u"&&(typeof $=="string"||$ instanceof HTMLImageElement)}}class a5{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set($,J,Z){let{width:Q,height:q}=J;if(Z){let K=$.width/2/Q,V=$.height/2/q,H=$.x/Q+K,X=$.y/q+V;Z=U0.add(Z,U0.NW),this.x0=H+K*U0.uX(Z),this.y0=X+V*U0.uY(Z),Z=U0.add(Z,2),this.x1=H+K*U0.uX(Z),this.y1=X+V*U0.uY(Z),Z=U0.add(Z,2),this.x2=H+K*U0.uX(Z),this.y2=X+V*U0.uY(Z),Z=U0.add(Z,2),this.x3=H+K*U0.uX(Z),this.y3=X+V*U0.uY(Z)}else this.x0=$.x/Q,this.y0=$.y/q,this.x1=($.x+$.width)/Q,this.y1=$.y/q,this.x2=($.x+$.width)/Q,this.y2=($.y+$.height)/q,this.x3=$.x/Q,this.y3=($.y+$.height)/q;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}a5.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};var DV=new a5;function E$($){$.destroy=function(){},$.on=function(){},$.once=function(){},$.emit=function(){}}class b extends m8.default{constructor($,J,Z,Q,q,K,V){if(super(),this.noFrame=!1,J||(this.noFrame=!0,J=new y(0,0,1,1)),$ instanceof b&&($=$.baseTexture),this.baseTexture=$,this._frame=J,this.trim=Q,this.valid=!1,this.destroyed=!1,this._uvs=DV,this.uvMatrix=null,this.orig=Z||J,this._rotate=Number(q||0),q===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=K?new d(K.x,K.y):new d(0,0),this.defaultBorders=V,this._updateID=0,this.textureCacheIds=[],$.valid?this.noFrame?$.valid&&this.onBaseTextureUpdated($):this.frame=J:$.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&$.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated($){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=$.width,this._frame.height=$.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy($){if(this.baseTexture){if($){let{resource:J}=this.baseTexture;J?.url&&y0[J.url]&&b.removeFromCache(J.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,b.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){let $=this._frame.clone(),J=this._frame===this.orig?$:this.orig.clone(),Z=new b(this.baseTexture,!this.noFrame&&$,J,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(Z._frame=$),Z}updateUvs(){this._uvs===DV&&(this._uvs=new a5),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from($,J={},Z=_.STRICT_TEXTURE_CACHE){let Q=typeof $=="string",q=null;if(Q)q=$;else if($ instanceof l){if(!$.cacheId){let V=J?.pixiIdPrefix||"pixiid";$.cacheId=`${V}-${K8()}`,l.addToCache($,$.cacheId)}q=$.cacheId}else{if(!$._pixiId){let V=J?.pixiIdPrefix||"pixiid";$._pixiId=`${V}_${K8()}`}q=$._pixiId}let K=y0[q];if(Q&&Z&&!K)throw new Error(`The cacheId "${q}" does not exist in TextureCache.`);return!K&&!($ instanceof l)?(J.resolution||(J.resolution=s6($)),K=new b(new l($,J)),K.baseTexture.cacheId=q,l.addToCache(K.baseTexture,q),b.addToCache(K,q)):!K&&$ instanceof l&&(K=new b($),b.addToCache(K,q)),K}static fromURL($,J){let Z=Object.assign({autoLoad:!1},J?.resourceOptions),Q=b.from($,Object.assign({resourceOptions:Z},J),!1),q=Q.baseTexture.resource;return Q.baseTexture.valid?Promise.resolve(Q):q.load().then(()=>Promise.resolve(Q))}static fromBuffer($,J,Z,Q){return new b(l.fromBuffer($,J,Z,Q))}static fromLoader($,J,Z,Q){let q=new l($,Object.assign({scaleMode:l.defaultOptions.scaleMode,resolution:s6(J)},Q)),{resource:K}=q;K instanceof i5&&(K.url=J);let V=new b(q);return Z||(Z=J),l.addToCache(V.baseTexture,Z),b.addToCache(V,Z),Z!==J&&(l.addToCache(V.baseTexture,J),b.addToCache(V,J)),V.baseTexture.valid?Promise.resolve(V):new Promise((H)=>{V.baseTexture.once("loaded",()=>H(V))})}static addToCache($,J){J&&($.textureCacheIds.includes(J)||$.textureCacheIds.push(J),y0[J]&&y0[J]!==$&&console.warn(`Texture added to the cache with an id [${J}] that already had an entry`),y0[J]=$)}static removeFromCache($){if(typeof $=="string"){let J=y0[$];if(J){let Z=J.textureCacheIds.indexOf($);return Z>-1&&J.textureCacheIds.splice(Z,1),delete y0[$],J}}else if($?.textureCacheIds){for(let J=0;J<$.textureCacheIds.length;++J)y0[$.textureCacheIds[J]]===$&&delete y0[$.textureCacheIds[J]];return $.textureCacheIds.length=0,$}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame($){this._frame=$,this.noFrame=!1;let{x:J,y:Z,width:Q,height:q}=$,K=J+Q>this.baseTexture.width,V=Z+q>this.baseTexture.height;if(K||V){let H=K&&V?"and":"or",X=`X: ${J} + ${Q} = ${J+Q} > ${this.baseTexture.width}`,W=`Y: ${Z} + ${q} = ${Z+q} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${X} ${H} ${W}`)}this.valid=Q&&q&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=$),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate($){this._rotate=$,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return b._EMPTY||(b._EMPTY=new b(new l),E$(b._EMPTY),E$(b._EMPTY.baseTexture)),b._EMPTY}static get WHITE(){if(!b._WHITE){let $=_.ADAPTER.createCanvas(16,16),J=$.getContext("2d");$.width=16,$.height=16,J.fillStyle="white",J.fillRect(0,0,16,16),b._WHITE=new b(l.from($)),E$(b._WHITE),E$(b._WHITE.baseTexture)}return b._WHITE}}class g1 extends b{constructor($,J){super($,J),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample($){this.framebuffer.multisample=$}resize($,J,Z=!0){let Q=this.baseTexture.resolution,q=Math.round($*Q)/Q,K=Math.round(J*Q)/Q;this.valid=q>0&&K>0,this._frame.width=this.orig.width=q,this._frame.height=this.orig.height=K,Z&&this.baseTexture.resize(q,K),this.updateUvs()}setResolution($){let{baseTexture:J}=this;J.resolution!==$&&(J.setResolution($),this.resize(J.width,J.height,!1))}static create($){return new g1(new s5($))}}class Z9{constructor($){this.texturePool={},this.textureOptions=$||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture($,J,Z=H0.NONE){let Q=new s5(Object.assign({width:$,height:J,resolution:1,multisample:Z},this.textureOptions));return new g1(Q)}getOptimalTexture($,J,Z=1,Q=H0.NONE){let q;$=Math.max(Math.ceil($*Z-0.000001),1),J=Math.max(Math.ceil(J*Z-0.000001),1),!this.enableFullScreen||$!==this._pixelsWidth||J!==this._pixelsHeight?($=c8($),J=c8(J),q=(($&65535)<<16|J&65535)>>>0,Q>1&&(q+=Q*4294967296)):q=Q>1?-Q:-1,this.texturePool[q]||(this.texturePool[q]=[]);let K=this.texturePool[q].pop();return K||(K=this.createTexture($,J,Q)),K.filterPoolKey=q,K.setResolution(Z),K}getFilterTexture($,J,Z){let Q=this.getOptimalTexture($.width,$.height,J||$.resolution,Z||H0.NONE);return Q.filterFrame=$.filterFrame,Q}returnTexture($){let J=$.filterPoolKey;$.filterFrame=null,this.texturePool[J].push($)}returnFilterTexture($){this.returnTexture($)}clear($){if($=$!==!1,$)for(let J in this.texturePool){let Z=this.texturePool[J];if(Z)for(let Q=0;Q<Z.length;Q++)Z[Q].destroy(!0)}this.texturePool={}}setScreenSize($){if(!($.width===this._pixelsWidth&&$.height===this._pixelsHeight)){this.enableFullScreen=$.width>0&&$.height>0;for(let J in this.texturePool){if(!(Number(J)<0))continue;let Z=this.texturePool[J];if(Z)for(let Q=0;Q<Z.length;Q++)Z[Q].destroy(!0);this.texturePool[J]=[]}this._pixelsWidth=$.width,this._pixelsHeight=$.height}}}Z9.SCREEN_KEY=-1;class h$ extends O1{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class r5 extends O1{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new W0(this.vertices),this.uvBuffer=new W0(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map($,J){let Z=0,Q=0;return this.uvs[0]=Z,this.uvs[1]=Q,this.uvs[2]=Z+J.width/$.width,this.uvs[3]=Q,this.uvs[4]=Z+J.width/$.width,this.uvs[5]=Q+J.height/$.height,this.uvs[6]=Z,this.uvs[7]=Q+J.height/$.height,Z=J.x,Q=J.y,this.vertices[0]=Z,this.vertices[1]=Q,this.vertices[2]=Z+J.width,this.vertices[3]=Q,this.vertices[4]=Z+J.width,this.vertices[5]=Q+J.height,this.vertices[6]=Z,this.vertices[7]=Q+J.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class T${constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=H0.NONE,this.sourceFrame=new y,this.destinationFrame=new y,this.bindingSourceFrame=new y,this.bindingDestinationFrame=new y,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}var S$=[new d,new d,new d,new d],oJ=new $0;class Q9{constructor($){this.renderer=$,this.defaultFilterStack=[{}],this.texturePool=new Z9,this.statePool=[],this.quad=new h$,this.quadUv=new r5,this.tempRect=new y,this.activeState={},this.globalUniforms=new o0({outputFrame:new y,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push($,J){let Z=this.renderer,Q=this.defaultFilterStack,q=this.statePool.pop()||new T$,K=Z.renderTexture,V,H;if(K.current){let C=K.current;V=C.resolution,H=C.multisample}else V=Z.resolution,H=Z.multisample;let X=J[0].resolution||V,W=J[0].multisample??H,z=J[0].padding,G=J[0].autoFit,Y=J[0].legacy??!0;for(let C=1;C<J.length;C++){let N=J[C];X=Math.min(X,N.resolution||V),W=Math.min(W,N.multisample??H),z=this.useMaxPadding?Math.max(z,N.padding):z+N.padding,G=G&&N.autoFit,Y=Y||(N.legacy??!0)}Q.length===1&&(this.defaultFilterStack[0].renderTexture=K.current),Q.push(q),q.resolution=X,q.multisample=W,q.legacy=Y,q.target=$,q.sourceFrame.copyFrom($.filterArea||$.getBounds(!0)),q.sourceFrame.pad(z);let w=this.tempRect.copyFrom(K.sourceFrame);Z.projection.transform&&this.transformAABB(oJ.copyFrom(Z.projection.transform).invert(),w),G?(q.sourceFrame.fit(w),(q.sourceFrame.width<=0||q.sourceFrame.height<=0)&&(q.sourceFrame.width=0,q.sourceFrame.height=0)):q.sourceFrame.intersects(w)||(q.sourceFrame.width=0,q.sourceFrame.height=0),this.roundFrame(q.sourceFrame,K.current?K.current.resolution:Z.resolution,K.sourceFrame,K.destinationFrame,Z.projection.transform),q.renderTexture=this.getOptimalFilterTexture(q.sourceFrame.width,q.sourceFrame.height,X,W),q.filters=J,q.destinationFrame.width=q.renderTexture.width,q.destinationFrame.height=q.renderTexture.height;let U=this.tempRect;U.x=0,U.y=0,U.width=q.sourceFrame.width,U.height=q.sourceFrame.height,q.renderTexture.filterFrame=q.sourceFrame,q.bindingSourceFrame.copyFrom(K.sourceFrame),q.bindingDestinationFrame.copyFrom(K.destinationFrame),q.transform=Z.projection.transform,Z.projection.transform=null,K.bind(q.renderTexture,q.sourceFrame,U),Z.framebuffer.clear(0,0,0,0)}pop(){let $=this.defaultFilterStack,J=$.pop(),Z=J.filters;this.activeState=J;let Q=this.globalUniforms.uniforms;Q.outputFrame=J.sourceFrame,Q.resolution=J.resolution;let{inputSize:q,inputPixel:K,inputClamp:V}=Q;if(q[0]=J.destinationFrame.width,q[1]=J.destinationFrame.height,q[2]=1/q[0],q[3]=1/q[1],K[0]=Math.round(q[0]*J.resolution),K[1]=Math.round(q[1]*J.resolution),K[2]=1/K[0],K[3]=1/K[1],V[0]=0.5*K[2],V[1]=0.5*K[3],V[2]=J.sourceFrame.width*q[2]-0.5*K[2],V[3]=J.sourceFrame.height*q[3]-0.5*K[3],J.legacy){let X=Q.filterArea;X[0]=J.destinationFrame.width,X[1]=J.destinationFrame.height,X[2]=J.sourceFrame.x,X[3]=J.sourceFrame.y,Q.filterClamp=Q.inputClamp}this.globalUniforms.update();let H=$[$.length-1];if(this.renderer.framebuffer.blit(),Z.length===1)Z[0].apply(this,J.renderTexture,H.renderTexture,A1.BLEND,J),this.returnFilterTexture(J.renderTexture);else{let X=J.renderTexture,W=this.getOptimalFilterTexture(X.width,X.height,J.resolution);W.filterFrame=X.filterFrame;let z=0;for(z=0;z<Z.length-1;++z){z===1&&J.multisample>1&&(W=this.getOptimalFilterTexture(X.width,X.height,J.resolution),W.filterFrame=X.filterFrame),Z[z].apply(this,X,W,A1.CLEAR,J);let G=X;X=W,W=G}Z[z].apply(this,X,H.renderTexture,A1.BLEND,J),z>1&&J.multisample>1&&this.returnFilterTexture(J.renderTexture),this.returnFilterTexture(X),this.returnFilterTexture(W)}J.clear(),this.statePool.push(J)}bindAndClear($,J=A1.CLEAR){let{renderTexture:Z,state:Q}=this.renderer;if($===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,$?.filterFrame){let K=this.tempRect;K.x=0,K.y=0,K.width=$.filterFrame.width,K.height=$.filterFrame.height,Z.bind($,$.filterFrame,K)}else $!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?Z.bind($):this.renderer.renderTexture.bind($,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let q=Q.stateId&1||this.forceClear;(J===A1.CLEAR||J===A1.BLIT&&q)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter($,J,Z,Q){let q=this.renderer;q.state.set($.state),this.bindAndClear(Z,Q),$.uniforms.uSampler=J,$.uniforms.filterGlobals=this.globalUniforms,q.shader.bind($),$.legacy=!!$.program.attributeData.aTextureCoord,$.legacy?(this.quadUv.map(J._frame,J.filterFrame),q.geometry.bind(this.quadUv),q.geometry.draw(B1.TRIANGLES)):(q.geometry.bind(this.quad),q.geometry.draw(B1.TRIANGLE_STRIP))}calculateSpriteMatrix($,J){let{sourceFrame:Z,destinationFrame:Q}=this.activeState,{orig:q}=J._texture,K=$.set(Q.width,0,0,Q.height,Z.x,Z.y),V=J.worldTransform.copyTo($0.TEMP_MATRIX);return V.invert(),K.prepend(V),K.scale(1/q.width,1/q.height),K.translate(J.anchor.x,J.anchor.y),K}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture($,J,Z=1,Q=H0.NONE){return this.texturePool.getOptimalTexture($,J,Z,Q)}getFilterTexture($,J,Z){if(typeof $=="number"){let q=$;$=J,J=q}$=$||this.activeState.renderTexture;let Q=this.texturePool.getOptimalTexture($.width,$.height,J||$.resolution,Z||H0.NONE);return Q.filterFrame=$.filterFrame,Q}returnFilterTexture($){this.texturePool.returnTexture($)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB($,J){let Z=S$[0],Q=S$[1],q=S$[2],K=S$[3];Z.set(J.left,J.top),Q.set(J.left,J.bottom),q.set(J.right,J.top),K.set(J.right,J.bottom),$.apply(Z,Z),$.apply(Q,Q),$.apply(q,q),$.apply(K,K);let V=Math.min(Z.x,Q.x,q.x,K.x),H=Math.min(Z.y,Q.y,q.y,K.y),X=Math.max(Z.x,Q.x,q.x,K.x),W=Math.max(Z.y,Q.y,q.y,K.y);J.x=V,J.y=H,J.width=X-V,J.height=W-H}roundFrame($,J,Z,Q,q){if(!($.width<=0||$.height<=0||Z.width<=0||Z.height<=0)){if(q){let{a:K,b:V,c:H,d:X}=q;if((Math.abs(V)>0.0001||Math.abs(H)>0.0001)&&(Math.abs(K)>0.0001||Math.abs(X)>0.0001))return}q=q?oJ.copyFrom(q):oJ.identity(),q.translate(-Z.x,-Z.y).scale(Q.width/Z.width,Q.height/Z.height).translate(Q.x,Q.y),this.transformAABB(q,$),$.ceil(J),this.transformAABB(q.invert(),$)}}}Q9.extension={type:j.RendererSystem,name:"filter"};D.add(Q9);class b${constructor($){this.framebuffer=$,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=H0.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}var gw=new y;class q9{constructor($){this.renderer=$,this.managedFramebuffers=[],this.unknownFramebuffer=new N5(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let $=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new y,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let J=this.renderer.context.extensions.drawBuffers,Z=this.renderer.context.extensions.depthTexture;_.PREFER_ENV===k1.WEBGL_LEGACY&&(J=null,Z=null),J?$.drawBuffers=(Q)=>J.drawBuffersWEBGL(Q):(this.hasMRT=!1,$.drawBuffers=()=>{}),Z||(this.writeDepthTexture=!1)}else this.msaaSamples=$.getInternalformatParameter($.RENDERBUFFER,$.RGBA8,$.SAMPLES)}bind($,J,Z=0){let{gl:Q}=this;if($){let q=$.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer($);this.current!==$&&(this.current=$,Q.bindFramebuffer(Q.FRAMEBUFFER,q.framebuffer)),q.mipLevel!==Z&&($.dirtyId++,$.dirtyFormat++,q.mipLevel=Z),q.dirtyId!==$.dirtyId&&(q.dirtyId=$.dirtyId,q.dirtyFormat!==$.dirtyFormat?(q.dirtyFormat=$.dirtyFormat,q.dirtySize=$.dirtySize,this.updateFramebuffer($,Z)):q.dirtySize!==$.dirtySize&&(q.dirtySize=$.dirtySize,this.resizeFramebuffer($)));for(let K=0;K<$.colorTextures.length;K++){let V=$.colorTextures[K];this.renderer.texture.unbind(V.parentTextureArray||V)}if($.depthTexture&&this.renderer.texture.unbind($.depthTexture),J){let K=J.width>>Z,V=J.height>>Z,H=K/J.width;this.setViewport(J.x*H,J.y*H,K,V)}else{let K=$.width>>Z,V=$.height>>Z;this.setViewport(0,0,K,V)}}else this.current&&(this.current=null,Q.bindFramebuffer(Q.FRAMEBUFFER,null)),J?this.setViewport(J.x,J.y,J.width,J.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport($,J,Z,Q){let q=this.viewport;$=Math.round($),J=Math.round(J),Z=Math.round(Z),Q=Math.round(Q),(q.width!==Z||q.height!==Q||q.x!==$||q.y!==J)&&(q.x=$,q.y=J,q.width=Z,q.height=Q,this.gl.viewport($,J,Z,Q))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear($,J,Z,Q,q=K$.COLOR|K$.DEPTH){let{gl:K}=this;K.clearColor($,J,Z,Q),K.clear(q)}initFramebuffer($){let{gl:J}=this,Z=new b$(J.createFramebuffer());return Z.multisample=this.detectSamples($.multisample),$.glFramebuffers[this.CONTEXT_UID]=Z,this.managedFramebuffers.push($),$.disposeRunner.add(this),Z}resizeFramebuffer($){let{gl:J}=this,Z=$.glFramebuffers[this.CONTEXT_UID];if(Z.stencil){J.bindRenderbuffer(J.RENDERBUFFER,Z.stencil);let K;this.renderer.context.webGLVersion===1?K=J.DEPTH_STENCIL:$.depth&&$.stencil?K=J.DEPTH24_STENCIL8:$.depth?K=J.DEPTH_COMPONENT24:K=J.STENCIL_INDEX8,Z.msaaBuffer?J.renderbufferStorageMultisample(J.RENDERBUFFER,Z.multisample,K,$.width,$.height):J.renderbufferStorage(J.RENDERBUFFER,K,$.width,$.height)}let Q=$.colorTextures,q=Q.length;J.drawBuffers||(q=Math.min(q,1));for(let K=0;K<q;K++){let V=Q[K],H=V.parentTextureArray||V;this.renderer.texture.bind(H,0),K===0&&Z.msaaBuffer&&(J.bindRenderbuffer(J.RENDERBUFFER,Z.msaaBuffer),J.renderbufferStorageMultisample(J.RENDERBUFFER,Z.multisample,H._glTextures[this.CONTEXT_UID].internalFormat,$.width,$.height))}$.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind($.depthTexture,0)}updateFramebuffer($,J){let{gl:Z}=this,Q=$.glFramebuffers[this.CONTEXT_UID],q=$.colorTextures,K=q.length;Z.drawBuffers||(K=Math.min(K,1)),Q.multisample>1&&this.canMultisampleFramebuffer($)?Q.msaaBuffer=Q.msaaBuffer||Z.createRenderbuffer():Q.msaaBuffer&&(Z.deleteRenderbuffer(Q.msaaBuffer),Q.msaaBuffer=null,Q.blitFramebuffer&&(Q.blitFramebuffer.dispose(),Q.blitFramebuffer=null));let V=[];for(let H=0;H<K;H++){let X=q[H],W=X.parentTextureArray||X;this.renderer.texture.bind(W,0),H===0&&Q.msaaBuffer?(Z.bindRenderbuffer(Z.RENDERBUFFER,Q.msaaBuffer),Z.renderbufferStorageMultisample(Z.RENDERBUFFER,Q.multisample,W._glTextures[this.CONTEXT_UID].internalFormat,$.width,$.height),Z.framebufferRenderbuffer(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.RENDERBUFFER,Q.msaaBuffer)):(Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0+H,X.target,W._glTextures[this.CONTEXT_UID].texture,J),V.push(Z.COLOR_ATTACHMENT0+H))}if(V.length>1&&Z.drawBuffers(V),$.depthTexture&&this.writeDepthTexture){let H=$.depthTexture;this.renderer.texture.bind(H,0),Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.DEPTH_ATTACHMENT,Z.TEXTURE_2D,H._glTextures[this.CONTEXT_UID].texture,J)}if(($.stencil||$.depth)&&!($.depthTexture&&this.writeDepthTexture)){Q.stencil=Q.stencil||Z.createRenderbuffer();let H,X;this.renderer.context.webGLVersion===1?(H=Z.DEPTH_STENCIL_ATTACHMENT,X=Z.DEPTH_STENCIL):$.depth&&$.stencil?(H=Z.DEPTH_STENCIL_ATTACHMENT,X=Z.DEPTH24_STENCIL8):$.depth?(H=Z.DEPTH_ATTACHMENT,X=Z.DEPTH_COMPONENT24):(H=Z.STENCIL_ATTACHMENT,X=Z.STENCIL_INDEX8),Z.bindRenderbuffer(Z.RENDERBUFFER,Q.stencil),Q.msaaBuffer?Z.renderbufferStorageMultisample(Z.RENDERBUFFER,Q.multisample,X,$.width,$.height):Z.renderbufferStorage(Z.RENDERBUFFER,X,$.width,$.height),Z.framebufferRenderbuffer(Z.FRAMEBUFFER,H,Z.RENDERBUFFER,Q.stencil)}else Q.stencil&&(Z.deleteRenderbuffer(Q.stencil),Q.stencil=null)}canMultisampleFramebuffer($){return this.renderer.context.webGLVersion!==1&&$.colorTextures.length<=1&&!$.depthTexture}detectSamples($){let{msaaSamples:J}=this,Z=H0.NONE;if($<=1||J===null)return Z;for(let Q=0;Q<J.length;Q++)if(J[Q]<=$){Z=J[Q];break}return Z===1&&(Z=H0.NONE),Z}blit($,J,Z){let{current:Q,renderer:q,gl:K,CONTEXT_UID:V}=this;if(q.context.webGLVersion!==2||!Q)return;let H=Q.glFramebuffers[V];if(!H)return;if(!$){if(!H.msaaBuffer)return;let W=Q.colorTextures[0];if(!W)return;H.blitFramebuffer||(H.blitFramebuffer=new N5(Q.width,Q.height),H.blitFramebuffer.addColorTexture(0,W)),$=H.blitFramebuffer,$.colorTextures[0]!==W&&($.colorTextures[0]=W,$.dirtyId++,$.dirtyFormat++),($.width!==Q.width||$.height!==Q.height)&&($.width=Q.width,$.height=Q.height,$.dirtyId++,$.dirtySize++)}J||(J=gw,J.width=Q.width,J.height=Q.height),Z||(Z=J);let X=J.width===Z.width&&J.height===Z.height;this.bind($),K.bindFramebuffer(K.READ_FRAMEBUFFER,H.framebuffer),K.blitFramebuffer(J.left,J.top,J.right,J.bottom,Z.left,Z.top,Z.right,Z.bottom,K.COLOR_BUFFER_BIT,X?K.NEAREST:K.LINEAR),K.bindFramebuffer(K.READ_FRAMEBUFFER,$.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer($,J){let Z=$.glFramebuffers[this.CONTEXT_UID],Q=this.gl;if(!Z)return;delete $.glFramebuffers[this.CONTEXT_UID];let q=this.managedFramebuffers.indexOf($);q>=0&&this.managedFramebuffers.splice(q,1),$.disposeRunner.remove(this),J||(Q.deleteFramebuffer(Z.framebuffer),Z.msaaBuffer&&Q.deleteRenderbuffer(Z.msaaBuffer),Z.stencil&&Q.deleteRenderbuffer(Z.stencil)),Z.blitFramebuffer&&this.disposeFramebuffer(Z.blitFramebuffer,J)}disposeAll($){let J=this.managedFramebuffers;this.managedFramebuffers=[];for(let Z=0;Z<J.length;Z++)this.disposeFramebuffer(J[Z],$)}forceStencil(){let $=this.current;if(!$)return;let J=$.glFramebuffers[this.CONTEXT_UID];if(!J||J.stencil&&$.stencil)return;$.stencil=!0;let{width:Z,height:Q}=$,q=this.gl,K=J.stencil=q.createRenderbuffer();q.bindRenderbuffer(q.RENDERBUFFER,K);let V,H;this.renderer.context.webGLVersion===1?(V=q.DEPTH_STENCIL_ATTACHMENT,H=q.DEPTH_STENCIL):$.depth?(V=q.DEPTH_STENCIL_ATTACHMENT,H=q.DEPTH24_STENCIL8):(V=q.STENCIL_ATTACHMENT,H=q.STENCIL_INDEX8),J.msaaBuffer?q.renderbufferStorageMultisample(q.RENDERBUFFER,J.multisample,H,Z,Q):q.renderbufferStorage(q.RENDERBUFFER,H,Z,Q),q.framebufferRenderbuffer(q.FRAMEBUFFER,V,q.RENDERBUFFER,K)}reset(){this.current=this.unknownFramebuffer,this.viewport=new y}destroy(){this.renderer=null}}q9.extension={type:j.RendererSystem,name:"framebuffer"};D.add(q9);var sJ={5126:4,5123:2,5121:1};class K9{constructor($){this.renderer=$,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let $=this.gl=this.renderer.gl,J=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,J.webGLVersion!==2){let Z=this.renderer.context.extensions.vertexArrayObject;_.PREFER_ENV===k1.WEBGL_LEGACY&&(Z=null),Z?($.createVertexArray=()=>Z.createVertexArrayOES(),$.bindVertexArray=(Q)=>Z.bindVertexArrayOES(Q),$.deleteVertexArray=(Q)=>Z.deleteVertexArrayOES(Q)):(this.hasVao=!1,$.createVertexArray=()=>null,$.bindVertexArray=()=>null,$.deleteVertexArray=()=>null)}if(J.webGLVersion!==2){let Z=$.getExtension("ANGLE_instanced_arrays");Z?($.vertexAttribDivisor=(Q,q)=>Z.vertexAttribDivisorANGLE(Q,q),$.drawElementsInstanced=(Q,q,K,V,H)=>Z.drawElementsInstancedANGLE(Q,q,K,V,H),$.drawArraysInstanced=(Q,q,K,V)=>Z.drawArraysInstancedANGLE(Q,q,K,V)):this.hasInstance=!1}this.canUseUInt32ElementIndex=J.webGLVersion===2||!!J.extensions.uint32ElementIndex}bind($,J){J=J||this.renderer.shader.shader;let{gl:Z}=this,Q=$.glVertexArrayObjects[this.CONTEXT_UID],q=!1;Q||(this.managedGeometries[$.id]=$,$.disposeRunner.add(this),$.glVertexArrayObjects[this.CONTEXT_UID]=Q={},q=!0);let K=Q[J.program.id]||this.initGeometryVao($,J,q);this._activeGeometry=$,this._activeVao!==K&&(this._activeVao=K,this.hasVao?Z.bindVertexArray(K):this.activateVao($,J.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let $=this._activeGeometry,J=this.renderer.buffer;for(let Z=0;Z<$.buffers.length;Z++){let Q=$.buffers[Z];J.update(Q)}}checkCompatibility($,J){let Z=$.attributes,Q=J.attributeData;for(let q in Q)if(!Z[q])throw new Error(`shader and geometry incompatible, geometry missing the "${q}" attribute`)}getSignature($,J){let Z=$.attributes,Q=J.attributeData,q=["g",$.id];for(let K in Z)Q[K]&&q.push(K,Q[K].location);return q.join("-")}initGeometryVao($,J,Z=!0){let Q=this.gl,q=this.CONTEXT_UID,K=this.renderer.buffer,V=J.program;V.glPrograms[q]||this.renderer.shader.generateProgram(J),this.checkCompatibility($,V);let H=this.getSignature($,V),X=$.glVertexArrayObjects[this.CONTEXT_UID],W=X[H];if(W)return X[V.id]=W,W;let{buffers:z,attributes:G}=$,Y={},w={};for(let U in z)Y[U]=0,w[U]=0;for(let U in G)!G[U].size&&V.attributeData[U]?G[U].size=V.attributeData[U].size:G[U].size||console.warn(`PIXI Geometry attribute '${U}' size cannot be determined (likely the bound shader does not have the attribute)`),Y[G[U].buffer]+=G[U].size*sJ[G[U].type];for(let U in G){let C=G[U],N=C.size;C.stride===void 0&&(Y[C.buffer]===N*sJ[C.type]?C.stride=0:C.stride=Y[C.buffer]),C.start===void 0&&(C.start=w[C.buffer],w[C.buffer]+=N*sJ[C.type])}W=Q.createVertexArray(),Q.bindVertexArray(W);for(let U=0;U<z.length;U++){let C=z[U];K.bind(C),Z&&C._glBuffers[q].refCount++}return this.activateVao($,V),X[V.id]=W,X[H]=W,Q.bindVertexArray(null),K.unbind(F1.ARRAY_BUFFER),W}disposeGeometry($,J){if(!this.managedGeometries[$.id])return;delete this.managedGeometries[$.id];let Z=$.glVertexArrayObjects[this.CONTEXT_UID],Q=this.gl,q=$.buffers,K=this.renderer?.buffer;if($.disposeRunner.remove(this),!!Z){if(K)for(let V=0;V<q.length;V++){let H=q[V]._glBuffers[this.CONTEXT_UID];H&&(H.refCount--,H.refCount===0&&!J&&K.dispose(q[V],J))}if(!J){for(let V in Z)if(V[0]==="g"){let H=Z[V];this._activeVao===H&&this.unbind(),Q.deleteVertexArray(H)}}delete $.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll($){let J=Object.keys(this.managedGeometries);for(let Z=0;Z<J.length;Z++)this.disposeGeometry(this.managedGeometries[J[Z]],$)}activateVao($,J){let Z=this.gl,Q=this.CONTEXT_UID,q=this.renderer.buffer,K=$.buffers,V=$.attributes;$.indexBuffer&&q.bind($.indexBuffer);let H=null;for(let X in V){let W=V[X],z=K[W.buffer],G=z._glBuffers[Q];if(J.attributeData[X]){H!==G&&(q.bind(z),H=G);let Y=J.attributeData[X].location;if(Z.enableVertexAttribArray(Y),Z.vertexAttribPointer(Y,W.size,W.type||Z.FLOAT,W.normalized,W.stride,W.start),W.instance)if(this.hasInstance)Z.vertexAttribDivisor(Y,W.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw($,J,Z,Q){let{gl:q}=this,K=this._activeGeometry;if(K.indexBuffer){let V=K.indexBuffer.data.BYTES_PER_ELEMENT,H=V===2?q.UNSIGNED_SHORT:q.UNSIGNED_INT;V===2||V===4&&this.canUseUInt32ElementIndex?K.instanced?q.drawElementsInstanced($,J||K.indexBuffer.data.length,H,(Z||0)*V,Q||1):q.drawElements($,J||K.indexBuffer.data.length,H,(Z||0)*V):console.warn("unsupported index buffer type: uint32")}else K.instanced?q.drawArraysInstanced($,Z,J||K.getSize(),Q||1):q.drawArrays($,Z,J||K.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}K9.extension={type:j.RendererSystem,name:"geometry"};D.add(K9);var LV=new $0;class p8{constructor($,J){this._texture=$,this.mapCoord=new $0,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof J>"u"?0.5:J,this.isSimple=!1}get texture(){return this._texture}set texture($){this._texture=$,this._textureID=-1}multiplyUvs($,J){J===void 0&&(J=$);let Z=this.mapCoord;for(let Q=0;Q<$.length;Q+=2){let q=$[Q],K=$[Q+1];J[Q]=q*Z.a+K*Z.c+Z.tx,J[Q+1]=q*Z.b+K*Z.d+Z.ty}return J}update($){let J=this._texture;if(!J||!J.valid||!$&&this._textureID===J._updateID)return!1;this._textureID=J._updateID,this._updateID++;let Z=J._uvs;this.mapCoord.set(Z.x1-Z.x0,Z.y1-Z.y0,Z.x3-Z.x0,Z.y3-Z.y0,Z.x0,Z.y0);let{orig:Q,trim:q}=J;q&&(LV.set(Q.width/q.width,0,0,Q.height/q.height,-q.x/q.width,-q.y/q.height),this.mapCoord.append(LV));let K=J.baseTexture,V=this.uClampFrame,H=this.clampMargin/K.resolution,X=this.clampOffset;return V[0]=(J._frame.x+H+X)/K.width,V[1]=(J._frame.y+H+X)/K.height,V[2]=(J._frame.x+J._frame.width-H+X)/K.width,V[3]=(J._frame.y+J._frame.height-H+X)/K.height,this.uClampOffset[0]=X/K.realWidth,this.uClampOffset[1]=X/K.realHeight,this.isSimple=J._frame.width===K.width&&J._frame.height===K.height&&J.rotate===0,!0}}var kV=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var AV=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class f$ extends G0{constructor($,J,Z){let Q=null;typeof $!="string"&&J===void 0&&Z===void 0&&(Q=$,$=void 0,J=void 0,Z=void 0),super($||AV,J||kV,Z),this.maskSprite=Q,this.maskMatrix=new $0}get maskSprite(){return this._maskSprite}set maskSprite($){this._maskSprite=$,this._maskSprite&&(this._maskSprite.renderable=!1)}apply($,J,Z,Q){let q=this._maskSprite,K=q._texture;K.valid&&(K.uvMatrix||(K.uvMatrix=new p8(K,0)),K.uvMatrix.update(),this.uniforms.npmAlpha=K.baseTexture.alphaMode?0:1,this.uniforms.mask=K,this.uniforms.otherMatrix=$.calculateSpriteMatrix(this.maskMatrix,q).prepend(K.uvMatrix.mapCoord),this.uniforms.alpha=q.worldAlpha,this.uniforms.maskClamp=K.uvMatrix.uClampFrame,$.applyFilter(this,J,Z,Q))}}class v${constructor($=null){this.type=D0.NONE,this.autoDetect=!0,this.maskObject=$||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=G0.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter($){$?this._filters?this._filters[0]=$:this._filters=[$]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=D0.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset($){$?(this._stencilCounter=$._stencilCounter,this._scissorCounter=$._scissorCounter,this._scissorRect=$._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class V9{constructor($){this.renderer=$,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack($){this.maskStack=$,this.renderer.scissor.setMaskStack($),this.renderer.stencil.setMaskStack($)}push($,J){let Z=J;if(!Z.isMaskData){let q=this.maskDataPool.pop()||new v$;q.pooled=!0,q.maskObject=J,Z=q}let Q=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(Z.copyCountersOrReset(Q),Z._colorMask=Q?Q._colorMask:15,Z.autoDetect&&this.detect(Z),Z._target=$,Z.type!==D0.SPRITE&&this.maskStack.push(Z),Z.enabled)switch(Z.type){case D0.SCISSOR:this.renderer.scissor.push(Z);break;case D0.STENCIL:this.renderer.stencil.push(Z);break;case D0.SPRITE:Z.copyCountersOrReset(null),this.pushSpriteMask(Z);break;case D0.COLOR:this.pushColorMask(Z);break;default:break}Z.type===D0.SPRITE&&this.maskStack.push(Z)}pop($){let J=this.maskStack.pop();if(!(!J||J._target!==$)){if(J.enabled)switch(J.type){case D0.SCISSOR:this.renderer.scissor.pop(J);break;case D0.STENCIL:this.renderer.stencil.pop(J.maskObject);break;case D0.SPRITE:this.popSpriteMask(J);break;case D0.COLOR:this.popColorMask(J);break;default:break}if(J.reset(),J.pooled&&this.maskDataPool.push(J),this.maskStack.length!==0){let Z=this.maskStack[this.maskStack.length-1];Z.type===D0.SPRITE&&Z._filters&&(Z._filters[0].maskSprite=Z.maskObject)}}}detect($){let J=$.maskObject;J?J.isSprite?$.type=D0.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor($)?$.type=D0.SCISSOR:$.type=D0.STENCIL:$.type=D0.COLOR}pushSpriteMask($){let{maskObject:J}=$,Z=$._target,Q=$._filters;Q||(Q=this.alphaMaskPool[this.alphaMaskIndex],Q||(Q=this.alphaMaskPool[this.alphaMaskIndex]=[new f$])),Q[0].resolution=$.resolution,Q[0].multisample=$.multisample,Q[0].maskSprite=J;let q=Z.filterArea;Z.filterArea=J.getBounds(!0),this.renderer.filter.push(Z,Q),Z.filterArea=q,$._filters||this.alphaMaskIndex++}popSpriteMask($){this.renderer.filter.pop(),$._filters?$._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask($){let J=$._colorMask,Z=$._colorMask=J&$.colorMask;Z!==J&&this.renderer.gl.colorMask((Z&1)!==0,(Z&2)!==0,(Z&4)!==0,(Z&8)!==0)}popColorMask($){let J=$._colorMask,Z=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;Z!==J&&this.renderer.gl.colorMask((Z&1)!==0,(Z&2)!==0,(Z&4)!==0,(Z&8)!==0)}destroy(){this.renderer=null}}V9.extension={type:j.RendererSystem,name:"mask"};D.add(V9);class H9{constructor($){this.renderer=$,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack($){let{gl:J}=this.renderer,Z=this.getStackLength();this.maskStack=$;let Q=this.getStackLength();Q!==Z&&(Q===0?J.disable(this.glConst):(J.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}var RV=new $0,MV=[],EV=class $ extends H9{constructor(J){super(J),this.glConst=_.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let J=this.maskStack[this.maskStack.length-1];return J?J._scissorCounter:0}calcScissorRect(J){if(J._scissorRectLocal)return;let Z=J._scissorRect,{maskObject:Q}=J,{renderer:q}=this,K=q.renderTexture,V=Q.getBounds(!0,MV.pop()??new y);this.roundFrameToPixels(V,K.current?K.current.resolution:q.resolution,K.sourceFrame,K.destinationFrame,q.projection.transform),Z&&V.fit(Z),J._scissorRectLocal=V}static isMatrixRotated(J){if(!J)return!1;let{a:Z,b:Q,c:q,d:K}=J;return(Math.abs(Q)>0.0001||Math.abs(q)>0.0001)&&(Math.abs(Z)>0.0001||Math.abs(K)>0.0001)}testScissor(J){let{maskObject:Z}=J;if(!Z.isFastRect||!Z.isFastRect()||$.isMatrixRotated(Z.worldTransform)||$.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(J);let Q=J._scissorRectLocal;return Q.width>0&&Q.height>0}roundFrameToPixels(J,Z,Q,q,K){$.isMatrixRotated(K)||(K=K?RV.copyFrom(K):RV.identity(),K.translate(-Q.x,-Q.y).scale(q.width/Q.width,q.height/Q.height).translate(q.x,q.y),this.renderer.filter.transformAABB(K,J),J.fit(q),J.x=Math.round(J.x*Z),J.y=Math.round(J.y*Z),J.width=Math.round(J.width*Z),J.height=Math.round(J.height*Z))}push(J){J._scissorRectLocal||this.calcScissorRect(J);let{gl:Z}=this.renderer;J._scissorRect||Z.enable(Z.SCISSOR_TEST),J._scissorCounter++,J._scissorRect=J._scissorRectLocal,this._useCurrent()}pop(J){let{gl:Z}=this.renderer;J&&MV.push(J._scissorRectLocal),this.getStackLength()>0?this._useCurrent():Z.disable(Z.SCISSOR_TEST)}_useCurrent(){let J=this.maskStack[this.maskStack.length-1]._scissorRect,Z;this.renderer.renderTexture.current?Z=J.y:Z=this.renderer.height-J.height-J.y,this.renderer.gl.scissor(J.x,Z,J.width,J.height)}};EV.extension={type:j.RendererSystem,name:"scissor"};var iJ=EV;D.add(iJ);class X9 extends H9{constructor($){super($),this.glConst=_.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let $=this.maskStack[this.maskStack.length-1];return $?$._stencilCounter:0}push($){let J=$.maskObject,{gl:Z}=this.renderer,Q=$._stencilCounter;Q===0&&(this.renderer.framebuffer.forceStencil(),Z.clearStencil(0),Z.clear(Z.STENCIL_BUFFER_BIT),Z.enable(Z.STENCIL_TEST)),$._stencilCounter++;let q=$._colorMask;q!==0&&($._colorMask=0,Z.colorMask(!1,!1,!1,!1)),Z.stencilFunc(Z.EQUAL,Q,4294967295),Z.stencilOp(Z.KEEP,Z.KEEP,Z.INCR),J.renderable=!0,J.render(this.renderer),this.renderer.batch.flush(),J.renderable=!1,q!==0&&($._colorMask=q,Z.colorMask((q&1)!==0,(q&2)!==0,(q&4)!==0,(q&8)!==0)),this._useCurrent()}pop($){let J=this.renderer.gl;if(this.getStackLength()===0)J.disable(J.STENCIL_TEST);else{let Z=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,Q=Z?Z._colorMask:15;Q!==0&&(Z._colorMask=0,J.colorMask(!1,!1,!1,!1)),J.stencilOp(J.KEEP,J.KEEP,J.DECR),$.renderable=!0,$.render(this.renderer),this.renderer.batch.flush(),$.renderable=!1,Q!==0&&(Z._colorMask=Q,J.colorMask((Q&1)!==0,(Q&2)!==0,(Q&4)!==0,(Q&8)!==0)),this._useCurrent()}}_useCurrent(){let $=this.renderer.gl;$.stencilFunc($.EQUAL,this.getStackLength(),4294967295),$.stencilOp($.KEEP,$.KEEP,$.KEEP)}}X9.extension={type:j.RendererSystem,name:"stencil"};D.add(X9);class W9{constructor($){this.renderer=$,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return a("7.0.0","renderer.plugins.extract has moved to renderer.extract"),$.extract}},prepare:{enumerable:!1,get(){return a("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),$.prepare}},interaction:{enumerable:!1,get(){return a("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),$.events}}})}init(){let $=this.rendererPlugins;for(let J in $)this.plugins[J]=new $[J](this.renderer)}destroy(){for(let $ in this.plugins)this.plugins[$].destroy(),this.plugins[$]=null}}W9.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"_plugin"};D.add(W9);class z9{constructor($){this.renderer=$,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new $0,this.transform=null}update($,J,Z,Q){this.destinationFrame=$||this.destinationFrame||this.defaultFrame,this.sourceFrame=J||this.sourceFrame||$,this.calculateProjection(this.destinationFrame,this.sourceFrame,Z,Q),this.transform&&this.projectionMatrix.append(this.transform);let q=this.renderer;q.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,q.globalUniforms.update(),q.shader.shader&&q.shader.syncUniformGroup(q.shader.shader.uniforms.globals)}calculateProjection($,J,Z,Q){let q=this.projectionMatrix,K=Q?-1:1;q.identity(),q.a=1/J.width*2,q.d=K*(1/J.height*2),q.tx=-1-J.x*q.a,q.ty=-K-J.y*q.d}setTransform($){}destroy(){this.renderer=null}}z9.extension={type:j.RendererSystem,name:"projection"};D.add(z9);var xw=new g8,hV=new y;class G9{constructor($){this.renderer=$,this._tempMatrix=new $0}generateTexture($,J){let{region:Z,...Q}=J||{},q=Z?.copyTo(hV)||$.getLocalBounds(hV,!0),K=Q.resolution||this.renderer.resolution;q.width=Math.max(q.width,1/K),q.height=Math.max(q.height,1/K),Q.width=q.width,Q.height=q.height,Q.resolution=K,Q.multisample??(Q.multisample=this.renderer.multisample);let V=g1.create(Q);this._tempMatrix.tx=-q.x,this._tempMatrix.ty=-q.y;let H=$.transform;return $.transform=xw,this.renderer.render($,{renderTexture:V,transform:this._tempMatrix,skipUpdateTransform:!!$.parent,blit:!0}),$.transform=H,V}destroy(){}}G9.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"textureGenerator"};D.add(G9);var B5=new y,Y9=new y;class w9{constructor($){this.renderer=$,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new y,this.destinationFrame=new y,this.viewportFrame=new y}contextChange(){let $=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!($&&$.alpha&&$.premultipliedAlpha)}bind($=null,J,Z){let Q=this.renderer;this.current=$;let q,K,V;$?(q=$.baseTexture,V=q.resolution,J||(B5.width=$.frame.width,B5.height=$.frame.height,J=B5),Z||(Y9.x=$.frame.x,Y9.y=$.frame.y,Y9.width=J.width,Y9.height=J.height,Z=Y9),K=q.framebuffer):(V=Q.resolution,J||(B5.width=Q._view.screen.width,B5.height=Q._view.screen.height,J=B5),Z||(Z=B5,Z.width=J.width,Z.height=J.height));let H=this.viewportFrame;H.x=Z.x*V,H.y=Z.y*V,H.width=Z.width*V,H.height=Z.height*V,$||(H.y=Q.view.height-(H.y+H.height)),H.ceil(),this.renderer.framebuffer.bind(K,H),this.renderer.projection.update(Z,J,V,!K),$?this.renderer.mask.setMaskStack(q.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(J),this.destinationFrame.copyFrom(Z)}clear($,J){let Z=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,Q=r.shared.setValue($||Z);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&Q.premultiply(Q.alpha);let q=this.destinationFrame,K=this.current?this.current.baseTexture:this.renderer._view.screen,V=q.width!==K.width||q.height!==K.height;if(V){let{x:H,y:X,width:W,height:z}=this.viewportFrame;H=Math.round(H),X=Math.round(X),W=Math.round(W),z=Math.round(z),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(H,X,W,z)}this.renderer.framebuffer.clear(Q.red,Q.green,Q.blue,Q.alpha,J),V&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}w9.extension={type:j.RendererSystem,name:"renderTexture"};D.add(w9);class y${constructor($,J){this.program=$,this.uniformData=J,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function TV($,J){let Z={},Q=J.getProgramParameter($,J.ACTIVE_ATTRIBUTES);for(let q=0;q<Q;q++){let K=J.getActiveAttrib($,q);if(K.name.startsWith("gl_"))continue;let V=t6(J,K.type),H={type:V,name:K.name,size:r6(V),location:J.getAttribLocation($,K.name)};Z[K.name]=H}return Z}function SV($,J){let Z={},Q=J.getProgramParameter($,J.ACTIVE_UNIFORMS);for(let q=0;q<Q;q++){let K=J.getActiveUniform($,q),V=K.name.replace(/\[.*?\]$/,""),H=!!K.name.match(/\[.*?\]$/),X=t6(J,K.type);Z[V]={name:V,index:q,type:X,size:K.size,isArray:H,value:a6(X,K.size)}}return Z}function aJ($,J){let Z=j$($,$.VERTEX_SHADER,J.vertexSrc),Q=j$($,$.FRAGMENT_SHADER,J.fragmentSrc),q=$.createProgram();$.attachShader(q,Z),$.attachShader(q,Q);let K=J.extra?.transformFeedbackVaryings;if(K&&(typeof $.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):$.transformFeedbackVaryings(q,K.names,K.bufferMode==="separate"?$.SEPARATE_ATTRIBS:$.INTERLEAVED_ATTRIBS)),$.linkProgram(q),$.getProgramParameter(q,$.LINK_STATUS)||pJ($,q,Z,Q),J.attributeData=TV(q,$),J.uniformData=SV(q,$),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(J.vertexSrc)){let H=Object.keys(J.attributeData);H.sort((X,W)=>X>W?1:-1);for(let X=0;X<H.length;X++)J.attributeData[H[X]].location=X,$.bindAttribLocation(q,X,H[X]);$.linkProgram(q)}$.deleteShader(Z),$.deleteShader(Q);let V={};for(let H in J.uniformData){let X=J.uniformData[H];V[H]={location:$.getUniformLocation(q,H),value:a6(X.type,X.size)}}return new y$(q,V)}function cw($,J,Z,Q,q){Z.buffer.update(q)}var mw={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},bV={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function fV($){let J=$.map((K)=>({data:K,offset:0,dataLen:0,dirty:0})),Z=0,Q=0,q=0;for(let K=0;K<J.length;K++){let V=J[K];if(Z=bV[V.data.type],V.data.size>1&&(Z=Math.max(Z,16)*V.data.size),V.dataLen=Z,Q%Z!==0&&Q<16){let H=Q%Z%16;Q+=H,q+=H}Q+Z>16?(q=Math.ceil(q/16)*16,V.offset=q,q+=Z,Q=Z):(V.offset=q,Q+=Z,q+=Z)}return q=Math.ceil(q/16)*16,{uboElements:J,size:q}}function vV($,J){let Z=[];for(let Q in $)J[Q]&&Z.push(J[Q]);return Z.sort((Q,q)=>Q.index-q.index),Z}function rJ($,J){if(!$.autoManage)return{size:0,syncFunc:cw};let Z=vV($.uniforms,J),{uboElements:Q,size:q}=fV(Z),K=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let V=0;V<Q.length;V++){let H=Q[V],X=$.uniforms[H.data.name],W=H.data.name,z=!1;for(let G=0;G<H8.length;G++){let Y=H8[G];if(Y.codeUbo&&Y.test(H.data,X)){K.push(`offset = ${H.offset/4};`,H8[G].codeUbo(H.data.name,X)),z=!0;break}}if(!z)if(H.data.size>1){let G=r6(H.data.type),Y=Math.max(bV[H.data.type]/16,1),w=G/Y,U=(4-w%4)%4;K.push(`
                cv = ud.${W}.value;
                v = uv.${W};
                offset = ${H.offset/4};

                t = 0;

                for(var i=0; i < ${H.data.size*Y}; i++)
                {
                    for(var j = 0; j < ${w}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${U};
                }

                `)}else{let G=mw[H.data.type];K.push(`
                cv = ud.${W}.value;
                v = uv.${W};
                offset = ${H.offset/4};
                ${G};
                `)}}return K.push(`
       renderer.buffer.update(buffer);
    `),{size:q,syncFunc:new Function("ud","uv","renderer","syncData","buffer",K.join(`
`))}}var uw=0,g$={textureCount:0,uboCount:0};class U9{constructor($){this.destroyed=!1,this.renderer=$,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=uw++}systemCheck(){if(!A$())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange($){this.gl=$,this.reset()}bind($,J){$.disposeRunner.add(this),$.uniforms.globals=this.renderer.globalUniforms;let Z=$.program,Q=Z.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram($);return this.shader=$,this.program!==Z&&(this.program=Z,this.gl.useProgram(Q.program)),J||(g$.textureCount=0,g$.uboCount=0,this.syncUniformGroup($.uniformGroup,g$)),Q}setUniforms($){let J=this.shader.program,Z=J.glPrograms[this.renderer.CONTEXT_UID];J.syncUniforms(Z.uniformData,$,this.renderer)}syncUniformGroup($,J){let Z=this.getGlProgram();(!$.static||$.dirtyId!==Z.uniformDirtyGroups[$.id])&&(Z.uniformDirtyGroups[$.id]=$.dirtyId,this.syncUniforms($,Z,J))}syncUniforms($,J,Z){($.syncUniforms[this.shader.program.id]||this.createSyncGroups($))(J.uniformData,$.uniforms,this.renderer,Z)}createSyncGroups($){let J=this.getSignature($,this.shader.program.uniformData,"u");return this.cache[J]||(this.cache[J]=uJ($,this.shader.program.uniformData)),$.syncUniforms[this.shader.program.id]=this.cache[J],$.syncUniforms[this.shader.program.id]}syncUniformBufferGroup($,J){let Z=this.getGlProgram();if(!$.static||$.dirtyId!==0||!Z.uniformGroups[$.id]){$.dirtyId=0;let Q=Z.uniformGroups[$.id]||this.createSyncBufferGroup($,Z,J);$.buffer.update(),Q(Z.uniformData,$.uniforms,this.renderer,g$,$.buffer)}this.renderer.buffer.bindBufferBase($.buffer,Z.uniformBufferBindings[J])}createSyncBufferGroup($,J,Z){let{gl:Q}=this.renderer;this.renderer.buffer.bind($.buffer);let q=this.gl.getUniformBlockIndex(J.program,Z);J.uniformBufferBindings[Z]=this.shader.uniformBindCount,Q.uniformBlockBinding(J.program,q,this.shader.uniformBindCount),this.shader.uniformBindCount++;let K=this.getSignature($,this.shader.program.uniformData,"ubo"),V=this._uboCache[K];if(V||(V=this._uboCache[K]=rJ($,this.shader.program.uniformData)),$.autoManage){let H=new Float32Array(V.size/4);$.buffer.update(H)}return J.uniformGroups[$.id]=V.syncFunc,J.uniformGroups[$.id]}getSignature($,J,Z){let Q=$.uniforms,q=[`${Z}-`];for(let K in Q)q.push(K),J[K]&&q.push(J[K].type);return q.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram($){let J=this.gl,Z=$.program,Q=aJ(J,Z);return Z.glPrograms[this.renderer.CONTEXT_UID]=Q,Q}reset(){this.program=null,this.shader=null}disposeShader($){this.shader===$&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}U9.extension={type:j.RendererSystem,name:"shader"};D.add(U9);class l8{constructor($){this.renderer=$}run($){let{renderer:J}=this;J.runners.init.emit(J.options),$.hello&&console.log(`PixiJS 7.4.3 - ${J.rendererLogId} - https://pixijs.com`),J.resize(J.screen.width,J.screen.height)}destroy(){}}l8.defaultOptions={hello:!1},l8.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"startup"};D.add(l8);function yV($,J=[]){return J[s.NORMAL]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.ADD]=[$.ONE,$.ONE],J[s.MULTIPLY]=[$.DST_COLOR,$.ONE_MINUS_SRC_ALPHA,$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.SCREEN]=[$.ONE,$.ONE_MINUS_SRC_COLOR,$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.OVERLAY]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.DARKEN]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.LIGHTEN]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.COLOR_DODGE]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.COLOR_BURN]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.HARD_LIGHT]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.SOFT_LIGHT]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.DIFFERENCE]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.EXCLUSION]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.HUE]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.SATURATION]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.COLOR]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.LUMINOSITY]=[$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.NONE]=[0,0],J[s.NORMAL_NPM]=[$.SRC_ALPHA,$.ONE_MINUS_SRC_ALPHA,$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.ADD_NPM]=[$.SRC_ALPHA,$.ONE,$.ONE,$.ONE],J[s.SCREEN_NPM]=[$.SRC_ALPHA,$.ONE_MINUS_SRC_COLOR,$.ONE,$.ONE_MINUS_SRC_ALPHA],J[s.SRC_IN]=[$.DST_ALPHA,$.ZERO],J[s.SRC_OUT]=[$.ONE_MINUS_DST_ALPHA,$.ZERO],J[s.SRC_ATOP]=[$.DST_ALPHA,$.ONE_MINUS_SRC_ALPHA],J[s.DST_OVER]=[$.ONE_MINUS_DST_ALPHA,$.ONE],J[s.DST_IN]=[$.ZERO,$.SRC_ALPHA],J[s.DST_OUT]=[$.ZERO,$.ONE_MINUS_SRC_ALPHA],J[s.DST_ATOP]=[$.ONE_MINUS_DST_ALPHA,$.SRC_ALPHA],J[s.XOR]=[$.ONE_MINUS_DST_ALPHA,$.ONE_MINUS_SRC_ALPHA],J[s.SUBTRACT]=[$.ONE,$.ONE,$.ONE,$.ONE,$.FUNC_REVERSE_SUBTRACT,$.FUNC_ADD],J}var dw=0,pw=1,lw=2,nw=3,ow=4,sw=5,gV=class ${constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=s.NONE,this._blendEq=!1,this.map=[],this.map[dw]=this.setBlend,this.map[pw]=this.setOffset,this.map[lw]=this.setCullFace,this.map[nw]=this.setDepthTest,this.map[ow]=this.setFrontFace,this.map[sw]=this.setDepthMask,this.checks=[],this.defaultState=new g0,this.defaultState.blend=!0}contextChange(J){this.gl=J,this.blendModes=yV(J),this.set(this.defaultState),this.reset()}set(J){if(J=J||this.defaultState,this.stateId!==J.data){let Z=this.stateId^J.data,Q=0;for(;Z;)Z&1&&this.map[Q].call(this,!!(J.data&1<<Q)),Z=Z>>1,Q++;this.stateId=J.data}for(let Z=0;Z<this.checks.length;Z++)this.checks[Z](this,J)}forceState(J){J=J||this.defaultState;for(let Z=0;Z<this.map.length;Z++)this.map[Z].call(this,!!(J.data&1<<Z));for(let Z=0;Z<this.checks.length;Z++)this.checks[Z](this,J);this.stateId=J.data}setBlend(J){this.updateCheck($.checkBlendMode,J),this.gl[J?"enable":"disable"](this.gl.BLEND)}setOffset(J){this.updateCheck($.checkPolygonOffset,J),this.gl[J?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(J){this.gl[J?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(J){this.gl.depthMask(J)}setCullFace(J){this.gl[J?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(J){this.gl.frontFace(this.gl[J?"CW":"CCW"])}setBlendMode(J){if(J===this.blendMode)return;this.blendMode=J;let Z=this.blendModes[J],Q=this.gl;Z.length===2?Q.blendFunc(Z[0],Z[1]):Q.blendFuncSeparate(Z[0],Z[1],Z[2],Z[3]),Z.length===6?(this._blendEq=!0,Q.blendEquationSeparate(Z[4],Z[5])):this._blendEq&&(this._blendEq=!1,Q.blendEquationSeparate(Q.FUNC_ADD,Q.FUNC_ADD))}setPolygonOffset(J,Z){this.gl.polygonOffset(J,Z)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(J,Z){let Q=this.checks.indexOf(J);Z&&Q===-1?this.checks.push(J):!Z&&Q!==-1&&this.checks.splice(Q,1)}static checkBlendMode(J,Z){J.setBlendMode(Z.blendMode)}static checkPolygonOffset(J,Z){J.setPolygonOffset(1,Z.polygonOffset)}destroy(){this.gl=null}};gV.extension={type:j.RendererSystem,name:"state"};var tJ=gV;D.add(tJ);class C9 extends m8.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup($){this.addRunners(...$.runners);let J=($.priority??[]).filter((Q)=>$.systems[Q]),Z=[...J,...Object.keys($.systems).filter((Q)=>!J.includes(Q))];for(let Q of Z)this.addSystem($.systems[Q],Q)}addRunners(...$){$.forEach((J)=>{this.runners[J]=new E0(J)})}addSystem($,J){let Z=new $(this);if(this[J])throw new Error(`Whoops! The name "${J}" is already in use`);this[J]=Z,this._systemsHash[J]=Z;for(let Q in this.runners)this.runners[Q].add(Z);return this}emitWithCustomOptions($,J){let Z=Object.keys(this._systemsHash);$.items.forEach((Q)=>{let q=Z.find((K)=>this._systemsHash[K]===Q);Q[$.name](J[q])})}destroy(){Object.values(this.runners).forEach(($)=>{$.destroy()}),this._systemsHash={}}}var N9=class ${constructor(J){this.renderer=J,this.count=0,this.checkCount=0,this.maxIdle=$.defaultMaxIdle,this.checkCountMax=$.defaultCheckCountMax,this.mode=$.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==V$.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let J=this.renderer.texture,Z=J.managedTextures,Q=!1;for(let q=0;q<Z.length;q++){let K=Z[q];K.resource&&this.count-K.touched>this.maxIdle&&(J.destroyTexture(K,!0),Z[q]=null,Q=!0)}if(Q){let q=0;for(let K=0;K<Z.length;K++)Z[K]!==null&&(Z[q++]=Z[K]);Z.length=q}}unload(J){let Z=this.renderer.texture,Q=J._texture;Q&&!Q.framebuffer&&Z.destroyTexture(Q);for(let q=J.children.length-1;q>=0;q--)this.unload(J.children[q])}destroy(){this.renderer=null}};N9.defaultMode=V$.AUTO,N9.defaultMaxIdle=3600,N9.defaultCheckCountMax=600,N9.extension={type:j.RendererSystem,name:"textureGC"};var W8=N9;D.add(W8);class t5{constructor($){this.texture=$,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=p.UNSIGNED_BYTE,this.internalFormat=h.RGBA,this.samplerType=0}}function xV($){let J;return"WebGL2RenderingContext"in globalThis&&$ instanceof globalThis.WebGL2RenderingContext?J={[$.RGB]:c.FLOAT,[$.RGBA]:c.FLOAT,[$.ALPHA]:c.FLOAT,[$.LUMINANCE]:c.FLOAT,[$.LUMINANCE_ALPHA]:c.FLOAT,[$.R8]:c.FLOAT,[$.R8_SNORM]:c.FLOAT,[$.RG8]:c.FLOAT,[$.RG8_SNORM]:c.FLOAT,[$.RGB8]:c.FLOAT,[$.RGB8_SNORM]:c.FLOAT,[$.RGB565]:c.FLOAT,[$.RGBA4]:c.FLOAT,[$.RGB5_A1]:c.FLOAT,[$.RGBA8]:c.FLOAT,[$.RGBA8_SNORM]:c.FLOAT,[$.RGB10_A2]:c.FLOAT,[$.RGB10_A2UI]:c.FLOAT,[$.SRGB8]:c.FLOAT,[$.SRGB8_ALPHA8]:c.FLOAT,[$.R16F]:c.FLOAT,[$.RG16F]:c.FLOAT,[$.RGB16F]:c.FLOAT,[$.RGBA16F]:c.FLOAT,[$.R32F]:c.FLOAT,[$.RG32F]:c.FLOAT,[$.RGB32F]:c.FLOAT,[$.RGBA32F]:c.FLOAT,[$.R11F_G11F_B10F]:c.FLOAT,[$.RGB9_E5]:c.FLOAT,[$.R8I]:c.INT,[$.R8UI]:c.UINT,[$.R16I]:c.INT,[$.R16UI]:c.UINT,[$.R32I]:c.INT,[$.R32UI]:c.UINT,[$.RG8I]:c.INT,[$.RG8UI]:c.UINT,[$.RG16I]:c.INT,[$.RG16UI]:c.UINT,[$.RG32I]:c.INT,[$.RG32UI]:c.UINT,[$.RGB8I]:c.INT,[$.RGB8UI]:c.UINT,[$.RGB16I]:c.INT,[$.RGB16UI]:c.UINT,[$.RGB32I]:c.INT,[$.RGB32UI]:c.UINT,[$.RGBA8I]:c.INT,[$.RGBA8UI]:c.UINT,[$.RGBA16I]:c.INT,[$.RGBA16UI]:c.UINT,[$.RGBA32I]:c.INT,[$.RGBA32UI]:c.UINT,[$.DEPTH_COMPONENT16]:c.FLOAT,[$.DEPTH_COMPONENT24]:c.FLOAT,[$.DEPTH_COMPONENT32F]:c.FLOAT,[$.DEPTH_STENCIL]:c.FLOAT,[$.DEPTH24_STENCIL8]:c.FLOAT,[$.DEPTH32F_STENCIL8]:c.FLOAT}:J={[$.RGB]:c.FLOAT,[$.RGBA]:c.FLOAT,[$.ALPHA]:c.FLOAT,[$.LUMINANCE]:c.FLOAT,[$.LUMINANCE_ALPHA]:c.FLOAT,[$.DEPTH_STENCIL]:c.FLOAT},J}function cV($){let J;return"WebGL2RenderingContext"in globalThis&&$ instanceof globalThis.WebGL2RenderingContext?J={[p.UNSIGNED_BYTE]:{[h.RGBA]:$.RGBA8,[h.RGB]:$.RGB8,[h.RG]:$.RG8,[h.RED]:$.R8,[h.RGBA_INTEGER]:$.RGBA8UI,[h.RGB_INTEGER]:$.RGB8UI,[h.RG_INTEGER]:$.RG8UI,[h.RED_INTEGER]:$.R8UI,[h.ALPHA]:$.ALPHA,[h.LUMINANCE]:$.LUMINANCE,[h.LUMINANCE_ALPHA]:$.LUMINANCE_ALPHA},[p.BYTE]:{[h.RGBA]:$.RGBA8_SNORM,[h.RGB]:$.RGB8_SNORM,[h.RG]:$.RG8_SNORM,[h.RED]:$.R8_SNORM,[h.RGBA_INTEGER]:$.RGBA8I,[h.RGB_INTEGER]:$.RGB8I,[h.RG_INTEGER]:$.RG8I,[h.RED_INTEGER]:$.R8I},[p.UNSIGNED_SHORT]:{[h.RGBA_INTEGER]:$.RGBA16UI,[h.RGB_INTEGER]:$.RGB16UI,[h.RG_INTEGER]:$.RG16UI,[h.RED_INTEGER]:$.R16UI,[h.DEPTH_COMPONENT]:$.DEPTH_COMPONENT16},[p.SHORT]:{[h.RGBA_INTEGER]:$.RGBA16I,[h.RGB_INTEGER]:$.RGB16I,[h.RG_INTEGER]:$.RG16I,[h.RED_INTEGER]:$.R16I},[p.UNSIGNED_INT]:{[h.RGBA_INTEGER]:$.RGBA32UI,[h.RGB_INTEGER]:$.RGB32UI,[h.RG_INTEGER]:$.RG32UI,[h.RED_INTEGER]:$.R32UI,[h.DEPTH_COMPONENT]:$.DEPTH_COMPONENT24},[p.INT]:{[h.RGBA_INTEGER]:$.RGBA32I,[h.RGB_INTEGER]:$.RGB32I,[h.RG_INTEGER]:$.RG32I,[h.RED_INTEGER]:$.R32I},[p.FLOAT]:{[h.RGBA]:$.RGBA32F,[h.RGB]:$.RGB32F,[h.RG]:$.RG32F,[h.RED]:$.R32F,[h.DEPTH_COMPONENT]:$.DEPTH_COMPONENT32F},[p.HALF_FLOAT]:{[h.RGBA]:$.RGBA16F,[h.RGB]:$.RGB16F,[h.RG]:$.RG16F,[h.RED]:$.R16F},[p.UNSIGNED_SHORT_5_6_5]:{[h.RGB]:$.RGB565},[p.UNSIGNED_SHORT_4_4_4_4]:{[h.RGBA]:$.RGBA4},[p.UNSIGNED_SHORT_5_5_5_1]:{[h.RGBA]:$.RGB5_A1},[p.UNSIGNED_INT_2_10_10_10_REV]:{[h.RGBA]:$.RGB10_A2,[h.RGBA_INTEGER]:$.RGB10_A2UI},[p.UNSIGNED_INT_10F_11F_11F_REV]:{[h.RGB]:$.R11F_G11F_B10F},[p.UNSIGNED_INT_5_9_9_9_REV]:{[h.RGB]:$.RGB9_E5},[p.UNSIGNED_INT_24_8]:{[h.DEPTH_STENCIL]:$.DEPTH24_STENCIL8},[p.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[h.DEPTH_STENCIL]:$.DEPTH32F_STENCIL8}}:J={[p.UNSIGNED_BYTE]:{[h.RGBA]:$.RGBA,[h.RGB]:$.RGB,[h.ALPHA]:$.ALPHA,[h.LUMINANCE]:$.LUMINANCE,[h.LUMINANCE_ALPHA]:$.LUMINANCE_ALPHA},[p.UNSIGNED_SHORT_5_6_5]:{[h.RGB]:$.RGB},[p.UNSIGNED_SHORT_4_4_4_4]:{[h.RGBA]:$.RGBA},[p.UNSIGNED_SHORT_5_5_5_1]:{[h.RGBA]:$.RGBA}},J}class B9{constructor($){this.renderer=$,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new l,this.hasIntegerTextures=!1}contextChange(){let $=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=cV($),this.samplerTypes=xV($);let J=$.getParameter($.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=J;for(let Q=0;Q<J;Q++)this.boundTextures[Q]=null;this.emptyTextures={};let Z=new t5($.createTexture());$.bindTexture($.TEXTURE_2D,Z.texture),$.texImage2D($.TEXTURE_2D,0,$.RGBA,1,1,0,$.RGBA,$.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[$.TEXTURE_2D]=Z,this.emptyTextures[$.TEXTURE_CUBE_MAP]=new t5($.createTexture()),$.bindTexture($.TEXTURE_CUBE_MAP,this.emptyTextures[$.TEXTURE_CUBE_MAP].texture);for(let Q=0;Q<6;Q++)$.texImage2D($.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,$.RGBA,1,1,0,$.RGBA,$.UNSIGNED_BYTE,null);$.texParameteri($.TEXTURE_CUBE_MAP,$.TEXTURE_MAG_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_CUBE_MAP,$.TEXTURE_MIN_FILTER,$.LINEAR);for(let Q=0;Q<this.boundTextures.length;Q++)this.bind(null,Q)}bind($,J=0){let{gl:Z}=this;if($=$?.castToBaseTexture(),$?.valid&&!$.parentTextureArray){$.touched=this.renderer.textureGC.count;let Q=$._glTextures[this.CONTEXT_UID]||this.initTexture($);this.boundTextures[J]!==$&&(this.currentLocation!==J&&(this.currentLocation=J,Z.activeTexture(Z.TEXTURE0+J)),Z.bindTexture($.target,Q.texture)),Q.dirtyId!==$.dirtyId?(this.currentLocation!==J&&(this.currentLocation=J,Z.activeTexture(Z.TEXTURE0+J)),this.updateTexture($)):Q.dirtyStyleId!==$.dirtyStyleId&&this.updateTextureStyle($),this.boundTextures[J]=$}else this.currentLocation!==J&&(this.currentLocation=J,Z.activeTexture(Z.TEXTURE0+J)),Z.bindTexture(Z.TEXTURE_2D,this.emptyTextures[Z.TEXTURE_2D].texture),this.boundTextures[J]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let $=0;$<this.boundTextures.length;$++)this.boundTextures[$]=this.unknownTexture}unbind($){let{gl:J,boundTextures:Z}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let Q=0;Q<Z.length;Q++)Z[Q]===this.unknownTexture&&this.bind(null,Q)}for(let Q=0;Q<Z.length;Q++)Z[Q]===$&&(this.currentLocation!==Q&&(J.activeTexture(J.TEXTURE0+Q),this.currentLocation=Q),J.bindTexture($.target,this.emptyTextures[$.target].texture),Z[Q]=null)}ensureSamplerType($){let{boundTextures:J,hasIntegerTextures:Z,CONTEXT_UID:Q}=this;if(Z)for(let q=$-1;q>=0;--q){let K=J[q];K&&K._glTextures[Q].samplerType!==c.FLOAT&&this.renderer.texture.unbind(K)}}initTexture($){let J=new t5(this.gl.createTexture());return J.dirtyId=-1,$._glTextures[this.CONTEXT_UID]=J,this.managedTextures.push($),$.on("dispose",this.destroyTexture,this),J}initTextureType($,J){J.internalFormat=this.internalFormats[$.type]?.[$.format]??$.format,J.samplerType=this.samplerTypes[J.internalFormat]??c.FLOAT,this.webGLVersion===2&&$.type===p.HALF_FLOAT?J.type=this.gl.HALF_FLOAT:J.type=$.type}updateTexture($){let J=$._glTextures[this.CONTEXT_UID];if(!J)return;let Z=this.renderer;if(this.initTextureType($,J),$.resource?.upload(Z,$,J))J.samplerType!==c.FLOAT&&(this.hasIntegerTextures=!0);else{let{realWidth:Q,realHeight:q}=$,K=Z.gl;(J.width!==Q||J.height!==q||J.dirtyId<0)&&(J.width=Q,J.height=q,K.texImage2D($.target,0,J.internalFormat,Q,q,0,$.format,J.type,null))}$.dirtyStyleId!==J.dirtyStyleId&&this.updateTextureStyle($),J.dirtyId=$.dirtyId}destroyTexture($,J){let{gl:Z}=this;if($=$.castToBaseTexture(),$._glTextures[this.CONTEXT_UID]&&(this.unbind($),Z.deleteTexture($._glTextures[this.CONTEXT_UID].texture),$.off("dispose",this.destroyTexture,this),delete $._glTextures[this.CONTEXT_UID],!J)){let Q=this.managedTextures.indexOf($);Q!==-1&&B$(this.managedTextures,Q,1)}}updateTextureStyle($){let J=$._glTextures[this.CONTEXT_UID];J&&(($.mipmap===n0.POW2||this.webGLVersion!==2)&&!$.isPowerOfTwo?J.mipmap=!1:J.mipmap=$.mipmap>=1,this.webGLVersion!==2&&!$.isPowerOfTwo?J.wrapMode=X1.CLAMP:J.wrapMode=$.wrapMode,$.resource?.style(this.renderer,$,J)||this.setStyle($,J),J.dirtyStyleId=$.dirtyStyleId)}setStyle($,J){let Z=this.gl;if(J.mipmap&&$.mipmap!==n0.ON_MANUAL&&Z.generateMipmap($.target),Z.texParameteri($.target,Z.TEXTURE_WRAP_S,J.wrapMode),Z.texParameteri($.target,Z.TEXTURE_WRAP_T,J.wrapMode),J.mipmap){Z.texParameteri($.target,Z.TEXTURE_MIN_FILTER,$.scaleMode===I1.LINEAR?Z.LINEAR_MIPMAP_LINEAR:Z.NEAREST_MIPMAP_NEAREST);let Q=this.renderer.context.extensions.anisotropicFiltering;if(Q&&$.anisotropicLevel>0&&$.scaleMode===I1.LINEAR){let q=Math.min($.anisotropicLevel,Z.getParameter(Q.MAX_TEXTURE_MAX_ANISOTROPY_EXT));Z.texParameterf($.target,Q.TEXTURE_MAX_ANISOTROPY_EXT,q)}}else Z.texParameteri($.target,Z.TEXTURE_MIN_FILTER,$.scaleMode===I1.LINEAR?Z.LINEAR:Z.NEAREST);Z.texParameteri($.target,Z.TEXTURE_MAG_FILTER,$.scaleMode===I1.LINEAR?Z.LINEAR:Z.NEAREST)}destroy(){this.renderer=null}}B9.extension={type:j.RendererSystem,name:"texture"};D.add(B9);class I9{constructor($){this.renderer=$}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind($){let{gl:J,CONTEXT_UID:Z}=this,Q=$._glTransformFeedbacks[Z]||this.createGLTransformFeedback($);J.bindTransformFeedback(J.TRANSFORM_FEEDBACK,Q)}unbind(){let{gl:$}=this;$.bindTransformFeedback($.TRANSFORM_FEEDBACK,null)}beginTransformFeedback($,J){let{gl:Z,renderer:Q}=this;J&&Q.shader.bind(J),Z.beginTransformFeedback($)}endTransformFeedback(){let{gl:$}=this;$.endTransformFeedback()}createGLTransformFeedback($){let{gl:J,renderer:Z,CONTEXT_UID:Q}=this,q=J.createTransformFeedback();$._glTransformFeedbacks[Q]=q,J.bindTransformFeedback(J.TRANSFORM_FEEDBACK,q);for(let K=0;K<$.buffers.length;K++){let V=$.buffers[K];V&&(Z.buffer.update(V),V._glBuffers[Q].refCount++,J.bindBufferBase(J.TRANSFORM_FEEDBACK_BUFFER,K,V._glBuffers[Q].buffer||null))}return J.bindTransformFeedback(J.TRANSFORM_FEEDBACK,null),$.disposeRunner.add(this),q}disposeTransformFeedback($,J){let Z=$._glTransformFeedbacks[this.CONTEXT_UID],Q=this.gl;$.disposeRunner.remove(this);let q=this.renderer.buffer;if(q)for(let K=0;K<$.buffers.length;K++){let V=$.buffers[K];if(!V)continue;let H=V._glBuffers[this.CONTEXT_UID];H&&(H.refCount--,H.refCount===0&&!J&&q.dispose(V,J))}Z&&(J||Q.deleteTransformFeedback(Z),delete $._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}I9.extension={type:j.RendererSystem,name:"transformFeedback"};D.add(I9);class n8{constructor($){this.renderer=$}init($){this.screen=new y(0,0,$.width,$.height),this.element=$.view||_.ADAPTER.createCanvas(),this.resolution=$.resolution||_.RESOLUTION,this.autoDensity=!!$.autoDensity}resizeView($,J){this.element.width=Math.round($*this.resolution),this.element.height=Math.round(J*this.resolution);let Z=this.element.width/this.resolution,Q=this.element.height/this.resolution;this.screen.width=Z,this.screen.height=Q,this.autoDensity&&(this.element.style.width=`${Z}px`,this.element.style.height=`${Q}px`),this.renderer.emit("resize",Z,Q),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy($){$&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}n8.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},n8.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"_view"};D.add(n8);_.PREFER_ENV=k1.WEBGL2;_.STRICT_TEXTURE_CACHE=!1;_.RENDER_OPTIONS={...d8.defaultOptions,...u8.defaultOptions,...n8.defaultOptions,...l8.defaultOptions};Object.defineProperties(_,{WRAP_MODE:{get(){return l.defaultOptions.wrapMode},set($){a("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),l.defaultOptions.wrapMode=$}},SCALE_MODE:{get(){return l.defaultOptions.scaleMode},set($){a("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),l.defaultOptions.scaleMode=$}},MIPMAP_TEXTURES:{get(){return l.defaultOptions.mipmap},set($){a("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),l.defaultOptions.mipmap=$}},ANISOTROPIC_LEVEL:{get(){return l.defaultOptions.anisotropicLevel},set($){a("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),l.defaultOptions.anisotropicLevel=$}},FILTER_RESOLUTION:{get(){return a("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),G0.defaultResolution},set($){G0.defaultResolution=$}},FILTER_MULTISAMPLE:{get(){return a("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),G0.defaultMultisample},set($){G0.defaultMultisample=$}},SPRITE_MAX_TEXTURES:{get(){return R8.defaultMaxTextures},set($){a("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),R8.defaultMaxTextures=$}},SPRITE_BATCH_SIZE:{get(){return R8.defaultBatchSize},set($){a("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),R8.defaultBatchSize=$}},CAN_UPLOAD_SAME_BUFFER:{get(){return R8.canUploadSameBuffer},set($){a("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),R8.canUploadSameBuffer=$}},GC_MODE:{get(){return W8.defaultMode},set($){a("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),W8.defaultMode=$}},GC_MAX_IDLE:{get(){return W8.defaultMaxIdle},set($){a("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),W8.defaultMaxIdle=$}},GC_MAX_CHECK_COUNT:{get(){return W8.defaultCheckCountMax},set($){a("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),W8.defaultCheckCountMax=$}},PRECISION_VERTEX:{get(){return J1.defaultVertexPrecision},set($){a("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),J1.defaultVertexPrecision=$}},PRECISION_FRAGMENT:{get(){return J1.defaultFragmentPrecision},set($){a("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),J1.defaultFragmentPrecision=$}}});var R1=(($)=>($[$.INTERACTION=50]="INTERACTION",$[$.HIGH=25]="HIGH",$[$.NORMAL=0]="NORMAL",$[$.LOW=-25]="LOW",$[$.UTILITY=-50]="UTILITY",$))(R1||{});class F9{constructor($,J=null,Z=0,Q=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=$,this.context=J,this.priority=Z,this.once=Q}match($,J=null){return this.fn===$&&this.context===J}emit($){this.fn&&(this.context?this.fn.call(this.context,$):this.fn($));let J=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),J}connect($){this.previous=$,$.next&&($.next.previous=this),this.next=$.next,$.next=this}destroy($=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let J=this.next;return this.next=$?null:J,this.previous=null,J}}var mV=class ${constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new F9(null,null,1/0),this.deltaMS=1/$.targetFPMS,this.elapsedMS=1/$.targetFPMS,this._tick=(J)=>{this._requestId=null,this.started&&(this.update(J),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(J,Z,Q=R1.NORMAL){return this._addListener(new F9(J,Z,Q))}addOnce(J,Z,Q=R1.NORMAL){return this._addListener(new F9(J,Z,Q,!0))}_addListener(J){let Z=this._head.next,Q=this._head;if(!Z)J.connect(Q);else{for(;Z;){if(J.priority>Z.priority){J.connect(Q);break}Q=Z,Z=Z.next}J.previous||J.connect(Q)}return this._startIfPossible(),this}remove(J,Z){let Q=this._head.next;for(;Q;)Q.match(J,Z)?Q=Q.destroy():Q=Q.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let J=0,Z=this._head;for(;Z=Z.next;)J++;return J}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let J=this._head.next;for(;J;)J=J.destroy(!0);this._head.destroy(),this._head=null}}update(J=performance.now()){let Z;if(J>this.lastTime){if(Z=this.elapsedMS=J-this.lastTime,Z>this._maxElapsedMS&&(Z=this._maxElapsedMS),Z*=this.speed,this._minElapsedMS){let K=J-this._lastFrame|0;if(K<this._minElapsedMS)return;this._lastFrame=J-K%this._minElapsedMS}this.deltaMS=Z,this.deltaTime=this.deltaMS*$.targetFPMS;let Q=this._head,q=Q.next;for(;q;)q=q.emit(this.deltaTime);Q.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=J}get FPS(){return 1000/this.elapsedMS}get minFPS(){return 1000/this._maxElapsedMS}set minFPS(J){let Z=Math.min(this.maxFPS,J),Q=Math.min(Math.max(0,Z)/1000,$.targetFPMS);this._maxElapsedMS=1/Q}get maxFPS(){return this._minElapsedMS?Math.round(1000/this._minElapsedMS):0}set maxFPS(J){if(J===0)this._minElapsedMS=0;else{let Z=Math.max(this.minFPS,J);this._minElapsedMS=1/(Z/1000)}}static get shared(){if(!$._shared){let J=$._shared=new $;J.autoStart=!0,J._protected=!0}return $._shared}static get system(){if(!$._system){let J=$._system=new $;J.autoStart=!0,J._protected=!0}return $._system}};mV.targetFPMS=0.06;var C0=mV;Object.defineProperties(_,{TARGET_FPMS:{get(){return C0.targetFPMS},set($){a("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),C0.targetFPMS=$}}});class x${static init($){$=Object.assign({autoStart:!0,sharedTicker:!1},$),Object.defineProperty(this,"ticker",{set(J){this._ticker&&this._ticker.remove(this.render,this),this._ticker=J,J&&J.add(this.render,this,R1.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=$.sharedTicker?C0.shared:new C0,$.autoStart&&this.start()}static destroy(){if(this._ticker){let $=this._ticker;this.ticker=null,$.destroy()}}}x$.extension=j.Application;D.add(x$);var uV=[];D.handleByList(j.Renderer,uV);function eJ($){for(let J of uV)if(J.test($))return new J($);throw new Error("Unable to auto-detect a suitable renderer.")}var dV=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`;var pV=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var $4=dV,O9=pV;class c${constructor($){this.renderer=$}contextChange($){let J;if(this.renderer.context.webGLVersion===1){let Z=$.getParameter($.FRAMEBUFFER_BINDING);$.bindFramebuffer($.FRAMEBUFFER,null),J=$.getParameter($.SAMPLES),$.bindFramebuffer($.FRAMEBUFFER,Z)}else{let Z=$.getParameter($.DRAW_FRAMEBUFFER_BINDING);$.bindFramebuffer($.DRAW_FRAMEBUFFER,null),J=$.getParameter($.SAMPLES),$.bindFramebuffer($.DRAW_FRAMEBUFFER,Z)}J>=H0.HIGH?this.multisample=H0.HIGH:J>=H0.MEDIUM?this.multisample=H0.MEDIUM:J>=H0.LOW?this.multisample=H0.LOW:this.multisample=H0.NONE}destroy(){}}c$.extension={type:j.RendererSystem,name:"_multisample"};D.add(c$);class J4{constructor($){this.buffer=$||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class m${constructor($){this.renderer=$,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind($){let{gl:J,CONTEXT_UID:Z}=this,Q=$._glBuffers[Z]||this.createGLBuffer($);J.bindBuffer($.type,Q.buffer)}unbind($){let{gl:J}=this;J.bindBuffer($,null)}bindBufferBase($,J){let{gl:Z,CONTEXT_UID:Q}=this;if(this.boundBufferBases[J]!==$){let q=$._glBuffers[Q]||this.createGLBuffer($);this.boundBufferBases[J]=$,Z.bindBufferBase(Z.UNIFORM_BUFFER,J,q.buffer)}}bindBufferRange($,J,Z){let{gl:Q,CONTEXT_UID:q}=this;Z=Z||0;let K=$._glBuffers[q]||this.createGLBuffer($);Q.bindBufferRange(Q.UNIFORM_BUFFER,J||0,K.buffer,Z*256,256)}update($){let{gl:J,CONTEXT_UID:Z}=this,Q=$._glBuffers[Z]||this.createGLBuffer($);if($._updateID!==Q.updateID)if(Q.updateID=$._updateID,J.bindBuffer($.type,Q.buffer),Q.byteLength>=$.data.byteLength)J.bufferSubData($.type,0,$.data);else{let q=$.static?J.STATIC_DRAW:J.DYNAMIC_DRAW;Q.byteLength=$.data.byteLength,J.bufferData($.type,$.data,q)}}dispose($,J){if(!this.managedBuffers[$.id])return;delete this.managedBuffers[$.id];let Z=$._glBuffers[this.CONTEXT_UID],Q=this.gl;$.disposeRunner.remove(this),Z&&(J||Q.deleteBuffer(Z.buffer),delete $._glBuffers[this.CONTEXT_UID])}disposeAll($){let J=Object.keys(this.managedBuffers);for(let Z=0;Z<J.length;Z++)this.dispose(this.managedBuffers[J[Z]],$)}createGLBuffer($){let{CONTEXT_UID:J,gl:Z}=this;return $._glBuffers[J]=new J4(Z.createBuffer()),this.managedBuffers[$.id]=$,$.disposeRunner.add(this),$._glBuffers[J]}}m$.extension={type:j.RendererSystem,name:"buffer"};D.add(m$);class u${constructor($){this.renderer=$}render($,J){let Z=this.renderer,Q,q,K,V;if(J&&(Q=J.renderTexture,q=J.clear,K=J.transform,V=J.skipUpdateTransform),this.renderingToScreen=!Q,Z.runners.prerender.emit(),Z.emit("prerender"),Z.projection.transform=K,!Z.context.isLost){if(Q||(this.lastObjectRendered=$),!V){let H=$.enableTempParent();$.updateTransform(),$.disableTempParent(H)}Z.renderTexture.bind(Q),Z.batch.currentRenderer.start(),(q??Z.background.clearBeforeRender)&&Z.renderTexture.clear(),$.render(Z),Z.batch.currentRenderer.flush(),Q&&(J.blit&&Z.framebuffer.blit(),Q.baseTexture.update()),Z.runners.postrender.emit(),Z.projection.transform=null,Z.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}u$.extension={type:j.RendererSystem,name:"objectRenderer"};D.add(u$);var d$=class $ extends C9{constructor(J){super(),this.type=WJ.WEBGL,J=Object.assign({},_.RENDER_OPTIONS,J),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new o0({projectionMatrix:new $0},!0);let Z={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:$.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(Z),"useContextAlpha"in J&&(a("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),J.premultipliedAlpha=J.useContextAlpha&&J.useContextAlpha!=="notMultiplied",J.backgroundAlpha=J.useContextAlpha===!1?1:J.backgroundAlpha),this._plugin.rendererPlugins=$.__plugins,this.options=J,this.startup.run(this.options)}static test(J){return J?.forceCanvas?!1:U$()}render(J,Z){this.objectRenderer.render(J,Z)}resize(J,Z){this._view.resizeView(J,Z)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(J=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:J}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(J){this._view.resolution=J,this.runners.resolutionChange.emit(J)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return a("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return a("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return a("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return a("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(J){a("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=J}get backgroundAlpha(){return a("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(J){a("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=J}get powerPreference(){return a("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(J,Z){return this.textureGenerator.generateTexture(J,Z)}};d$.extension={type:j.Renderer,priority:1},d$.__plugins={},d$.__systems={};var p$=d$;D.handleByMap(j.RendererPlugin,p$.__plugins);D.handleByMap(j.RendererSystem,p$.__systems);D.add(p$);class I5 extends y1{constructor($,J){let{width:Z,height:Q}=J||{};super(Z,Q),this.items=[],this.itemDirtyIds=[];for(let q=0;q<$;q++){let K=new l;this.items.push(K),this.itemDirtyIds.push(-2)}this.length=$,this._load=null,this.baseTexture=null}initFromArray($,J){for(let Z=0;Z<this.length;Z++)$[Z]&&($[Z].castToBaseTexture?this.addBaseTextureAt($[Z].castToBaseTexture(),Z):$[Z]instanceof y1?this.addResourceAt($[Z],Z):this.addResourceAt(l5($[Z],J),Z))}dispose(){for(let $=0,J=this.length;$<J;$++)this.items[$].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt($,J){if(!this.items[J])throw new Error(`Index ${J} is out of bounds`);return $.valid&&!this.valid&&this.resize($.width,$.height),this.items[J].setResource($),this}bind($){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind($);for(let J=0;J<this.length;J++)this.items[J].parentTextureArray=$,this.items[J].on("update",$.update,$)}unbind($){super.unbind($);for(let J=0;J<this.length;J++)this.items[J].parentTextureArray=null,this.items[J].off("update",$.update,$)}load(){if(this._load)return this._load;let $=this.items.map((J)=>J.resource).filter((J)=>J).map((J)=>J.load());return this._load=Promise.all($).then(()=>{let{realWidth:J,realHeight:Z}=this.items[0];return this.resize(J,Z),this.update(),Promise.resolve(this)}),this._load}}class l$ extends I5{constructor($,J){let{width:Z,height:Q}=J||{},q,K;Array.isArray($)?(q=$,K=$.length):K=$,super(K,{width:Z,height:Q}),q&&this.initFromArray(q,J)}addBaseTextureAt($,J){if($.resource)this.addResourceAt($.resource,J);else throw new Error("ArrayResource does not support RenderTexture");return this}bind($){super.bind($),$.target=L8.TEXTURE_2D_ARRAY}upload($,J,Z){let{length:Q,itemDirtyIds:q,items:K}=this,{gl:V}=$;Z.dirtyId<0&&V.texImage3D(V.TEXTURE_2D_ARRAY,0,Z.internalFormat,this._width,this._height,Q,0,J.format,Z.type,null);for(let H=0;H<Q;H++){let X=K[H];q[H]<X.dirtyId&&(q[H]=X.dirtyId,X.valid&&V.texSubImage3D(V.TEXTURE_2D_ARRAY,0,0,0,H,X.resource.width,X.resource.height,1,J.format,Z.type,X.resource.source))}return!0}}class n$ extends x0{constructor($){super($)}static test($){let{OffscreenCanvas:J}=globalThis;return J&&$ instanceof J?!0:globalThis.HTMLCanvasElement&&$ instanceof HTMLCanvasElement}}var lV=class $ extends I5{constructor(J,Z){let{width:Q,height:q,autoLoad:K,linkBaseTexture:V}=Z||{};if(J&&J.length!==$.SIDES)throw new Error(`Invalid length. Got ${J.length}, expected 6`);super(6,{width:Q,height:q});for(let H=0;H<$.SIDES;H++)this.items[H].target=L8.TEXTURE_CUBE_MAP_POSITIVE_X+H;this.linkBaseTexture=V!==!1,J&&this.initFromArray(J,Z),K!==!1&&this.load()}bind(J){super.bind(J),J.target=L8.TEXTURE_CUBE_MAP}addBaseTextureAt(J,Z,Q){if(Q===void 0&&(Q=this.linkBaseTexture),!this.items[Z])throw new Error(`Index ${Z} is out of bounds`);if(!this.linkBaseTexture||J.parentTextureArray||Object.keys(J._glTextures).length>0)if(J.resource)this.addResourceAt(J.resource,Z);else throw new Error("CubeResource does not support copying of renderTexture.");else J.target=L8.TEXTURE_CUBE_MAP_POSITIVE_X+Z,J.parentTextureArray=this.baseTexture,this.items[Z]=J;return J.valid&&!this.valid&&this.resize(J.realWidth,J.realHeight),this.items[Z]=J,this}upload(J,Z,Q){let q=this.itemDirtyIds;for(let K=0;K<$.SIDES;K++){let V=this.items[K];(q[K]<V.dirtyId||Q.dirtyId<Z.dirtyId)&&(V.valid&&V.resource?(V.resource.upload(J,V,Q),q[K]=V.dirtyId):q[K]<-1&&(J.gl.texImage2D(V.target,0,Q.internalFormat,Z.realWidth,Z.realHeight,0,Z.format,Q.type,null),q[K]=-1))}return!0}static test(J){return Array.isArray(J)&&J.length===$.SIDES}};lV.SIDES=6;var Z4=lV;class o8 extends x0{constructor($,J){J=J||{};let Z,Q,q;typeof $=="string"?(Z=o8.EMPTY,Q=$,q=!0):(Z=$,Q=null,q=!1),super(Z),this.url=Q,this.crossOrigin=J.crossOrigin??!0,this.alphaMode=typeof J.alphaMode=="number"?J.alphaMode:null,this.ownsImageBitmap=J.ownsImageBitmap??q,this._load=null,J.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async($,J)=>{if(this.url===null){$(this);return}try{let Z=await _.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let Q=await Z.blob();if(this.destroyed)return;let q=await createImageBitmap(Q,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===F0.UNPACK?"premultiply":"none"});if(this.destroyed){q.close();return}this.source=q,this.update(),$(this)}catch(Z){if(this.destroyed)return;J(Z),this.onError.emit(Z)}}),this._load)}upload($,J,Z){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(J.alphaMode=this.alphaMode),super.upload($,J,Z)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test($){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof $=="string"||$ instanceof ImageBitmap)}static get EMPTY(){return o8._EMPTY=o8._EMPTY??_.ADAPTER.createCanvas(0,0),o8._EMPTY}}var Q4=class $ extends x0{constructor(J,Z){Z=Z||{},super(_.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=J,this.scale=Z.scale||1,this._overrideWidth=Z.width,this._overrideHeight=Z.height,this._resolve=null,this._crossorigin=Z.crossorigin,this._load=null,Z.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise((J)=>{if(this._resolve=()=>{this.update(),J(this)},$.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){let J=new Image;x0.crossOrigin(J,this.svg,this._crossorigin),J.src=this.svg,J.onerror=(Z)=>{this._resolve&&(J.onerror=null,this.onError.emit(Z))},J.onload=()=>{if(!this._resolve)return;let{width:Z,height:Q}=J;if(!Z||!Q)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let q=Z*this.scale,K=Q*this.scale;(this._overrideWidth||this._overrideHeight)&&(q=this._overrideWidth||this._overrideHeight/Q*Z,K=this._overrideHeight||this._overrideWidth/Z*Q),q=Math.round(q),K=Math.round(K);let V=this.source;V.width=q,V.height=K,V._pixiId=`canvas_${K8()}`,V.getContext("2d").drawImage(J,0,0,Z,Q,0,0,q,K),this._resolve(),this._resolve=null}}static getSize(J){let Z=$.SVG_SIZE.exec(J),Q={};return Z&&(Q[Z[1]]=Math.round(parseFloat(Z[3])),Q[Z[5]]=Math.round(parseFloat(Z[7]))),Q}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(J,Z){return Z==="svg"||typeof J=="string"&&J.startsWith("data:image/svg+xml")||typeof J=="string"&&$.SVG_XML.test(J)}};Q4.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Q4.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var e5=Q4;class q4 extends x0{constructor($){super($)}static test($){return!!globalThis.VideoFrame&&$ instanceof globalThis.VideoFrame}}var K4=class $ extends x0{constructor(J,Z){if(Z=Z||{},!(J instanceof HTMLVideoElement)){let Q=document.createElement("video");Z.autoLoad!==!1&&Q.setAttribute("preload","auto"),Z.playsinline!==!1&&(Q.setAttribute("webkit-playsinline",""),Q.setAttribute("playsinline","")),Z.muted===!0&&(Q.setAttribute("muted",""),Q.muted=!0),Z.loop===!0&&Q.setAttribute("loop",""),Z.autoPlay!==!1&&Q.setAttribute("autoplay",""),typeof J=="string"&&(J=[J]);let q=J[0].src||J[0];x0.crossOrigin(Q,q,Z.crossorigin);for(let K=0;K<J.length;++K){let V=document.createElement("source"),{src:H,mime:X}=J[K];if(H=H||J[K],H.startsWith("data:"))X=H.slice(5,H.indexOf(";"));else if(!H.startsWith("blob:")){let W=H.split("?").shift().toLowerCase(),z=W.slice(W.lastIndexOf(".")+1);X=X||$.MIME_TYPES[z]||`video/${z}`}V.src=H,X&&(V.type=X),Q.appendChild(V)}J=Q}super(J),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=Z.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=Z.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),Z.autoLoad!==!1&&this.load()}update(J=0){if(!this.destroyed){if(this._updateFPS){let Z=C0.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-Z)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1000/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;let J=this.source;return(J.readyState===J.HAVE_ENOUGH_DATA||J.readyState===J.HAVE_FUTURE_DATA)&&J.width&&J.height&&(J.complete=!0),J.addEventListener("play",this._onPlayStart),J.addEventListener("pause",this._onPlayStop),J.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(J.addEventListener("canplay",this._onCanPlay),J.addEventListener("canplaythrough",this._onCanPlay),J.addEventListener("error",this._onError,!0)),this._load=new Promise((Z,Q)=>{this.valid?Z(this):(this._resolve=Z,this._reject=Q,J.load())}),this._load}_onError(J){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(J),this._reject&&(this._reject(J),this._reject=null,this._resolve=null)}_isSourcePlaying(){let J=this.source;return!J.paused&&!J.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){let J=this.source;J.removeEventListener("canplay",this._onCanPlay),J.removeEventListener("canplaythrough",this._onCanPlay);let Z=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!Z&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&J.play()}dispose(){this._configureAutoUpdate();let J=this.source;J&&(J.removeEventListener("play",this._onPlayStart),J.removeEventListener("pause",this._onPlayStop),J.removeEventListener("seeked",this._onSeeked),J.removeEventListener("canplay",this._onCanPlay),J.removeEventListener("canplaythrough",this._onCanPlay),J.removeEventListener("error",this._onError,!0),J.pause(),J.src="",J.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(J){J!==this._autoUpdate&&(this._autoUpdate=J,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(J){J!==this._updateFPS&&(this._updateFPS=J,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(C0.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(C0.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(C0.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(J,Z){return globalThis.HTMLVideoElement&&J instanceof HTMLVideoElement||$.TYPES.includes(Z)}};K4.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],K4.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};var j9=K4;i6.push(o8,i5,n$,j9,q4,e5,V8,Z4,l$);var nV={loader:j.LoadParser,resolver:j.ResolveParser,cache:j.CacheParser,detection:j.DetectionParser};D.handle(j.Asset,($)=>{let J=$.ref;Object.entries(nV).filter(([Z])=>!!J[Z]).forEach(([Z,Q])=>D.add(Object.assign(J[Z],{extension:J[Z].extension??Q})))},($)=>{let J=$.ref;Object.keys(nV).filter((Z)=>!!J[Z]).forEach((Z)=>D.remove(J[Z]))});class V4{constructor($,J=!1){this._loader=$,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=J}add($){$.forEach((J)=>{this._assetList.push(J)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let $=[],J=Math.min(this._assetList.length,this._maxConcurrent);for(let Z=0;Z<J;Z++)$.push(this._assetList.pop());await this._loader.load($),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active($){this._isActive!==$&&(this._isActive=$,$&&!this._isLoading&&this._next())}}function j1($,J){if(Array.isArray(J)){for(let Z of J)if($.startsWith(`data:${Z}`))return!0;return!1}return $.startsWith(`data:${J}`)}function c0($,J){let Z=$.split("?")[0],Q=R.path.extname(Z).toLowerCase();return Array.isArray(J)?J.includes(Q):Q===J}var i0=($,J,Z=!1)=>(Array.isArray($)||($=[$]),J?$.map((Q)=>typeof Q=="string"||Z?J(Q):Q):$);var F5=($,J)=>{let Z=J.split("?")[1];return Z&&($+=`?${Z}`),$};function oV($,J,Z,Q,q){let K=J[Z];for(let V=0;V<K.length;V++){let H=K[V];Z<J.length-1?oV($.replace(Q[Z],H),J,Z+1,Q,q):q.push($.replace(Q[Z],H))}}function o$($){let J=/\{(.*?)\}/g,Z=$.match(J),Q=[];if(Z){let q=[];Z.forEach((K)=>{let V=K.substring(1,K.length-1).split(",");q.push(V)}),oV($,q,0,Z,Q)}else Q.push($);return Q}var M8=($)=>!Array.isArray($);class sV{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has($){return this._cache.has($)}get($){let J=this._cache.get($);return J||console.warn(`[Assets] Asset id ${$} was not found in the Cache`),J}set($,J){let Z=i0($),Q;for(let V=0;V<this.parsers.length;V++){let H=this.parsers[V];if(H.test(J)){Q=H.getCacheableAssets(Z,J);break}}Q||(Q={},Z.forEach((V)=>{Q[V]=J}));let q=Object.keys(Q),K={cacheKeys:q,keys:Z};if(Z.forEach((V)=>{this._cacheMap.set(V,K)}),q.forEach((V)=>{let H=Q?Q[V]:J;this._cache.has(V)&&this._cache.get(V)!==H&&console.warn("[Cache] already has key:",V),this._cache.set(V,Q[V])}),J instanceof b){let V=J;Z.forEach((H)=>{V.baseTexture!==b.EMPTY.baseTexture&&l.addToCache(V.baseTexture,H),b.addToCache(V,H)})}}remove($){if(!this._cacheMap.has($)){console.warn(`[Assets] Asset id ${$} was not found in the Cache`);return}let J=this._cacheMap.get($);J.cacheKeys.forEach((Z)=>{this._cache.delete(Z)}),J.keys.forEach((Z)=>{this._cacheMap.delete(Z)})}get parsers(){return this._parsers}}var i1=new sV;class H4{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:($,J,Z)=>(this._parsersValidated=!1,$[J]=Z,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser($,J){let Z={promise:null,parser:null};return Z.promise=(async()=>{let Q=null,q=null;if(J.loadParser&&(q=this._parserHash[J.loadParser],q||console.warn(`[Assets] specified load parser "${J.loadParser}" not found while loading ${$}`)),!q){for(let K=0;K<this.parsers.length;K++){let V=this.parsers[K];if(V.load&&V.test?.($,J,this)){q=V;break}}if(!q)return console.warn(`[Assets] ${$} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}Q=await q.load($,J,this),Z.parser=q;for(let K=0;K<this.parsers.length;K++){let V=this.parsers[K];V.parse&&V.parse&&await V.testParse?.(Q,J,this)&&(Q=await V.parse(Q,J,this)||Q,Z.parser=V)}return Q})(),Z}async load($,J){this._parsersValidated||this._validateParsers();let Z=0,Q={},q=M8($),K=i0($,(X)=>({alias:[X],src:X})),V=K.length,H=K.map(async(X)=>{let W=R.path.toAbsolute(X.src);if(!Q[X.src])try{this.promiseCache[W]||(this.promiseCache[W]=this._getLoadPromiseAndParser(W,X)),Q[X.src]=await this.promiseCache[W].promise,J&&J(++Z/V)}catch(z){throw delete this.promiseCache[W],delete Q[X.src],new Error(`[Loader.load] Failed to load ${W}.
${z}`)}});return await Promise.all(H),q?Q[K[0].src]:Q}async unload($){let J=i0($,(Z)=>({alias:[Z],src:Z})).map(async(Z)=>{let Q=R.path.toAbsolute(Z.src),q=this.promiseCache[Q];if(q){let K=await q.promise;delete this.promiseCache[Q],q.parser?.unload?.(K,Z,this)}});await Promise.all(J)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(($)=>$.name).reduce(($,J)=>($[J.name]&&console.warn(`[Assets] loadParser name conflict "${J.name}"`),{...$,[J.name]:J}),{})}}var j0=(($)=>($[$.Low=0]="Low",$[$.Normal=1]="Normal",$[$.High=2]="High",$))(j0||{});var iw=".json",aw="application/json",X4={extension:{type:j.LoadParser,priority:j0.Low},name:"loadJson",test($){return j1($,aw)||c0($,iw)},async load($){return await(await _.ADAPTER.fetch($)).json()}};D.add(X4);var rw=".txt",tw="text/plain",W4={name:"loadTxt",extension:{type:j.LoadParser,priority:j0.Low},test($){return j1($,tw)||c0($,rw)},async load($){return await(await _.ADAPTER.fetch($)).text()}};D.add(W4);var ew=["normal","bold","100","200","300","400","500","600","700","800","900"],$U=[".ttf",".otf",".woff",".woff2"],JU=["font/ttf","font/otf","font/woff","font/woff2"],ZU=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function z4($){let J=R.path.extname($),Z=R.path.basename($,J).replace(/(-|_)/g," ").toLowerCase().split(" ").map((K)=>K.charAt(0).toUpperCase()+K.slice(1)),Q=Z.length>0;for(let K of Z)if(!K.match(ZU)){Q=!1;break}let q=Z.join(" ");return Q||(q=`"${q.replace(/[\\"]/g,"\\$&")}"`),q}var QU=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function qU($){return QU.test($)?$:encodeURI($)}var G4={extension:{type:j.LoadParser,priority:j0.Low},name:"loadWebFont",test($){return j1($,JU)||c0($,$U)},async load($,J){let Z=_.ADAPTER.getFontFaceSet();if(Z){let Q=[],q=J.data?.family??z4($),K=J.data?.weights?.filter((H)=>ew.includes(H))??["normal"],V=J.data??{};for(let H=0;H<K.length;H++){let X=K[H],W=new FontFace(q,`url(${qU($)})`,{...V,weight:X});await W.load(),Z.add(W),Q.push(W)}return Q.length===1?Q[0]:Q}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload($){(Array.isArray($)?$:[$]).forEach((J)=>_.ADAPTER.getFontFaceSet().delete(J))}};D.add(G4);var $6=null;class _9{constructor(){$6||($6=URL.createObjectURL(new Blob([`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`],{type:"application/javascript"}))),this.worker=new Worker($6)}}_9.revokeObjectURL=function(){$6&&(URL.revokeObjectURL($6),$6=null)};var J6=null;class s${constructor(){J6||(J6=URL.createObjectURL(new Blob([`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`],{type:"application/javascript"}))),this.worker=new Worker(J6)}}s$.revokeObjectURL=function(){J6&&(URL.revokeObjectURL(J6),J6=null)};var iV=0,Y4;class aV{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(($)=>{let{worker:J}=new _9;J.addEventListener("message",(Z)=>{J.terminate(),_9.revokeObjectURL(),$(Z.data)})}),this._isImageBitmapSupported)}loadImageBitmap($){return this._run("loadImageBitmap",[$])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Y4===void 0&&(Y4=navigator.hardwareConcurrency||4);let $=this.workerPool.pop();return!$&&this._createdWorkers<Y4&&(this._createdWorkers++,$=new s$().worker,$.addEventListener("message",(J)=>{this.complete(J.data),this.returnWorker(J.target),this.next()})),$}returnWorker($){this.workerPool.push($)}complete($){$.error!==void 0?this.resolveHash[$.uuid].reject($.error):this.resolveHash[$.uuid].resolve($.data),this.resolveHash[$.uuid]=null}async _run($,J){await this._initWorkers();let Z=new Promise((Q,q)=>{this.queue.push({id:$,arguments:J,resolve:Q,reject:q})});return this.next(),Z}next(){if(!this.queue.length)return;let $=this.getWorker();if(!$)return;let J=this.queue.pop(),Z=J.id;this.resolveHash[iV]={resolve:J.resolve,reject:J.reject},$.postMessage({data:J.arguments,uuid:iV++,id:Z})}}var w4=new aV;function x1($,J,Z){$.resource.internal=!0;let Q=new b($),q=()=>{delete J.promiseCache[Z],i1.has(Z)&&i1.remove(Z)};return Q.baseTexture.once("destroyed",()=>{Z in J.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),q())}),Q.once("destroyed",()=>{$.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),q())}),Q}var KU=[".jpeg",".jpg",".png",".webp",".avif"],VU=["image/jpeg","image/png","image/webp","image/avif"];async function U4($){let J=await _.ADAPTER.fetch($);if(!J.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${$}: ${J.status} ${J.statusText}`);let Z=await J.blob();return await createImageBitmap(Z)}var E8={name:"loadTextures",extension:{type:j.LoadParser,priority:j0.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test($){return j1($,VU)||c0($,KU)},async load($,J,Z){let Q=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap,q;Q?this.config.preferWorkers&&await w4.isImageBitmapSupported()?q=await w4.loadImageBitmap($):q=await U4($):q=await new Promise((H,X)=>{let W=new Image;W.crossOrigin=this.config.crossOrigin,W.src=$,W.complete?H(W):(W.onload=()=>H(W),W.onerror=(z)=>X(z))});let K={...J.data};K.resolution??(K.resolution=R.getResolutionOfUrl($)),Q&&K.resourceOptions?.ownsImageBitmap===void 0&&(K.resourceOptions={...K.resourceOptions},K.resourceOptions.ownsImageBitmap=!0);let V=new l(q,K);return V.resource.src=$,x1(V,Z,$)},unload($){$.destroy(!0)}};D.add(E8);var HU=".svg",XU="image/svg+xml",C4={extension:{type:j.LoadParser,priority:j0.High},name:"loadSVG",test($){return j1($,XU)||c0($,HU)},async testParse($){return e5.test($)},async parse($,J,Z){let Q=new e5($,J?.data?.resourceOptions);await Q.load();let q=new l(Q,{resolution:R.getResolutionOfUrl($),...J?.data});return q.resource.src=J.src,x1(q,Z,J.src)},async load($,J){return(await _.ADAPTER.fetch($)).text()},unload:E8.unload};D.add(C4);var WU=[".mp4",".m4v",".webm",".ogv"],zU=["video/mp4","video/webm","video/ogg"],N4={name:"loadVideo",extension:{type:j.LoadParser,priority:j0.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test($){return j1($,zU)||c0($,WU)},async load($,J,Z){let Q,q=await(await _.ADAPTER.fetch($)).blob(),K=URL.createObjectURL(q);try{let V={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...J?.data?.resourceOptions,autoLoad:!0},H=new j9(K,V);await H.load();let X=new l(H,{alphaMode:await R.detectVideoAlphaMode(),resolution:R.getResolutionOfUrl($),...J?.data});X.resource.src=$,Q=x1(X,Z,$),Q.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(K)})}catch(V){throw URL.revokeObjectURL(K),V}return Q},unload($){$.destroy(!0)}};D.add(N4);class B4{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:($,J)=>`${$}${this._bundleIdConnector}${J}`,extractAssetIdFromBundle:($,J)=>J.replace(`${$}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier($){if(this._bundleIdConnector=$.connector??this._bundleIdConnector,this._createBundleAssetId=$.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=$.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...$){$.forEach((J)=>{this._preferredOrder.push(J),J.priority||(J.priority=Object.keys(J.params))}),this._resolverHash={}}set basePath($){this._basePath=$}get basePath(){return this._basePath}set rootPath($){this._rootPath=$}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams($){if(typeof $=="string")this._defaultSearchParams=$;else{let J=$;this._defaultSearchParams=Object.keys(J).map((Z)=>`${encodeURIComponent(Z)}=${encodeURIComponent(J[Z])}`).join("&")}}getAlias($){let{alias:J,name:Z,src:Q,srcs:q}=$;return i0(J||Z||Q||q,(K)=>typeof K=="string"?K:Array.isArray(K)?K.map((V)=>V?.src??V?.srcs??V):K?.src||K?.srcs?K.src??K.srcs:K,!0)}addManifest($){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=$,$.bundles.forEach((J)=>{this.addBundle(J.name,J.assets)})}addBundle($,J){let Z=[];Array.isArray(J)?J.forEach((Q)=>{let q=Q.src??Q.srcs,K=Q.alias??Q.name,V;if(typeof K=="string"){let H=this._createBundleAssetId($,K);Z.push(H),V=[K,H]}else{let H=K.map((X)=>this._createBundleAssetId($,X));Z.push(...H),V=[...K,...H]}this.add({...Q,alias:V,src:q})}):Object.keys(J).forEach((Q)=>{let q=[Q,this._createBundleAssetId($,Q)];if(typeof J[Q]=="string")this.add({alias:q,src:J[Q]});else if(Array.isArray(J[Q]))this.add({alias:q,src:J[Q]});else{let K=J[Q],V=K.src??K.srcs;this.add({...K,alias:q,src:Array.isArray(V)?V:[V]})}Z.push(...q)}),this._bundles[$]=Z}add($,J,Z,Q,q){let K=[];typeof $=="string"||Array.isArray($)&&typeof $[0]=="string"?(R.deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),K.push({alias:$,src:J,data:Z,format:Q,loadParser:q})):Array.isArray($)?K.push(...$):K.push($);let V;V=(H)=>{this.hasKey(H)&&console.warn(`[Resolver] already has key: ${H} overwriting`)},i0(K).forEach((H)=>{let{src:X,srcs:W}=H,{data:z,format:G,loadParser:Y}=H,w=i0(X||W).map((N)=>typeof N=="string"?o$(N):Array.isArray(N)?N:[N]),U=this.getAlias(H);Array.isArray(U)?U.forEach(V):V(U);let C=[];w.forEach((N)=>{N.forEach((O)=>{let I={};if(typeof O!="object"){I.src=O;for(let B=0;B<this._parsers.length;B++){let F=this._parsers[B];if(F.test(O)){I=F.parse(O);break}}}else z=O.data??z,G=O.format??G,Y=O.loadParser??Y,I={...I,...O};if(!U)throw new Error(`[Resolver] alias is undefined for this asset: ${I.src}`);I=this.buildResolvedAsset(I,{aliases:U,data:z,format:G,loadParser:Y}),C.push(I)})}),U.forEach((N)=>{this._assetMap[N]=C})})}resolveBundle($){let J=M8($);$=i0($);let Z={};return $.forEach((Q)=>{let q=this._bundles[Q];if(q){let K=this.resolve(q),V={};for(let H in K){let X=K[H];V[this._extractAssetIdFromBundle(Q,H)]=X}Z[Q]=V}}),J?Z[$[0]]:Z}resolveUrl($){let J=this.resolve($);if(typeof $!="string"){let Z={};for(let Q in J)Z[Q]=J[Q].src;return Z}return J.src}resolve($){let J=M8($);$=i0($);let Z={};return $.forEach((Q)=>{if(!this._resolverHash[Q])if(this._assetMap[Q]){let q=this._assetMap[Q],K=q[0],V=this._getPreferredOrder(q);V?.priority.forEach((H)=>{V.params[H].forEach((X)=>{let W=q.filter((z)=>z[H]?z[H]===X:!1);W.length&&(q=W)})}),this._resolverHash[Q]=q[0]??K}else this._resolverHash[Q]=this.buildResolvedAsset({alias:[Q],src:Q},{});Z[Q]=this._resolverHash[Q]}),J?Z[$[0]]:Z}hasKey($){return!!this._assetMap[$]}hasBundle($){return!!this._bundles[$]}_getPreferredOrder($){for(let J=0;J<$.length;J++){let Z=$[0],Q=this._preferredOrder.find((q)=>q.params.format.includes(Z.format));if(Q)return Q}return this._preferredOrder[0]}_appendDefaultSearchParams($){if(!this._defaultSearchParams)return $;let J=/\?/.test($)?"&":"?";return`${$}${J}${this._defaultSearchParams}`}buildResolvedAsset($,J){let{aliases:Z,data:Q,loadParser:q,format:K}=J;return(this._basePath||this._rootPath)&&($.src=R.path.toAbsolute($.src,this._basePath,this._rootPath)),$.alias=Z??$.alias??[$.src],$.src=this._appendDefaultSearchParams($.src),$.data={...Q||{},...$.data},$.loadParser=q??$.loadParser,$.format=K??$.format??R.path.extname($.src).slice(1),$.srcs=$.src,$.name=$.alias,$}}class I4{constructor(){this._detections=[],this._initialized=!1,this.resolver=new B4,this.loader=new H4,this.cache=i1,this._backgroundLoader=new V4(this.loader),this._backgroundLoader.active=!0,this.reset()}async init($={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,$.defaultSearchParams&&this.resolver.setDefaultSearchParams($.defaultSearchParams),$.basePath&&(this.resolver.basePath=$.basePath),$.bundleIdentifier&&this.resolver.setBundleIdentifier($.bundleIdentifier),$.manifest){let q=$.manifest;typeof q=="string"&&(q=await this.load(q)),this.resolver.addManifest(q)}let J=$.texturePreference?.resolution??1,Z=typeof J=="number"?[J]:J,Q=await this._detectFormats({preferredFormats:$.texturePreference?.format,skipDetections:$.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:Q,resolution:Z}}),$.preferences&&this.setPreferences($.preferences)}add($,J,Z,Q,q){this.resolver.add($,J,Z,Q,q)}async load($,J){this._initialized||await this.init();let Z=M8($),Q=i0($).map((V)=>{if(typeof V!="string"){let H=this.resolver.getAlias(V);return H.some((X)=>!this.resolver.hasKey(X))&&this.add(V),Array.isArray(H)?H[0]:H}return this.resolver.hasKey(V)||this.add({alias:V,src:V}),V}),q=this.resolver.resolve(Q),K=await this._mapLoadToResolve(q,J);return Z?K[Q[0]]:K}addBundle($,J){this.resolver.addBundle($,J)}async loadBundle($,J){this._initialized||await this.init();let Z=!1;typeof $=="string"&&(Z=!0,$=[$]);let Q=this.resolver.resolveBundle($),q={},K=Object.keys(Q),V=0,H=0,X=()=>{J?.(++V/H)},W=K.map((z)=>{let G=Q[z];return H+=Object.keys(G).length,this._mapLoadToResolve(G,X).then((Y)=>{q[z]=Y})});return await Promise.all(W),Z?q[$[0]]:q}async backgroundLoad($){this._initialized||await this.init(),typeof $=="string"&&($=[$]);let J=this.resolver.resolve($);this._backgroundLoader.add(Object.values(J))}async backgroundLoadBundle($){this._initialized||await this.init(),typeof $=="string"&&($=[$]);let J=this.resolver.resolveBundle($);Object.values(J).forEach((Z)=>{this._backgroundLoader.add(Object.values(Z))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get($){if(typeof $=="string")return i1.get($);let J={};for(let Z=0;Z<$.length;Z++)J[Z]=i1.get($[Z]);return J}async _mapLoadToResolve($,J){let Z=Object.values($),Q=Object.keys($);this._backgroundLoader.active=!1;let q=await this.loader.load(Z,J);this._backgroundLoader.active=!0;let K={};return Z.forEach((V,H)=>{let X=q[V.src],W=[V.src];V.alias&&W.push(...V.alias),K[Q[H]]=X,i1.set(W,X)}),K}async unload($){this._initialized||await this.init();let J=i0($).map((Q)=>typeof Q!="string"?Q.src:Q),Z=this.resolver.resolve(J);await this._unloadFromResolved(Z)}async unloadBundle($){this._initialized||await this.init(),$=i0($);let J=this.resolver.resolveBundle($),Z=Object.keys(J).map((Q)=>this._unloadFromResolved(J[Q]));await Promise.all(Z)}async _unloadFromResolved($){let J=Object.values($);J.forEach((Z)=>{i1.remove(Z.src)}),await this.loader.unload(J)}async _detectFormats($){let J=[];$.preferredFormats&&(J=Array.isArray($.preferredFormats)?$.preferredFormats:[$.preferredFormats]);for(let Z of $.detections)$.skipDetections||await Z.test()?J=await Z.add(J):$.skipDetections||(J=await Z.remove(J));return J=J.filter((Z,Q)=>J.indexOf(Z)===Q),J}get detections(){return this._detections}get preferWorkers(){return E8.config.preferWorkers}set preferWorkers($){R.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:$})}setPreferences($){this.loader.parsers.forEach((J)=>{J.config&&Object.keys(J.config).filter((Z)=>(Z in $)).forEach((Z)=>{J.config[Z]=$[Z]})})}}var z8=new I4;D.handleByList(j.LoadParser,z8.loader.parsers).handleByList(j.ResolveParser,z8.resolver.parsers).handleByList(j.CacheParser,z8.cache.parsers).handleByList(j.DetectionParser,z8.detections);var F4={extension:j.CacheParser,test:($)=>Array.isArray($)&&$.every((J)=>J instanceof b),getCacheableAssets:($,J)=>{let Z={};return $.forEach((Q)=>{J.forEach((q,K)=>{Z[Q+(K===0?"":K+1)]=q})}),Z}};D.add(F4);async function i$($){if("Image"in globalThis)return new Promise((J)=>{let Z=new Image;Z.onload=()=>{J(!0)},Z.onerror=()=>{J(!1)},Z.src=$});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{let J=await(await fetch($)).blob();await createImageBitmap(J)}catch{return!1}return!0}return!1}var O4={extension:{type:j.DetectionParser,priority:1},test:async()=>i$("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async($)=>[...$,"avif"],remove:async($)=>$.filter((J)=>J!=="avif")};D.add(O4);var j4={extension:{type:j.DetectionParser,priority:0},test:async()=>i$("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async($)=>[...$,"webp"],remove:async($)=>$.filter((J)=>J!=="webp")};D.add(j4);var rV=["png","jpg","jpeg"],_4={extension:{type:j.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async($)=>[...$,...rV],remove:async($)=>$.filter((J)=>!rV.includes(J))};D.add(_4);var GU="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Z6($){return GU?!1:document.createElement("video").canPlayType($)!==""}var P4={extension:{type:j.DetectionParser,priority:0},test:async()=>Z6("video/webm"),add:async($)=>[...$,"webm"],remove:async($)=>$.filter((J)=>J!=="webm")};D.add(P4);var D4={extension:{type:j.DetectionParser,priority:0},test:async()=>Z6("video/mp4"),add:async($)=>[...$,"mp4","m4v"],remove:async($)=>$.filter((J)=>J!=="mp4"&&J!=="m4v")};D.add(D4);var L4={extension:{type:j.DetectionParser,priority:0},test:async()=>Z6("video/ogg"),add:async($)=>[...$,"ogv"],remove:async($)=>$.filter((J)=>J!=="ogv")};D.add(L4);var k4={extension:j.ResolveParser,test:E8.test,parse:($)=>({resolution:parseFloat(_.RETINA_PREFIX.exec($)?.[1]??"1"),format:R.path.extname($).slice(1),src:$})};D.add(k4);class h8{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle($){return this.minX>this.maxX||this.minY>this.maxY?y.EMPTY:($=$||new y(0,0,1,1),$.x=this.minX,$.y=this.minY,$.width=this.maxX-this.minX,$.height=this.maxY-this.minY,$)}addPoint($){this.minX=Math.min(this.minX,$.x),this.maxX=Math.max(this.maxX,$.x),this.minY=Math.min(this.minY,$.y),this.maxY=Math.max(this.maxY,$.y)}addPointMatrix($,J){let{a:Z,b:Q,c:q,d:K,tx:V,ty:H}=$,X=Z*J.x+q*J.y+V,W=Q*J.x+K*J.y+H;this.minX=Math.min(this.minX,X),this.maxX=Math.max(this.maxX,X),this.minY=Math.min(this.minY,W),this.maxY=Math.max(this.maxY,W)}addQuad($){let J=this.minX,Z=this.minY,Q=this.maxX,q=this.maxY,K=$[0],V=$[1];J=K<J?K:J,Z=V<Z?V:Z,Q=K>Q?K:Q,q=V>q?V:q,K=$[2],V=$[3],J=K<J?K:J,Z=V<Z?V:Z,Q=K>Q?K:Q,q=V>q?V:q,K=$[4],V=$[5],J=K<J?K:J,Z=V<Z?V:Z,Q=K>Q?K:Q,q=V>q?V:q,K=$[6],V=$[7],J=K<J?K:J,Z=V<Z?V:Z,Q=K>Q?K:Q,q=V>q?V:q,this.minX=J,this.minY=Z,this.maxX=Q,this.maxY=q}addFrame($,J,Z,Q,q){this.addFrameMatrix($.worldTransform,J,Z,Q,q)}addFrameMatrix($,J,Z,Q,q){let{a:K,b:V,c:H,d:X,tx:W,ty:z}=$,G=this.minX,Y=this.minY,w=this.maxX,U=this.maxY,C=K*J+H*Z+W,N=V*J+X*Z+z;G=C<G?C:G,Y=N<Y?N:Y,w=C>w?C:w,U=N>U?N:U,C=K*Q+H*Z+W,N=V*Q+X*Z+z,G=C<G?C:G,Y=N<Y?N:Y,w=C>w?C:w,U=N>U?N:U,C=K*J+H*q+W,N=V*J+X*q+z,G=C<G?C:G,Y=N<Y?N:Y,w=C>w?C:w,U=N>U?N:U,C=K*Q+H*q+W,N=V*Q+X*q+z,G=C<G?C:G,Y=N<Y?N:Y,w=C>w?C:w,U=N>U?N:U,this.minX=G,this.minY=Y,this.maxX=w,this.maxY=U}addVertexData($,J,Z){let Q=this.minX,q=this.minY,K=this.maxX,V=this.maxY;for(let H=J;H<Z;H+=2){let X=$[H],W=$[H+1];Q=X<Q?X:Q,q=W<q?W:q,K=X>K?X:K,V=W>V?W:V}this.minX=Q,this.minY=q,this.maxX=K,this.maxY=V}addVertices($,J,Z,Q){this.addVerticesMatrix($.worldTransform,J,Z,Q)}addVerticesMatrix($,J,Z,Q,q=0,K=q){let{a:V,b:H,c:X,d:W,tx:z,ty:G}=$,Y=this.minX,w=this.minY,U=this.maxX,C=this.maxY;for(let N=Z;N<Q;N+=2){let O=J[N],I=J[N+1],B=V*O+X*I+z,F=W*I+H*O+G;Y=Math.min(Y,B-q),U=Math.max(U,B+q),w=Math.min(w,F-K),C=Math.max(C,F+K)}this.minX=Y,this.minY=w,this.maxX=U,this.maxY=C}addBounds($){let J=this.minX,Z=this.minY,Q=this.maxX,q=this.maxY;this.minX=$.minX<J?$.minX:J,this.minY=$.minY<Z?$.minY:Z,this.maxX=$.maxX>Q?$.maxX:Q,this.maxY=$.maxY>q?$.maxY:q}addBoundsMask($,J){let Z=$.minX>J.minX?$.minX:J.minX,Q=$.minY>J.minY?$.minY:J.minY,q=$.maxX<J.maxX?$.maxX:J.maxX,K=$.maxY<J.maxY?$.maxY:J.maxY;if(Z<=q&&Q<=K){let V=this.minX,H=this.minY,X=this.maxX,W=this.maxY;this.minX=Z<V?Z:V,this.minY=Q<H?Q:H,this.maxX=q>X?q:X,this.maxY=K>W?K:W}}addBoundsMatrix($,J){this.addFrameMatrix(J,$.minX,$.minY,$.maxX,$.maxY)}addBoundsArea($,J){let Z=$.minX>J.x?$.minX:J.x,Q=$.minY>J.y?$.minY:J.y,q=$.maxX<J.x+J.width?$.maxX:J.x+J.width,K=$.maxY<J.y+J.height?$.maxY:J.y+J.height;if(Z<=q&&Q<=K){let V=this.minX,H=this.minY,X=this.maxX,W=this.maxY;this.minX=Z<V?Z:V,this.minY=Q<H?Q:H,this.maxX=q>X?q:X,this.maxY=K>W?K:W}}pad($=0,J=$){this.isEmpty()||(this.minX-=$,this.maxX+=$,this.minY-=J,this.maxY+=J)}addFramePad($,J,Z,Q,q,K){$-=q,J-=K,Z+=q,Q+=K,this.minX=this.minX<$?this.minX:$,this.maxX=this.maxX>Z?this.maxX:Z,this.minY=this.minY<J?this.minY:J,this.maxY=this.maxY>Q?this.maxY:Q}}class K0 extends R.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new g8,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new h8,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin($){let J=Object.keys($);for(let Z=0;Z<J.length;++Z){let Q=J[Z];Object.defineProperty(K0.prototype,Q,Object.getOwnPropertyDescriptor($,Q))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds($,J){return $||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),J||(this._boundsRect||(this._boundsRect=new y),J=this._boundsRect),this._bounds.getRectangle(J)}getLocalBounds($){$||(this._localBoundsRect||(this._localBoundsRect=new y),$=this._localBoundsRect),this._localBounds||(this._localBounds=new h8);let J=this.transform,Z=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=Z?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;let Q=this._bounds,q=this._boundsID;this._bounds=this._localBounds;let K=this.getBounds(!1,$);return this.parent=Z,this.transform=J,this._bounds=Q,this._bounds.updateID+=this._boundsID-q,K}toGlobal($,J,Z=!1){return Z||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply($,J)}toLocal($,J,Z,Q){return J&&($=J.toGlobal($,Z,Q)),Q||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse($,Z)}setParent($){if(!$||!$.addChild)throw new Error("setParent: Argument must be a Container");return $.addChild(this),$}removeFromParent(){this.parent?.removeChild(this)}setTransform($=0,J=0,Z=1,Q=1,q=0,K=0,V=0,H=0,X=0){return this.position.x=$,this.position.y=J,this.scale.x=Z||1,this.scale.y=Q||1,this.rotation=q,this.skew.x=K,this.skew.y=V,this.pivot.x=H,this.pivot.y=X,this}destroy($){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new A4),this.tempDisplayObjectParent}enableTempParent(){let $=this.parent;return this.parent=this._tempDisplayObjectParent,$}disableTempParent($){this.parent=$}get x(){return this.position.x}set x($){this.transform.position.x=$}get y(){return this.position.y}set y($){this.transform.position.y=$}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position($){this.transform.position.copyFrom($)}get scale(){return this.transform.scale}set scale($){this.transform.scale.copyFrom($)}get pivot(){return this.transform.pivot}set pivot($){this.transform.pivot.copyFrom($)}get skew(){return this.transform.skew}set skew($){this.transform.skew.copyFrom($)}get rotation(){return this.transform.rotation}set rotation($){this.transform.rotation=$}get angle(){return this.transform.rotation*qJ}set angle($){this.transform.rotation=$*KJ}get zIndex(){return this._zIndex}set zIndex($){this._zIndex!==$&&(this._zIndex=$,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let $=this;do{if(!$.visible)return!1;$=$.parent}while($);return!0}get mask(){return this._mask}set mask($){if(this._mask!==$){if(this._mask){let J=this._mask.isMaskData?this._mask.maskObject:this._mask;J&&(J._maskRefCount--,J._maskRefCount===0&&(J.renderable=!0,J.isMask=!1))}if(this._mask=$,this._mask){let J=this._mask.isMaskData?this._mask.maskObject:this._mask;J&&(J._maskRefCount===0&&(J.renderable=!1,J.isMask=!0),J._maskRefCount++)}}}}class A4 extends K0{constructor(){super(...arguments),this.sortDirty=null}}K0.prototype.displayObjectUpdateTransform=K0.prototype.updateTransform;var YU=new $0;function wU($,J){return $.zIndex===J.zIndex?$._lastSortedIndex-J._lastSortedIndex:$.zIndex-J.zIndex}var tV=class $ extends K0{constructor(){super(),this.children=[],this.sortableChildren=$.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(J){}addChild(...J){if(J.length>1)for(let Z=0;Z<J.length;Z++)this.addChild(J[Z]);else{let Z=J[0];Z.parent&&Z.parent.removeChild(Z),Z.parent=this,this.sortDirty=!0,Z.transform._parentID=-1,this.children.push(Z),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",Z,this,this.children.length-1),Z.emit("added",this)}return J[0]}addChildAt(J,Z){if(Z<0||Z>this.children.length)throw new Error(`${J}addChildAt: The index ${Z} supplied is out of bounds ${this.children.length}`);return J.parent&&J.parent.removeChild(J),J.parent=this,this.sortDirty=!0,J.transform._parentID=-1,this.children.splice(Z,0,J),this._boundsID++,this.onChildrenChange(Z),J.emit("added",this),this.emit("childAdded",J,this,Z),J}swapChildren(J,Z){if(J===Z)return;let Q=this.getChildIndex(J),q=this.getChildIndex(Z);this.children[Q]=Z,this.children[q]=J,this.onChildrenChange(Q<q?Q:q)}getChildIndex(J){let Z=this.children.indexOf(J);if(Z===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return Z}setChildIndex(J,Z){if(Z<0||Z>=this.children.length)throw new Error(`The index ${Z} supplied is out of bounds ${this.children.length}`);let Q=this.getChildIndex(J);R.removeItems(this.children,Q,1),this.children.splice(Z,0,J),this.onChildrenChange(Z)}getChildAt(J){if(J<0||J>=this.children.length)throw new Error(`getChildAt: Index (${J}) does not exist.`);return this.children[J]}removeChild(...J){if(J.length>1)for(let Z=0;Z<J.length;Z++)this.removeChild(J[Z]);else{let Z=J[0],Q=this.children.indexOf(Z);if(Q===-1)return null;Z.parent=null,Z.transform._parentID=-1,R.removeItems(this.children,Q,1),this._boundsID++,this.onChildrenChange(Q),Z.emit("removed",this),this.emit("childRemoved",Z,this,Q)}return J[0]}removeChildAt(J){let Z=this.getChildAt(J);return Z.parent=null,Z.transform._parentID=-1,R.removeItems(this.children,J,1),this._boundsID++,this.onChildrenChange(J),Z.emit("removed",this),this.emit("childRemoved",Z,this,J),Z}removeChildren(J=0,Z=this.children.length){let Q=J,q=Z,K=q-Q,V;if(K>0&&K<=q){V=this.children.splice(Q,K);for(let H=0;H<V.length;++H)V[H].parent=null,V[H].transform&&(V[H].transform._parentID=-1);this._boundsID++,this.onChildrenChange(J);for(let H=0;H<V.length;++H)V[H].emit("removed",this),this.emit("childRemoved",V[H],this,H);return V}else if(K===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let J=!1;for(let Z=0,Q=this.children.length;Z<Q;++Z){let q=this.children[Z];q._lastSortedIndex=Z,!J&&q.zIndex!==0&&(J=!0)}J&&this.children.length>1&&this.children.sort(wU),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let J=0,Z=this.children.length;J<Z;++J){let Q=this.children[J];Q.visible&&Q.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let J=0;J<this.children.length;J++){let Z=this.children[J];if(!(!Z.visible||!Z.renderable))if(Z.calculateBounds(),Z._mask){let Q=Z._mask.isMaskData?Z._mask.maskObject:Z._mask;Q?(Q.calculateBounds(),this._bounds.addBoundsMask(Z._bounds,Q._bounds)):this._bounds.addBounds(Z._bounds)}else Z.filterArea?this._bounds.addBoundsArea(Z._bounds,Z.filterArea):this._bounds.addBounds(Z._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(J,Z=!1){let Q=super.getLocalBounds(J);if(!Z)for(let q=0,K=this.children.length;q<K;++q){let V=this.children[q];V.visible&&V.updateTransform()}return Q}_calculateBounds(){}_renderWithCulling(J){let Z=J.renderTexture.sourceFrame;if(!(Z.width>0&&Z.height>0))return;let Q,q;this.cullArea?(Q=this.cullArea,q=this.worldTransform):this._render!==$.prototype._render&&(Q=this.getBounds(!0));let K=J.projection.transform;if(K&&(q?(q=YU.copyFrom(q),q.prepend(K)):q=K),Q&&Z.intersects(Q,q))this._render(J);else if(this.cullArea)return;for(let V=0,H=this.children.length;V<H;++V){let X=this.children[V],W=X.cullable;X.cullable=W||!this.cullArea,X.render(J),X.cullable=W}}render(J){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(J);else if(this.cullable)this._renderWithCulling(J);else{this._render(J);for(let Z=0,Q=this.children.length;Z<Q;++Z)this.children[Z].render(J)}}renderAdvanced(J){let Z=this.filters,Q=this._mask;if(Z){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let K=0;K<Z.length;K++)Z[K].enabled&&this._enabledFilters.push(Z[K])}let q=Z&&this._enabledFilters?.length||Q&&(!Q.isMaskData||Q.enabled&&(Q.autoDetect||Q.type!==D0.NONE));if(q&&J.batch.flush(),Z&&this._enabledFilters?.length&&J.filter.push(this,this._enabledFilters),Q&&J.mask.push(this,this._mask),this.cullable)this._renderWithCulling(J);else{this._render(J);for(let K=0,V=this.children.length;K<V;++K)this.children[K].render(J)}q&&J.batch.flush(),Q&&J.mask.pop(this),Z&&this._enabledFilters?.length&&J.filter.pop()}_render(J){}destroy(J){super.destroy(),this.sortDirty=!1;let Z=typeof J=="boolean"?J:J?.children,Q=this.removeChildren(0,this.children.length);if(Z)for(let q=0;q<Q.length;++q)Q[q].destroy(J)}get width(){return this.scale.x*this.getLocalBounds().width}set width(J){let Z=this.getLocalBounds().width;Z!==0?this.scale.x=J/Z:this.scale.x=1,this._width=J}get height(){return this.scale.y*this.getLocalBounds().height}set height(J){let Z=this.getLocalBounds().height;Z!==0?this.scale.y=J/Z:this.scale.y=1,this._height=J}};tV.defaultSortableChildren=!1;var i=tV;i.prototype.containerUpdateTransform=i.prototype.updateTransform;Object.defineProperties(_,{SORTABLE_CHILDREN:{get(){return i.defaultSortableChildren},set($){R.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),i.defaultSortableChildren=$}}});/*!
 * pixi-viewport - v5.1.0
 * Compiled Tue, 09 Apr 2024 15:05:21 UTC
 *
 * pixi-viewport is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2020, David Figatner, All Rights Reserved
 */class M1{constructor($){this.parent=$,this.paused=!1}destroy(){}down($){return!1}move($){return!1}up($){return!1}wheel($){return!1}update($){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}var UU=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function CU($,J,Z){return Z={path:J,exports:{},require:function(Q,q){return NU(Q,q===void 0||q===null?Z.path:q)}},$(Z,Z.exports),Z.exports}function NU(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var eV=CU(function($,J){(function(){var Z,Q;Q=function(q){return $.exports=q},Z={linear:function(q,K,V,H){return V*q/H+K},easeInQuad:function(q,K,V,H){return V*(q/=H)*q+K},easeOutQuad:function(q,K,V,H){return-V*(q/=H)*(q-2)+K},easeInOutQuad:function(q,K,V,H){if((q/=H/2)<1)return V/2*q*q+K;else return-V/2*(--q*(q-2)-1)+K},easeInCubic:function(q,K,V,H){return V*(q/=H)*q*q+K},easeOutCubic:function(q,K,V,H){return V*((q=q/H-1)*q*q+1)+K},easeInOutCubic:function(q,K,V,H){if((q/=H/2)<1)return V/2*q*q*q+K;else return V/2*((q-=2)*q*q+2)+K},easeInQuart:function(q,K,V,H){return V*(q/=H)*q*q*q+K},easeOutQuart:function(q,K,V,H){return-V*((q=q/H-1)*q*q*q-1)+K},easeInOutQuart:function(q,K,V,H){if((q/=H/2)<1)return V/2*q*q*q*q+K;else return-V/2*((q-=2)*q*q*q-2)+K},easeInQuint:function(q,K,V,H){return V*(q/=H)*q*q*q*q+K},easeOutQuint:function(q,K,V,H){return V*((q=q/H-1)*q*q*q*q+1)+K},easeInOutQuint:function(q,K,V,H){if((q/=H/2)<1)return V/2*q*q*q*q*q+K;else return V/2*((q-=2)*q*q*q*q+2)+K},easeInSine:function(q,K,V,H){return-V*Math.cos(q/H*(Math.PI/2))+V+K},easeOutSine:function(q,K,V,H){return V*Math.sin(q/H*(Math.PI/2))+K},easeInOutSine:function(q,K,V,H){return-V/2*(Math.cos(Math.PI*q/H)-1)+K},easeInExpo:function(q,K,V,H){if(q===0)return K;else return V*Math.pow(2,10*(q/H-1))+K},easeOutExpo:function(q,K,V,H){if(q===H)return K+V;else return V*(-Math.pow(2,-10*q/H)+1)+K},easeInOutExpo:function(q,K,V,H){if((q/=H/2)<1)return V/2*Math.pow(2,10*(q-1))+K;else return V/2*(-Math.pow(2,-10*--q)+2)+K},easeInCirc:function(q,K,V,H){return-V*(Math.sqrt(1-(q/=H)*q)-1)+K},easeOutCirc:function(q,K,V,H){return V*Math.sqrt(1-(q=q/H-1)*q)+K},easeInOutCirc:function(q,K,V,H){if((q/=H/2)<1)return-V/2*(Math.sqrt(1-q*q)-1)+K;else return V/2*(Math.sqrt(1-(q-=2)*q)+1)+K},easeInElastic:function(q,K,V,H){var X,W,z;if(z=1.70158,W=0,X=V,q===0);else if((q/=H)===1);if(!W)W=H*0.3;if(X<Math.abs(V))X=V,z=W/4;else z=W/(2*Math.PI)*Math.asin(V/X);return-(X*Math.pow(2,10*(q-=1))*Math.sin((q*H-z)*(2*Math.PI)/W))+K},easeOutElastic:function(q,K,V,H){var X,W,z;if(z=1.70158,W=0,X=V,q===0);else if((q/=H)===1);if(!W)W=H*0.3;if(X<Math.abs(V))X=V,z=W/4;else z=W/(2*Math.PI)*Math.asin(V/X);return X*Math.pow(2,-10*q)*Math.sin((q*H-z)*(2*Math.PI)/W)+V+K},easeInOutElastic:function(q,K,V,H){var X,W,z;if(z=1.70158,W=0,X=V,q===0);else if((q/=H/2)===2);if(!W)W=H*0.44999999999999996;if(X<Math.abs(V))X=V,z=W/4;else z=W/(2*Math.PI)*Math.asin(V/X);if(q<1)return-0.5*(X*Math.pow(2,10*(q-=1))*Math.sin((q*H-z)*(2*Math.PI)/W))+K;else return X*Math.pow(2,-10*(q-=1))*Math.sin((q*H-z)*(2*Math.PI)/W)*0.5+V+K},easeInBack:function(q,K,V,H,X){if(X===void 0)X=1.70158;return V*(q/=H)*q*((X+1)*q-X)+K},easeOutBack:function(q,K,V,H,X){if(X===void 0)X=1.70158;return V*((q=q/H-1)*q*((X+1)*q+X)+1)+K},easeInOutBack:function(q,K,V,H,X){if(X===void 0)X=1.70158;if((q/=H/2)<1)return V/2*(q*q*(((X*=1.525)+1)*q-X))+K;else return V/2*((q-=2)*q*(((X*=1.525)+1)*q+X)+2)+K},easeInBounce:function(q,K,V,H){var X=Z.easeOutBounce(H-q,0,V,H);return V-X+K},easeOutBounce:function(q,K,V,H){if((q/=H)<0.36363636363636365)return V*(7.5625*q*q)+K;else if(q<0.7272727272727273)return V*(7.5625*(q-=0.5454545454545454)*q+0.75)+K;else if(q<0.9090909090909091)return V*(7.5625*(q-=0.8181818181818182)*q+0.9375)+K;else return V*(7.5625*(q-=0.9545454545454546)*q+0.984375)+K},easeInOutBounce:function(q,K,V,H){var X;if(q<H/2)return X=Z.easeInBounce(q*2,0,V,H),X*0.5+K;else return X=Z.easeOutBounce(q*2-H,0,V,H),X*0.5+V*0.5+K}},Q(Z)}).call(UU)});function t$($,J){if(!$)return eV[J];else if(typeof $==="function")return $;else if(typeof $==="string")return eV[$]}var BU={removeOnInterrupt:!1,ease:"linear",time:1000};class T8 extends M1{__init(){this.startWidth=null}__init2(){this.startHeight=null}__init3(){this.deltaWidth=null}__init4(){this.deltaHeight=null}__init5(){this.width=null}__init6(){this.height=null}__init7(){this.time=0}constructor($,J={}){super($);T8.prototype.__init.call(this),T8.prototype.__init2.call(this),T8.prototype.__init3.call(this),T8.prototype.__init4.call(this),T8.prototype.__init5.call(this),T8.prototype.__init6.call(this),T8.prototype.__init7.call(this),this.options=Object.assign({},BU,J),this.options.ease=t$(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){if(typeof this.options.position!=="undefined")this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1;else this.keepCenter=!0}setupZoom(){if(this.width=null,this.height=null,typeof this.options.scale!=="undefined")this.width=this.parent.screenWidth/this.options.scale;else if(typeof this.options.scaleX!=="undefined"||typeof this.options.scaleY!=="undefined"){if(typeof this.options.scaleX!=="undefined")this.width=this.parent.screenWidth/this.options.scaleX;if(typeof this.options.scaleY!=="undefined")this.height=this.parent.screenHeight/this.options.scaleY}else{if(typeof this.options.width!=="undefined")this.width=this.options.width;if(typeof this.options.height!=="undefined")this.height=this.options.height}if(this.width!==null)this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth;if(this.height!==null)this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight}down(){if(this.options.removeOnInterrupt)this.parent.plugins.remove("animate");return!1}complete(){if(this.parent.plugins.remove("animate"),this.width!==null)this.parent.fitWidth(this.width,this.keepCenter,this.height===null);if(this.height!==null)this.parent.fitHeight(this.height,this.keepCenter,this.width===null);if(!this.keepCenter&&this.options.position)this.parent.moveCenter(this.options.position);if(this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete)this.options.callbackOnComplete(this.parent)}update($){if(this.paused)return;this.time+=$;let J=new d(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){let Z=this.parent.width,Q=this.parent.height;if(this.complete(),Z!==this.parent.width||Q!==this.parent.height)this.parent.emit("zoomed",{viewport:this.parent,original:J,type:"animate"})}else{let Z=this.options.ease(this.time,0,1,this.options.time);if(this.width!==null){let Q=this.startWidth,q=this.deltaWidth;this.parent.fitWidth(Q+q*Z,this.keepCenter,this.height===null)}if(this.height!==null){let Q=this.startHeight,q=this.deltaHeight;this.parent.fitHeight(Q+q*Z,this.keepCenter,this.width===null)}if(this.width===null)this.parent.scale.x=this.parent.scale.y;else if(this.height===null)this.parent.scale.y=this.parent.scale.x;if(!this.keepCenter){let Q=this.startX,q=this.startY,K=this.deltaX,V=this.deltaY,H=new d(this.parent.x,this.parent.y);this.parent.moveCenter(Q+K*Z,q+V*Z),this.parent.emit("moved",{viewport:this.parent,original:H,type:"animate"})}if(this.width||this.height)this.parent.emit("zoomed",{viewport:this.parent,original:J,type:"animate"})}}}function a$($){let J=void 0,Z=$[0],Q=1;while(Q<$.length){let q=$[Q],K=$[Q+1];if(Q+=2,(q==="optionalAccess"||q==="optionalCall")&&Z==null)return;if(q==="access"||q==="optionalAccess")J=Z,Z=K(Z);else if(q==="call"||q==="optionalCall")Z=K((...V)=>Z.call(J,...V)),J=void 0}return Z}var IU={sides:"all",friction:0.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class $2 extends M1{constructor($,J={}){super($);if(this.options=Object.assign({},IU,J),this.ease=t$(this.options.ease,"easeInOutSine"),this.options.sides)if(this.options.sides==="all")this.top=this.bottom=this.left=this.right=!0;else if(this.options.sides==="horizontal")this.right=this.left=!0,this.top=this.bottom=!1;else if(this.options.sides==="vertical")this.left=this.right=!1,this.top=this.bottom=!0;else this.top=this.options.sides.indexOf("top")!==-1,this.bottom=this.options.sides.indexOf("bottom")!==-1,this.left=this.options.sides.indexOf("left")!==-1,this.right=this.options.sides.indexOf("right")!==-1;else this.left=this.top=this.right=this.bottom=!1;let Z=this.options.underflow.toLowerCase();if(Z==="center")this.underflowX=0,this.underflowY=0;else this.underflowX=Z.indexOf("left")!==-1?-1:Z.indexOf("right")!==-1?1:0,this.underflowY=Z.indexOf("top")!==-1?-1:Z.indexOf("bottom")!==-1?1:0;this.reset()}isActive(){return this.toX!==null||this.toY!==null}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update($){if(this.paused)return;if(this.bounce(),this.toX){let J=this.toX;if(J.time+=$,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),J.time>=this.options.time)this.parent.x=J.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent);else this.parent.x=this.ease(J.time,J.start,J.delta,this.options.time)}if(this.toY){let J=this.toY;if(J.time+=$,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),J.time>=this.options.time)this.parent.y=J.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent);else this.parent.y=this.ease(J.time,J.start,J.delta,this.options.time)}}calcUnderflowX(){let $;switch(this.underflowX){case-1:$=0;break;case 1:$=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:$=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return $}calcUnderflowY(){let $;switch(this.underflowY){case-1:$=0;break;case 1:$=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:$=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return $}oob(){let $=this.options.bounceBox;if($){let J=typeof $.x==="undefined"?0:$.x,Z=typeof $.y==="undefined"?0:$.y,Q=typeof $.width==="undefined"?this.parent.worldWidth:$.width,q=typeof $.height==="undefined"?this.parent.worldHeight:$.height;return{left:this.parent.left<J,right:this.parent.right>Q,top:this.parent.top<Z,bottom:this.parent.bottom>q,topLeft:new d(J*this.parent.scale.x,Z*this.parent.scale.y),bottomRight:new d(Q*this.parent.scale.x-this.parent.screenWidth,q*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new d(0,0),bottomRight:new d(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){if(this.paused)return;let $,J=this.parent.plugins.get("decelerate",!0);if(J&&(J.x||J.y)){if(J.x&&J.percentChangeX===a$([J,"access",(q)=>q.options,"optionalAccess",(q)=>q.friction])||J.y&&J.percentChangeY===a$([J,"access",(q)=>q.options,"optionalAccess",(q)=>q.friction])){if($=this.oob(),$.left&&this.left||$.right&&this.right)J.percentChangeX=this.options.friction;if($.top&&this.top||$.bottom&&this.bottom)J.percentChangeY=this.options.friction}}let Z=this.parent.plugins.get("drag",!0)||{},Q=this.parent.plugins.get("pinch",!0)||{};if(J=J||{},!a$([Z,"optionalAccess",(q)=>q.active])&&!a$([Q,"optionalAccess",(q)=>q.active])&&((!this.toX||!this.toY)&&(!J.x||!J.y))){$=$||this.oob();let{topLeft:q,bottomRight:K}=$;if(!this.toX&&!J.x){let V=null;if($.left&&this.left)V=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-q.x;else if($.right&&this.right)V=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-K.x;if(V!==null&&this.parent.x!==V)this.toX={time:0,start:this.parent.x,delta:V-this.parent.x,end:V},this.parent.emit("bounce-x-start",this.parent)}if(!this.toY&&!J.y){let V=null;if($.top&&this.top)V=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-q.y;else if($.bottom&&this.bottom)V=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-K.y;if(V!==null&&this.parent.y!==V)this.toY={time:0,start:this.parent.y,delta:V-this.parent.y,end:V},this.parent.emit("bounce-y-start",this.parent)}}}reset(){this.toX=this.toY=null,this.bounce()}}var FU={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class J2 extends M1{constructor($,J={}){super($);if(this.options=Object.assign({},FU,J),this.options.direction)this.options.left=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.right=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.top=this.options.direction==="y"||this.options.direction==="all"?!0:null,this.options.bottom=this.options.direction==="y"||this.options.direction==="all"?!0:null;this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){let $=this.options.underflow.toLowerCase();if($==="none")this.noUnderflow=!0;else if($==="center")this.underflowX=this.underflowY=0,this.noUnderflow=!1;else this.underflowX=$.indexOf("left")!==-1?-1:$.indexOf("right")!==-1?1:0,this.underflowY=$.indexOf("top")!==-1?-1:$.indexOf("bottom")!==-1?1:0,this.noUnderflow=!1}move(){return this.update(),!1}update(){if(this.paused)return;if(this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;let $={x:this.parent.x,y:this.parent.y},J=this.parent.plugins.decelerate||{};if(this.options.left!==null||this.options.right!==null){let Z=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:if(this.parent.x!==0)this.parent.x=0,Z=!0;break;case 1:if(this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth)this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,Z=!0;break;default:if(this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2)this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,Z=!0}else{if(this.options.left!==null){if(this.parent.left<(this.options.left===!0?0:this.options.left))this.parent.x=-(this.options.left===!0?0:this.options.left)*this.parent.scale.x,J.x=0,Z=!0}if(this.options.right!==null){if(this.parent.right>(this.options.right===!0?this.parent.worldWidth:this.options.right))this.parent.x=-(this.options.right===!0?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,J.x=0,Z=!0}}if(Z)this.parent.emit("moved",{viewport:this.parent,original:$,type:"clamp-x"})}if(this.options.top!==null||this.options.bottom!==null){let Z=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:if(this.parent.y!==0)this.parent.y=0,Z=!0;break;case 1:if(this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight)this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,Z=!0;break;default:if(this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2)this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,Z=!0}else{if(this.options.top!==null){if(this.parent.top<(this.options.top===!0?0:this.options.top))this.parent.y=-(this.options.top===!0?0:this.options.top)*this.parent.scale.y,J.y=0,Z=!0}if(this.options.bottom!==null){if(this.parent.bottom>(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom))this.parent.y=-(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,J.y=0,Z=!0}}if(Z)this.parent.emit("moved",{viewport:this.parent,original:$,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}var OU={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class Z2 extends M1{constructor($,J={}){super($);this.options=Object.assign({},OU,J),this.clamp()}resize(){this.clamp()}clamp(){if(this.paused)return;if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let $=this.parent.worldScreenWidth,J=this.parent.worldScreenHeight;if(this.options.minWidth!==null&&$<this.options.minWidth){let Z=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/Z,$=this.parent.worldScreenWidth,J=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxWidth!==null&&$>this.options.maxWidth){let Z=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/Z,$=this.parent.worldScreenWidth,J=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.minHeight!==null&&J<this.options.minHeight){let Z=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/Z,$=this.parent.worldScreenWidth,J=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxHeight!==null&&J>this.options.maxHeight){let Z=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/Z,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){let $={x:null,y:null},J={x:null,y:null};if(typeof this.options.minScale==="number")$.x=this.options.minScale,$.y=this.options.minScale;else if(this.options.minScale!==null){let q=this.options.minScale;$.x=typeof q.x==="undefined"?null:q.x,$.y=typeof q.y==="undefined"?null:q.y}if(typeof this.options.maxScale==="number")J.x=this.options.maxScale,J.y=this.options.maxScale;else if(this.options.maxScale!==null){let q=this.options.maxScale;J.x=typeof q.x==="undefined"?null:q.x,J.y=typeof q.y==="undefined"?null:q.y}let Z=this.parent.scale.x,Q=this.parent.scale.y;if($.x!==null&&Z<$.x)Z=$.x;if(J.x!==null&&Z>J.x)Z=J.x;if($.y!==null&&Q<$.y)Q=$.y;if(J.y!==null&&Q>J.y)Q=J.y;if(Z!==this.parent.scale.x||Q!==this.parent.scale.y)this.parent.scale.set(Z,Q),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}reset(){this.clamp()}}var jU={friction:0.98,bounce:0.8,minSpeed:0.01},s8=16;class Q2 extends M1{constructor($,J={}){super($);this.options=Object.assign({},jU,J),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",(Z)=>this.moved(Z))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!!(this.x||this.y)}move(){if(this.paused)return!1;let $=this.parent.input.count();if($===1||$>1&&!this.parent.plugins.get("pinch",!0)){if(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60)this.saved.splice(0,30)}return!1}moved($){if(this.saved.length){let J=this.saved[this.saved.length-1];if($.type==="clamp-x"){if(J.x===$.original.x)J.x=this.parent.x}else if($.type==="clamp-y"){if(J.y===$.original.y)J.y=this.parent.y}}}up(){if(this.parent.input.count()===0&&this.saved.length){let $=performance.now();for(let J of this.saved)if(J.time>=$-100){let Z=$-J.time;this.x=(this.parent.x-J.x)/Z,this.y=(this.parent.y-J.y)/Z,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate($){if($=$||{},typeof $.x!=="undefined")this.x=$.x,this.percentChangeX=this.options.friction;if(typeof $.y!=="undefined")this.y=$.y,this.percentChangeY=this.options.friction}update($){if(this.paused)return;let J=this.x||this.y,Z=this.timeSinceRelease,Q=this.timeSinceRelease+$;if(this.x){let q=this.percentChangeX,K=Math.log(q);this.parent.x+=this.x*s8/K*(Math.pow(q,Q/s8)-Math.pow(q,Z/s8)),this.x*=Math.pow(this.percentChangeX,$/s8)}if(this.y){let q=this.percentChangeY,K=Math.log(q);this.parent.y+=this.y*s8/K*(Math.pow(q,Q/s8)-Math.pow(q,Z/s8)),this.y*=Math.pow(this.percentChangeY,$/s8)}if(this.timeSinceRelease+=$,this.x&&this.y){if(Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed)this.x=0,this.y=0}else{if(Math.abs(this.x||0)<this.options.minSpeed)this.x=0;if(Math.abs(this.y||0)<this.options.minSpeed)this.y=0}if(J)this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}var _U={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1};class R4 extends M1{__init(){this.windowEventHandlers=new Array}constructor($,J={}){super($);if(R4.prototype.__init.call(this),this.options=Object.assign({},_U,J),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="x",this.yDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="y",this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress)this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses($){let J=(Q)=>{if($.includes(Q.code))this.keyIsPressed=!0},Z=(Q)=>{if($.includes(Q.code))this.keyIsPressed=!1};this.addWindowEventHandler("keyup",Z),this.addWindowEventHandler("keydown",J)}addWindowEventHandler($,J){window.addEventListener($,J),this.windowEventHandlers.push({event:$,handler:J})}destroy(){this.windowEventHandlers.forEach(({event:$,handler:J})=>{window.removeEventListener($,J)})}mouseButtons($){if(!$||$==="all")this.mouse=[!0,!0,!0];else this.mouse=[$.indexOf("left")!==-1,$.indexOf("middle")!==-1,$.indexOf("right")!==-1]}parseUnderflow(){let $=this.options.underflow.toLowerCase();if($==="center")this.underflowX=0,this.underflowY=0;else{if($.includes("left"))this.underflowX=-1;else if($.includes("right"))this.underflowX=1;else this.underflowX=0;if($.includes("top"))this.underflowY=-1;else if($.includes("bottom"))this.underflowY=1;else this.underflowY=0}}checkButtons($){let J=$.data.pointerType==="mouse",Z=this.parent.input.count();if(Z===1||Z>1&&!this.parent.plugins.get("pinch",!0)){if(!J||this.mouse[$.data.button])return!0}return!1}checkKeyPress($){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&$.data.pointerType==="touch"}down($){if(this.paused||!this.options.pressDrag)return!1;if(this.checkButtons($)&&this.checkKeyPress($))return this.last={x:$.data.global.x,y:$.data.global.y},this.current=$.data.pointerId,!0;return this.last=null,!1}get active(){return this.moved}move($){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===$.data.pointerId){let J=$.data.global.x,Z=$.data.global.y,Q=this.parent.input.count();if(Q===1||Q>1&&!this.parent.plugins.get("pinch",!0)){let q=J-this.last.x,K=Z-this.last.y;if(this.moved||(this.xDirection&&this.parent.input.checkThreshold(q)||this.yDirection&&this.parent.input.checkThreshold(K))){let V={x:J,y:Z};if(this.xDirection)this.parent.x+=(V.x-this.last.x)*this.options.factor;if(this.yDirection)this.parent.y+=(V.y-this.last.y)*this.options.factor;if(this.last=V,!this.moved)this.parent.emit("drag-start",{event:$,screen:new d(this.last.x,this.last.y),world:this.parent.toWorld(new d(this.last.x,this.last.y)),viewport:this.parent});return this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up($){if(this.paused)return!1;let J=this.parent.input.touches;if(J.length===1){let Z=J[0];if(Z.last)this.last={x:Z.last.x,y:Z.last.y},this.current=Z.id;return this.moved=!1,!0}else if(this.last){if(this.moved){let Z=new d(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:$,screen:Z,world:this.parent.toWorld(Z),viewport:this.parent}),this.last=null,this.moved=!1,!0}}return!1}wheel($){if(this.paused)return!1;if(this.options.wheel){let J=this.parent.plugins.get("wheel",!0);if(!J||!J.options.wheelZoom&&!$.ctrlKey){let Z=$.deltaMode?this.options.lineHeight:1,Q=[$.deltaX,$.deltaY],[q,K]=this.options.wheelSwapAxes?Q.reverse():Q;if(this.xDirection)this.parent.x+=q*Z*this.options.wheelScroll*this.reverse;if(this.yDirection)this.parent.y+=K*Z*this.options.wheelScroll*this.reverse;if(this.options.clampWheel)this.clamp();if(this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),!this.parent.options.passiveWheel)$.preventDefault();if(this.parent.options.stopPropagation)$.stopPropagation();return!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){let $=this.parent.plugins.get("decelerate",!0)||{};if(this.options.clampWheel!=="y"){if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else if(this.parent.left<0)this.parent.x=0,$.x=0;else if(this.parent.right>this.parent.worldWidth)this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,$.x=0}if(this.options.clampWheel!=="x")if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else{if(this.parent.top<0)this.parent.y=0,$.y=0;if(this.parent.bottom>this.parent.worldHeight)this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,$.y=0}}}var PU={speed:0,acceleration:null,radius:null};class q2 extends M1{constructor($,J,Z={}){super($);this.target=J,this.options=Object.assign({},PU,Z),this.velocity={x:0,y:0}}update($){if(this.paused)return;let J=this.parent.center,Z=this.target.x,Q=this.target.y;if(this.options.radius)if(Math.sqrt(Math.pow(this.target.y-J.y,2)+Math.pow(this.target.x-J.x,2))>this.options.radius){let H=Math.atan2(this.target.y-J.y,this.target.x-J.x);Z=this.target.x-Math.cos(H)*this.options.radius,Q=this.target.y-Math.sin(H)*this.options.radius}else return;let q=Z-J.x,K=Q-J.y;if(q||K)if(this.options.speed)if(this.options.acceleration){let V=Math.atan2(Q-J.y,Z-J.x),H=Math.sqrt(Math.pow(q,2)+Math.pow(K,2));if(H){let X=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);if(H>X)this.velocity={x:Math.min(this.velocity.x+(this.options.acceleration*$,this.options.speed)),y:Math.min(this.velocity.y+(this.options.acceleration*$,this.options.speed))};else this.velocity={x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};let W=Math.cos(V)*this.velocity.x,z=Math.sin(V)*this.velocity.y,G=Math.abs(W)>Math.abs(q)?Z:J.x+W,Y=Math.abs(z)>Math.abs(K)?Q:J.y+z;this.parent.moveCenter(G,Y),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{let V=Math.atan2(Q-J.y,Z-J.x),H=Math.cos(V)*this.options.speed,X=Math.sin(V)*this.options.speed,W=Math.abs(H)>Math.abs(q)?Z:J.x+H,z=Math.abs(X)>Math.abs(K)?Q:J.y+X;this.parent.moveCenter(W,z),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(Z,Q),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}var DU={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class K2 extends M1{constructor($,J={}){super($);this.options=Object.assign({},DU,J),this.reverse=this.options.reverse?1:-1,this.radiusSquared=typeof this.options.radius==="number"?Math.pow(this.options.radius,2):null,this.resize()}resize(){let $=this.options.distance;if($!==null)this.left=$,this.top=$,this.right=this.parent.screenWidth-$,this.bottom=this.parent.screenHeight-$;else if(!this.options.radius)this.left=this.options.left,this.top=this.options.top,this.right=this.options.right===null?null:this.parent.screenWidth-this.options.right,this.bottom=this.options.bottom===null?null:this.parent.screenHeight-this.options.bottom}down(){if(this.paused)return!1;if(!this.options.allowButtons)this.horizontal=this.vertical=null;return!1}move($){if(this.paused)return!1;if($.data.pointerType!=="mouse"&&$.data.identifier!==1||!this.options.allowButtons&&$.data.buttons!==0)return!1;let J=$.data.global.x,Z=$.data.global.y;if(this.radiusSquared){let Q=this.parent.toScreen(this.parent.center);if(Math.pow(Q.x-J,2)+Math.pow(Q.y-Z,2)>=this.radiusSquared){let K=Math.atan2(Q.y-Z,Q.x-J);if(this.options.linear)this.horizontal=Math.round(Math.cos(K))*this.options.speed*this.reverse*0.06,this.vertical=Math.round(Math.sin(K))*this.options.speed*this.reverse*0.06;else this.horizontal=Math.cos(K)*this.options.speed*this.reverse*0.06,this.vertical=Math.sin(K)*this.options.speed*this.reverse*0.06}else{if(this.horizontal)this.decelerateHorizontal();if(this.vertical)this.decelerateVertical();this.horizontal=this.vertical=0}}else{if(this.left!==null&&J<this.left)this.horizontal=Number(this.reverse)*this.options.speed*0.06;else if(this.right!==null&&J>this.right)this.horizontal=-1*this.reverse*this.options.speed*0.06;else this.decelerateHorizontal(),this.horizontal=0;if(this.top!==null&&Z<this.top)this.vertical=Number(this.reverse)*this.options.speed*0.06;else if(this.bottom!==null&&Z>this.bottom)this.vertical=-1*this.reverse*this.options.speed*0.06;else this.decelerateVertical(),this.vertical=0}return!1}decelerateHorizontal(){let $=this.parent.plugins.get("decelerate",!0);if(this.horizontal&&$&&!this.options.noDecelerate)$.activate({x:this.horizontal*this.options.speed*this.reverse/16.666666666666668})}decelerateVertical(){let $=this.parent.plugins.get("decelerate",!0);if(this.vertical&&$&&!this.options.noDecelerate)$.activate({y:this.vertical*this.options.speed*this.reverse/16.666666666666668})}up(){if(this.paused)return!1;if(this.horizontal)this.decelerateHorizontal();if(this.vertical)this.decelerateVertical();return this.horizontal=this.vertical=null,!1}update(){if(this.paused)return;if(this.horizontal||this.vertical){let $=this.parent.center;if(this.horizontal)$.x+=this.horizontal*this.options.speed;if(this.vertical)$.y+=this.vertical*this.options.speed;this.parent.moveCenter($),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}var LU={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class D9 extends M1{__init(){this.active=!1}__init2(){this.pinching=!1}__init3(){this.moved=!1}constructor($,J={}){super($);D9.prototype.__init.call(this),D9.prototype.__init2.call(this),D9.prototype.__init3.call(this),this.options=Object.assign({},LU,J)}down(){if(this.parent.input.count()>=2)return this.active=!0,!0;return!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move($){if(this.paused||!this.active)return!1;let J=$.data.global.x,Z=$.data.global.y,Q=this.parent.input.touches;if(Q.length>=2){let q=Q[0],K=Q[1],V=q.last&&K.last?Math.sqrt(Math.pow(K.last.x-q.last.x,2)+Math.pow(K.last.y-q.last.y,2)):null;if(q.id===$.data.pointerId)q.last={x:J,y:Z,data:$.data};else if(K.id===$.data.pointerId)K.last={x:J,y:Z,data:$.data};if(V){let H,X={x:q.last.x+(K.last.x-q.last.x)/2,y:q.last.y+(K.last.y-q.last.y)/2};if(!this.options.center)H=this.parent.toLocal(X);let W=Math.sqrt(Math.pow(K.last.x-q.last.x,2)+Math.pow(K.last.y-q.last.y,2));W=W===0?W=0.0000000001:W;let z=(1-V/W)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);if(this.isAxisX())this.parent.scale.x+=z;if(this.isAxisY())this.parent.scale.y+=z;this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:X});let G=this.parent.plugins.get("clamp-zoom",!0);if(G)G.clamp();if(this.options.center)this.parent.moveCenter(this.options.center);else{let Y=this.parent.toGlobal(H);this.parent.x+=(X.x-Y.x)*this.options.factor,this.parent.y+=(X.y-Y.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}if(!this.options.noDrag&&this.lastCenter)this.parent.x+=(X.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(X.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"});this.lastCenter=X,this.moved=!0}else if(!this.pinching)this.parent.emit("pinch-start",this.parent),this.pinching=!0;return!0}return!1}up(){if(this.pinching){if(this.parent.input.touches.length<=1)return this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0}return!1}}var kU={topLeft:!1,friction:0.8,time:1000,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class V2 extends M1{constructor($,J,Z,Q={}){super($);if(this.options=Object.assign({},kU,Q),this.ease=t$(Q.ease,"easeInOutSine"),this.x=J,this.y=Z,this.options.forceStart)this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};let $=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-$.x,this.deltaY=this.y-$.y,this.startX=$.x,this.startY=$.y,this.parent.emit("snap-start",this.parent)}wheel(){if(this.options.removeOnInterrupt)this.parent.plugins.remove("snap");return!1}down(){if(this.options.removeOnInterrupt)this.parent.plugins.remove("snap");else if(this.options.interrupt)this.snapping=null;return!1}up(){if(this.parent.input.count()===0){let $=this.parent.plugins.get("decelerate",!0);if($&&($.x||$.y))$.percentChangeX=$.percentChangeY=this.options.friction}return!1}update($){if(this.paused)return;if(this.options.interrupt&&this.parent.input.count()!==0)return;if(!this.snapping){let J=this.options.topLeft?this.parent.corner:this.parent.center;if(J.x!==this.x||J.y!==this.y)this.snapStart()}else{let J=this.snapping;J.time+=$;let Z,Q,q,K=this.startX,V=this.startY,H=this.deltaX,X=this.deltaY;if(J.time>this.options.time)Z=!0,Q=K+H,q=V+X;else{let W=this.ease(J.time,0,1,this.options.time);Q=K+H*W,q=V+X*W}if(this.options.topLeft)this.parent.moveCorner(Q,q);else this.parent.moveCenter(Q,q);if(this.parent.emit("moved",{viewport:this.parent,type:"snap"}),Z){if(this.options.removeOnComplete)this.parent.plugins.remove("snap");this.parent.emit("snap-end",this.parent),this.snapping=null}}}}var AU={width:0,height:0,time:1000,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class H2 extends M1{constructor($,J={}){super($);if(this.options=Object.assign({},AU,J),this.ease=t$(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0)this.xScale=$.screenWidth/this.options.width,this.xIndependent=!0;if(this.options.height>0)this.yScale=$.screenHeight/this.options.height,this.yIndependent=!0;if(this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,this.options.time===0){if($.container.scale.x=this.xScale,$.container.scale.y=this.yScale,this.options.removeOnComplete)this.parent.plugins.remove("snap-zoom")}else if(J.forceStart)this.createSnapping()}createSnapping(){let $=this.parent.worldScreenWidth,J=this.parent.worldScreenHeight,Z=this.parent.screenWidth/this.xScale,Q=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:$,startY:J,deltaX:Z-$,deltaY:Q-J},this.parent.emit("snap-zoom-start",this.parent)}resize(){if(this.snapping=null,this.options.width>0)this.xScale=this.parent.screenWidth/this.options.width;if(this.options.height>0)this.yScale=this.parent.screenHeight/this.options.height;this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){if(this.options.removeOnInterrupt)this.parent.plugins.remove("snap-zoom");return!1}down(){if(this.options.removeOnInterrupt)this.parent.plugins.remove("snap-zoom");else if(this.options.interrupt)this.snapping=null;return!1}update($){if(this.paused)return;if(this.options.interrupt&&this.parent.input.count()!==0)return;let J;if(!this.options.center&&!this.options.noMove)J=this.parent.center;if(!this.snapping){if(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)this.createSnapping()}else if(this.snapping){let Z=this.snapping;if(Z.time+=$,Z.time>=this.options.time){if(this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete)this.parent.plugins.remove("snap-zoom");this.parent.emit("snap-zoom-end",this.parent),this.snapping=null}else{let q=this.snapping,K=this.ease(q.time,q.startX,q.deltaX,this.options.time),V=this.ease(q.time,q.startY,q.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/K,this.parent.scale.y=this.parent.screenHeight/V}let Q=this.parent.plugins.get("clamp-zoom",!0);if(Q)Q.clamp();if(!this.options.noMove)if(!this.options.center)this.parent.moveCenter(J);else this.parent.moveCenter(this.options.center)}}resume(){this.snapping=null,super.resume()}}var RU={percent:0.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class X2 extends M1{constructor($,J={}){super($);if(this.options=Object.assign({},RU,J),this.keyIsPressed=!1,this.options.keyToPress)this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses($){window.addEventListener("keydown",(J)=>{if($.includes(J.code))this.keyIsPressed=!0}),window.addEventListener("keyup",(J)=>{if($.includes(J.code))this.keyIsPressed=!1})}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){if(this.options.interrupt)this.smoothing=null;return!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){let $=this.smoothingCenter,J=this.smoothing,Z;if(!this.options.center)Z=this.parent.toLocal($);if(this.isAxisX())this.parent.scale.x+=J.x;if(this.isAxisY())this.parent.scale.y+=J.y;this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});let Q=this.parent.plugins.get("clamp-zoom",!0);if(Q)Q.clamp();if(this.options.center)this.parent.moveCenter(this.options.center);else{let q=this.parent.toGlobal(Z);this.parent.x+=$.x-q.x,this.parent.y+=$.y-q.y}if(this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth)this.smoothing=null}}pinch($){if(this.paused)return;let J=this.parent.input.getPointerPosition($),Z=-$.deltaY*($.deltaMode?this.options.lineHeight:1)/200,Q=Math.pow(2,(1+this.options.percent)*Z),q;if(!this.options.center)q=this.parent.toLocal(J);if(this.isAxisX())this.parent.scale.x*=Q;if(this.isAxisY())this.parent.scale.y*=Q;this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});let K=this.parent.plugins.get("clamp-zoom",!0);if(K)K.clamp();if(this.options.center)this.parent.moveCenter(this.options.center);else{let V=this.parent.toGlobal(q);this.parent.x+=J.x-V.x,this.parent.y+=J.y-V.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:$.deltaX,dy:$.deltaY,dz:$.deltaZ},event:$,viewport:this.parent})}wheel($){if(this.paused)return!1;if(!this.checkKeyPress())return!1;if($.ctrlKey&&this.options.trackpadPinch)this.pinch($);else if(this.options.wheelZoom){let J=this.parent.input.getPointerPosition($),Q=(this.options.reverse?-1:1)*-$.deltaY*($.deltaMode?this.options.lineHeight:1)/500,q=Math.pow(2,(1+this.options.percent)*Q);if(this.options.smooth){let K={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+K.x)*q-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+K.y)*q-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=J}else{let K;if(!this.options.center)K=this.parent.toLocal(J);if(this.isAxisX())this.parent.scale.x*=q;if(this.isAxisY())this.parent.scale.y*=q;this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});let V=this.parent.plugins.get("clamp-zoom",!0);if(V)V.clamp();if(this.options.center)this.parent.moveCenter(this.options.center);else{let H=this.parent.toGlobal(K);this.parent.x+=J.x-H.x,this.parent.y+=J.y-H.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:$.deltaX,dy:$.deltaY,dz:$.deltaZ},event:$,viewport:this.parent})}return!this.parent.options.passiveWheel}}class W2{constructor($){this.viewport=$,this.touches=[],this.addListeners()}addListeners(){if(this.viewport.interactive=!0,!this.viewport.forceHitArea)this.viewport.hitArea=new y(0,0,this.viewport.worldWidth,this.viewport.worldHeight);this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=($)=>this.handleWheel($),this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}down($){if(this.viewport.pause||!this.viewport.worldVisible)return;if($.data.pointerType==="mouse")this.isMouseDown=!0;else if(!this.get($.data.pointerId))this.touches.push({id:$.data.pointerId,last:null});if(this.count()===1){this.last=$.data.global.clone();let Z=this.viewport.plugins.get("decelerate",!0),Q=this.viewport.plugins.get("bounce",!0);if((!Z||!Z.isActive())&&(!Q||!Q.isActive()))this.clickedAvailable=!0;else this.clickedAvailable=!1}else this.clickedAvailable=!1;if(this.viewport.plugins.down($)&&this.viewport.options.stopPropagation)$.stopPropagation()}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold($){if(Math.abs($)>=this.viewport.threshold)return!0;return!1}move($){if(this.viewport.pause||!this.viewport.worldVisible)return;let J=this.viewport.plugins.move($);if(this.clickedAvailable&&this.last){let Z=$.data.global.x-this.last.x,Q=$.data.global.y-this.last.y;if(this.checkThreshold(Z)||this.checkThreshold(Q))this.clickedAvailable=!1}if(J&&this.viewport.options.stopPropagation)$.stopPropagation()}up($){if(this.viewport.pause||!this.viewport.worldVisible)return;if($.data.pointerType==="mouse")this.isMouseDown=!1;if($.data.pointerType!=="mouse")this.remove($.data.pointerId);let J=this.viewport.plugins.up($);if(this.clickedAvailable&&this.count()===0&&this.last)this.viewport.emit("clicked",{event:$,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1;if(J&&this.viewport.options.stopPropagation)$.stopPropagation()}getPointerPosition($){let J=new d;if(this.viewport.options.interaction)this.viewport.options.interaction.mapPositionToPoint(J,$.clientX,$.clientY);else if(this.viewport.options.useDivWheelForInputManager&&this.viewport.options.divWheel){let Z=this.viewport.options.divWheel.getBoundingClientRect();J.x=$.clientX-Z.left,J.y=$.clientY-Z.top}else J.x=$.clientX,J.y=$.clientY;return J}handleWheel($){if(this.viewport.pause||!this.viewport.worldVisible)return;if(this.viewport.options.interaction&&this.viewport.options.interaction.interactionDOMElement!==$.target)return;let J=this.viewport.toLocal(this.getPointerPosition($));if(this.viewport.left<=J.x&&J.x<=this.viewport.right&&this.viewport.top<=J.y&&J.y<=this.viewport.bottom){if(this.viewport.plugins.wheel($)&&!this.viewport.options.passiveWheel)$.preventDefault()}}pause(){this.touches=[],this.isMouseDown=!1}get($){for(let J of this.touches)if(J.id===$)return J;return null}remove($){for(let J=0;J<this.touches.length;J++)if(this.touches[J].id===$){this.touches.splice(J,1);return}}count(){return(this.isMouseDown?1:0)+this.touches.length}}function r$($){let J=void 0,Z=$[0],Q=1;while(Q<$.length){let q=$[Q],K=$[Q+1];if(Q+=2,(q==="optionalAccess"||q==="optionalCall")&&Z==null)return;if(q==="access"||q==="optionalAccess")J=Z,Z=K(Z);else if(q==="call"||q==="optionalCall")Z=K((...V)=>Z.call(J,...V)),J=void 0}return Z}var P9=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class z2{constructor($){this.viewport=$,this.list=[],this.plugins={}}add($,J,Z=P9.length){let Q=this.plugins[$];if(Q)Q.destroy();this.plugins[$]=J;let q=P9.indexOf($);if(q!==-1)P9.splice(q,1);P9.splice(Z,0,$),this.sort()}get($,J){if(J){if(r$([this,"access",(Z)=>Z.plugins,"access",(Z)=>Z[$],"optionalAccess",(Z)=>Z.paused]))return null}return this.plugins[$]}update($){for(let J of this.list)J.update($)}resize(){for(let $ of this.list)$.resize()}reset(){for(let $ of this.list)$.reset()}removeAll(){this.list.forEach(($)=>{$.destroy()}),this.plugins={},this.sort()}remove($){if(this.plugins[$])r$([this,"access",(J)=>J.plugins,"access",(J)=>J[$],"optionalAccess",(J)=>J.destroy,"call",(J)=>J()]),delete this.plugins[$],this.viewport.emit(`${$}-remove`),this.sort()}pause($){r$([this,"access",(J)=>J.plugins,"access",(J)=>J[$],"optionalAccess",(J)=>J.pause,"call",(J)=>J()])}resume($){r$([this,"access",(J)=>J.plugins,"access",(J)=>J[$],"optionalAccess",(J)=>J.resume,"call",(J)=>J()])}sort(){this.list=[];for(let $ of P9)if(this.plugins[$])this.list.push(this.plugins[$])}down($){let J=!1;for(let Z of this.list)if(Z.down($))J=!0;return J}move($){let J=!1;for(let Z of this.viewport.plugins.list)if(Z.move($))J=!0;return J}up($){let J=!1;for(let Z of this.list)if(Z.up($))J=!0;return J}wheel($){let J=!1;for(let Z of this.list)if(Z.wheel($))J=!0;return J}}var MU={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1,ticker:C0.shared};class e$ extends i{__init(){this._disableOnContextMenu=($)=>$.preventDefault()}constructor($={}){super();if(e$.prototype.__init.call(this),this.options=Object.assign({},{divWheel:document.body},MU,$),this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.divWheel=this.options.divWheel||document.body,this.options.disableOnContextMenu)this.options.divWheel.addEventListener("contextmenu",this._disableOnContextMenu);if(!this.options.noTicker)this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction);this.input=new W2(this),this.plugins=new z2(this)}destroy($){if(!this.options.noTicker&&this.tickerFunction)this.options.ticker.remove(this.tickerFunction);if(this.options.disableOnContextMenu)this.options.divWheel.removeEventListener("contextmenu",this._disableOnContextMenu);this.input.destroy(),super.destroy($)}update($){if(!this.pause){if(this.plugins.update($),this.lastViewport){if(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y)this.moving=!0;else if(this.moving)this.emit("moved-end",this),this.moving=!1;if(this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y)this.zooming=!0;else if(this.zooming)this.emit("zoomed-end",this),this.zooming=!1}if(!this.forceHitArea)this._hitAreaDefault=new y(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault;this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this)}}resize($=window.innerWidth,J=window.innerHeight,Z,Q){if(this.screenWidth=$,this.screenHeight=J,typeof Z!=="undefined")this._worldWidth=Z;if(typeof Q!=="undefined")this._worldHeight=Q;this.plugins.resize(),this.dirty=!0}get worldWidth(){if(this._worldWidth)return this._worldWidth;return this.width/this.scale.x}set worldWidth($){this._worldWidth=$,this.plugins.resize()}get worldHeight(){if(this._worldHeight)return this._worldHeight;return this.height/this.scale.y}set worldHeight($){this._worldHeight=$,this.plugins.resize()}getVisibleBounds(){return new y(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld($,J){if(arguments.length===2)return this.toLocal(new d($,J));return this.toLocal($)}toScreen($,J){if(arguments.length===2)return this.toGlobal(new d($,J));return this.toGlobal($)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new d(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center($){this.moveCenter($)}moveCenter(...$){let J,Z;if(typeof $[0]==="number")J=$[0],Z=$[1];else J=$[0].x,Z=$[0].y;let Q=(this.worldScreenWidth/2-J)*this.scale.x,q=(this.worldScreenHeight/2-Z)*this.scale.y;if(this.x!==Q||this.y!==q)this.position.set(Q,q),this.plugins.reset(),this.dirty=!0;return this}get corner(){return new d(-this.x/this.scale.x,-this.y/this.scale.y)}set corner($){this.moveCorner($)}moveCorner(...$){let J,Z;if($.length===1)J=-$[0].x*this.scale.x,Z=-$[0].y*this.scale.y;else J=-$[0]*this.scale.x,Z=-$[1]*this.scale.y;if(J!==this.x||Z!==this.y)this.position.set(J,Z),this.plugins.reset(),this.dirty=!0;return this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth($){return this.screenWidth/$}findFitHeight($){return this.screenHeight/$}findFit($,J){let Z=this.screenWidth/$,Q=this.screenHeight/J;return Math.min(Z,Q)}findCover($,J){let Z=this.screenWidth/$,Q=this.screenHeight/J;return Math.max(Z,Q)}fitWidth($=this.worldWidth,J,Z=!0,Q){let q;if(J)q=this.center;if(this.scale.x=this.screenWidth/$,Z)this.scale.y=this.scale.x;let K=this.plugins.get("clamp-zoom",!0);if(!Q&&K)K.clamp();if(J&&q)this.moveCenter(q);return this}fitHeight($=this.worldHeight,J,Z=!0,Q){let q;if(J)q=this.center;if(this.scale.y=this.screenHeight/$,Z)this.scale.x=this.scale.y;let K=this.plugins.get("clamp-zoom",!0);if(!Q&&K)K.clamp();if(J&&q)this.moveCenter(q);return this}fitWorld($){let J;if($)J=this.center;if(this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y)this.scale.y=this.scale.x;else this.scale.x=this.scale.y;let Z=this.plugins.get("clamp-zoom",!0);if(Z)Z.clamp();if($&&J)this.moveCenter(J);return this}fit($,J=this.worldWidth,Z=this.worldHeight){let Q;if($)Q=this.center;if(this.scale.x=this.screenWidth/J,this.scale.y=this.screenHeight/Z,this.scale.x<this.scale.y)this.scale.y=this.scale.x;else this.scale.x=this.scale.y;let q=this.plugins.get("clamp-zoom",!0);if(q)q.clamp();if($&&Q)this.moveCenter(Q);return this}setZoom($,J){let Z;if(J)Z=this.center;this.scale.set($);let Q=this.plugins.get("clamp-zoom",!0);if(Q)Q.clamp();if(J&&Z)this.moveCenter(Z);return this}zoomPercent($,J){return this.setZoom(this.scale.x+this.scale.x*$,J)}zoom($,J){return this.fitWidth($+this.worldScreenWidth,J),this}get scaled(){return this.scale.x}set scaled($){this.setZoom($,!0)}snapZoom($){return this.plugins.add("snap-zoom",new H2(this,$)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new d(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right($){this.x=-$*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left($){this.x=-$*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top($){this.y=-$*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom($){this.y=-$*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty($){this._dirty=$}get forceHitArea(){return this._forceHitArea}set forceHitArea($){if($)this._forceHitArea=$,this.hitArea=$;else this._forceHitArea=null,this.hitArea=new y(0,0,this.worldWidth,this.worldHeight)}drag($){return this.plugins.add("drag",new R4(this,$)),this}clamp($){return this.plugins.add("clamp",new J2(this,$)),this}decelerate($){return this.plugins.add("decelerate",new Q2(this,$)),this}bounce($){return this.plugins.add("bounce",new $2(this,$)),this}pinch($){return this.plugins.add("pinch",new D9(this,$)),this}snap($,J,Z){return this.plugins.add("snap",new V2(this,$,J,Z)),this}follow($,J){return this.plugins.add("follow",new q2(this,$,J)),this}wheel($){return this.plugins.add("wheel",new X2(this,$)),this}animate($){return this.plugins.add("animate",new T8(this,$)),this}clampZoom($){return this.plugins.add("clamp-zoom",new Z2(this,$)),this}mouseEdges($){return this.plugins.add("mouse-edges",new K2(this,$)),this}get pause(){return!!this._pause}set pause($){if(this._pause=$,this.lastViewport=null,this.moving=!1,this.zooming=!1,$)this.input.pause()}ensureVisible($,J,Z,Q,q){if(q&&(Z>this.worldScreenWidth||Q>this.worldScreenHeight))this.fit(!0,Z,Q),this.emit("zoomed",{viewport:this,type:"ensureVisible"});let K=!1;if($<this.left)this.left=$,K=!0;else if($+Z>this.right)this.right=$+Z,K=!0;if(J<this.top)this.top=J,K=!0;else if(J+Q>this.bottom)this.bottom=J+Q,K=!0;if(K)this.emit("moved",{viewport:this,type:"ensureVisible"})}}var L9=new d,EU=new Uint16Array([0,1,2,0,2,3]);class h0 extends i{constructor($){super(),this._anchor=new L1(this._onAnchorUpdate,this,$?$.defaultAnchor.x:0,$?$.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new r(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=s.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=$||b.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=EU,this.pluginName="batch",this.isSprite=!0,this._roundPixels=_.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=R.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=R.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let $=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===$._updateID)return;this._textureID!==$._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=$._updateID;let J=this.transform.worldTransform,Z=J.a,Q=J.b,q=J.c,K=J.d,V=J.tx,H=J.ty,X=this.vertexData,W=$.trim,z=$.orig,G=this._anchor,Y=0,w=0,U=0,C=0;if(W?(w=W.x-G._x*z.width,Y=w+W.width,C=W.y-G._y*z.height,U=C+W.height):(w=-G._x*z.width,Y=w+z.width,C=-G._y*z.height,U=C+z.height),X[0]=Z*w+q*C+V,X[1]=K*C+Q*w+H,X[2]=Z*Y+q*C+V,X[3]=K*C+Q*Y+H,X[4]=Z*Y+q*U+V,X[5]=K*U+Q*Y+H,X[6]=Z*w+q*U+V,X[7]=K*U+Q*w+H,this._roundPixels){let N=_.RESOLUTION;for(let O=0;O<X.length;++O)X[O]=Math.round(X[O]*N)/N}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let $=this._texture,J=this.vertexTrimmedData,Z=$.orig,Q=this._anchor,q=this.transform.worldTransform,K=q.a,V=q.b,H=q.c,X=q.d,W=q.tx,z=q.ty,G=-Q._x*Z.width,Y=G+Z.width,w=-Q._y*Z.height,U=w+Z.height;if(J[0]=K*G+H*w+W,J[1]=X*w+V*G+z,J[2]=K*Y+H*w+W,J[3]=X*w+V*Y+z,J[4]=K*Y+H*U+W,J[5]=X*U+V*Y+z,J[6]=K*G+H*U+W,J[7]=X*U+V*G+z,this._roundPixels){let C=_.RESOLUTION;for(let N=0;N<J.length;++N)J[N]=Math.round(J[N]*C)/C}}_render($){this.calculateVertices(),$.batch.setObjectRenderer($.plugins[this.pluginName]),$.plugins[this.pluginName].render(this)}_calculateBounds(){let $=this._texture.trim,J=this._texture.orig;!$||$.width===J.width&&$.height===J.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds($){return this.children.length===0?(this._localBounds||(this._localBounds=new h8),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),$||(this._localBoundsRect||(this._localBoundsRect=new y),$=this._localBoundsRect),this._localBounds.getRectangle($)):super.getLocalBounds.call(this,$)}containsPoint($){this.worldTransform.applyInverse($,L9);let J=this._texture.orig.width,Z=this._texture.orig.height,Q=-J*this.anchor.x,q=0;return L9.x>=Q&&L9.x<Q+J&&(q=-Z*this.anchor.y,L9.y>=q&&L9.y<q+Z)}destroy($){if(super.destroy($),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof $=="boolean"?$:$?.texture){let J=typeof $=="boolean"?$:$?.baseTexture;this._texture.destroy(!!J)}this._texture=null}static from($,J){let Z=$ instanceof b?$:b.from($,J);return new h0(Z)}set roundPixels($){this._roundPixels!==$&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=$}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width($){let J=R.sign(this.scale.x)||1;this.scale.x=J*$/this._texture.orig.width,this._width=$}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height($){let J=R.sign(this.scale.y)||1;this.scale.y=J*$/this._texture.orig.height,this._height=$}get anchor(){return this._anchor}set anchor($){this._anchor.copyFrom($)}get tint(){return this._tintColor.value}set tint($){this._tintColor.setValue($),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture($){this._texture!==$&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=$||b.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,$&&($.baseTexture.valid?this._onTextureUpdate():$.once("update",this._onTextureUpdate,this)))}}var G2=new $0;K0.prototype._cacheAsBitmap=!1;K0.prototype._cacheData=null;K0.prototype._cacheAsBitmapResolution=null;K0.prototype._cacheAsBitmapMultisample=null;class Y2{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(K0.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set($){$!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=$,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set($){$!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=$,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set($){if(this._cacheAsBitmap===$)return;this._cacheAsBitmap=$;let J;$?(this._cacheData||(this._cacheData=new Y2),J=this._cacheData,J.originalRender=this.render,J.originalRenderCanvas=this.renderCanvas,J.originalUpdateTransform=this.updateTransform,J.originalCalculateBounds=this.calculateBounds,J.originalGetLocalBounds=this.getLocalBounds,J.originalDestroy=this.destroy,J.originalContainsPoint=this.containsPoint,J.originalMask=this._mask,J.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(J=this._cacheData,J.sprite&&this._destroyCachedDisplayObject(),this.render=J.originalRender,this.renderCanvas=J.originalRenderCanvas,this.calculateBounds=J.originalCalculateBounds,this.getLocalBounds=J.originalGetLocalBounds,this.destroy=J.originalDestroy,this.updateTransform=J.originalUpdateTransform,this.containsPoint=J.originalContainsPoint,this._mask=J.originalMask,this.filterArea=J.originalFilterArea)}}});K0.prototype._renderCached=function($){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject($),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render($))};K0.prototype._initCachedDisplayObject=function($){if(this._cacheData?.sprite)return;let J=this.alpha;this.alpha=1,$.batch.flush();let Z=this.getLocalBounds(new y,!0);if(this.filters?.length){let Y=this.filters[0].padding;Z.pad(Y)}let Q=this.cacheAsBitmapResolution||$.resolution;Z.ceil(Q),Z.width=Math.max(Z.width,1/Q),Z.height=Math.max(Z.height,1/Q);let q=$.renderTexture.current,K=$.renderTexture.sourceFrame.clone(),V=$.renderTexture.destinationFrame.clone(),H=$.projection.transform,X=g1.create({width:Z.width,height:Z.height,resolution:Q,multisample:this.cacheAsBitmapMultisample??$.multisample}),W=`cacheAsBitmap_${R.uid()}`;this._cacheData.textureCacheId=W,l.addToCache(X.baseTexture,W),b.addToCache(X,W);let z=this.transform.localTransform.copyTo(G2).invert().translate(-Z.x,-Z.y);this.render=this._cacheData.originalRender,$.render(this,{renderTexture:X,clear:!0,transform:z,skipUpdateTransform:!1}),$.framebuffer.blit(),$.projection.transform=H,$.renderTexture.bind(q,K,V),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=J;let G=new h0(X);G.transform.worldTransform=this.transform.worldTransform,G.anchor.x=-(Z.x/Z.width),G.anchor.y=-(Z.y/Z.height),G.alpha=J,G._bounds=this._bounds,this._cacheData.sprite=G,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=G.containsPoint.bind(G)};K0.prototype._renderCachedCanvas=function($){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas($),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas($))};K0.prototype._initCachedDisplayObjectCanvas=function($){if(this._cacheData?.sprite)return;let J=this.getLocalBounds(new y,!0),Z=this.alpha;this.alpha=1;let Q=$.canvasContext.activeContext,q=$._projTransform,K=this.cacheAsBitmapResolution||$.resolution;J.ceil(K),J.width=Math.max(J.width,1/K),J.height=Math.max(J.height,1/K);let V=g1.create({width:J.width,height:J.height,resolution:K}),H=`cacheAsBitmap_${R.uid()}`;this._cacheData.textureCacheId=H,l.addToCache(V.baseTexture,H),b.addToCache(V,H);let X=G2;this.transform.localTransform.copyTo(X),X.invert(),X.tx-=J.x,X.ty-=J.y,this.renderCanvas=this._cacheData.originalRenderCanvas,$.render(this,{renderTexture:V,clear:!0,transform:X,skipUpdateTransform:!1}),$.canvasContext.activeContext=Q,$._projTransform=q,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=Z;let W=new h0(V);W.transform.worldTransform=this.transform.worldTransform,W.anchor.x=-(J.x/J.width),W.anchor.y=-(J.y/J.height),W.alpha=Z,W._bounds=this._bounds,this._cacheData.sprite=W,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=$._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=W.containsPoint.bind(W)};K0.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};K0.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};K0.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,l.removeFromCache(this._cacheData.textureCacheId),b.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};K0.prototype._cacheAsBitmapDestroy=function($){this.cacheAsBitmap=!1,this.destroy($)};K0.prototype.name=null;i.prototype.getChildByName=function($,J){for(let Z=0,Q=this.children.length;Z<Q;Z++)if(this.children[Z].name===$)return this.children[Z];if(J)for(let Z=0,Q=this.children.length;Z<Q;Z++){let q=this.children[Z];if(!q.getChildByName)continue;let K=q.getChildByName($,!0);if(K)return K}return null};K0.prototype.getGlobalPosition=function($=new d,J=!1){return this.parent?this.parent.toGlobal(this.position,$,J):($.x=this.position.x,$.y=this.position.y),$};var w2=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class $7 extends G0{constructor($=1){super($4,w2,{uAlpha:1}),this.alpha=$}get alpha(){return this.uniforms.uAlpha}set alpha($){this.uniforms.uAlpha=$}}var hU={5:[0.153388,0.221461,0.250301],7:[0.071303,0.131514,0.189879,0.214607],9:[0.028532,0.067234,0.124009,0.179044,0.20236],11:[0.0093,0.028002,0.065984,0.121703,0.175713,0.198596],13:[0.002406,0.009255,0.027867,0.065666,0.121117,0.174868,0.197641],15:[0.000489,0.002403,0.009246,0.02784,0.065602,0.120999,0.174697,0.197448]},TU=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function U2($){let J=hU[$],Z=J.length,Q=TU,q="",K="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",V;for(let H=0;H<$;H++){let X=K.replace("%index%",H.toString());V=H,H>=Z&&(V=$-H-1),X=X.replace("%value%",J[V].toString()),q+=X,q+=`
`}return Q=Q.replace("%blur%",q),Q=Q.replace("%size%",$.toString()),Q}function C2($,J){let Z=Math.ceil($/2),Q=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`,q="",K;J?K="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":K="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let V=0;V<$;V++){let H=K.replace("%index%",V.toString());H=H.replace("%sampleIndex%",`${V-(Z-1)}.0`),q+=H,q+=`
`}return Q=Q.replace("%blur%",q),Q=Q.replace("%size%",$.toString()),Q}class O5 extends G0{constructor($,J=8,Z=4,Q=G0.defaultResolution,q=5){let K=C2(q,$),V=U2(q);super(K,V),this.horizontal=$,this.resolution=Q,this._quality=0,this.quality=Z,this.blur=J}apply($,J,Z,Q){if(Z?this.horizontal?this.uniforms.strength=1/Z.width*(Z.width/J.width):this.uniforms.strength=1/Z.height*(Z.height/J.height):this.horizontal?this.uniforms.strength=1/$.renderer.width*($.renderer.width/J.width):this.uniforms.strength=1/$.renderer.height*($.renderer.height/J.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)$.applyFilter(this,J,Z,Q);else{let q=$.getFilterTexture(),K=$.renderer,V=J,H=q;this.state.blend=!1,$.applyFilter(this,V,H,A1.CLEAR);for(let X=1;X<this.passes-1;X++){$.bindAndClear(V,A1.BLIT),this.uniforms.uSampler=H;let W=H;H=V,V=W,K.shader.bind(this),K.geometry.draw(5)}this.state.blend=!0,$.applyFilter(this,H,Z,Q),$.returnFilterTexture(q)}}get blur(){return this.strength}set blur($){this.padding=1+Math.abs($)*2,this.strength=$}get quality(){return this._quality}set quality($){this._quality=$,this.passes=$}}class J7 extends G0{constructor($=8,J=4,Z=G0.defaultResolution,Q=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new O5(!0,$,J,Z,Q),this.blurYFilter=new O5(!1,$,J,Z,Q),this.resolution=Z,this.quality=J,this.blur=$,this.repeatEdgePixels=!1}apply($,J,Z,Q){let q=Math.abs(this.blurXFilter.strength),K=Math.abs(this.blurYFilter.strength);if(q&&K){let V=$.getFilterTexture();this.blurXFilter.apply($,J,V,A1.CLEAR),this.blurYFilter.apply($,V,Z,Q),$.returnFilterTexture(V)}else K?this.blurYFilter.apply($,J,Z,Q):this.blurXFilter.apply($,J,Z,Q)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur($){this.blurXFilter.blur=this.blurYFilter.blur=$,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality($){this.blurXFilter.quality=this.blurYFilter.quality=$}get blurX(){return this.blurXFilter.blur}set blurX($){this.blurXFilter.blur=$,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY($){this.blurYFilter.blur=$,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode($){this.blurYFilter.blendMode=$}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels($){this._repeatEdgePixels=$,this.updatePadding()}}var N2=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Q6 extends G0{constructor(){let $={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(O9,N2,$),this.alpha=1}_loadMatrix($,J=!1){let Z=$;J&&(this._multiply(Z,this.uniforms.m,$),Z=this._colorMatrix(Z)),this.uniforms.m=Z}_multiply($,J,Z){return $[0]=J[0]*Z[0]+J[1]*Z[5]+J[2]*Z[10]+J[3]*Z[15],$[1]=J[0]*Z[1]+J[1]*Z[6]+J[2]*Z[11]+J[3]*Z[16],$[2]=J[0]*Z[2]+J[1]*Z[7]+J[2]*Z[12]+J[3]*Z[17],$[3]=J[0]*Z[3]+J[1]*Z[8]+J[2]*Z[13]+J[3]*Z[18],$[4]=J[0]*Z[4]+J[1]*Z[9]+J[2]*Z[14]+J[3]*Z[19]+J[4],$[5]=J[5]*Z[0]+J[6]*Z[5]+J[7]*Z[10]+J[8]*Z[15],$[6]=J[5]*Z[1]+J[6]*Z[6]+J[7]*Z[11]+J[8]*Z[16],$[7]=J[5]*Z[2]+J[6]*Z[7]+J[7]*Z[12]+J[8]*Z[17],$[8]=J[5]*Z[3]+J[6]*Z[8]+J[7]*Z[13]+J[8]*Z[18],$[9]=J[5]*Z[4]+J[6]*Z[9]+J[7]*Z[14]+J[8]*Z[19]+J[9],$[10]=J[10]*Z[0]+J[11]*Z[5]+J[12]*Z[10]+J[13]*Z[15],$[11]=J[10]*Z[1]+J[11]*Z[6]+J[12]*Z[11]+J[13]*Z[16],$[12]=J[10]*Z[2]+J[11]*Z[7]+J[12]*Z[12]+J[13]*Z[17],$[13]=J[10]*Z[3]+J[11]*Z[8]+J[12]*Z[13]+J[13]*Z[18],$[14]=J[10]*Z[4]+J[11]*Z[9]+J[12]*Z[14]+J[13]*Z[19]+J[14],$[15]=J[15]*Z[0]+J[16]*Z[5]+J[17]*Z[10]+J[18]*Z[15],$[16]=J[15]*Z[1]+J[16]*Z[6]+J[17]*Z[11]+J[18]*Z[16],$[17]=J[15]*Z[2]+J[16]*Z[7]+J[17]*Z[12]+J[18]*Z[17],$[18]=J[15]*Z[3]+J[16]*Z[8]+J[17]*Z[13]+J[18]*Z[18],$[19]=J[15]*Z[4]+J[16]*Z[9]+J[17]*Z[14]+J[18]*Z[19]+J[19],$}_colorMatrix($){let J=new Float32Array($);return J[4]/=255,J[9]/=255,J[14]/=255,J[19]/=255,J}brightness($,J){let Z=[$,0,0,0,0,0,$,0,0,0,0,0,$,0,0,0,0,0,1,0];this._loadMatrix(Z,J)}tint($,J){let[Z,Q,q]=r.shared.setValue($).toArray(),K=[Z,0,0,0,0,0,Q,0,0,0,0,0,q,0,0,0,0,0,1,0];this._loadMatrix(K,J)}greyscale($,J){let Z=[$,$,$,0,0,$,$,$,0,0,$,$,$,0,0,0,0,0,1,0];this._loadMatrix(Z,J)}blackAndWhite($){let J=[0.3,0.6,0.1,0,0,0.3,0.6,0.1,0,0,0.3,0.6,0.1,0,0,0,0,0,1,0];this._loadMatrix(J,$)}hue($,J){$=($||0)/180*Math.PI;let Z=Math.cos($),Q=Math.sin($),q=Math.sqrt,K=0.3333333333333333,V=q(K),H=Z+(1-Z)*K,X=K*(1-Z)-V*Q,W=K*(1-Z)+V*Q,z=K*(1-Z)+V*Q,G=Z+K*(1-Z),Y=K*(1-Z)-V*Q,w=K*(1-Z)-V*Q,U=K*(1-Z)+V*Q,C=Z+K*(1-Z),N=[H,X,W,0,0,z,G,Y,0,0,w,U,C,0,0,0,0,0,1,0];this._loadMatrix(N,J)}contrast($,J){let Z=($||0)+1,Q=-0.5*(Z-1),q=[Z,0,0,0,Q,0,Z,0,0,Q,0,0,Z,0,Q,0,0,0,1,0];this._loadMatrix(q,J)}saturate($=0,J){let Z=$*2/3+1,Q=(Z-1)*-0.5,q=[Z,Q,Q,0,0,Q,Z,Q,0,0,Q,Q,Z,0,0,0,0,0,1,0];this._loadMatrix(q,J)}desaturate(){this.saturate(-1)}negative($){let J=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(J,$)}sepia($){let J=[0.393,0.7689999,0.18899999,0,0,0.349,0.6859999,0.16799999,0,0,0.272,0.5339999,0.13099999,0,0,0,0,0,1,0];this._loadMatrix(J,$)}technicolor($){let J=[1.9125277891456083,-0.8545344976951645,-0.09155508482755585,0,11.793603434377337,-0.3087833385928097,1.7658908555458428,-0.10601743074722245,0,-70.35205161461398,-0.231103377548616,-0.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(J,$)}polaroid($){let J=[1.438,-0.062,-0.062,0,0,-0.122,1.378,-0.122,0,0,-0.016,-0.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(J,$)}toBGR($){let J=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(J,$)}kodachrome($){let J=[1.1285582396593525,-0.3967382283601348,-0.03992559172921793,0,63.72958762196502,-0.16404339962244616,1.0835251566291304,-0.05498805115633132,0,24.732407896706203,-0.16786010706155763,-0.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(J,$)}browni($){let J=[0.5997023498159715,0.34553243048391263,-0.2708298674538042,0,47.43192855600873,-0.037703249837783157,0.8609577587992641,0.15059552388459913,0,-36.96841498319127,0.24113635128153335,-0.07441037908422492,0.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(J,$)}vintage($){let J=[0.6279345635605994,0.3202183420819367,-0.03965408211312453,0,9.651285835294123,0.02578397704808868,0.6441188644374771,0.03259127616149294,0,7.462829176470591,0.0466055556782719,-0.0851232987247891,0.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(J,$)}colorTone($,J,Z,Q,q){$=$||0.2,J=J||0.15,Z=Z||16770432,Q=Q||3375104;let K=r.shared,[V,H,X]=K.setValue(Z).toArray(),[W,z,G]=K.setValue(Q).toArray(),Y=[0.3,0.59,0.11,0,0,V,H,X,$,0,W,z,G,J,0,V-W,H-z,X-G,0,0];this._loadMatrix(Y,q)}night($,J){$=$||0.1;let Z=[$*-2,-$,0,0,0,-$,0,$,0,0,0,$,$*2,0,0,0,0,0,1,0];this._loadMatrix(Z,J)}predator($,J){let Z=[11.224130630493164*$,-4.794486999511719*$,-2.8746118545532227*$,0*$,0.40342438220977783*$,-3.6330697536468506*$,9.193157196044922*$,-2.951810836791992*$,0*$,-1.316135048866272*$,-3.2184197902679443*$,-4.2375030517578125*$,7.476448059082031*$,0*$,0.8044459223747253*$,0,0,0,1,0];this._loadMatrix(Z,J)}lsd($){let J=[2,-0.4,0.5,0,0,-0.5,2,-0.4,0,0,-0.4,-0.5,3,0,0,0,0,0,1,0];this._loadMatrix(J,$)}reset(){let $=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix($,!1)}get matrix(){return this.uniforms.m}set matrix($){this.uniforms.m=$}get alpha(){return this.uniforms.uAlpha}set alpha($){this.uniforms.uAlpha=$}}Q6.prototype.grayscale=Q6.prototype.greyscale;var B2=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`;var I2=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class Z7 extends G0{constructor($,J){let Z=new $0;$.renderable=!1,super(I2,B2,{mapSampler:$._texture,filterMatrix:Z,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=$,this.maskMatrix=Z,J==null&&(J=20),this.scale=new d(J,J)}apply($,J,Z,Q){this.uniforms.filterMatrix=$.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;let q=this.maskSprite.worldTransform,K=Math.sqrt(q.a*q.a+q.b*q.b),V=Math.sqrt(q.c*q.c+q.d*q.d);K!==0&&V!==0&&(this.uniforms.rotation[0]=q.a/K,this.uniforms.rotation[1]=q.b/K,this.uniforms.rotation[2]=q.c/V,this.uniforms.rotation[3]=q.d/V),$.applyFilter(this,J,Z,Q)}get map(){return this.uniforms.mapSampler}set map($){this.uniforms.mapSampler=$}}var F2=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;var O2=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class Q7 extends G0{constructor(){super(O2,F2)}}var j2=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class q7 extends G0{constructor($=0.5,J=Math.random()){super(O9,j2,{uNoise:0,uSeed:0}),this.noise=$,this.seed=J}get noise(){return this.uniforms.uNoise}set noise($){this.uniforms.uNoise=$}get seed(){return this.uniforms.uSeed}set seed($){this.uniforms.uSeed=$}}var M4={AlphaFilter:$7,BlurFilter:J7,BlurFilterPass:O5,ColorMatrixFilter:Q6,DisplacementFilter:Z7,FXAAFilter:Q7,NoiseFilter:q7};Object.entries(M4).forEach(([$,J])=>{Object.defineProperty(M4,$,{get(){return R.deprecation("7.1.0",`filters.${$} has moved to ${$}`),J}})});class _2{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init($){this.removeTickerListener(),this.events=$,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate($){this._pauseUpdate=$}addTickerListener(){this.tickerAdded||!this.domElement||(C0.system.add(this.tickerUpdate,this,R1.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(C0.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let $=this.events.rootPointerEvent;this.events.supportsTouchEvents&&$.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:$.clientX,clientY:$.clientY}))}tickerUpdate($){this._deltaTime+=$,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}var G8=new _2;class S8{constructor($){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=S8.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new d,this.page=new d,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=$}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent($,J,Z){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent($,J,Z,Q,q){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class b8 extends S8{constructor(){super(...arguments),this.client=new d,this.movement=new d,this.offset=new d,this.global=new d,this.screen=new d}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition($,J,Z){return $.worldTransform.applyInverse(Z||this.global,J)}getModifierState($){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState($)}initMouseEvent($,J,Z,Q,q,K,V,H,X,W,z,G,Y,w,U){throw new Error("Method not implemented.")}}class Y1 extends b8{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Y8 extends b8{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Y8.DOM_DELTA_PIXEL=0,Y8.DOM_DELTA_LINE=1,Y8.DOM_DELTA_PAGE=2;var SU=2048,bU=new d,E4=new d;class K7{constructor($){this.dispatch=new R.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=$,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping($,J){this.mappingTable[$]||(this.mappingTable[$]=[]),this.mappingTable[$].push({fn:J,priority:0}),this.mappingTable[$].sort((Z,Q)=>Z.priority-Q.priority)}dispatchEvent($,J){$.propagationStopped=!1,$.propagationImmediatelyStopped=!1,this.propagate($,J),this.dispatch.emit(J||$.type,$)}mapEvent($){if(!this.rootTarget)return;let J=this.mappingTable[$.type];if(J)for(let Z=0,Q=J.length;Z<Q;Z++)J[Z].fn($);else console.warn(`[EventBoundary]: Event mapping not defined for ${$.type}`)}hitTest($,J){G8.pauseUpdate=!0;let Z=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",Q=this[Z](this.rootTarget,this.rootTarget.eventMode,bU.set($,J),this.hitTestFn,this.hitPruneFn);return Q&&Q[0]}propagate($,J){if(!$.target)return;let Z=$.composedPath();$.eventPhase=$.CAPTURING_PHASE;for(let Q=0,q=Z.length-1;Q<q;Q++)if($.currentTarget=Z[Q],this.notifyTarget($,J),$.propagationStopped||$.propagationImmediatelyStopped)return;if($.eventPhase=$.AT_TARGET,$.currentTarget=$.target,this.notifyTarget($,J),!($.propagationStopped||$.propagationImmediatelyStopped)){$.eventPhase=$.BUBBLING_PHASE;for(let Q=Z.length-2;Q>=0;Q--)if($.currentTarget=Z[Q],this.notifyTarget($,J),$.propagationStopped||$.propagationImmediatelyStopped)return}}all($,J,Z=this._allInteractiveElements){if(Z.length===0)return;$.eventPhase=$.BUBBLING_PHASE;let Q=Array.isArray(J)?J:[J];for(let q=Z.length-1;q>=0;q--)Q.forEach((K)=>{$.currentTarget=Z[q],this.notifyTarget($,K)})}propagationPath($){let J=[$];for(let Z=0;Z<SU&&$!==this.rootTarget;Z++){if(!$.parent)throw new Error("Cannot find propagation path to disconnected target");J.push($.parent),$=$.parent}return J.reverse(),J}hitTestMoveRecursive($,J,Z,Q,q,K=!1){let V=!1;if(this._interactivePrune($))return null;if(($.eventMode==="dynamic"||J==="dynamic")&&(G8.pauseUpdate=!1),$.interactiveChildren&&$.children){let W=$.children;for(let z=W.length-1;z>=0;z--){let G=W[z],Y=this.hitTestMoveRecursive(G,this._isInteractive(J)?J:G.eventMode,Z,Q,q,K||q($,Z));if(Y){if(Y.length>0&&!Y[Y.length-1].parent)continue;let w=$.isInteractive();(Y.length>0||w)&&(w&&this._allInteractiveElements.push($),Y.push($)),this._hitElements.length===0&&(this._hitElements=Y),V=!0}}}let H=this._isInteractive(J),X=$.isInteractive();return H&&X&&this._allInteractiveElements.push($),K||this._hitElements.length>0?null:V?this._hitElements:H&&!q($,Z)&&Q($,Z)?X?[$]:[]:null}hitTestRecursive($,J,Z,Q,q){if(this._interactivePrune($)||q($,Z))return null;if(($.eventMode==="dynamic"||J==="dynamic")&&(G8.pauseUpdate=!1),$.interactiveChildren&&$.children){let H=$.children;for(let X=H.length-1;X>=0;X--){let W=H[X],z=this.hitTestRecursive(W,this._isInteractive(J)?J:W.eventMode,Z,Q,q);if(z){if(z.length>0&&!z[z.length-1].parent)continue;let G=$.isInteractive();return(z.length>0||G)&&z.push($),z}}}let K=this._isInteractive(J),V=$.isInteractive();return K&&Q($,Z)?V?[$]:[]:null}_isInteractive($){return $==="static"||$==="dynamic"}_interactivePrune($){return!!(!$||$.isMask||!$.visible||!$.renderable||$.eventMode==="none"||$.eventMode==="passive"&&!$.interactiveChildren||$.isMask)}hitPruneFn($,J){if($.hitArea&&($.worldTransform.applyInverse(J,E4),!$.hitArea.contains(E4.x,E4.y)))return!0;if($._mask){let Z=$._mask.isMaskData?$._mask.maskObject:$._mask;if(Z&&!Z.containsPoint?.(J))return!0}return!1}hitTestFn($,J){return $.eventMode==="passive"?!1:$.hitArea?!0:$.containsPoint?$.containsPoint(J):!1}notifyTarget($,J){J=J??$.type;let Z=`on${J}`;$.currentTarget[Z]?.($);let Q=$.eventPhase===$.CAPTURING_PHASE||$.eventPhase===$.AT_TARGET?`${J}capture`:J;this.notifyListeners($,Q),$.eventPhase===$.AT_TARGET&&this.notifyListeners($,J)}mapPointerDown($){if(!($ instanceof Y1)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let J=this.createPointerEvent($);if(this.dispatchEvent(J,"pointerdown"),J.pointerType==="touch")this.dispatchEvent(J,"touchstart");else if(J.pointerType==="mouse"||J.pointerType==="pen"){let Q=J.button===2;this.dispatchEvent(J,Q?"rightdown":"mousedown")}let Z=this.trackingData($.pointerId);Z.pressTargetsByButton[$.button]=J.composedPath(),this.freeEvent(J)}mapPointerMove($){if(!($ instanceof Y1)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;let J=this.createPointerEvent($);this._isPointerMoveEvent=!1;let Z=J.pointerType==="mouse"||J.pointerType==="pen",Q=this.trackingData($.pointerId),q=this.findMountedTarget(Q.overTargets);if(Q.overTargets?.length>0&&q!==J.target){let H=$.type==="mousemove"?"mouseout":"pointerout",X=this.createPointerEvent($,H,q);if(this.dispatchEvent(X,"pointerout"),Z&&this.dispatchEvent(X,"mouseout"),!J.composedPath().includes(q)){let W=this.createPointerEvent($,"pointerleave",q);for(W.eventPhase=W.AT_TARGET;W.target&&!J.composedPath().includes(W.target);)W.currentTarget=W.target,this.notifyTarget(W),Z&&this.notifyTarget(W,"mouseleave"),W.target=W.target.parent;this.freeEvent(W)}this.freeEvent(X)}if(q!==J.target){let H=$.type==="mousemove"?"mouseover":"pointerover",X=this.clonePointerEvent(J,H);this.dispatchEvent(X,"pointerover"),Z&&this.dispatchEvent(X,"mouseover");let W=q?.parent;for(;W&&W!==this.rootTarget.parent&&W!==J.target;)W=W.parent;if(!W||W===this.rootTarget.parent){let z=this.clonePointerEvent(J,"pointerenter");for(z.eventPhase=z.AT_TARGET;z.target&&z.target!==q&&z.target!==this.rootTarget.parent;)z.currentTarget=z.target,this.notifyTarget(z),Z&&this.notifyTarget(z,"mouseenter"),z.target=z.target.parent;this.freeEvent(z)}this.freeEvent(X)}let K=[],V=this.enableGlobalMoveEvents??!0;this.moveOnAll?K.push("pointermove"):this.dispatchEvent(J,"pointermove"),V&&K.push("globalpointermove"),J.pointerType==="touch"&&(this.moveOnAll?K.splice(1,0,"touchmove"):this.dispatchEvent(J,"touchmove"),V&&K.push("globaltouchmove")),Z&&(this.moveOnAll?K.splice(1,0,"mousemove"):this.dispatchEvent(J,"mousemove"),V&&K.push("globalmousemove"),this.cursor=J.target?.cursor),K.length>0&&this.all(J,K),this._allInteractiveElements.length=0,this._hitElements.length=0,Q.overTargets=J.composedPath(),this.freeEvent(J)}mapPointerOver($){if(!($ instanceof Y1)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let J=this.trackingData($.pointerId),Z=this.createPointerEvent($),Q=Z.pointerType==="mouse"||Z.pointerType==="pen";this.dispatchEvent(Z,"pointerover"),Q&&this.dispatchEvent(Z,"mouseover"),Z.pointerType==="mouse"&&(this.cursor=Z.target?.cursor);let q=this.clonePointerEvent(Z,"pointerenter");for(q.eventPhase=q.AT_TARGET;q.target&&q.target!==this.rootTarget.parent;)q.currentTarget=q.target,this.notifyTarget(q),Q&&this.notifyTarget(q,"mouseenter"),q.target=q.target.parent;J.overTargets=Z.composedPath(),this.freeEvent(Z),this.freeEvent(q)}mapPointerOut($){if(!($ instanceof Y1)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let J=this.trackingData($.pointerId);if(J.overTargets){let Z=$.pointerType==="mouse"||$.pointerType==="pen",Q=this.findMountedTarget(J.overTargets),q=this.createPointerEvent($,"pointerout",Q);this.dispatchEvent(q),Z&&this.dispatchEvent(q,"mouseout");let K=this.createPointerEvent($,"pointerleave",Q);for(K.eventPhase=K.AT_TARGET;K.target&&K.target!==this.rootTarget.parent;)K.currentTarget=K.target,this.notifyTarget(K),Z&&this.notifyTarget(K,"mouseleave"),K.target=K.target.parent;J.overTargets=null,this.freeEvent(q),this.freeEvent(K)}this.cursor=null}mapPointerUp($){if(!($ instanceof Y1)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let J=performance.now(),Z=this.createPointerEvent($);if(this.dispatchEvent(Z,"pointerup"),Z.pointerType==="touch")this.dispatchEvent(Z,"touchend");else if(Z.pointerType==="mouse"||Z.pointerType==="pen"){let V=Z.button===2;this.dispatchEvent(Z,V?"rightup":"mouseup")}let Q=this.trackingData($.pointerId),q=this.findMountedTarget(Q.pressTargetsByButton[$.button]),K=q;if(q&&!Z.composedPath().includes(q)){let V=q;for(;V&&!Z.composedPath().includes(V);){if(Z.currentTarget=V,this.notifyTarget(Z,"pointerupoutside"),Z.pointerType==="touch")this.notifyTarget(Z,"touchendoutside");else if(Z.pointerType==="mouse"||Z.pointerType==="pen"){let H=Z.button===2;this.notifyTarget(Z,H?"rightupoutside":"mouseupoutside")}V=V.parent}delete Q.pressTargetsByButton[$.button],K=V}if(K){let V=this.clonePointerEvent(Z,"click");V.target=K,V.path=null,Q.clicksByButton[$.button]||(Q.clicksByButton[$.button]={clickCount:0,target:V.target,timeStamp:J});let H=Q.clicksByButton[$.button];if(H.target===V.target&&J-H.timeStamp<200?++H.clickCount:H.clickCount=1,H.target=V.target,H.timeStamp=J,V.detail=H.clickCount,V.pointerType==="mouse"){let X=V.button===2;this.dispatchEvent(V,X?"rightclick":"click")}else V.pointerType==="touch"&&this.dispatchEvent(V,"tap");this.dispatchEvent(V,"pointertap"),this.freeEvent(V)}this.freeEvent(Z)}mapPointerUpOutside($){if(!($ instanceof Y1)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let J=this.trackingData($.pointerId),Z=this.findMountedTarget(J.pressTargetsByButton[$.button]),Q=this.createPointerEvent($);if(Z){let q=Z;for(;q;)Q.currentTarget=q,this.notifyTarget(Q,"pointerupoutside"),Q.pointerType==="touch"?this.notifyTarget(Q,"touchendoutside"):(Q.pointerType==="mouse"||Q.pointerType==="pen")&&this.notifyTarget(Q,Q.button===2?"rightupoutside":"mouseupoutside"),q=q.parent;delete J.pressTargetsByButton[$.button]}this.freeEvent(Q)}mapWheel($){if(!($ instanceof Y8)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}let J=this.createWheelEvent($);this.dispatchEvent(J),this.freeEvent(J)}findMountedTarget($){if(!$)return null;let J=$[0];for(let Z=1;Z<$.length&&$[Z].parent===J;Z++)J=$[Z];return J}createPointerEvent($,J,Z){let Q=this.allocateEvent(Y1);return this.copyPointerData($,Q),this.copyMouseData($,Q),this.copyData($,Q),Q.nativeEvent=$.nativeEvent,Q.originalEvent=$,Q.target=Z??this.hitTest(Q.global.x,Q.global.y)??this._hitElements[0],typeof J=="string"&&(Q.type=J),Q}createWheelEvent($){let J=this.allocateEvent(Y8);return this.copyWheelData($,J),this.copyMouseData($,J),this.copyData($,J),J.nativeEvent=$.nativeEvent,J.originalEvent=$,J.target=this.hitTest(J.global.x,J.global.y),J}clonePointerEvent($,J){let Z=this.allocateEvent(Y1);return Z.nativeEvent=$.nativeEvent,Z.originalEvent=$.originalEvent,this.copyPointerData($,Z),this.copyMouseData($,Z),this.copyData($,Z),Z.target=$.target,Z.path=$.composedPath().slice(),Z.type=J??Z.type,Z}copyWheelData($,J){J.deltaMode=$.deltaMode,J.deltaX=$.deltaX,J.deltaY=$.deltaY,J.deltaZ=$.deltaZ}copyPointerData($,J){$ instanceof Y1&&J instanceof Y1&&(J.pointerId=$.pointerId,J.width=$.width,J.height=$.height,J.isPrimary=$.isPrimary,J.pointerType=$.pointerType,J.pressure=$.pressure,J.tangentialPressure=$.tangentialPressure,J.tiltX=$.tiltX,J.tiltY=$.tiltY,J.twist=$.twist)}copyMouseData($,J){$ instanceof b8&&J instanceof b8&&(J.altKey=$.altKey,J.button=$.button,J.buttons=$.buttons,J.client.copyFrom($.client),J.ctrlKey=$.ctrlKey,J.metaKey=$.metaKey,J.movement.copyFrom($.movement),J.screen.copyFrom($.screen),J.shiftKey=$.shiftKey,J.global.copyFrom($.global))}copyData($,J){J.isTrusted=$.isTrusted,J.srcElement=$.srcElement,J.timeStamp=performance.now(),J.type=$.type,J.detail=$.detail,J.view=$.view,J.which=$.which,J.layer.copyFrom($.layer),J.page.copyFrom($.page)}trackingData($){return this.mappingState.trackingData[$]||(this.mappingState.trackingData[$]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[$]}allocateEvent($){this.eventPool.has($)||this.eventPool.set($,[]);let J=this.eventPool.get($).pop()||new $(this);return J.eventPhase=J.NONE,J.currentTarget=null,J.path=null,J.target=null,J}freeEvent($){if($.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");let J=$.constructor;this.eventPool.has(J)||this.eventPool.set(J,[]),this.eventPool.get(J).push($)}notifyListeners($,J){let Z=$.currentTarget._events[J];if(Z&&$.currentTarget.isInteractive())if("fn"in Z)Z.once&&$.currentTarget.removeListener(J,Z.fn,void 0,!0),Z.fn.call(Z.context,$);else for(let Q=0,q=Z.length;Q<q&&!$.propagationImmediatelyStopped;Q++)Z[Q].once&&$.currentTarget.removeListener(J,Z[Q].fn,void 0,!0),Z[Q].fn.call(Z[Q].context,$)}}var fU=1,vU={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},h4=class ${constructor(J){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=J,this.rootBoundary=new K7(null),G8.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Y1(null),this.rootWheelEvent=new Y8(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...$.defaultEventFeatures},{set:(Z,Q,q)=>(Q==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=q),Z[Q]=q,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(J){let{view:Z,resolution:Q}=this.renderer;this.setTargetElement(Z),this.resolution=Q,$._defaultEventMode=J.eventMode??"auto",Object.assign(this.features,J.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(J){this.resolution=J}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(J){J=J||"default";let Z=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(Z=!1),this.currentCursor===J)return;this.currentCursor=J;let Q=this.cursorStyles[J];if(Q)switch(typeof Q){case"string":Z&&(this.domElement.style.cursor=Q);break;case"function":Q(J);break;case"object":Z&&Object.assign(this.domElement.style,Q);break}else Z&&typeof J=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,J)&&(this.domElement.style.cursor=J)}get pointer(){return this.rootPointerEvent}onPointerDown(J){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let Z=this.normalizeToPointerData(J);this.autoPreventDefault&&Z[0].isNormalized&&(J.cancelable||!("cancelable"in J))&&J.preventDefault();for(let Q=0,q=Z.length;Q<q;Q++){let K=Z[Q],V=this.bootstrapEvent(this.rootPointerEvent,K);this.rootBoundary.mapEvent(V)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(J){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,G8.pointerMoved();let Z=this.normalizeToPointerData(J);for(let Q=0,q=Z.length;Q<q;Q++){let K=this.bootstrapEvent(this.rootPointerEvent,Z[Q]);this.rootBoundary.mapEvent(K)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(J){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let Z=J.target;J.composedPath&&J.composedPath().length>0&&(Z=J.composedPath()[0]);let Q=Z!==this.domElement?"outside":"",q=this.normalizeToPointerData(J);for(let K=0,V=q.length;K<V;K++){let H=this.bootstrapEvent(this.rootPointerEvent,q[K]);H.type+=Q,this.rootBoundary.mapEvent(H)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(J){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let Z=this.normalizeToPointerData(J);for(let Q=0,q=Z.length;Q<q;Q++){let K=this.bootstrapEvent(this.rootPointerEvent,Z[Q]);this.rootBoundary.mapEvent(K)}this.setCursor(this.rootBoundary.cursor)}onWheel(J){if(!this.features.wheel)return;let Z=this.normalizeWheelEvent(J);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(Z)}setTargetElement(J){this.removeEvents(),this.domElement=J,G8.domElement=J,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;G8.addTickerListener();let J=this.domElement.style;J&&(globalThis.navigator.msPointerEnabled?(J.msContentZooming="none",J.msTouchAction="none"):this.supportsPointerEvents&&(J.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;G8.removeTickerListener();let J=this.domElement.style;globalThis.navigator.msPointerEnabled?(J.msContentZooming="",J.msTouchAction=""):this.supportsPointerEvents&&(J.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(J,Z,Q){let q=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},K=1/this.resolution;J.x=(Z-q.left)*(this.domElement.width/q.width)*K,J.y=(Q-q.top)*(this.domElement.height/q.height)*K}normalizeToPointerData(J){let Z=[];if(this.supportsTouchEvents&&J instanceof TouchEvent)for(let Q=0,q=J.changedTouches.length;Q<q;Q++){let K=J.changedTouches[Q];typeof K.button>"u"&&(K.button=0),typeof K.buttons>"u"&&(K.buttons=1),typeof K.isPrimary>"u"&&(K.isPrimary=J.touches.length===1&&J.type==="touchstart"),typeof K.width>"u"&&(K.width=K.radiusX||1),typeof K.height>"u"&&(K.height=K.radiusY||1),typeof K.tiltX>"u"&&(K.tiltX=0),typeof K.tiltY>"u"&&(K.tiltY=0),typeof K.pointerType>"u"&&(K.pointerType="touch"),typeof K.pointerId>"u"&&(K.pointerId=K.identifier||0),typeof K.pressure>"u"&&(K.pressure=K.force||0.5),typeof K.twist>"u"&&(K.twist=0),typeof K.tangentialPressure>"u"&&(K.tangentialPressure=0),typeof K.layerX>"u"&&(K.layerX=K.offsetX=K.clientX),typeof K.layerY>"u"&&(K.layerY=K.offsetY=K.clientY),K.isNormalized=!0,K.type=J.type,Z.push(K)}else if(!globalThis.MouseEvent||J instanceof MouseEvent&&(!this.supportsPointerEvents||!(J instanceof globalThis.PointerEvent))){let Q=J;typeof Q.isPrimary>"u"&&(Q.isPrimary=!0),typeof Q.width>"u"&&(Q.width=1),typeof Q.height>"u"&&(Q.height=1),typeof Q.tiltX>"u"&&(Q.tiltX=0),typeof Q.tiltY>"u"&&(Q.tiltY=0),typeof Q.pointerType>"u"&&(Q.pointerType="mouse"),typeof Q.pointerId>"u"&&(Q.pointerId=fU),typeof Q.pressure>"u"&&(Q.pressure=0.5),typeof Q.twist>"u"&&(Q.twist=0),typeof Q.tangentialPressure>"u"&&(Q.tangentialPressure=0),Q.isNormalized=!0,Z.push(Q)}else Z.push(J);return Z}normalizeWheelEvent(J){let Z=this.rootWheelEvent;return this.transferMouseData(Z,J),Z.deltaX=J.deltaX,Z.deltaY=J.deltaY,Z.deltaZ=J.deltaZ,Z.deltaMode=J.deltaMode,this.mapPositionToPoint(Z.screen,J.clientX,J.clientY),Z.global.copyFrom(Z.screen),Z.offset.copyFrom(Z.screen),Z.nativeEvent=J,Z.type=J.type,Z}bootstrapEvent(J,Z){return J.originalEvent=null,J.nativeEvent=Z,J.pointerId=Z.pointerId,J.width=Z.width,J.height=Z.height,J.isPrimary=Z.isPrimary,J.pointerType=Z.pointerType,J.pressure=Z.pressure,J.tangentialPressure=Z.tangentialPressure,J.tiltX=Z.tiltX,J.tiltY=Z.tiltY,J.twist=Z.twist,this.transferMouseData(J,Z),this.mapPositionToPoint(J.screen,Z.clientX,Z.clientY),J.global.copyFrom(J.screen),J.offset.copyFrom(J.screen),J.isTrusted=Z.isTrusted,J.type==="pointerleave"&&(J.type="pointerout"),J.type.startsWith("mouse")&&(J.type=J.type.replace("mouse","pointer")),J.type.startsWith("touch")&&(J.type=vU[J.type]||J.type),J}transferMouseData(J,Z){J.isTrusted=Z.isTrusted,J.srcElement=Z.srcElement,J.timeStamp=performance.now(),J.type=Z.type,J.altKey=Z.altKey,J.button=Z.button,J.buttons=Z.buttons,J.client.x=Z.clientX,J.client.y=Z.clientY,J.ctrlKey=Z.ctrlKey,J.metaKey=Z.metaKey,J.movement.x=Z.movementX,J.movement.y=Z.movementY,J.page.x=Z.pageX,J.page.y=Z.pageY,J.relatedTarget=null,J.shiftKey=Z.shiftKey}};h4.extension={name:"events",type:[j.RendererSystem,j.CanvasRendererSystem]},h4.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};var k9=h4;D.add(k9);function P2($){return $==="dynamic"||$==="static"}var D2={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??P2(k9.defaultEventMode)},set interactive($){R.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=$,this.eventMode=$?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??k9.defaultEventMode},set eventMode($){this._internalInteractive=P2($),this._internalEventMode=$},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener($,J,Z){let Q=typeof Z=="boolean"&&Z||typeof Z=="object"&&Z.capture,q=typeof Z=="object"?Z.signal:void 0,K=typeof Z=="object"?Z.once===!0:!1,V=typeof J=="function"?void 0:J;$=Q?`${$}capture`:$;let H=typeof J=="function"?J:J.handleEvent,X=this;q&&q.addEventListener("abort",()=>{X.off($,H,V)}),K?X.once($,H,V):X.on($,H,V)},removeEventListener($,J,Z){let Q=typeof Z=="boolean"&&Z||typeof Z=="object"&&Z.capture,q=typeof J=="function"?void 0:J;$=Q?`${$}capture`:$,J=typeof J=="function"?J:J.handleEvent,this.off($,J,q)},dispatchEvent($){if(!($ instanceof S8))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return $.defaultPrevented=!1,$.path=null,$.target=this,$.manager.dispatchEvent($),!$.defaultPrevented}};K0.mixin(D2);var T4={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};K0.mixin(T4);var yU=9,V7=100,gU=0,xU=0,L2=2,k2=1,cU=-1000,mU=-1000,uU=2;class H7{constructor($){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(R.isMobile.tablet||R.isMobile.phone)&&this.createTouchHook();let J=document.createElement("div");J.style.width=`${V7}px`,J.style.height=`${V7}px`,J.style.position="absolute",J.style.top=`${gU}px`,J.style.left=`${xU}px`,J.style.zIndex=L2.toString(),this.div=J,this.renderer=$,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){let $=document.createElement("button");$.style.width=`${k2}px`,$.style.height=`${k2}px`,$.style.position="absolute",$.style.top=`${cU}px`,$.style.left=`${mU}px`,$.style.zIndex=uU.toString(),$.style.backgroundColor="#FF0000",$.title="select to enable accessibility for this content",$.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild($),this._hookDiv=$}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects($){if(!$.visible||!$.accessibleChildren)return;$.accessible&&$.isInteractive()&&($._accessibleActive||this.addChild($),$.renderId=this.renderId);let J=$.children;if(J)for(let Z=0;Z<J.length;Z++)this.updateAccessibleObjects(J[Z])}update(){let $=performance.now();if(R.isMobile.android.device&&$<this.androidUpdateCount||(this.androidUpdateCount=$+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);let{x:J,y:Z,width:Q,height:q}=this.renderer.view.getBoundingClientRect(),{width:K,height:V,resolution:H}=this.renderer,X=Q/K*H,W=q/V*H,z=this.div;z.style.left=`${J}px`,z.style.top=`${Z}px`,z.style.width=`${K}px`,z.style.height=`${V}px`;for(let G=0;G<this.children.length;G++){let Y=this.children[G];if(Y.renderId!==this.renderId)Y._accessibleActive=!1,R.removeItems(this.children,G,1),this.div.removeChild(Y._accessibleDiv),this.pool.push(Y._accessibleDiv),Y._accessibleDiv=null,G--;else{z=Y._accessibleDiv;let{hitArea:w,worldTransform:U}=Y;Y.hitArea?(z.style.left=`${(U.tx+w.x*U.a)*X}px`,z.style.top=`${(U.ty+w.y*U.d)*W}px`,z.style.width=`${w.width*U.a*X}px`,z.style.height=`${w.height*U.d*W}px`):(w=Y.getBounds(),this.capHitArea(w),z.style.left=`${w.x*X}px`,z.style.top=`${w.y*W}px`,z.style.width=`${w.width*X}px`,z.style.height=`${w.height*W}px`,z.title!==Y.accessibleTitle&&Y.accessibleTitle!==null&&(z.title=Y.accessibleTitle),z.getAttribute("aria-label")!==Y.accessibleHint&&Y.accessibleHint!==null&&z.setAttribute("aria-label",Y.accessibleHint)),(Y.accessibleTitle!==z.title||Y.tabIndex!==z.tabIndex)&&(z.title=Y.accessibleTitle,z.tabIndex=Y.tabIndex,this.debug&&this.updateDebugHTML(z))}}this.renderId++}updateDebugHTML($){$.innerHTML=`type: ${$.type}</br> title : ${$.title}</br> tabIndex: ${$.tabIndex}`}capHitArea($){$.x<0&&($.width+=$.x,$.x=0),$.y<0&&($.height+=$.y,$.y=0);let{width:J,height:Z}=this.renderer;$.x+$.width>J&&($.width=J-$.x),$.y+$.height>Z&&($.height=Z-$.y)}addChild($){let J=this.pool.pop();J||(J=document.createElement("button"),J.style.width=`${V7}px`,J.style.height=`${V7}px`,J.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",J.style.position="absolute",J.style.zIndex=L2.toString(),J.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?J.setAttribute("aria-live","off"):J.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?J.setAttribute("aria-relevant","additions"):J.setAttribute("aria-relevant","text"),J.addEventListener("click",this._onClick.bind(this)),J.addEventListener("focus",this._onFocus.bind(this)),J.addEventListener("focusout",this._onFocusOut.bind(this))),J.style.pointerEvents=$.accessiblePointerEvents,J.type=$.accessibleType,$.accessibleTitle&&$.accessibleTitle!==null?J.title=$.accessibleTitle:(!$.accessibleHint||$.accessibleHint===null)&&(J.title=`displayObject ${$.tabIndex}`),$.accessibleHint&&$.accessibleHint!==null&&J.setAttribute("aria-label",$.accessibleHint),this.debug&&this.updateDebugHTML(J),$._accessibleActive=!0,$._accessibleDiv=J,J.displayObject=$,this.children.push($),this.div.appendChild($._accessibleDiv),$._accessibleDiv.tabIndex=$.tabIndex}_dispatchEvent($,J){let{displayObject:Z}=$.target,Q=this.renderer.events.rootBoundary,q=Object.assign(new S8(Q),{target:Z});Q.rootTarget=this.renderer.lastObjectRendered,J.forEach((K)=>Q.dispatchEvent(q,K))}_onClick($){this._dispatchEvent($,["click","pointertap","tap"])}_onFocus($){$.target.getAttribute("aria-live")||$.target.setAttribute("aria-live","assertive"),this._dispatchEvent($,["mouseover"])}_onFocusOut($){$.target.getAttribute("aria-live")||$.target.setAttribute("aria-live","polite"),this._dispatchEvent($,["mouseout"])}_onKeyDown($){$.keyCode===yU&&this.activate()}_onMouseMove($){$.movementX===0&&$.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}H7.extension={name:"accessibility",type:[j.RendererPlugin,j.CanvasRendererPlugin]};D.add(H7);var A2=class ${constructor(J){this.stage=new i,J=Object.assign({forceCanvas:!1},J),this.renderer=eJ(J),$._plugins.forEach((Z)=>{Z.init.call(this,J)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(J,Z){let Q=$._plugins.slice(0);Q.reverse(),Q.forEach((q)=>{q.destroy.call(this)}),this.stage.destroy(Z),this.stage=null,this.renderer.destroy(J),this.renderer=null}};A2._plugins=[];var X7=A2;D.handleByList(j.Application,X7._plugins);class W7{static init($){Object.defineProperty(this,"resizeTo",{set(J){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=J,J&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let J,Z;if(this._resizeTo===globalThis.window)J=globalThis.innerWidth,Z=globalThis.innerHeight;else{let{clientWidth:Q,clientHeight:q}=this._resizeTo;J=Q,Z=q}this.renderer.resize(J,Z),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=$.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}W7.extension=j.Application;D.add(W7);var S0=(($)=>($[$.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",$[$.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",$[$.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",$[$.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",$[$.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",$[$.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",$[$.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",$[$.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",$[$.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",$[$.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",$[$.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",$[$.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",$[$.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",$[$.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",$[$.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",$[$.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",$[$.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",$[$.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",$[$.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",$[$.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",$[$.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",$[$.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",$[$.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",$[$.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",$[$.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",$[$.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",$[$.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",$[$.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",$[$.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",$[$.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",$[$.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",$))(S0||{}),i8={33776:0.5,33777:0.5,33778:1,33779:1,35916:0.5,35917:0.5,35918:1,35919:1,37488:0.5,37489:0.5,37490:1,37491:1,37492:0.5,37496:1,37493:0.5,37497:1,37494:0.5,37495:0.5,35840:0.5,35842:0.5,35841:0.25,35843:0.25,36196:0.5,35986:0.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};var w8,q6;function R2(){q6={bptc:w8.getExtension("EXT_texture_compression_bptc"),astc:w8.getExtension("WEBGL_compressed_texture_astc"),etc:w8.getExtension("WEBGL_compressed_texture_etc"),s3tc:w8.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:w8.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:w8.getExtension("WEBGL_compressed_texture_pvrtc")||w8.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:w8.getExtension("WEBGL_compressed_texture_etc1"),atc:w8.getExtension("WEBGL_compressed_texture_atc")}}var S4={extension:{type:j.DetectionParser,priority:2},test:async()=>{let $=_.ADAPTER.createCanvas().getContext("webgl");return $?(w8=$,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async($)=>{q6||R2();let J=[];for(let Z in q6)q6[Z]&&J.push(Z);return[...J,...$]},remove:async($)=>(q6||R2(),$.filter((J)=>!(J in q6)))};D.add(S4);class A9 extends V8{constructor($,J={width:1,height:1,autoLoad:!0}){let Z,Q;typeof $=="string"?(Z=$,Q=new Uint8Array):(Z=null,Q=$),super(Q,J),this.origin=Z,this.buffer=Q?new w5(Q):null,this._load=null,this.loaded=!1,this.origin!==null&&J.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded($){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(($)=>$.blob()).then(($)=>$.arrayBuffer()).then(($)=>(this.data=new Uint32Array($),this.buffer=new w5($),this.loaded=!0,this.onBlobLoaded($),this.update(),this)),this._load)}}class a1 extends A9{constructor($,J){super($,J),this.format=J.format,this.levels=J.levels||1,this._width=J.width,this._height=J.height,this._extension=a1._formatToExtension(this.format),(J.levelBuffers||this.buffer)&&(this._levelBuffers=J.levelBuffers||a1._createLevelBuffers($ instanceof Uint8Array?$:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload($,J,Z){let Q=$.gl;if(!$.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;Q.pixelStorei(Q.UNPACK_ALIGNMENT,4);for(let q=0,K=this.levels;q<K;q++){let{levelID:V,levelWidth:H,levelHeight:X,levelBuffer:W}=this._levelBuffers[q];Q.compressedTexImage2D(Q.TEXTURE_2D,V,this.format,H,X,0,W)}return!0}onBlobLoaded(){this._levelBuffers=a1._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension($){if($>=33776&&$<=33779)return"s3tc";if($>=35916&&$<=35919)return"s3tc_sRGB";if($>=37488&&$<=37497)return"etc";if($>=35840&&$<=35843)return"pvrtc";if($===36196)return"etc1";if($===35986||$===35987||$===34798)return"atc";if($>=36492&&$<=36495)return"bptc";if($===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${$}`)}static _createLevelBuffers($,J,Z,Q,q,K,V){let H=new Array(Z),X=$.byteOffset,W=K,z=V,G=W+Q-1&~(Q-1),Y=z+q-1&~(q-1),w=G*Y*i8[J];for(let U=0;U<Z;U++)H[U]={levelID:U,levelWidth:Z>1?W:G,levelHeight:Z>1?z:Y,levelBuffer:new Uint8Array($.buffer,X,w)},X+=w,W=W>>1||1,z=z>>1||1,G=W+Q-1&~(Q-1),Y=z+q-1&~(q-1),w=G*Y*i8[J];return H}}var b4=4,z7=124,dU=32,M2=20,pU=542327876,G7={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},lU={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Y7={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},nU=1,oU=2,sU=4,iU=64,aU=512,rU=131072,tU=827611204,eU=861165636,$C=894720068,JC=808540228,ZC=4,QC={[tU]:S0.COMPRESSED_RGBA_S3TC_DXT1_EXT,[eU]:S0.COMPRESSED_RGBA_S3TC_DXT3_EXT,[$C]:S0.COMPRESSED_RGBA_S3TC_DXT5_EXT},qC={70:S0.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:S0.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:S0.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:S0.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:S0.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:S0.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:S0.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:S0.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:S0.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:S0.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:S0.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:S0.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:S0.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function w7($){let J=new Uint32Array($);if(J[0]!==pU)throw new Error("Invalid DDS file magic word");let Z=new Uint32Array($,0,z7/Uint32Array.BYTES_PER_ELEMENT),Q=Z[G7.HEIGHT],q=Z[G7.WIDTH],K=Z[G7.MIPMAP_COUNT],V=new Uint32Array($,G7.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,dU/Uint32Array.BYTES_PER_ELEMENT),H=V[nU];if(H&sU){let X=V[lU.FOURCC];if(X!==JC){let I=QC[X],B=b4+z7,F=new Uint8Array($,B);return[new a1(F,{format:I,width:q,height:Q,levels:K})]}let W=b4+z7,z=new Uint32Array(J.buffer,W,M2/Uint32Array.BYTES_PER_ELEMENT),G=z[Y7.DXGI_FORMAT],Y=z[Y7.RESOURCE_DIMENSION],w=z[Y7.MISC_FLAG],U=z[Y7.ARRAY_SIZE],C=qC[G];if(C===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${G}`);if(w===ZC)throw new Error("DDSParser does not support cubemap textures");if(Y===6)throw new Error("DDSParser does not supported 3D texture data");let N=new Array,O=b4+z7+M2;if(U===1)N.push(new Uint8Array($,O));else{let I=i8[C],B=0,F=q,P=Q;for(let M=0;M<K;M++){let E=Math.max(1,F+3&-4),g=Math.max(1,P+3&-4),o=E*g*I;B+=o,F=F>>>1,P=P>>>1}let L=O;for(let M=0;M<U;M++)N.push(new Uint8Array($,L,B)),L+=B}return N.map((I)=>new a1(I,{format:C,width:q,height:Q,levels:K}))}throw H&iU?new Error("DDSParser does not support uncompressed texture data."):H&aU?new Error("DDSParser does not supported YUV uncompressed texture data."):H&rU?new Error("DDSParser does not support single-channel (lumninance) texture data!"):H&oU?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var E2=[171,75,84,88,32,49,49,187,13,10,26,10],KC=67305985,r1={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},f4=64,U7={[p.UNSIGNED_BYTE]:1,[p.UNSIGNED_SHORT]:2,[p.INT]:4,[p.UNSIGNED_INT]:4,[p.FLOAT]:4,[p.HALF_FLOAT]:8},v4={[h.RGBA]:4,[h.RGB]:3,[h.RG]:2,[h.RED]:1,[h.LUMINANCE]:1,[h.LUMINANCE_ALPHA]:2,[h.ALPHA]:1},y4={[p.UNSIGNED_SHORT_4_4_4_4]:2,[p.UNSIGNED_SHORT_5_5_5_1]:2,[p.UNSIGNED_SHORT_5_6_5]:2};function C7($,J,Z=!1){let Q=new DataView(J);if(!VC($,Q))return null;let q=Q.getUint32(r1.ENDIANNESS,!0)===KC,K=Q.getUint32(r1.GL_TYPE,q),V=Q.getUint32(r1.GL_FORMAT,q),H=Q.getUint32(r1.GL_INTERNAL_FORMAT,q),X=Q.getUint32(r1.PIXEL_WIDTH,q),W=Q.getUint32(r1.PIXEL_HEIGHT,q)||1,z=Q.getUint32(r1.PIXEL_DEPTH,q)||1,G=Q.getUint32(r1.NUMBER_OF_ARRAY_ELEMENTS,q)||1,Y=Q.getUint32(r1.NUMBER_OF_FACES,q),w=Q.getUint32(r1.NUMBER_OF_MIPMAP_LEVELS,q),U=Q.getUint32(r1.BYTES_OF_KEY_VALUE_DATA,q);if(W===0||z!==1)throw new Error("Only 2D textures are supported");if(Y!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(G!==1)throw new Error("WebGL does not support array textures");let C=4,N=4,O=X+3&-4,I=W+3&-4,B=new Array(G),F=X*W;K===0&&(F=O*I);let P;if(K!==0?U7[K]?P=U7[K]*v4[V]:P=y4[K]:P=i8[H],P===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");let L=Z?XC(Q,U,q):null,M=F*P,E=X,g=W,o=O,f=I,x=f4+U;for(let k=0;k<w;k++){let T=Q.getUint32(x,q),J0=x+4;for(let n=0;n<G;n++){let S=B[n];S||(S=B[n]=new Array(w)),S[k]={levelID:k,levelWidth:w>1||K!==0?E:o,levelHeight:w>1||K!==0?g:f,levelBuffer:new Uint8Array(J,J0,M)},J0+=M}x+=T+4,x=x%4!==0?x+4-x%4:x,E=E>>1||1,g=g>>1||1,o=E+C-1&~(C-1),f=g+N-1&~(N-1),M=o*f*P}return K!==0?{uncompressed:B.map((k)=>{let T=k[0].levelBuffer,J0=!1;return K===p.FLOAT?T=new Float32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4):K===p.UNSIGNED_INT?(J0=!0,T=new Uint32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)):K===p.INT&&(J0=!0,T=new Int32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)),{resource:new V8(T,{width:k[0].levelWidth,height:k[0].levelHeight}),type:K,format:J0?HC(V):V}}),kvData:L}:{compressed:B.map((k)=>new a1(null,{format:H,width:X,height:W,levels:w,levelBuffers:k})),kvData:L}}function VC($,J){for(let Z=0;Z<E2.length;Z++)if(J.getUint8(Z)!==E2[Z])return console.error(`${$} is not a valid *.ktx file!`),!1;return!0}function HC($){switch($){case h.RGBA:return h.RGBA_INTEGER;case h.RGB:return h.RGB_INTEGER;case h.RG:return h.RG_INTEGER;case h.RED:return h.RED_INTEGER;default:return $}}function XC($,J,Z){let Q=new Map,q=0;for(;q<J;){let K=$.getUint32(f4+q,Z),V=f4+q+4,H=3-(K+3)%4;if(K===0||K>J-q){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let X=0;for(;X<K&&$.getUint8(V+X)!==0;X++);if(X===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}let W=new TextDecoder().decode(new Uint8Array($.buffer,V,X)),z=new DataView($.buffer,V+X+1,K-X-1);Q.set(W,z),q+=4+K+H}return Q}var g4={extension:{type:j.LoadParser,priority:j0.High},name:"loadDDS",test($){return c0($,".dds")},async load($,J,Z){let Q=await(await _.ADAPTER.fetch($)).arrayBuffer(),q=w7(Q).map((K)=>{let V=new l(K,{mipmap:n0.OFF,alphaMode:F0.NO_PREMULTIPLIED_ALPHA,resolution:R.getResolutionOfUrl($),...J.data});return x1(V,Z,$)});return q.length===1?q[0]:q},unload($){Array.isArray($)?$.forEach((J)=>J.destroy(!0)):$.destroy(!0)}};D.add(g4);var x4={extension:{type:j.LoadParser,priority:j0.High},name:"loadKTX",test($){return c0($,".ktx")},async load($,J,Z){let Q=await(await _.ADAPTER.fetch($)).arrayBuffer(),{compressed:q,uncompressed:K,kvData:V}=C7($,Q),H=q??K,X={mipmap:n0.OFF,alphaMode:F0.NO_PREMULTIPLIED_ALPHA,resolution:R.getResolutionOfUrl($),...J.data},W=H.map((z)=>{H===K&&Object.assign(X,{type:z.type,format:z.format});let G=z.resource??z,Y=new l(G,X);return Y.ktxKeyValueData=V,x1(Y,Z,$)});return W.length===1?W[0]:W},unload($){Array.isArray($)?$.forEach((J)=>J.destroy(!0)):$.destroy(!0)}};D.add(x4);var WC=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],c4={extension:j.ResolveParser,test:($)=>{let J=R.path.extname($).slice(1);return["basis","ktx","dds"].includes(J)},parse:($)=>{let J=$.split("."),Z=J.pop();if(["ktx","dds"].includes(Z)){let Q=J.pop();if(WC.includes(Q))return{resolution:parseFloat(_.RETINA_PREFIX.exec($)?.[1]??"1"),format:Q,src:$}}return{resolution:parseFloat(_.RETINA_PREFIX.exec($)?.[1]??"1"),format:Z,src:$}}};D.add(c4);var N7=new y,zC=4,h2=class ${constructor(J){this.renderer=J,this._rendererPremultipliedAlpha=!1}contextChange(){let J=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(J&&J.alpha&&J.premultipliedAlpha)}async image(J,Z,Q,q){let K=new Image;return K.src=await this.base64(J,Z,Q,q),K}async base64(J,Z,Q,q){let K=this.canvas(J,q);if(K.toBlob!==void 0)return new Promise((V,H)=>{K.toBlob((X)=>{if(!X){H(new Error("ICanvas.toBlob failed!"));return}let W=new FileReader;W.onload=()=>V(W.result),W.onerror=H,W.readAsDataURL(X)},Z,Q)});if(K.toDataURL!==void 0)return K.toDataURL(Z,Q);if(K.convertToBlob!==void 0){let V=await K.convertToBlob({type:Z,quality:Q});return new Promise((H,X)=>{let W=new FileReader;W.onload=()=>H(W.result),W.onerror=X,W.readAsDataURL(V)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(J,Z){let{pixels:Q,width:q,height:K,flipY:V,premultipliedAlpha:H}=this._rawPixels(J,Z);V&&$._flipY(Q,q,K),H&&$._unpremultiplyAlpha(Q);let X=new R.CanvasRenderTarget(q,K,1),W=new ImageData(new Uint8ClampedArray(Q.buffer),q,K);return X.context.putImageData(W,0,0),X.canvas}pixels(J,Z){let{pixels:Q,width:q,height:K,flipY:V,premultipliedAlpha:H}=this._rawPixels(J,Z);return V&&$._flipY(Q,q,K),H&&$._unpremultiplyAlpha(Q),Q}_rawPixels(J,Z){let Q=this.renderer;if(!Q)throw new Error("The Extract has already been destroyed");let q,K=!1,V=!1,H,X=!1;J&&(J instanceof g1?H=J:(H=Q.generateTexture(J,{region:Z,resolution:Q.resolution,multisample:Q.multisample}),X=!0,Z&&(N7.width=Z.width,N7.height=Z.height,Z=N7)));let W=Q.gl;if(H){if(q=H.baseTexture.resolution,Z=Z??H.frame,K=!1,V=H.baseTexture.alphaMode>0&&H.baseTexture.format===h.RGBA,!X){Q.renderTexture.bind(H);let w=H.framebuffer.glFramebuffers[Q.CONTEXT_UID];w.blitFramebuffer&&Q.framebuffer.bind(w.blitFramebuffer)}}else q=Q.resolution,Z||(Z=N7,Z.width=Q.width/q,Z.height=Q.height/q),K=!0,V=this._rendererPremultipliedAlpha,Q.renderTexture.bind();let z=Math.max(Math.round(Z.width*q),1),G=Math.max(Math.round(Z.height*q),1),Y=new Uint8Array(zC*z*G);return W.readPixels(Math.round(Z.x*q),Math.round(Z.y*q),z,G,W.RGBA,W.UNSIGNED_BYTE,Y),X&&H?.destroy(!0),{pixels:Y,width:z,height:G,flipY:K,premultipliedAlpha:V}}destroy(){this.renderer=null}static _flipY(J,Z,Q){let q=Z<<2,K=Q>>1,V=new Uint8Array(q);for(let H=0;H<K;H++){let X=H*q,W=(Q-H-1)*q;V.set(J.subarray(X,X+q)),J.copyWithin(X,W,W+q),J.set(V,W)}}static _unpremultiplyAlpha(J){J instanceof Uint8ClampedArray&&(J=new Uint8Array(J.buffer));let Z=J.length;for(let Q=0;Q<Z;Q+=4){let q=J[Q+3];if(q!==0){let K=255.001/q;J[Q]=J[Q]*K+0.5,J[Q+1]=J[Q+1]*K+0.5,J[Q+2]=J[Q+2]*K+0.5}}}};h2.extension={name:"extract",type:j.RendererSystem};var T2=h2;D.add(T2);var j5={build($){let J=$.points,Z,Q,q,K,V,H;if($.type===z0.CIRC){let U=$.shape;Z=U.x,Q=U.y,V=H=U.radius,q=K=0}else if($.type===z0.ELIP){let U=$.shape;Z=U.x,Q=U.y,V=U.width,H=U.height,q=K=0}else{let U=$.shape,C=U.width/2,N=U.height/2;Z=U.x+C,Q=U.y+N,V=H=Math.max(0,Math.min(U.radius,Math.min(C,N))),q=C-V,K=N-H}if(!(V>=0&&H>=0&&q>=0&&K>=0)){J.length=0;return}let X=Math.ceil(2.3*Math.sqrt(V+H)),W=X*8+(q?4:0)+(K?4:0);if(J.length=W,W===0)return;if(X===0){J.length=8,J[0]=J[6]=Z+q,J[1]=J[3]=Q+K,J[2]=J[4]=Z-q,J[5]=J[7]=Q-K;return}let z=0,G=X*4+(q?2:0)+2,Y=G,w=W;{let U=q+V,C=K,N=Z+U,O=Z-U,I=Q+C;if(J[z++]=N,J[z++]=I,J[--G]=I,J[--G]=O,K){let B=Q-C;J[Y++]=O,J[Y++]=B,J[--w]=B,J[--w]=N}}for(let U=1;U<X;U++){let C=Math.PI/2*(U/X),N=q+Math.cos(C)*V,O=K+Math.sin(C)*H,I=Z+N,B=Z-N,F=Q+O,P=Q-O;J[z++]=I,J[z++]=F,J[--G]=F,J[--G]=B,J[Y++]=B,J[Y++]=P,J[--w]=P,J[--w]=I}{let U=q,C=K+H,N=Z+U,O=Z-U,I=Q+C,B=Q-C;J[z++]=N,J[z++]=I,J[--w]=B,J[--w]=N,q&&(J[z++]=O,J[z++]=I,J[--w]=B,J[--w]=O)}},triangulate($,J){let Z=$.points,Q=J.points,q=J.indices;if(Z.length===0)return;let K=Q.length/2,V=K,H,X;if($.type!==z0.RREC){let z=$.shape;H=z.x,X=z.y}else{let z=$.shape;H=z.x+z.width/2,X=z.y+z.height/2}let W=$.matrix;Q.push($.matrix?W.a*H+W.c*X+W.tx:H,$.matrix?W.b*H+W.d*X+W.ty:X),K++,Q.push(Z[0],Z[1]);for(let z=2;z<Z.length;z+=2)Q.push(Z[z],Z[z+1]),q.push(K++,V,K);q.push(V+1,V,K)}};function S2($,J=!1){let Z=$.length;if(Z<6)return;let Q=0;for(let q=0,K=$[Z-2],V=$[Z-1];q<Z;q+=2){let H=$[q],X=$[q+1];Q+=(H-K)*(X+V),K=H,V=X}if(!J&&Q>0||J&&Q<=0){let q=Z/2;for(let K=q+q%2;K<Z;K+=2){let V=Z-K-2,H=Z-K-1,X=K,W=K+1;[$[V],$[X]]=[$[X],$[V]],[$[H],$[W]]=[$[W],$[H]]}}}var R9={build($){$.points=$.shape.points.slice()},triangulate($,J){let{points:Z,holes:Q}=$,q=J.points,K=J.indices;if(Z.length>=6){S2(Z,!1);let V=[];for(let W=0;W<Q.length;W++){let z=Q[W];S2(z.points,!0),V.push(Z.length/2),Z=Z.concat(z.points)}let H=R.earcut(Z,V,2);if(!H)return;let X=q.length/2;for(let W=0;W<H.length;W+=3)K.push(H[W]+X),K.push(H[W+1]+X),K.push(H[W+2]+X);for(let W=0;W<Z.length;W++)q.push(Z[W])}}};var m4={build($){let J=$.shape,Z=J.x,Q=J.y,q=J.width,K=J.height,V=$.points;V.length=0,q>=0&&K>=0&&V.push(Z,Q,Z+q,Q,Z+q,Q+K,Z,Q+K)},triangulate($,J){let Z=$.points,Q=J.points;if(Z.length===0)return;let q=Q.length/2;Q.push(Z[0],Z[1],Z[2],Z[3],Z[6],Z[7],Z[4],Z[5]),J.indices.push(q,q+1,q+2,q+1,q+2,q+3)}};var u4={build($){j5.build($)},triangulate($,J){j5.triangulate($,J)}};var Z1=(($)=>($.MITER="miter",$.BEVEL="bevel",$.ROUND="round",$))(Z1||{}),c1=(($)=>($.BUTT="butt",$.ROUND="round",$.SQUARE="square",$))(c1||{}),m1={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:0.0001,_segmentsCount($,J=20){if(!this.adaptive||!$||isNaN($))return J;let Z=Math.ceil($/this.maxLength);return Z<this.minSegments?Z=this.minSegments:Z>this.maxSegments&&(Z=this.maxSegments),Z}};class K6{static curveTo($,J,Z,Q,q,K){let V=K[K.length-2],H=K[K.length-1]-J,X=V-$,W=Q-J,z=Z-$,G=Math.abs(H*z-X*W);if(G<0.00000001||q===0)return(K[K.length-2]!==$||K[K.length-1]!==J)&&K.push($,J),null;let Y=H*H+X*X,w=W*W+z*z,U=H*W+X*z,C=q*Math.sqrt(Y)/G,N=q*Math.sqrt(w)/G,O=C*U/Y,I=N*U/w,B=C*z+N*X,F=C*W+N*H,P=X*(N+O),L=H*(N+O),M=z*(C+I),E=W*(C+I),g=Math.atan2(L-F,P-B),o=Math.atan2(E-F,M-B);return{cx:B+$,cy:F+J,radius:q,startAngle:g,endAngle:o,anticlockwise:X*W>z*H}}static arc($,J,Z,Q,q,K,V,H,X){let W=V-K,z=m1._segmentsCount(Math.abs(W)*q,Math.ceil(Math.abs(W)/y8)*40),G=W/(z*2),Y=G*2,w=Math.cos(G),U=Math.sin(G),C=z-1,N=C%1/C;for(let O=0;O<=C;++O){let I=O+N*O,B=G+K+Y*I,F=Math.cos(B),P=-Math.sin(B);X.push((w*F+U*P)*q+Z,(w*-P+U*F)*q+Q)}}}class M9{constructor(){this.reset()}begin($,J,Z){this.reset(),this.style=$,this.start=J,this.attribStart=Z}end($,J){this.attribSize=J-this.attribStart,this.size=$-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class V6{static curveLength($,J,Z,Q,q,K,V,H){let X=0,W=0,z=0,G=0,Y=0,w=0,U=0,C=0,N=0,O=0,I=0,B=$,F=J;for(let P=1;P<=10;++P)W=P/10,z=W*W,G=z*W,Y=1-W,w=Y*Y,U=w*Y,C=U*$+3*w*W*Z+3*Y*z*q+G*V,N=U*J+3*w*W*Q+3*Y*z*K+G*H,O=B-C,I=F-N,B=C,F=N,X+=Math.sqrt(O*O+I*I);return X}static curveTo($,J,Z,Q,q,K,V){let H=V[V.length-2],X=V[V.length-1];V.length-=2;let W=m1._segmentsCount(V6.curveLength(H,X,$,J,Z,Q,q,K)),z=0,G=0,Y=0,w=0,U=0;V.push(H,X);for(let C=1,N=0;C<=W;++C)N=C/W,z=1-N,G=z*z,Y=G*z,w=N*N,U=w*N,V.push(Y*H+3*G*N*$+3*z*w*Z+U*q,Y*X+3*G*N*J+3*z*w*Q+U*K)}}function b2($,J,Z,Q,q,K,V,H){let X=$-Z*q,W=J-Q*q,z=$+Z*K,G=J+Q*K,Y,w;V?(Y=Q,w=-Z):(Y=-Q,w=Z);let U=X+Y,C=W+w,N=z+Y,O=G+w;return H.push(U,C,N,O),2}function _5($,J,Z,Q,q,K,V,H){let X=Z-$,W=Q-J,z=Math.atan2(X,W),G=Math.atan2(q-$,K-J);H&&z<G?z+=Math.PI*2:!H&&z>G&&(G+=Math.PI*2);let Y=z,w=G-z,U=Math.abs(w),C=Math.sqrt(X*X+W*W),N=(15*U*Math.sqrt(C)/Math.PI>>0)+1,O=w/N;if(Y+=O,H){V.push($,J,Z,Q);for(let I=1,B=Y;I<N;I++,B+=O)V.push($,J,$+Math.sin(B)*C,J+Math.cos(B)*C);V.push($,J,q,K)}else{V.push(Z,Q,$,J);for(let I=1,B=Y;I<N;I++,B+=O)V.push($+Math.sin(B)*C,J+Math.cos(B)*C,$,J);V.push(q,K,$,J)}return N*2}function GC($,J){let Z=$.shape,Q=$.points||Z.points.slice(),q=J.closePointEps;if(Q.length===0)return;let K=$.lineStyle,V=new d(Q[0],Q[1]),H=new d(Q[Q.length-2],Q[Q.length-1]),X=Z.type!==z0.POLY||Z.closeStroke,W=Math.abs(V.x-H.x)<q&&Math.abs(V.y-H.y)<q;if(X){Q=Q.slice(),W&&(Q.pop(),Q.pop(),H.set(Q[Q.length-2],Q[Q.length-1]));let S=(V.x+H.x)*0.5,Z0=(H.y+V.y)*0.5;Q.unshift(S,Z0),Q.push(S,Z0)}let z=J.points,G=Q.length/2,Y=Q.length,w=z.length/2,U=K.width/2,C=U*U,N=K.miterLimit*K.miterLimit,O=Q[0],I=Q[1],B=Q[2],F=Q[3],P=0,L=0,M=-(I-F),E=O-B,g=0,o=0,f=Math.sqrt(M*M+E*E);M/=f,E/=f,M*=U,E*=U;let x=K.alignment,k=(1-x)*2,T=x*2;X||(K.cap===c1.ROUND?Y+=_5(O-M*(k-T)*0.5,I-E*(k-T)*0.5,O-M*k,I-E*k,O+M*T,I+E*T,z,!0)+2:K.cap===c1.SQUARE&&(Y+=b2(O,I,M,E,k,T,!0,z))),z.push(O-M*k,I-E*k,O+M*T,I+E*T);for(let S=1;S<G-1;++S){O=Q[(S-1)*2],I=Q[(S-1)*2+1],B=Q[S*2],F=Q[S*2+1],P=Q[(S+1)*2],L=Q[(S+1)*2+1],M=-(I-F),E=O-B,f=Math.sqrt(M*M+E*E),M/=f,E/=f,M*=U,E*=U,g=-(F-L),o=B-P,f=Math.sqrt(g*g+o*o),g/=f,o/=f,g*=U,o*=U;let Z0=B-O,V0=I-F,t=B-P,I0=L-F,b5=Z0*t+V0*I0,x9=V0*t-I0*Z0,D6=x9<0;if(Math.abs(x9)<0.001*Math.abs(b5)){z.push(B-M*k,F-E*k,B+M*T,F+E*T),b5>=0&&(K.join===Z1.ROUND?Y+=_5(B,F,B-M*k,F-E*k,B-g*k,F-o*k,z,!1)+4:Y+=2,z.push(B-g*T,F-o*T,B+g*k,F+o*k));continue}let GQ=(-M+O)*(-E+F)-(-M+B)*(-E+I),YQ=(-g+P)*(-o+F)-(-g+B)*(-o+L),c9=(Z0*YQ-t*GQ)/x9,m9=(I0*GQ-V0*YQ)/x9,wQ=(c9-B)*(c9-B)+(m9-F)*(m9-F),Z5=B+(c9-B)*k,Q5=F+(m9-F)*k,q5=B-(c9-B)*T,K5=F-(m9-F)*T,yW=Math.min(Z0*Z0+V0*V0,t*t+I0*I0),UQ=D6?k:T,gW=yW+UQ*UQ*C,xW=wQ<=gW,u9=K.join;if(u9===Z1.MITER&&wQ/C>N&&(u9=Z1.BEVEL),xW)switch(u9){case Z1.MITER:{z.push(Z5,Q5,q5,K5);break}case Z1.BEVEL:{D6?z.push(Z5,Q5,B+M*T,F+E*T,Z5,Q5,B+g*T,F+o*T):z.push(B-M*k,F-E*k,q5,K5,B-g*k,F-o*k,q5,K5),Y+=2;break}case Z1.ROUND:{D6?(z.push(Z5,Q5,B+M*T,F+E*T),Y+=_5(B,F,B+M*T,F+E*T,B+g*T,F+o*T,z,!0)+4,z.push(Z5,Q5,B+g*T,F+o*T)):(z.push(B-M*k,F-E*k,q5,K5),Y+=_5(B,F,B-M*k,F-E*k,B-g*k,F-o*k,z,!1)+4,z.push(B-g*k,F-o*k,q5,K5));break}}else{switch(z.push(B-M*k,F-E*k,B+M*T,F+E*T),u9){case Z1.MITER:{D6?z.push(q5,K5,q5,K5):z.push(Z5,Q5,Z5,Q5),Y+=2;break}case Z1.ROUND:{D6?Y+=_5(B,F,B+M*T,F+E*T,B+g*T,F+o*T,z,!0)+2:Y+=_5(B,F,B-M*k,F-E*k,B-g*k,F-o*k,z,!1)+2;break}}z.push(B-g*k,F-o*k,B+g*T,F+o*T),Y+=2}}O=Q[(G-2)*2],I=Q[(G-2)*2+1],B=Q[(G-1)*2],F=Q[(G-1)*2+1],M=-(I-F),E=O-B,f=Math.sqrt(M*M+E*E),M/=f,E/=f,M*=U,E*=U,z.push(B-M*k,F-E*k,B+M*T,F+E*T),X||(K.cap===c1.ROUND?Y+=_5(B-M*(k-T)*0.5,F-E*(k-T)*0.5,B-M*k,F-E*k,B+M*T,F+E*T,z,!1)+2:K.cap===c1.SQUARE&&(Y+=b2(B,F,M,E,k,T,!1,z)));let J0=J.indices,n=m1.epsilon*m1.epsilon;for(let S=w;S<Y+w-2;++S)O=z[S*2],I=z[S*2+1],B=z[(S+1)*2],F=z[(S+1)*2+1],P=z[(S+2)*2],L=z[(S+2)*2+1],!(Math.abs(O*(F-L)+B*(L-I)+P*(I-F))<n)&&J0.push(S,S+1,S+2)}function YC($,J){let Z=0,Q=$.shape,q=$.points||Q.points,K=Q.type!==z0.POLY||Q.closeStroke;if(q.length===0)return;let{points:V,indices:H}=J,X=q.length/2,W=V.length/2,z=W;for(V.push(q[0],q[1]),Z=1;Z<X;Z++)V.push(q[Z*2],q[Z*2+1]),H.push(z,z+1),z++;K&&H.push(z,W)}function E9($,J){$.lineStyle.native?YC($,J):GC($,J)}class H6{static curveLength($,J,Z,Q,q,K){let V=$-2*Z+q,H=J-2*Q+K,X=2*Z-2*$,W=2*Q-2*J,z=4*(V*V+H*H),G=4*(V*X+H*W),Y=X*X+W*W,w=2*Math.sqrt(z+G+Y),U=Math.sqrt(z),C=2*z*U,N=2*Math.sqrt(Y),O=G/U;return(C*w+U*G*(w-N)+(4*Y*z-G*G)*Math.log((2*U+O+w)/(O+N)))/(4*C)}static curveTo($,J,Z,Q,q){let K=q[q.length-2],V=q[q.length-1],H=m1._segmentsCount(H6.curveLength(K,V,$,J,Z,Q)),X=0,W=0;for(let z=1;z<=H;++z){let G=z/H;X=K+($-K)*G,W=V+(J-V)*G,q.push(X+($+(Z-$)*G-X)*G,W+(J+(Q-J)*G-W)*G)}}}var h9={[z0.POLY]:R9,[z0.CIRC]:j5,[z0.ELIP]:j5,[z0.RECT]:m4,[z0.RREC]:u4},B7=[],X6=[];class W6{constructor($,J=null,Z=null,Q=null){this.points=[],this.holes=[],this.shape=$,this.lineStyle=Z,this.fillStyle=J,this.matrix=Q,this.type=$.type}clone(){return new W6(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}var z6=new d,f2=class $ extends o5{constructor(){super(),this.closePointEps=0.0001,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new h8,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let J=0;J<this.drawCalls.length;J++)this.drawCalls[J].texArray.clear(),X6.push(this.drawCalls[J]);this.drawCalls.length=0;for(let J=0;J<this.batches.length;J++){let Z=this.batches[J];Z.reset(),B7.push(Z)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(J,Z=null,Q=null,q=null){let K=new W6(J,Z,Q,q);return this.graphicsData.push(K),this.dirty++,this}drawHole(J,Z=null){if(!this.graphicsData.length)return null;let Q=new W6(J,null,null,Z),q=this.graphicsData[this.graphicsData.length-1];return Q.lineStyle=q.lineStyle,q.holes.push(Q),this.dirty++,this}destroy(){super.destroy();for(let J=0;J<this.graphicsData.length;++J)this.graphicsData[J].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(J){let Z=this.graphicsData;for(let Q=0;Q<Z.length;++Q){let q=Z[Q];if(q.fillStyle.visible&&q.shape&&(q.matrix?q.matrix.applyInverse(J,z6):z6.copyFrom(J),q.shape.contains(z6.x,z6.y))){let K=!1;if(q.holes){for(let V=0;V<q.holes.length;V++)if(q.holes[V].shape.contains(z6.x,z6.y)){K=!0;break}}if(!K)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let J=this.uvs,Z=this.graphicsData,Q=null,q=null;this.batches.length>0&&(Q=this.batches[this.batches.length-1],q=Q.style);for(let X=this.shapeIndex;X<Z.length;X++){this.shapeIndex++;let W=Z[X],z=W.fillStyle,G=W.lineStyle;h9[W.type].build(W),W.matrix&&this.transformPoints(W.points,W.matrix),(z.visible||G.visible)&&this.processHoles(W.holes);for(let Y=0;Y<2;Y++){let w=Y===0?z:G;if(!w.visible)continue;let U=w.texture.baseTexture,C=this.indices.length,N=this.points.length/2;U.wrapMode=X1.REPEAT,Y===0?this.processFill(W):this.processLine(W);let O=this.points.length/2-N;O!==0&&(Q&&!this._compareStyles(q,w)&&(Q.end(C,N),Q=null),Q||(Q=B7.pop()||new M9,Q.begin(w,C,N),this.batches.push(Q),q=w),this.addUvs(this.points,J,w.texture,N,O,w.matrix))}}let K=this.indices.length,V=this.points.length/2;if(Q&&Q.end(K,V),this.batches.length===0){this.batchable=!0;return}let H=V>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&H===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=H?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(J,Z){return!(!J||!Z||J.texture.baseTexture!==Z.texture.baseTexture||J.color+J.alpha!==Z.color+Z.alpha||!!J.native!=!!Z.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let J=0,Z=this.graphicsData.length;J<Z;J++){let Q=this.graphicsData[J],q=Q.fillStyle,K=Q.lineStyle;if(q&&!q.texture.baseTexture.valid||K&&!K.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let J=this.batches;for(let Z=0,Q=J.length;Z<Q;Z++){let q=J[Z];for(let K=0;K<q.size;K++){let V=q.start+K;this.indicesUint16[V]=this.indicesUint16[V]-q.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;let J=this.batches;for(let Z=0;Z<J.length;Z++)if(J[Z].style.native)return!1;return this.points.length<$.BATCHABLE_SIZE*2}buildDrawCalls(){let J=++l._globalBatch;for(let G=0;G<this.drawCalls.length;G++)this.drawCalls[G].texArray.clear(),X6.push(this.drawCalls[G]);this.drawCalls.length=0;let Z=this.colors,Q=this.textureIds,q=X6.pop();q||(q=new U5,q.texArray=new C5),q.texArray.count=0,q.start=0,q.size=0,q.type=B1.TRIANGLES;let K=0,V=null,H=0,X=!1,W=B1.TRIANGLES,z=0;this.drawCalls.push(q);for(let G=0;G<this.batches.length;G++){let Y=this.batches[G],U=Y.style,C=U.texture.baseTexture;X!==!!U.native&&(X=!!U.native,W=X?B1.LINES:B1.TRIANGLES,V=null,K=8,J++),V!==C&&(V=C,C._batchEnabled!==J&&(K===8&&(J++,K=0,q.size>0&&(q=X6.pop(),q||(q=new U5,q.texArray=new C5),this.drawCalls.push(q)),q.start=z,q.size=0,q.texArray.count=0,q.type=W),C.touched=1,C._batchEnabled=J,C._batchLocation=K,C.wrapMode=X1.REPEAT,q.texArray.elements[q.texArray.count++]=C,K++)),q.size+=Y.size,z+=Y.size,H=C._batchLocation,this.addColors(Z,U.color,U.alpha,Y.attribSize,Y.attribStart),this.addTextureIds(Q,H,Y.attribSize,Y.attribStart)}l._globalBatch=J,this.packAttributes()}packAttributes(){let J=this.points,Z=this.uvs,Q=this.colors,q=this.textureIds,K=new ArrayBuffer(J.length*3*4),V=new Float32Array(K),H=new Uint32Array(K),X=0;for(let W=0;W<J.length/2;W++)V[X++]=J[W*2],V[X++]=J[W*2+1],V[X++]=Z[W*2],V[X++]=Z[W*2+1],H[X++]=Q[W],V[X++]=q[W];this._buffer.update(K),this._indexBuffer.update(this.indicesUint16)}processFill(J){J.holes.length?R9.triangulate(J,this):h9[J.type].triangulate(J,this)}processLine(J){E9(J,this);for(let Z=0;Z<J.holes.length;Z++)E9(J.holes[Z],this)}processHoles(J){for(let Z=0;Z<J.length;Z++){let Q=J[Z];h9[Q.type].build(Q),Q.matrix&&this.transformPoints(Q.points,Q.matrix)}}calculateBounds(){let J=this._bounds;J.clear(),J.addVertexData(this.points,0,this.points.length),J.pad(this.boundsPadding,this.boundsPadding)}transformPoints(J,Z){for(let Q=0;Q<J.length/2;Q++){let q=J[Q*2],K=J[Q*2+1];J[Q*2]=Z.a*q+Z.c*K+Z.tx,J[Q*2+1]=Z.b*q+Z.d*K+Z.ty}}addColors(J,Z,Q,q,K=0){let V=r.shared.setValue(Z).toLittleEndianNumber(),H=r.shared.setValue(V).toPremultiplied(Q);J.length=Math.max(J.length,K+q);for(let X=0;X<q;X++)J[K+X]=H}addTextureIds(J,Z,Q,q=0){J.length=Math.max(J.length,q+Q);for(let K=0;K<Q;K++)J[q+K]=Z}addUvs(J,Z,Q,q,K,V=null){let H=0,X=Z.length,W=Q.frame;for(;H<K;){let G=J[(q+H)*2],Y=J[(q+H)*2+1];if(V){let w=V.a*G+V.c*Y+V.tx;Y=V.b*G+V.d*Y+V.ty,G=w}H++,Z.push(G/W.width,Y/W.height)}let z=Q.baseTexture;(W.width<z.width||W.height<z.height)&&this.adjustUvs(Z,Q,X,K)}adjustUvs(J,Z,Q,q){let K=Z.baseTexture,H=Q+q*2,X=Z.frame,W=X.width/K.width,z=X.height/K.height,G=X.x/X.width,Y=X.y/X.height,w=Math.floor(J[Q]+0.000001),U=Math.floor(J[Q+1]+0.000001);for(let C=Q+2;C<H;C+=2)w=Math.min(w,Math.floor(J[C]+0.000001)),U=Math.min(U,Math.floor(J[C+1]+0.000001));G-=w,Y-=U;for(let C=Q;C<H;C+=2)J[C]=(J[C]+G)*W,J[C+1]=(J[C+1]+Y)*z}};f2.BATCHABLE_SIZE=100;var d4=f2;class P5{constructor(){this.color=16777215,this.alpha=1,this.texture=b.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let $=new P5;return $.color=this.color,$.alpha=this.alpha,$.texture=this.texture,$.matrix=this.matrix,$.visible=this.visible,$}reset(){this.color=16777215,this.alpha=1,this.texture=b.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class T9 extends P5{constructor(){super(...arguments),this.width=0,this.alignment=0.5,this.native=!1,this.cap=c1.BUTT,this.join=Z1.MITER,this.miterLimit=10}clone(){let $=new T9;return $.color=this.color,$.alpha=this.alpha,$.texture=this.texture,$.matrix=this.matrix,$.visible=this.visible,$.width=this.width,$.alignment=this.alignment,$.native=this.native,$.cap=this.cap,$.join=this.join,$.miterLimit=this.miterLimit,$}reset(){super.reset(),this.color=0,this.alignment=0.5,this.width=0,this.native=!1,this.cap=c1.BUTT,this.join=Z1.MITER,this.miterLimit=10}}var p4={},l4=class $ extends i{constructor(J=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new P5,this._lineStyle=new T9,this._matrix=null,this._holeMode=!1,this.state=g0.for2d(),this._geometry=J||new d4,this._geometry.refCount++,this._transformID=-1,this._tintColor=new r(16777215),this.blendMode=s.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new $(this._geometry)}set blendMode(J){this.state.blendMode=J}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(J){this._tintColor.setValue(J)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(J=null,Z=0,Q,q=0.5,K=!1){return typeof J=="number"&&(J={width:J,color:Z,alpha:Q,alignment:q,native:K}),this.lineTextureStyle(J)}lineTextureStyle(J){let Z={width:0,texture:b.WHITE,color:J?.texture?16777215:0,matrix:null,alignment:0.5,native:!1,cap:c1.BUTT,join:Z1.MITER,miterLimit:10};J=Object.assign(Z,J),this.normalizeColor(J),this.currentPath&&this.startPoly();let Q=J.width>0&&J.alpha>0;return Q?(J.matrix&&(J.matrix=J.matrix.clone(),J.matrix.invert()),Object.assign(this._lineStyle,{visible:Q},J)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let J=this.currentPath.points,Z=this.currentPath.points.length;Z>2&&(this.drawShape(this.currentPath),this.currentPath=new q8,this.currentPath.closeStroke=!1,this.currentPath.points.push(J[Z-2],J[Z-1]))}else this.currentPath=new q8,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(J,Z){return this.startPoly(),this.currentPath.points[0]=J,this.currentPath.points[1]=Z,this}lineTo(J,Z){this.currentPath||this.moveTo(0,0);let Q=this.currentPath.points,q=Q[Q.length-2],K=Q[Q.length-1];return(q!==J||K!==Z)&&Q.push(J,Z),this}_initCurve(J=0,Z=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[J,Z]):this.moveTo(J,Z)}quadraticCurveTo(J,Z,Q,q){this._initCurve();let K=this.currentPath.points;return K.length===0&&this.moveTo(0,0),H6.curveTo(J,Z,Q,q,K),this}bezierCurveTo(J,Z,Q,q,K,V){return this._initCurve(),V6.curveTo(J,Z,Q,q,K,V,this.currentPath.points),this}arcTo(J,Z,Q,q,K){this._initCurve(J,Z);let V=this.currentPath.points,H=K6.curveTo(J,Z,Q,q,K,V);if(H){let{cx:X,cy:W,radius:z,startAngle:G,endAngle:Y,anticlockwise:w}=H;this.arc(X,W,z,G,Y,w)}return this}arc(J,Z,Q,q,K,V=!1){if(q===K)return this;if(!V&&K<=q?K+=y8:V&&q<=K&&(q+=y8),K-q===0)return this;let H=J+Math.cos(q)*Q,X=Z+Math.sin(q)*Q,W=this._geometry.closePointEps,z=this.currentPath?this.currentPath.points:null;if(z){let G=Math.abs(z[z.length-2]-H),Y=Math.abs(z[z.length-1]-X);G<W&&Y<W||z.push(H,X)}else this.moveTo(H,X),z=this.currentPath.points;return K6.arc(H,X,J,Z,Q,q,K,V,z),this}beginFill(J=0,Z){return this.beginTextureFill({texture:b.WHITE,color:J,alpha:Z})}normalizeColor(J){let Z=r.shared.setValue(J.color??0);J.color=Z.toNumber(),J.alpha??(J.alpha=Z.alpha)}beginTextureFill(J){let Z={texture:b.WHITE,color:16777215,matrix:null};J=Object.assign(Z,J),this.normalizeColor(J),this.currentPath&&this.startPoly();let Q=J.alpha>0;return Q?(J.matrix&&(J.matrix=J.matrix.clone(),J.matrix.invert()),Object.assign(this._fillStyle,{visible:Q},J)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(J,Z,Q,q){return this.drawShape(new y(J,Z,Q,q))}drawRoundedRect(J,Z,Q,q,K){return this.drawShape(new c5(J,Z,Q,q,K))}drawCircle(J,Z,Q){return this.drawShape(new g5(J,Z,Q))}drawEllipse(J,Z,Q,q){return this.drawShape(new x5(J,Z,Q,q))}drawPolygon(...J){let Z,Q=!0,q=J[0];q.points?(Q=q.closeStroke,Z=q.points):Array.isArray(J[0])?Z=J[0]:Z=J;let K=new q8(Z);return K.closeStroke=Q,this.drawShape(K),this}drawShape(J){return this._holeMode?this._geometry.drawHole(J,this._matrix):this._geometry.drawShape(J,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let J=this._geometry.graphicsData;return J.length===1&&J[0].shape.type===z0.RECT&&!J[0].matrix&&!J[0].holes.length&&!(J[0].lineStyle.visible&&J[0].lineStyle.width)}_render(J){this.finishPoly();let Z=this._geometry;Z.updateBatches(),Z.batchable?(this.batchDirty!==Z.batchDirty&&this._populateBatches(),this._renderBatched(J)):(J.batch.flush(),this._renderDirect(J))}_populateBatches(){let J=this._geometry,Z=this.blendMode,Q=J.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=J.batchDirty,this.batches.length=Q,this.vertexData=new Float32Array(J.points);for(let q=0;q<Q;q++){let K=J.batches[q],V=K.style.color,H=new Float32Array(this.vertexData.buffer,K.attribStart*4*2,K.attribSize*2),X=new Float32Array(J.uvsFloat32.buffer,K.attribStart*4*2,K.attribSize*2),W=new Uint16Array(J.indicesUint16.buffer,K.start*2,K.size),z={vertexData:H,blendMode:Z,indices:W,uvs:X,_batchRGB:r.shared.setValue(V).toRgbArray(),_tintRGB:V,_texture:K.style.texture,alpha:K.style.alpha,worldAlpha:1};this.batches[q]=z}}_renderBatched(J){if(this.batches.length){J.batch.setObjectRenderer(J.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let Z=0,Q=this.batches.length;Z<Q;Z++){let q=this.batches[Z];q.worldAlpha=this.worldAlpha*q.alpha,J.plugins[this.pluginName].render(q)}}}_renderDirect(J){let Z=this._resolveDirectShader(J),Q=this._geometry,q=this.worldAlpha,K=Z.uniforms,V=Q.drawCalls;K.translationMatrix=this.transform.worldTransform,r.shared.setValue(this._tintColor).premultiply(q).toArray(K.tint),J.shader.bind(Z),J.geometry.bind(Q,Z),J.state.set(this.state);for(let H=0,X=V.length;H<X;H++)this._renderDrawCallDirect(J,Q.drawCalls[H])}_renderDrawCallDirect(J,Z){let{texArray:Q,type:q,size:K,start:V}=Z,H=Q.count;for(let X=0;X<H;X++)J.texture.bind(Q.elements[X],X);J.geometry.draw(q,K,V)}_resolveDirectShader(J){let Z=this.shader,Q=this.pluginName;if(!Z){if(!p4[Q]){let{maxTextures:q}=J.plugins[Q],K=new Int32Array(q);for(let X=0;X<q;X++)K[X]=X;let V={tint:new Float32Array([1,1,1,1]),translationMatrix:new $0,default:o0.from({uSamplers:K},!0)},H=J.plugins[Q]._shader.program;p4[Q]=new s0(H,V)}Z=p4[Q]}return Z}_calculateBounds(){this.finishPoly();let J=this._geometry;if(!J.graphicsData.length)return;let{minX:Z,minY:Q,maxX:q,maxY:K}=J.bounds;this._bounds.addFrame(this.transform,Z,Q,q,K)}containsPoint(J){return this.worldTransform.applyInverse(J,$._TEMP_POINT),this._geometry.containsPoint($._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let J=0;J<this.batches.length;J++){let Z=this.batches[J];Z._tintRGB=r.shared.setValue(this._tintColor).multiply(Z._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let J=this.transform._worldID;if(this._transformID===J)return;this._transformID=J;let Z=this.transform.worldTransform,Q=Z.a,q=Z.b,K=Z.c,V=Z.d,H=Z.tx,X=Z.ty,W=this._geometry.points,z=this.vertexData,G=0;for(let Y=0;Y<W.length;Y+=2){let w=W[Y],U=W[Y+1];z[G++]=Q*w+K*U+H,z[G++]=V*U+q*w+X}}closePath(){let J=this.currentPath;return J&&(J.closeStroke=!0,this.finishPoly()),this}setMatrix(J){return this._matrix=J,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(J){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(J)}};l4.curves=m1,l4._TEMP_POINT=new d;var t1=l4;class I7{constructor($,J){this.uvBuffer=$,this.uvMatrix=J,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update($){if(!$&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;let J=this.uvBuffer.data;(!this.data||this.data.length!==J.length)&&(this.data=new Float32Array(J.length)),this.uvMatrix.multiplyUvs(J,this.data),this._updateID++}}var n4=new d,v2=new q8,y2=class $ extends i{constructor(J,Z,Q,q=B1.TRIANGLES){super(),this.geometry=J,this.shader=Z,this.state=Q||g0.for2d(),this.drawMode=q,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=_.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(J){this._geometry!==J&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=J,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(J){this.shader=J}get material(){return this.shader}set blendMode(J){this.state.blendMode=J}get blendMode(){return this.state.blendMode}set roundPixels(J){this._roundPixels!==J&&(this._transformID=-1),this._roundPixels=J}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(J){this.shader.tint=J}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(J){this.shader.texture=J}_render(J){let Z=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===B1.TRIANGLES&&Z.length<$.BATCHABLE_SIZE*2?this._renderToBatch(J):this._renderDefault(J)}_renderDefault(J){let Z=this.shader;Z.alpha=this.worldAlpha,Z.update&&Z.update(),J.batch.flush(),Z.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),J.shader.bind(Z),J.state.set(this.state),J.geometry.bind(this.geometry,Z),J.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(J){let Z=this.geometry,Q=this.shader;Q.uvMatrix&&(Q.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=Z.indexBuffer.data,this._tintRGB=Q._tintRGB,this._texture=Q.texture;let q=this.material.pluginName;J.batch.setObjectRenderer(J.plugins[q]),J.plugins[q].render(this)}calculateVertices(){let J=this.geometry.buffers[0],Z=J.data,Q=J._updateID;if(Q===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==Z.length&&(this.vertexData=new Float32Array(Z.length));let q=this.transform.worldTransform,K=q.a,V=q.b,H=q.c,X=q.d,W=q.tx,z=q.ty,G=this.vertexData;for(let Y=0;Y<G.length/2;Y++){let w=Z[Y*2],U=Z[Y*2+1];G[Y*2]=K*w+H*U+W,G[Y*2+1]=V*w+X*U+z}if(this._roundPixels){let Y=_.RESOLUTION;for(let w=0;w<G.length;++w)G[w]=Math.round(G[w]*Y)/Y}this.vertexDirty=Q}calculateUvs(){let J=this.geometry.buffers[1],Z=this.shader;Z.uvMatrix.isSimple?this.uvs=J.data:(this.batchUvs||(this.batchUvs=new I7(J,Z.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(J){if(!this.getBounds().contains(J.x,J.y))return!1;this.worldTransform.applyInverse(J,n4);let Z=this.geometry.getBuffer("aVertexPosition").data,Q=v2.points,q=this.geometry.getIndex().data,K=q.length,V=this.drawMode===4?3:1;for(let H=0;H+2<K;H+=V){let X=q[H]*2,W=q[H+1]*2,z=q[H+2]*2;if(Q[0]=Z[X],Q[1]=Z[X+1],Q[2]=Z[W],Q[3]=Z[W+1],Q[4]=Z[z],Q[5]=Z[z+1],v2.contains(n4.x,n4.y))return!0}return!1}destroy(J){super.destroy(J),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};y2.BATCHABLE_SIZE=100;var D5=y2;class L5 extends O1{constructor($,J,Z){super();let Q=new W0($),q=new W0(J,!0),K=new W0(Z,!0,!0);this.addAttribute("aVertexPosition",Q,2,!1,p.FLOAT).addAttribute("aTextureCoord",q,2,!1,p.FLOAT).addIndex(K),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var g2=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`;var x2=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class a8 extends s0{constructor($,J){let Z={uSampler:$,alpha:1,uTextureMatrix:$0.IDENTITY,uColor:new Float32Array([1,1,1,1])};J=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},J),J.uniforms&&Object.assign(Z,J.uniforms),super(J.program||J1.from(x2,g2),Z),this._colorDirty=!1,this.uvMatrix=new p8($),this.batchable=J.program===void 0,this.pluginName=J.pluginName,this._tintColor=new r(J.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=J.alpha}get texture(){return this.uniforms.uSampler}set texture($){this.uniforms.uSampler!==$&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!$.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=$,this.uvMatrix.texture=$)}set alpha($){$!==this._alpha&&(this._alpha=$,this._colorDirty=!0)}get alpha(){return this._alpha}set tint($){$!==this.tint&&(this._tintColor.setValue($),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;let $=this.texture.baseTexture.alphaMode;r.shared.setValue(this._tintColor).premultiply(this._alpha,$).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class F7{constructor($,J,Z){this.geometry=new O1,this.indexBuffer=null,this.size=Z,this.dynamicProperties=[],this.staticProperties=[];for(let Q=0;Q<$.length;++Q){let q=$[Q];q={attributeName:q.attributeName,size:q.size,uploadFunction:q.uploadFunction,type:q.type||p.FLOAT,offset:q.offset},J[Q]?this.dynamicProperties.push(q):this.staticProperties.push(q)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){let $=this.geometry,J=0;this.indexBuffer=new W0(R.createIndicesForQuads(this.size),!0,!0),$.addIndex(this.indexBuffer),this.dynamicStride=0;for(let K=0;K<this.dynamicProperties.length;++K){let V=this.dynamicProperties[K];V.offset=J,J+=V.size,this.dynamicStride+=V.size}let Z=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(Z),this.dynamicDataUint32=new Uint32Array(Z),this.dynamicBuffer=new W0(this.dynamicData,!1,!1);let Q=0;this.staticStride=0;for(let K=0;K<this.staticProperties.length;++K){let V=this.staticProperties[K];V.offset=Q,Q+=V.size,this.staticStride+=V.size}let q=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(q),this.staticDataUint32=new Uint32Array(q),this.staticBuffer=new W0(this.staticData,!0,!1);for(let K=0;K<this.dynamicProperties.length;++K){let V=this.dynamicProperties[K];$.addAttribute(V.attributeName,this.dynamicBuffer,0,V.type===p.UNSIGNED_BYTE,V.type,this.dynamicStride*4,V.offset*4)}for(let K=0;K<this.staticProperties.length;++K){let V=this.staticProperties[K];$.addAttribute(V.attributeName,this.staticBuffer,0,V.type===p.UNSIGNED_BYTE,V.type,this.staticStride*4,V.offset*4)}}uploadDynamic($,J,Z){for(let Q=0;Q<this.dynamicProperties.length;Q++){let q=this.dynamicProperties[Q];q.uploadFunction($,J,Z,q.type===p.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,q.offset)}this.dynamicBuffer._updateID++}uploadStatic($,J,Z){for(let Q=0;Q<this.staticProperties.length;Q++){let q=this.staticProperties[Q];q.uploadFunction($,J,Z,q.type===p.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,q.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var c2=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`;var m2=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class O7 extends X8{constructor($){super($),this.shader=null,this.properties=null,this.tempMatrix=new $0,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:p.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=s0.from(m2,c2,{}),this.state=g0.for2d()}render($){let{children:J,_maxSize:Z,_batchSize:Q}=$,q=this.renderer,K=J.length;if(K===0)return;K>Z&&!$.autoResize&&(K=Z);let V=$._buffers;V||(V=$._buffers=this.generateBuffers($));let H=J[0]._texture.baseTexture,X=H.alphaMode>0;this.state.blendMode=R.correctBlendMode($.blendMode,X),q.state.set(this.state);let W=q.gl,z=$.worldTransform.copyTo(this.tempMatrix);z.prepend(q.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=z.toArray(!0),this.shader.uniforms.uColor=r.shared.setValue($.tintRgb).premultiply($.worldAlpha,X).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=H,this.renderer.shader.bind(this.shader);let G=!1;for(let Y=0,w=0;Y<K;Y+=Q,w+=1){let U=K-Y;U>Q&&(U=Q),w>=V.length&&V.push(this._generateOneMoreBuffer($));let C=V[w];C.uploadDynamic(J,Y,U);let N=$._bufferUpdateIDs[w]||0;G=G||C._updateID<N,G&&(C._updateID=$._updateID,C.uploadStatic(J,Y,U)),q.geometry.bind(C.geometry),W.drawElements(W.TRIANGLES,U*6,W.UNSIGNED_SHORT,0)}}generateBuffers($){let J=[],Z=$._maxSize,Q=$._batchSize,q=$._properties;for(let K=0;K<Z;K+=Q)J.push(new F7(this.properties,q,Q));return J}_generateOneMoreBuffer($){let{_batchSize:J,_properties:Z}=$;return new F7(this.properties,Z,J)}uploadVertices($,J,Z,Q,q,K){let V=0,H=0,X=0,W=0;for(let z=0;z<Z;++z){let G=$[J+z],Y=G._texture,w=G.scale.x,U=G.scale.y,C=Y.trim,N=Y.orig;C?(H=C.x-G.anchor.x*N.width,V=H+C.width,W=C.y-G.anchor.y*N.height,X=W+C.height):(V=N.width*(1-G.anchor.x),H=N.width*-G.anchor.x,X=N.height*(1-G.anchor.y),W=N.height*-G.anchor.y),Q[K]=H*w,Q[K+1]=W*U,Q[K+q]=V*w,Q[K+q+1]=W*U,Q[K+q*2]=V*w,Q[K+q*2+1]=X*U,Q[K+q*3]=H*w,Q[K+q*3+1]=X*U,K+=q*4}}uploadPosition($,J,Z,Q,q,K){for(let V=0;V<Z;V++){let H=$[J+V].position;Q[K]=H.x,Q[K+1]=H.y,Q[K+q]=H.x,Q[K+q+1]=H.y,Q[K+q*2]=H.x,Q[K+q*2+1]=H.y,Q[K+q*3]=H.x,Q[K+q*3+1]=H.y,K+=q*4}}uploadRotation($,J,Z,Q,q,K){for(let V=0;V<Z;V++){let H=$[J+V].rotation;Q[K]=H,Q[K+q]=H,Q[K+q*2]=H,Q[K+q*3]=H,K+=q*4}}uploadUvs($,J,Z,Q,q,K){for(let V=0;V<Z;++V){let H=$[J+V]._texture._uvs;H?(Q[K]=H.x0,Q[K+1]=H.y0,Q[K+q]=H.x1,Q[K+q+1]=H.y1,Q[K+q*2]=H.x2,Q[K+q*2+1]=H.y2,Q[K+q*3]=H.x3,Q[K+q*3+1]=H.y3,K+=q*4):(Q[K]=0,Q[K+1]=0,Q[K+q]=0,Q[K+q+1]=0,Q[K+q*2]=0,Q[K+q*2+1]=0,Q[K+q*3]=0,Q[K+q*3+1]=0,K+=q*4)}}uploadTint($,J,Z,Q,q,K){for(let V=0;V<Z;++V){let H=$[J+V],X=r.shared.setValue(H._tintRGB).toPremultiplied(H.alpha,H.texture.baseTexture.alphaMode>0);Q[K]=X,Q[K+q]=X,Q[K+q*2]=X,Q[K+q*3]=X,K+=q*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}O7.extension={name:"particle",type:j.RendererPlugin};D.add(O7);var r8=(($)=>($[$.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",$[$.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",$))(r8||{});var j7={willReadFrequently:!0},U8=class ${static get experimentalLetterSpacingSupported(){let J=$._experimentalLetterSpacingSupported;if(J!==void 0){let Z=_.ADAPTER.getCanvasRenderingContext2D().prototype;J=$._experimentalLetterSpacingSupported="letterSpacing"in Z||"textLetterSpacing"in Z}return J}constructor(J,Z,Q,q,K,V,H,X,W){this.text=J,this.style=Z,this.width=Q,this.height=q,this.lines=K,this.lineWidths=V,this.lineHeight=H,this.maxLineWidth=X,this.fontProperties=W}static measureText(J,Z,Q,q=$._canvas){Q=Q??Z.wordWrap;let K=Z.toFontString(),V=$.measureFont(K);V.fontSize===0&&(V.fontSize=Z.fontSize,V.ascent=Z.fontSize);let H=q.getContext("2d",j7);H.font=K;let X=(Q?$.wordWrap(J,Z,q):J).split(/(?:\r\n|\r|\n)/),W=new Array(X.length),z=0;for(let U=0;U<X.length;U++){let C=$._measureText(X[U],Z.letterSpacing,H);W[U]=C,z=Math.max(z,C)}let G=z+Z.strokeThickness;Z.dropShadow&&(G+=Z.dropShadowDistance);let Y=Z.lineHeight||V.fontSize+Z.strokeThickness,w=Math.max(Y,V.fontSize+Z.strokeThickness*2)+Z.leading+(X.length-1)*(Y+Z.leading);return Z.dropShadow&&(w+=Z.dropShadowDistance),new $(J,Z,G,w,X,W,Y+Z.leading,z,V)}static _measureText(J,Z,Q){let q=!1;$.experimentalLetterSpacingSupported&&($.experimentalLetterSpacing?(Q.letterSpacing=`${Z}px`,Q.textLetterSpacing=`${Z}px`,q=!0):(Q.letterSpacing="0px",Q.textLetterSpacing="0px"));let K=Q.measureText(J).width;return K>0&&(q?K-=Z:K+=($.graphemeSegmenter(J).length-1)*Z),K}static wordWrap(J,Z,Q=$._canvas){let q=Q.getContext("2d",j7),K=0,V="",H="",X=Object.create(null),{letterSpacing:W,whiteSpace:z}=Z,G=$.collapseSpaces(z),Y=$.collapseNewlines(z),w=!G,U=Z.wordWrapWidth+W,C=$.tokenize(J);for(let N=0;N<C.length;N++){let O=C[N];if($.isNewline(O)){if(!Y){H+=$.addLine(V),w=!G,V="",K=0;continue}O=" "}if(G){let B=$.isBreakingSpace(O),F=$.isBreakingSpace(V[V.length-1]);if(B&&F)continue}let I=$.getFromCache(O,W,X,q);if(I>U)if(V!==""&&(H+=$.addLine(V),V="",K=0),$.canBreakWords(O,Z.breakWords)){let B=$.wordWrapSplit(O);for(let F=0;F<B.length;F++){let P=B[F],L=P,M=1;for(;B[F+M];){let g=B[F+M];if(!$.canBreakChars(L,g,O,F,Z.breakWords))P+=g;else break;L=g,M++}F+=M-1;let E=$.getFromCache(P,W,X,q);E+K>U&&(H+=$.addLine(V),w=!1,V="",K=0),V+=P,K+=E}}else{V.length>0&&(H+=$.addLine(V),V="",K=0);let B=N===C.length-1;H+=$.addLine(O,!B),w=!1,V="",K=0}else I+K>U&&(w=!1,H+=$.addLine(V),V="",K=0),(V.length>0||!$.isBreakingSpace(O)||w)&&(V+=O,K+=I)}return H+=$.addLine(V,!1),H}static addLine(J,Z=!0){return J=$.trimRight(J),J=Z?`${J}
`:J,J}static getFromCache(J,Z,Q,q){let K=Q[J];return typeof K!="number"&&(K=$._measureText(J,Z,q)+Z,Q[J]=K),K}static collapseSpaces(J){return J==="normal"||J==="pre-line"}static collapseNewlines(J){return J==="normal"}static trimRight(J){if(typeof J!="string")return"";for(let Z=J.length-1;Z>=0;Z--){let Q=J[Z];if(!$.isBreakingSpace(Q))break;J=J.slice(0,-1)}return J}static isNewline(J){return typeof J!="string"?!1:$._newlines.includes(J.charCodeAt(0))}static isBreakingSpace(J,Z){return typeof J!="string"?!1:$._breakingSpaces.includes(J.charCodeAt(0))}static tokenize(J){let Z=[],Q="";if(typeof J!="string")return Z;for(let q=0;q<J.length;q++){let K=J[q],V=J[q+1];if($.isBreakingSpace(K,V)||$.isNewline(K)){Q!==""&&(Z.push(Q),Q=""),Z.push(K);continue}Q+=K}return Q!==""&&Z.push(Q),Z}static canBreakWords(J,Z){return Z}static canBreakChars(J,Z,Q,q,K){return!0}static wordWrapSplit(J){return $.graphemeSegmenter(J)}static measureFont(J){if($._fonts[J])return $._fonts[J];let Z={ascent:0,descent:0,fontSize:0},Q=$._canvas,q=$._context;q.font=J;let K=$.METRICS_STRING+$.BASELINE_SYMBOL,V=Math.ceil(q.measureText(K).width),H=Math.ceil(q.measureText($.BASELINE_SYMBOL).width),X=Math.ceil($.HEIGHT_MULTIPLIER*H);if(H=H*$.BASELINE_MULTIPLIER|0,V===0||X===0)return $._fonts[J]=Z,Z;Q.width=V,Q.height=X,q.fillStyle="#f00",q.fillRect(0,0,V,X),q.font=J,q.textBaseline="alphabetic",q.fillStyle="#000",q.fillText(K,0,H);let W=q.getImageData(0,0,V,X).data,z=W.length,G=V*4,Y=0,w=0,U=!1;for(Y=0;Y<H;++Y){for(let C=0;C<G;C+=4)if(W[w+C]!==255){U=!0;break}if(!U)w+=G;else break}for(Z.ascent=H-Y,w=z-G,U=!1,Y=X;Y>H;--Y){for(let C=0;C<G;C+=4)if(W[w+C]!==255){U=!0;break}if(!U)w-=G;else break}return Z.descent=Y-H,Z.fontSize=Z.ascent+Z.descent,$._fonts[J]=Z,Z}static clearMetrics(J=""){J?delete $._fonts[J]:$._fonts={}}static get _canvas(){if(!$.__canvas){let J;try{let Z=new OffscreenCanvas(0,0);if(Z.getContext("2d",j7)?.measureText)return $.__canvas=Z,Z;J=_.ADAPTER.createCanvas()}catch{J=_.ADAPTER.createCanvas()}J.width=J.height=10,$.__canvas=J}return $.__canvas}static get _context(){return $.__context||($.__context=$._canvas.getContext("2d",j7)),$.__context}};U8.METRICS_STRING="|q",U8.BASELINE_SYMBOL="M",U8.BASELINE_MULTIPLIER=1.4,U8.HEIGHT_MULTIPLIER=2,U8.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){let $=new Intl.Segmenter;return(J)=>[...$.segment(J)].map((Z)=>Z.segment)}return($)=>[...$]})(),U8.experimentalLetterSpacing=!1,U8._fonts={},U8._newlines=[10,13],U8._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var u1=U8;var NC=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],u2=class ${constructor(J){this.styleID=0,this.reset(),s4(this,J,J)}clone(){let J={};return s4(J,this,$.defaultStyle),new $(J)}reset(){s4(this,$.defaultStyle,$.defaultStyle)}get align(){return this._align}set align(J){this._align!==J&&(this._align=J,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(J){this._breakWords!==J&&(this._breakWords=J,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(J){this._dropShadow!==J&&(this._dropShadow=J,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(J){this._dropShadowAlpha!==J&&(this._dropShadowAlpha=J,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(J){this._dropShadowAngle!==J&&(this._dropShadowAngle=J,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(J){this._dropShadowBlur!==J&&(this._dropShadowBlur=J,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(J){let Z=o4(J);this._dropShadowColor!==Z&&(this._dropShadowColor=Z,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(J){this._dropShadowDistance!==J&&(this._dropShadowDistance=J,this.styleID++)}get fill(){return this._fill}set fill(J){let Z=o4(J);this._fill!==Z&&(this._fill=Z,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(J){this._fillGradientType!==J&&(this._fillGradientType=J,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(J){BC(this._fillGradientStops,J)||(this._fillGradientStops=J,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(J){this.fontFamily!==J&&(this._fontFamily=J,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(J){this._fontSize!==J&&(this._fontSize=J,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(J){this._fontStyle!==J&&(this._fontStyle=J,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(J){this._fontVariant!==J&&(this._fontVariant=J,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(J){this._fontWeight!==J&&(this._fontWeight=J,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(J){this._letterSpacing!==J&&(this._letterSpacing=J,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(J){this._lineHeight!==J&&(this._lineHeight=J,this.styleID++)}get leading(){return this._leading}set leading(J){this._leading!==J&&(this._leading=J,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(J){this._lineJoin!==J&&(this._lineJoin=J,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(J){this._miterLimit!==J&&(this._miterLimit=J,this.styleID++)}get padding(){return this._padding}set padding(J){this._padding!==J&&(this._padding=J,this.styleID++)}get stroke(){return this._stroke}set stroke(J){let Z=o4(J);this._stroke!==Z&&(this._stroke=Z,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(J){this._strokeThickness!==J&&(this._strokeThickness=J,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(J){this._textBaseline!==J&&(this._textBaseline=J,this.styleID++)}get trim(){return this._trim}set trim(J){this._trim!==J&&(this._trim=J,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(J){this._whiteSpace!==J&&(this._whiteSpace=J,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(J){this._wordWrap!==J&&(this._wordWrap=J,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(J){this._wordWrapWidth!==J&&(this._wordWrapWidth=J,this.styleID++)}toFontString(){let J=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize,Z=this.fontFamily;Array.isArray(this.fontFamily)||(Z=this.fontFamily.split(","));for(let Q=Z.length-1;Q>=0;Q--){let q=Z[Q].trim();!/([\"\'])[^\'\"]+\1/.test(q)&&!NC.includes(q)&&(q=`"${q}"`),Z[Q]=q}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${J} ${Z.join(",")}`}};u2.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:r8.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};var _1=u2;function o4($){let J=r.shared,Z=(Q)=>{let q=J.setValue(Q);return q.alpha===1?q.toHex():q.toRgbaString()};return Array.isArray($)?$.map(Z):Z($)}function BC($,J){if(!Array.isArray($)||!Array.isArray(J)||$.length!==J.length)return!1;for(let Z=0;Z<$.length;++Z)if($[Z]!==J[Z])return!1;return!0}function s4($,J,Z){for(let Q in Z)Array.isArray(J[Q])?$[Q]=J[Q].slice():$[Q]=J[Q]}var IC={texture:!0,children:!1,baseTexture:!0},d2=class $ extends h0{constructor(J,Z,Q){let q=!1;Q||(Q=_.ADAPTER.createCanvas(),q=!0),Q.width=3,Q.height=3;let K=b.from(Q);K.orig=new y,K.trim=new y,super(K),this._ownCanvas=q,this.canvas=Q,this.context=Q.getContext("2d",{willReadFrequently:!0}),this._resolution=$.defaultResolution??_.RESOLUTION,this._autoResolution=$.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=J,this.style=Z,this.localStyleID=-1}static get experimentalLetterSpacing(){return u1.experimentalLetterSpacing}static set experimentalLetterSpacing(J){R.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),u1.experimentalLetterSpacing=J}updateText(J){let Z=this._style;if(this.localStyleID!==Z.styleID&&(this.dirty=!0,this.localStyleID=Z.styleID),!this.dirty&&J)return;this._font=this._style.toFontString();let Q=this.context,q=u1.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),K=q.width,V=q.height,H=q.lines,X=q.lineHeight,W=q.lineWidths,z=q.maxLineWidth,G=q.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,K)+Z.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,V)+Z.padding*2)*this._resolution),Q.scale(this._resolution,this._resolution),Q.clearRect(0,0,this.canvas.width,this.canvas.height),Q.font=this._font,Q.lineWidth=Z.strokeThickness,Q.textBaseline=Z.textBaseline,Q.lineJoin=Z.lineJoin,Q.miterLimit=Z.miterLimit;let Y,w,U=Z.dropShadow?2:1;for(let C=0;C<U;++C){let N=Z.dropShadow&&C===0,O=N?Math.ceil(Math.max(1,V)+Z.padding*2):0,I=O*this._resolution;if(N){Q.fillStyle="black",Q.strokeStyle="black";let F=Z.dropShadowColor,P=Z.dropShadowBlur*this._resolution,L=Z.dropShadowDistance*this._resolution;Q.shadowColor=r.shared.setValue(F).setAlpha(Z.dropShadowAlpha).toRgbaString(),Q.shadowBlur=P,Q.shadowOffsetX=Math.cos(Z.dropShadowAngle)*L,Q.shadowOffsetY=Math.sin(Z.dropShadowAngle)*L+I}else Q.fillStyle=this._generateFillStyle(Z,H,q),Q.strokeStyle=Z.stroke,Q.shadowColor="black",Q.shadowBlur=0,Q.shadowOffsetX=0,Q.shadowOffsetY=0;let B=(X-G.fontSize)/2;X-G.fontSize<0&&(B=0);for(let F=0;F<H.length;F++)Y=Z.strokeThickness/2,w=Z.strokeThickness/2+F*X+G.ascent+B,Z.align==="right"?Y+=z-W[F]:Z.align==="center"&&(Y+=(z-W[F])/2),Z.stroke&&Z.strokeThickness&&this.drawLetterSpacing(H[F],Y+Z.padding,w+Z.padding-O,!0),Z.fill&&this.drawLetterSpacing(H[F],Y+Z.padding,w+Z.padding-O)}this.updateTexture()}drawLetterSpacing(J,Z,Q,q=!1){let K=this._style.letterSpacing,V=!1;if(u1.experimentalLetterSpacingSupported&&(u1.experimentalLetterSpacing?(this.context.letterSpacing=`${K}px`,this.context.textLetterSpacing=`${K}px`,V=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),K===0||V){q?this.context.strokeText(J,Z,Q):this.context.fillText(J,Z,Q);return}let H=Z,X=u1.graphemeSegmenter(J),W=this.context.measureText(J).width,z=0;for(let G=0;G<X.length;++G){let Y=X[G];q?this.context.strokeText(Y,H,Q):this.context.fillText(Y,H,Q);let w="";for(let U=G+1;U<X.length;++U)w+=X[U];z=this.context.measureText(w).width,H+=W-z+K,W=z}}updateTexture(){let J=this.canvas;if(this._style.trim){let V=R.trimCanvas(J);V.data&&(J.width=V.width,J.height=V.height,this.context.putImageData(V.data,0,0))}let Z=this._texture,Q=this._style,q=Q.trim?0:Q.padding,K=Z.baseTexture;Z.trim.width=Z._frame.width=J.width/this._resolution,Z.trim.height=Z._frame.height=J.height/this._resolution,Z.trim.x=-q,Z.trim.y=-q,Z.orig.width=Z._frame.width-q*2,Z.orig.height=Z._frame.height-q*2,this._onTextureUpdate(),K.setRealSize(J.width,J.height,this._resolution),Z.updateUvs(),this.dirty=!1}_render(J){this._autoResolution&&this._resolution!==J.resolution&&(this._resolution=J.resolution,this.dirty=!0),this.updateText(!0),super._render(J)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(J,Z){return this.updateText(!0),this._textureID===-1&&(J=!1),super.getBounds(J,Z)}getLocalBounds(J){return this.updateText(!0),super.getLocalBounds.call(this,J)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(J,Z,Q){let q=J.fill;if(Array.isArray(q)){if(q.length===1)return q[0]}else return q;let K,V=J.dropShadow?J.dropShadowDistance:0,H=J.padding||0,X=this.canvas.width/this._resolution-V-H*2,W=this.canvas.height/this._resolution-V-H*2,z=q.slice(),G=J.fillGradientStops.slice();if(!G.length){let Y=z.length+1;for(let w=1;w<Y;++w)G.push(w/Y)}if(z.unshift(q[0]),G.unshift(0),z.push(q[q.length-1]),G.push(1),J.fillGradientType===r8.LINEAR_VERTICAL){K=this.context.createLinearGradient(X/2,H,X/2,W+H);let Y=Q.fontProperties.fontSize+J.strokeThickness;for(let w=0;w<Z.length;w++){let U=Q.lineHeight*(w-1)+Y,C=Q.lineHeight*w,N=C;w>0&&U>C&&(N=(C+U)/2);let O=C+Y,I=Q.lineHeight*(w+1),B=O;w+1<Z.length&&I<O&&(B=(O+I)/2);let F=(B-N)/W;for(let P=0;P<z.length;P++){let L=0;typeof G[P]=="number"?L=G[P]:L=P/z.length;let M=Math.min(1,Math.max(0,N/W+L*F));M=Number(M.toFixed(5)),K.addColorStop(M,z[P])}}}else{K=this.context.createLinearGradient(H,W/2,X+H,W/2);let Y=z.length+1,w=1;for(let U=0;U<z.length;U++){let C;typeof G[U]=="number"?C=G[U]:C=w/Y,K.addColorStop(C,z[U]),w++}}return K}destroy(J){typeof J=="boolean"&&(J={children:J}),J=Object.assign({},IC,J),super.destroy(J),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(J){this.updateText(!0);let Z=R.sign(this.scale.x)||1;this.scale.x=Z*J/this._texture.orig.width,this._width=J}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(J){this.updateText(!0);let Z=R.sign(this.scale.y)||1;this.scale.y=Z*J/this._texture.orig.height,this._height=J}get style(){return this._style}set style(J){J=J||{},J instanceof _1?this._style=J:this._style=new _1(J),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(J){J=String(J??""),this._text!==J&&(this._text=J,this.dirty=!0)}get resolution(){return this._resolution}set resolution(J){this._autoResolution=!1,this._resolution!==J&&(this._resolution=J,this.dirty=!0)}};d2.defaultAutoResolution=!0;var d1=d2;class _7{constructor($){this.maxItemsPerFrame=$,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function FC($,J){let Z=!1;if($?._textures?.length){for(let Q=0;Q<$._textures.length;Q++)if($._textures[Q]instanceof b){let q=$._textures[Q].baseTexture;J.includes(q)||(J.push(q),Z=!0)}}return Z}function OC($,J){if($.baseTexture instanceof l){let Z=$.baseTexture;return J.includes(Z)||J.push(Z),!0}return!1}function jC($,J){if($._texture&&$._texture instanceof b){let Z=$._texture.baseTexture;return J.includes(Z)||J.push(Z),!0}return!1}function _C($,J){return J instanceof d1?(J.updateText(!0),!0):!1}function PC($,J){if(J instanceof _1){let Z=J.toFontString();return u1.measureFont(Z),!0}return!1}function DC($,J){if($ instanceof d1){J.includes($.style)||J.push($.style),J.includes($)||J.push($);let Z=$._texture.baseTexture;return J.includes(Z)||J.push(Z),!0}return!1}function LC($,J){return $ instanceof _1?(J.includes($)||J.push($),!0):!1}var p2=class ${constructor(J){this.limiter=new _7($.uploadsPerFrame),this.renderer=J,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(DC),this.registerFindHook(LC),this.registerFindHook(FC),this.registerFindHook(OC),this.registerFindHook(jC),this.registerUploadHook(_C),this.registerUploadHook(PC)}upload(J){return new Promise((Z)=>{J&&this.add(J),this.queue.length?(this.completes.push(Z),this.ticking||(this.ticking=!0,C0.system.addOnce(this.tick,this,R1.UTILITY))):Z()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){let J=this.queue[0],Z=!1;if(J&&!J._destroyed){for(let Q=0,q=this.uploadHooks.length;Q<q;Q++)if(this.uploadHooks[Q](this.uploadHookHelper,J)){this.queue.shift(),Z=!0;break}}Z||this.queue.shift()}if(this.queue.length)C0.system.addOnce(this.tick,this,R1.UTILITY);else{this.ticking=!1;let J=this.completes.slice(0);this.completes.length=0;for(let Z=0,Q=J.length;Z<Q;Z++)J[Z]()}}registerFindHook(J){return J&&this.addHooks.push(J),this}registerUploadHook(J){return J&&this.uploadHooks.push(J),this}add(J){for(let Z=0,Q=this.addHooks.length;Z<Q&&!this.addHooks[Z](J,this.queue);Z++);if(J instanceof i)for(let Z=J.children.length-1;Z>=0;Z--)this.add(J.children[Z]);return this}destroy(){this.ticking&&C0.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};p2.uploadsPerFrame=4;var G6=p2;Object.defineProperties(_,{UPLOADS_PER_FRAME:{get(){return G6.uploadsPerFrame},set($){R.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),G6.uploadsPerFrame=$}}});function l2($,J){return J instanceof l?(J._glTextures[$.CONTEXT_UID]||$.texture.bind(J),!0):!1}function kC($,J){if(!(J instanceof t1))return!1;let{geometry:Z}=J;J.finishPoly(),Z.updateBatches();let{batches:Q}=Z;for(let q=0;q<Q.length;q++){let{texture:K}=Q[q].style;K&&l2($,K.baseTexture)}return Z.batchable||$.geometry.bind(Z,J._resolveDirectShader($)),!0}function AC($,J){return $ instanceof t1?(J.push($),!0):!1}class P7 extends G6{constructor($){super($),this.uploadHookHelper=this.renderer,this.registerFindHook(AC),this.registerUploadHook(l2),this.registerUploadHook(kC)}}P7.extension={name:"prepare",type:j.RendererSystem};D.add(P7);var S9=new d;class b9 extends h0{constructor($,J=100,Z=100){super($),this.tileTransform=new g8,this._width=J,this._height=Z,this.uvMatrix=this.texture.uvMatrix||new p8($),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin($){this.uvMatrix.clampMargin=$,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale($){this.tileTransform.scale.copyFrom($)}get tilePosition(){return this.tileTransform.position}set tilePosition($){this.tileTransform.position.copyFrom($)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render($){let J=this._texture;!J||!J.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),$.batch.setObjectRenderer($.plugins[this.pluginName]),$.plugins[this.pluginName].render(this))}_calculateBounds(){let $=this._width*-this._anchor._x,J=this._height*-this._anchor._y,Z=this._width*(1-this._anchor._x),Q=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,$,J,Z,Q)}getLocalBounds($){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),$||(this._localBoundsRect||(this._localBoundsRect=new y),$=this._localBoundsRect),this._bounds.getRectangle($)):super.getLocalBounds.call(this,$)}containsPoint($){this.worldTransform.applyInverse($,S9);let J=this._width,Z=this._height,Q=-J*this.anchor._x;if(S9.x>=Q&&S9.x<Q+J){let q=-Z*this.anchor._y;if(S9.y>=q&&S9.y<q+Z)return!0}return!1}destroy($){super.destroy($),this.tileTransform=null,this.uvMatrix=null}static from($,J){let Z=$ instanceof b?$:b.from($,J);return new b9(Z,J.width,J.height)}get width(){return this._width}set width($){this._width=$}get height(){return this._height}set height($){this._height=$}}var n2=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`;var o2=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var s2=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`;var i4=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var i2=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;var D7=new $0;class L7 extends X8{constructor($){super($),$.runners.contextChange.add(this),this.quad=new r5,this.state=g0.for2d()}contextChange(){let $=this.renderer,J={globals:$.globalUniforms};this.simpleShader=s0.from(i4,i2,J),this.shader=$.context.webGLVersion>1?s0.from(o2,n2,J):s0.from(i4,s2,J)}render($){let J=this.renderer,Z=this.quad,Q=Z.vertices;Q[0]=Q[6]=$._width*-$.anchor.x,Q[1]=Q[3]=$._height*-$.anchor.y,Q[2]=Q[4]=$._width*(1-$.anchor.x),Q[5]=Q[7]=$._height*(1-$.anchor.y);let q=$.uvRespectAnchor?$.anchor.x:0,K=$.uvRespectAnchor?$.anchor.y:0;Q=Z.uvs,Q[0]=Q[6]=-q,Q[1]=Q[3]=-K,Q[2]=Q[4]=1-q,Q[5]=Q[7]=1-K,Z.invalidate();let V=$._texture,H=V.baseTexture,X=H.alphaMode>0,W=$.tileTransform.localTransform,z=$.uvMatrix,G=H.isPowerOfTwo&&V.frame.width===H.width&&V.frame.height===H.height;G&&(H._glTextures[J.CONTEXT_UID]?G=H.wrapMode!==X1.CLAMP:H.wrapMode===X1.CLAMP&&(H.wrapMode=X1.REPEAT));let Y=G?this.simpleShader:this.shader,w=V.width,U=V.height,C=$._width,N=$._height;D7.set(W.a*w/C,W.b*w/N,W.c*U/C,W.d*U/N,W.tx/C,W.ty/N),D7.invert(),G?D7.prepend(z.mapCoord):(Y.uniforms.uMapCoord=z.mapCoord.toArray(!0),Y.uniforms.uClampFrame=z.uClampFrame,Y.uniforms.uClampOffset=z.uClampOffset),Y.uniforms.uTransform=D7.toArray(!0),Y.uniforms.uColor=r.shared.setValue($.tint).premultiply($.worldAlpha,X).toArray(Y.uniforms.uColor),Y.uniforms.translationMatrix=$.transform.worldTransform.toArray(!0),Y.uniforms.uSampler=V,J.shader.bind(Y),J.geometry.bind(Z),this.state.blendMode=R.correctBlendMode($.blendMode,X),J.state.set(this.state),J.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}L7.extension={name:"tilingSprite",type:j.RendererPlugin};D.add(L7);var a2=class ${constructor(J,Z,Q){this.linkedSheets=[],(J instanceof l||J instanceof b)&&(J={texture:J,data:Z,resolutionFilename:Q});let{texture:q,data:K,resolutionFilename:V=null,cachePrefix:H=""}=J;this.cachePrefix=H,this._texture=q instanceof b?q:null,this.baseTexture=q instanceof l?q:this._texture.baseTexture,this.textures={},this.animations={},this.data=K;let X=this.baseTexture.resource;this.resolution=this._updateResolution(V||(X?X.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(J=null){let{scale:Z}=this.data.meta,Q=R.getResolutionOfUrl(J,null);return Q===null&&(Q=typeof Z=="number"?Z:parseFloat(Z??"1")),Q!==1&&this.baseTexture.setResolution(Q),Q}parse(){return new Promise((J)=>{this._callback=J,this._batchIndex=0,this._frameKeys.length<=$.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(J){let Z=J,Q=$.BATCH_SIZE;for(;Z-J<Q&&Z<this._frameKeys.length;){let q=this._frameKeys[Z],K=this._frames[q],V=K.frame;if(V){let H=null,X=null,W=K.trimmed!==!1&&K.sourceSize?K.sourceSize:K.frame,z=new y(0,0,Math.floor(W.w)/this.resolution,Math.floor(W.h)/this.resolution);K.rotated?H=new y(Math.floor(V.x)/this.resolution,Math.floor(V.y)/this.resolution,Math.floor(V.h)/this.resolution,Math.floor(V.w)/this.resolution):H=new y(Math.floor(V.x)/this.resolution,Math.floor(V.y)/this.resolution,Math.floor(V.w)/this.resolution,Math.floor(V.h)/this.resolution),K.trimmed!==!1&&K.spriteSourceSize&&(X=new y(Math.floor(K.spriteSourceSize.x)/this.resolution,Math.floor(K.spriteSourceSize.y)/this.resolution,Math.floor(V.w)/this.resolution,Math.floor(V.h)/this.resolution)),this.textures[q]=new b(this.baseTexture,H,z,X,K.rotated?2:0,K.anchor,K.borders),b.addToCache(this.textures[q],this.cachePrefix+q.toString())}Z++}}_processAnimations(){let J=this.data.animations||{};for(let Z in J){this.animations[Z]=[];for(let Q=0;Q<J[Z].length;Q++){let q=J[Z][Q];this.animations[Z].push(this.textures[q])}}}_parseComplete(){let J=this._callback;this._callback=null,this._batchIndex=0,J.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*$.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*$.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(J=!1){for(let Z in this.textures)this.textures[Z].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,J&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};a2.BATCH_SIZE=1000;var k5=a2;var RC=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function r2($,J,Z){let Q={};if($.forEach((q)=>{Q[q]=J}),Object.keys(J.textures).forEach((q)=>{Q[`${J.cachePrefix}${q}`]=J.textures[q]}),!Z){let q=R.path.dirname($[0]);J.linkedSheets.forEach((K,V)=>{Object.assign(Q,r2([`${q}/${J.data.meta.related_multi_packs[V]}`],K,!0))})}return Q}var t2={extension:j.Asset,cache:{test:($)=>$ instanceof k5,getCacheableAssets:($,J)=>r2($,J,!1)},resolver:{test:($)=>{let J=$.split("?")[0].split("."),Z=J.pop(),Q=J.pop();return Z==="json"&&RC.includes(Q)},parse:($)=>{let J=$.split(".");return{resolution:parseFloat(_.RETINA_PREFIX.exec($)?.[1]??"1"),format:J[J.length-2],src:$}}},loader:{name:"spritesheetLoader",extension:{type:j.LoadParser,priority:j0.Normal},async testParse($,J){return R.path.extname(J.src).toLowerCase()===".json"&&!!$.frames},async parse($,J,Z){let{texture:Q,imageFilename:q,cachePrefix:K}=J?.data??{},V=R.path.dirname(J.src);V&&V.lastIndexOf("/")!==V.length-1&&(V+="/");let H;if(Q&&Q.baseTexture)H=Q;else{let z=F5(V+(q??$.meta.image),J.src);H=(await Z.load([z]))[z]}let X=new k5({texture:H.baseTexture,data:$,resolutionFilename:J.src,cachePrefix:K});await X.parse();let W=$?.meta?.related_multi_packs;if(Array.isArray(W)){let z=[];for(let Y of W){if(typeof Y!="string")continue;let w=V+Y;J.data?.ignoreMultiPack||(w=F5(w,J.src),z.push(Z.load({src:w,data:{ignoreMultiPack:!0}})))}let G=await Promise.all(z);X.linkedSheets=G,G.forEach((Y)=>{Y.linkedSheets=[X].concat(X.linkedSheets.filter((w)=>w!==Y))})}return X},unload($){$.destroy(!0)}}};D.add(t2);class f8{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class t8{static test($){return typeof $=="string"&&$.startsWith("info face=")}static parse($){let J=$.match(/^[a-z]+\s+.+$/gm),Z={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let q in J){let K=J[q].match(/^[a-z]+/gm)[0],V=J[q].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),H={};for(let X in V){let W=V[X].split("="),z=W[0],G=W[1].replace(/"/gm,""),Y=parseFloat(G),w=isNaN(Y)?G:Y;H[z]=w}Z[K].push(H)}let Q=new f8;return Z.info.forEach((q)=>Q.info.push({face:q.face,size:parseInt(q.size,10)})),Z.common.forEach((q)=>Q.common.push({lineHeight:parseInt(q.lineHeight,10)})),Z.page.forEach((q)=>Q.page.push({id:parseInt(q.id,10),file:q.file})),Z.char.forEach((q)=>Q.char.push({id:parseInt(q.id,10),page:parseInt(q.page,10),x:parseInt(q.x,10),y:parseInt(q.y,10),width:parseInt(q.width,10),height:parseInt(q.height,10),xoffset:parseInt(q.xoffset,10),yoffset:parseInt(q.yoffset,10),xadvance:parseInt(q.xadvance,10)})),Z.kerning.forEach((q)=>Q.kerning.push({first:parseInt(q.first,10),second:parseInt(q.second,10),amount:parseInt(q.amount,10)})),Z.distanceField.forEach((q)=>Q.distanceField.push({distanceRange:parseInt(q.distanceRange,10),fieldType:q.fieldType})),Q}}class A5{static test($){let J=$;return typeof $!="string"&&"getElementsByTagName"in $&&J.getElementsByTagName("page").length&&J.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse($){let J=new f8,Z=$.getElementsByTagName("info"),Q=$.getElementsByTagName("common"),q=$.getElementsByTagName("page"),K=$.getElementsByTagName("char"),V=$.getElementsByTagName("kerning"),H=$.getElementsByTagName("distanceField");for(let X=0;X<Z.length;X++)J.info.push({face:Z[X].getAttribute("face"),size:parseInt(Z[X].getAttribute("size"),10)});for(let X=0;X<Q.length;X++)J.common.push({lineHeight:parseInt(Q[X].getAttribute("lineHeight"),10)});for(let X=0;X<q.length;X++)J.page.push({id:parseInt(q[X].getAttribute("id"),10)||0,file:q[X].getAttribute("file")});for(let X=0;X<K.length;X++){let W=K[X];J.char.push({id:parseInt(W.getAttribute("id"),10),page:parseInt(W.getAttribute("page"),10)||0,x:parseInt(W.getAttribute("x"),10),y:parseInt(W.getAttribute("y"),10),width:parseInt(W.getAttribute("width"),10),height:parseInt(W.getAttribute("height"),10),xoffset:parseInt(W.getAttribute("xoffset"),10),yoffset:parseInt(W.getAttribute("yoffset"),10),xadvance:parseInt(W.getAttribute("xadvance"),10)})}for(let X=0;X<V.length;X++)J.kerning.push({first:parseInt(V[X].getAttribute("first"),10),second:parseInt(V[X].getAttribute("second"),10),amount:parseInt(V[X].getAttribute("amount"),10)});for(let X=0;X<H.length;X++)J.distanceField.push({fieldType:H[X].getAttribute("fieldType"),distanceRange:parseInt(H[X].getAttribute("distanceRange"),10)});return J}}class R5{static test($){return typeof $=="string"&&$.includes("<font>")?A5.test(_.ADAPTER.parseXML($)):!1}static parse($){return A5.parse(_.ADAPTER.parseXML($))}}var a4=[t8,A5,R5];function r4($){for(let J=0;J<a4.length;J++)if(a4[J].test($))return a4[J];return null}function t4($,J,Z,Q,q,K){let V=Z.fill;if(Array.isArray(V)){if(V.length===1)return V[0]}else return V;let H,X=Z.dropShadow?Z.dropShadowDistance:0,W=Z.padding||0,z=$.width/Q-X-W*2,G=$.height/Q-X-W*2,Y=V.slice(),w=Z.fillGradientStops.slice();if(!w.length){let U=Y.length+1;for(let C=1;C<U;++C)w.push(C/U)}if(Y.unshift(V[0]),w.unshift(0),Y.push(V[V.length-1]),w.push(1),Z.fillGradientType===r8.LINEAR_VERTICAL){H=J.createLinearGradient(z/2,W,z/2,G+W);let U=0,C=(K.fontProperties.fontSize+Z.strokeThickness)/G;for(let N=0;N<q.length;N++){let O=K.lineHeight*N;for(let I=0;I<Y.length;I++){let B=0;typeof w[I]=="number"?B=w[I]:B=I/Y.length;let F=O/G+B*C,P=Math.max(U,F);P=Math.min(P,1),H.addColorStop(P,Y[I]),U=P}}}else{H=J.createLinearGradient(W,G/2,z+W,G/2);let U=Y.length+1,C=1;for(let N=0;N<Y.length;N++){let O;typeof w[N]=="number"?O=w[N]:O=C/U,H.addColorStop(O,Y[N]),C++}}return H}function e4($,J,Z,Q,q,K,V){let{text:H,fontProperties:X}=Z;J.translate(Q,q),J.scale(K,K);let W=V.strokeThickness/2,z=-(V.strokeThickness/2);if(J.font=V.toFontString(),J.lineWidth=V.strokeThickness,J.textBaseline=V.textBaseline,J.lineJoin=V.lineJoin,J.miterLimit=V.miterLimit,J.fillStyle=t4($,J,V,K,[H],Z),J.strokeStyle=V.stroke,V.dropShadow){let G=V.dropShadowColor,Y=V.dropShadowBlur*K,w=V.dropShadowDistance*K;J.shadowColor=r.shared.setValue(G).setAlpha(V.dropShadowAlpha).toRgbaString(),J.shadowBlur=Y,J.shadowOffsetX=Math.cos(V.dropShadowAngle)*w,J.shadowOffsetY=Math.sin(V.dropShadowAngle)*w}else J.shadowColor="black",J.shadowBlur=0,J.shadowOffsetX=0,J.shadowOffsetY=0;V.stroke&&V.strokeThickness&&J.strokeText(H,W,z+Z.lineHeight-X.descent),V.fill&&J.fillText(H,W,z+Z.lineHeight-X.descent),J.setTransform(1,0,0,1,0,0),J.fillStyle="rgba(0, 0, 0, 0)"}function M5($){return $.codePointAt?$.codePointAt(0):$.charCodeAt(0)}function f9($){return Array.from?Array.from($):$.split("")}function $Z($){typeof $=="string"&&($=[$]);let J=[];for(let Z=0,Q=$.length;Z<Q;Z++){let q=$[Z];if(Array.isArray(q)){if(q.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${q.length}.`);let K=q[0].charCodeAt(0),V=q[1].charCodeAt(0);if(V<K)throw new Error("[BitmapFont]: Invalid character range.");for(let H=K,X=V;H<=X;H++)J.push(String.fromCharCode(H))}else J.push(...f9(q))}if(J.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return J}var e8=class ${constructor(J,Z,Q){let[q]=J.info,[K]=J.common,[V]=J.page,[H]=J.distanceField,X=R.getResolutionOfUrl(V.file),W={};this._ownsTextures=Q,this.font=q.face,this.size=q.size,this.lineHeight=K.lineHeight/X,this.chars={},this.pageTextures=W;for(let z=0;z<J.page.length;z++){let{id:G,file:Y}=J.page[z];W[G]=Z instanceof Array?Z[z]:Z[Y],H?.fieldType&&H.fieldType!=="none"&&(W[G].baseTexture.alphaMode=F0.NO_PREMULTIPLIED_ALPHA,W[G].baseTexture.mipmap=n0.OFF)}for(let z=0;z<J.char.length;z++){let{id:G,page:Y}=J.char[z],{x:w,y:U,width:C,height:N,xoffset:O,yoffset:I,xadvance:B}=J.char[z];w/=X,U/=X,C/=X,N/=X,O/=X,I/=X,B/=X;let F=new y(w+W[Y].frame.x/X,U+W[Y].frame.y/X,C,N);this.chars[G]={xOffset:O,yOffset:I,xAdvance:B,kerning:{},texture:new b(W[Y].baseTexture,F),page:Y}}for(let z=0;z<J.kerning.length;z++){let{first:G,second:Y,amount:w}=J.kerning[z];G/=X,Y/=X,w/=X,this.chars[Y]&&(this.chars[Y].kerning[G]=w)}this.distanceFieldRange=H?.distanceRange,this.distanceFieldType=H?.fieldType?.toLowerCase()??"none"}destroy(){for(let J in this.chars)this.chars[J].texture.destroy(),this.chars[J].texture=null;for(let J in this.pageTextures)this._ownsTextures&&this.pageTextures[J].destroy(!0),this.pageTextures[J]=null;this.chars=null,this.pageTextures=null}static install(J,Z,Q){let q;if(J instanceof f8)q=J;else{let V=r4(J);if(!V)throw new Error("Unrecognized data format for font.");q=V.parse(J)}Z instanceof b&&(Z=[Z]);let K=new $(q,Z,Q);return $.available[K.font]=K,K}static uninstall(J){let Z=$.available[J];if(!Z)throw new Error(`No font found named '${J}'`);Z.destroy(),delete $.available[J]}static from(J,Z,Q){if(!J)throw new Error("[BitmapFont] Property `name` is required.");let{chars:q,padding:K,resolution:V,textureWidth:H,textureHeight:X,...W}=Object.assign({},$.defaultOptions,Q),z=$Z(q),G=Z instanceof _1?Z:new _1(Z),Y=H,w=new f8;w.info[0]={face:G.fontFamily,size:G.fontSize},w.common[0]={lineHeight:G.fontSize};let U=0,C=0,N,O,I,B=0,F=[],P=[];for(let M=0;M<z.length;M++){N||(N=_.ADAPTER.createCanvas(),N.width=H,N.height=X,O=N.getContext("2d"),I=new l(N,{resolution:V,...W}),F.push(I),P.push(new b(I)),w.page.push({id:P.length-1,file:""}));let E=z[M],g=u1.measureText(E,G,!1,N),o=g.width,f=Math.ceil(g.height),x=Math.ceil((G.fontStyle==="italic"?2:1)*o);if(C>=X-f*V){if(C===0)throw new Error(`[BitmapFont] textureHeight ${X}px is too small (fontFamily: '${G.fontFamily}', fontSize: ${G.fontSize}px, char: '${E}')`);--M,N=null,O=null,I=null,C=0,U=0,B=0;continue}if(B=Math.max(f+g.fontProperties.descent,B),x*V+U>=Y){if(U===0)throw new Error(`[BitmapFont] textureWidth ${H}px is too small (fontFamily: '${G.fontFamily}', fontSize: ${G.fontSize}px, char: '${E}')`);--M,C+=B*V,C=Math.ceil(C),U=0,B=0;continue}e4(N,O,g,U,C,V,G);let k=M5(g.text);w.char.push({id:k,page:P.length-1,x:U/V,y:C/V,width:x,height:f,xoffset:0,yoffset:0,xadvance:o-(G.dropShadow?G.dropShadowDistance:0)-(G.stroke?G.strokeThickness:0)}),U+=(x+2*K)*V,U=Math.ceil(U)}if(!Q?.skipKerning)for(let M=0,E=z.length;M<E;M++){let g=z[M];for(let o=0;o<E;o++){let f=z[o],x=O.measureText(g).width,k=O.measureText(f).width,T=O.measureText(g+f).width-(x+k);T&&w.kerning.push({first:M5(g),second:M5(f),amount:T})}}let L=new $(w,P,!0);return $.available[J]!==void 0&&$.uninstall(J),$.available[J]=L,L}};e8.ALPHA=[["a","z"],["A","Z"]," "],e8.NUMERIC=[["0","9"]],e8.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],e8.ASCII=[[" ","~"]],e8.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:e8.ALPHANUMERIC},e8.available={};var e1=e8;var e2=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`;var $H=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;var JH=[],ZH=[],QH=[],MC=class $ extends i{constructor(J,Z={}){super();let{align:Q,tint:q,maxWidth:K,letterSpacing:V,fontName:H,fontSize:X}=Object.assign({},$.styleDefaults,Z);if(!e1.available[H])throw new Error(`Missing BitmapFont "${H}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=Q,this._tintColor=new r(q),this._font=void 0,this._fontName=H,this._fontSize=X,this.text=J,this._maxWidth=K,this._maxLineHeight=0,this._letterSpacing=V,this._anchor=new L1(()=>{this.dirty=!0},this,0,0),this._roundPixels=_.ROUND_PIXELS,this.dirty=!0,this._resolution=_.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){let J=e1.available[this._fontName],Z=this.fontSize,Q=Z/J.size,q=new d,K=[],V=[],H=[],X=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",W=f9(X),z=this._maxWidth*J.size/Z,G=J.distanceFieldType==="none"?JH:ZH,Y=null,w=0,U=0,C=0,N=-1,O=0,I=0,B=0,F=0;for(let f=0;f<W.length;f++){let x=W[f],k=M5(x);if(/(?:\s)/.test(x)&&(N=f,O=w,F++),x==="\r"||x===`
`){V.push(w),H.push(-1),U=Math.max(U,w),++C,++I,q.x=0,q.y+=J.lineHeight,Y=null,F=0;continue}let T=J.chars[k];if(!T)continue;Y&&T.kerning[Y]&&(q.x+=T.kerning[Y]);let J0=QH.pop()||{texture:b.EMPTY,line:0,charCode:0,prevSpaces:0,position:new d};J0.texture=T.texture,J0.line=C,J0.charCode=k,J0.position.x=Math.round(q.x+T.xOffset+this._letterSpacing/2),J0.position.y=Math.round(q.y+T.yOffset),J0.prevSpaces=F,K.push(J0),w=J0.position.x+Math.max(T.xAdvance-T.xOffset,T.texture.orig.width),q.x+=T.xAdvance+this._letterSpacing,B=Math.max(B,T.yOffset+T.texture.height),Y=k,N!==-1&&z>0&&q.x>z&&(++I,R.removeItems(K,1+N-I,1+f-N),f=N,N=-1,V.push(O),H.push(K.length>0?K[K.length-1].prevSpaces:0),U=Math.max(U,O),C++,q.x=0,q.y+=J.lineHeight,Y=null,F=0)}let P=W[W.length-1];P!=="\r"&&P!==`
`&&(/(?:\s)/.test(P)&&(w=O),V.push(w),U=Math.max(U,w),H.push(-1));let L=[];for(let f=0;f<=C;f++){let x=0;this._align==="right"?x=U-V[f]:this._align==="center"?x=(U-V[f])/2:this._align==="justify"&&(x=H[f]<0?0:(U-V[f])/H[f]),L.push(x)}let M=K.length,E={},g=[],o=this._activePagesMeshData;G.push(...o);for(let f=0;f<M;f++){let x=K[f].texture,k=x.baseTexture.uid;if(!E[k]){let T=G.pop();if(!T){let n=new L5,S,Z0;J.distanceFieldType==="none"?(S=new a8(b.EMPTY),Z0=s.NORMAL):(S=new a8(b.EMPTY,{program:J1.from($H,e2),uniforms:{uFWidth:0}}),Z0=s.NORMAL_NPM);let V0=new D5(n,S);V0.blendMode=Z0,T={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:V0,vertices:null,uvs:null,indices:null}}T.index=0,T.indexCount=0,T.vertexCount=0,T.uvsCount=0,T.total=0;let{_textureCache:J0}=this;J0[k]=J0[k]||new b(x.baseTexture),T.mesh.texture=J0[k],T.mesh.tint=this._tintColor.value,g.push(T),E[k]=T}E[k].total++}for(let f=0;f<o.length;f++)g.includes(o[f])||this.removeChild(o[f].mesh);for(let f=0;f<g.length;f++)g[f].mesh.parent!==this&&this.addChild(g[f].mesh);this._activePagesMeshData=g;for(let f in E){let x=E[f],k=x.total;if(!(x.indices?.length>6*k)||x.vertices.length<D5.BATCHABLE_SIZE*2)x.vertices=new Float32Array(8*k),x.uvs=new Float32Array(8*k),x.indices=new Uint16Array(6*k);else{let{total:T,vertices:J0}=x;for(let n=T*4*2;n<J0.length;n++)J0[n]=0}x.mesh.size=6*k}for(let f=0;f<M;f++){let x=K[f],k=x.position.x+L[x.line]*(this._align==="justify"?x.prevSpaces:1);this._roundPixels&&(k=Math.round(k));let T=k*Q,J0=x.position.y*Q,n=x.texture,S=E[n.baseTexture.uid],Z0=n.frame,V0=n._uvs,t=S.index++;S.indices[t*6+0]=0+t*4,S.indices[t*6+1]=1+t*4,S.indices[t*6+2]=2+t*4,S.indices[t*6+3]=0+t*4,S.indices[t*6+4]=2+t*4,S.indices[t*6+5]=3+t*4,S.vertices[t*8+0]=T,S.vertices[t*8+1]=J0,S.vertices[t*8+2]=T+Z0.width*Q,S.vertices[t*8+3]=J0,S.vertices[t*8+4]=T+Z0.width*Q,S.vertices[t*8+5]=J0+Z0.height*Q,S.vertices[t*8+6]=T,S.vertices[t*8+7]=J0+Z0.height*Q,S.uvs[t*8+0]=V0.x0,S.uvs[t*8+1]=V0.y0,S.uvs[t*8+2]=V0.x1,S.uvs[t*8+3]=V0.y1,S.uvs[t*8+4]=V0.x2,S.uvs[t*8+5]=V0.y2,S.uvs[t*8+6]=V0.x3,S.uvs[t*8+7]=V0.y3}this._textWidth=U*Q,this._textHeight=(q.y+J.lineHeight)*Q;for(let f in E){let x=E[f];if(this.anchor.x!==0||this.anchor.y!==0){let n=0,S=this._textWidth*this.anchor.x,Z0=this._textHeight*this.anchor.y;for(let V0=0;V0<x.total;V0++)x.vertices[n++]-=S,x.vertices[n++]-=Z0,x.vertices[n++]-=S,x.vertices[n++]-=Z0,x.vertices[n++]-=S,x.vertices[n++]-=Z0,x.vertices[n++]-=S,x.vertices[n++]-=Z0}this._maxLineHeight=B*Q;let k=x.mesh.geometry.getBuffer("aVertexPosition"),T=x.mesh.geometry.getBuffer("aTextureCoord"),J0=x.mesh.geometry.getIndex();k.data=x.vertices,T.data=x.uvs,J0.data=x.indices,k.update(),T.update(),J0.update()}for(let f=0;f<K.length;f++)QH.push(K[f]);this._font=J,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(J){this._autoResolution&&this._resolution!==J.resolution&&(this._resolution=J.resolution,this.dirty=!0);let{distanceFieldRange:Z,distanceFieldType:Q,size:q}=e1.available[this._fontName];if(Q!=="none"){let{a:K,b:V,c:H,d:X}=this.worldTransform,W=Math.sqrt(K*K+V*V),z=Math.sqrt(H*H+X*X),G=(Math.abs(W)+Math.abs(z))/2,Y=this.fontSize/q,w=J._view.resolution;for(let U of this._activePagesMeshData)U.mesh.shader.uniforms.uFWidth=G*Z*Y*w}super._render(J)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){let J=e1.available[this._fontName];if(!J)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==J&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(J){if(this.tint!==J){this._tintColor.setValue(J);for(let Z=0;Z<this._activePagesMeshData.length;Z++)this._activePagesMeshData[Z].mesh.tint=J}}get align(){return this._align}set align(J){this._align!==J&&(this._align=J,this.dirty=!0)}get fontName(){return this._fontName}set fontName(J){if(!e1.available[J])throw new Error(`Missing BitmapFont "${J}"`);this._fontName!==J&&(this._fontName=J,this.dirty=!0)}get fontSize(){return this._fontSize??e1.available[this._fontName].size}set fontSize(J){this._fontSize!==J&&(this._fontSize=J,this.dirty=!0)}get anchor(){return this._anchor}set anchor(J){typeof J=="number"?this._anchor.set(J):this._anchor.copyFrom(J)}get text(){return this._text}set text(J){J=String(J??""),this._text!==J&&(this._text=J,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(J){this._maxWidth!==J&&(this._maxWidth=J,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(J){this._letterSpacing!==J&&(this._letterSpacing=J,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(J){J!==this._roundPixels&&(this._roundPixels=J,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(J){this._autoResolution=!1,this._resolution!==J&&(this._resolution=J,this.dirty=!0)}destroy(J){let{_textureCache:Z}=this,Q=e1.available[this._fontName].distanceFieldType==="none"?JH:ZH;Q.push(...this._activePagesMeshData);for(let q of this._activePagesMeshData)this.removeChild(q.mesh);this._activePagesMeshData=[],Q.filter((q)=>Z[q.mesh.texture.baseTexture.uid]).forEach((q)=>{q.mesh.texture=b.EMPTY});for(let q in Z)Z[q].destroy(),delete Z[q];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(J)}};MC.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var EC=[".xml",".fnt"],qH={extension:{type:j.LoadParser,priority:j0.Normal},name:"loadBitmapFont",test($){return EC.includes(R.path.extname($).toLowerCase())},async testParse($){return t8.test($)||R5.test($)},async parse($,J,Z){let Q=t8.test($)?t8.parse($):R5.parse($),{src:q}=J,{page:K}=Q,V=[];for(let W=0;W<K.length;++W){let z=K[W].file,G=R.path.join(R.path.dirname(q),z);G=F5(G,q),V.push(G)}let H=await Z.load(V),X=V.map((W)=>H[W]);return e1.install(Q,X,!0)},async load($,J){return(await _.ADAPTER.fetch($)).text()},unload($){$.destroy()}};D.add(qH);var JZ=class $ extends _1{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(J){return new $(Object.keys($.defaultOptions).reduce((Z,Q)=>({...Z,[Q]:J[Q]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach((J)=>{URL.revokeObjectURL(J.src),J.refs--,J.refs===0&&(J.fontFace&&document.fonts.delete(J.fontFace),delete $.availableFonts[J.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(J,Z={}){let{availableFonts:Q}=$;if(Q[J]){let q=Q[J];return this._fonts.push(q),q.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return _.ADAPTER.fetch(J).then((q)=>q.blob()).then(async(q)=>new Promise((K,V)=>{let H=URL.createObjectURL(q),X=new FileReader;X.onload=()=>K([H,X.result]),X.onerror=V,X.readAsDataURL(q)})).then(async([q,K])=>{let V=Object.assign({family:R.path.basename(J,R.path.extname(J)),weight:"normal",style:"normal",display:"auto",src:q,dataSrc:K,refs:1,originalUrl:J,fontFace:null},Z);Q[J]=V,this._fonts.push(V),this.styleID++;let H=new FontFace(V.family,`url(${V.src})`,{weight:V.weight,style:V.style,display:V.display});V.fontFace=H,await H.load(),document.fonts.add(H),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...J){let Z=J.filter((Q)=>!this._overrides.includes(Q));Z.length>0&&(this._overrides.push(...Z),this.styleID++)}removeOverride(...J){let Z=J.filter((Q)=>this._overrides.includes(Q));Z.length>0&&(this._overrides=this._overrides.filter((Q)=>!Z.includes(Q)),this.styleID++)}toCSS(J){return[`transform: scale(${J})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((J,Z)=>`${J}
            @font-face {
                font-family: "${Z.family}";
                src: url('${Z.dataSrc}');
                font-weight: ${Z.weight};
                font-style: ${Z.style};
                font-display: ${Z.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(J){this._stylesheet!==J&&(this._stylesheet=J,this.styleID++)}normalizeColor(J){return Array.isArray(J)&&(J=R.rgb2hex(J)),typeof J=="number"?R.hex2string(J):J}dropShadowToCSS(){let J=this.normalizeColor(this.dropShadowColor),Z=this.dropShadowAlpha,Q=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),q=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);J.startsWith("#")&&Z<1&&(J+=(Z*255|0).toString(16).padStart(2,"0"));let K=`${Q}px ${q}px`;return this.dropShadowBlur>0?`text-shadow: ${K} ${this.dropShadowBlur}px ${J}`:`text-shadow: ${K} ${J}`}reset(){Object.assign(this,$.defaultOptions)}onBeforeDraw(){let{fontsDirty:J}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&J?new Promise((Z)=>setTimeout(Z,100)):Promise.resolve()}get isSafari(){let{userAgent:J}=_.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(J)}set fillGradientStops(J){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(J){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(J){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(J){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(J){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(J){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(J){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};JZ.availableFonts={},JZ.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};var v9=JZ;var k7=class $ extends h0{constructor(J="",Z={}){super(b.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;let Q=new Image,q=b.from(Q,{scaleMode:_.SCALE_MODE,resourceOptions:{autoLoad:!1}});q.orig=new y,q.trim=new y,this.texture=q;let K="http://www.w3.org/2000/svg",V="http://www.w3.org/1999/xhtml",H=document.createElementNS(K,"svg"),X=document.createElementNS(K,"foreignObject"),W=document.createElementNS(V,"div"),z=document.createElementNS(V,"style");X.setAttribute("width","10000"),X.setAttribute("height","10000"),X.style.overflow="hidden",H.appendChild(X),this.maxWidth=$.defaultMaxWidth,this.maxHeight=$.defaultMaxHeight,this._domElement=W,this._styleElement=z,this._svgRoot=H,this._foreignObject=X,this._foreignObject.appendChild(z),this._foreignObject.appendChild(W),this._image=Q,this._loadImage=new Image,this._autoResolution=$.defaultAutoResolution,this._resolution=$.defaultResolution??_.RESOLUTION,this.text=J,this.style=Z}measureText(J){let{text:Z,style:Q,resolution:q}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},J);Object.assign(this._domElement,{innerHTML:Z,style:Q.toCSS(q)}),this._styleElement.textContent=Q.toGlobalCSS(),document.body.appendChild(this._svgRoot);let K=this._domElement.getBoundingClientRect();this._svgRoot.remove();let{width:V,height:H}=K;(V>this.maxWidth||H>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");let X=Math.min(this.maxWidth,Math.ceil(V)),W=Math.min(this.maxHeight,Math.ceil(H));return this._svgRoot.setAttribute("width",X.toString()),this._svgRoot.setAttribute("height",W.toString()),Z!==this._text&&(this._domElement.innerHTML=this._text),Q!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(q)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:X+Q.padding*2,height:W+Q.padding*2}}async updateText(J=!0){let{style:Z,_image:Q,_loadImage:q}=this;if(this.localStyleID!==Z.styleID&&(this.dirty=!0,this.localStyleID=Z.styleID),!this.dirty&&J)return;let{width:K,height:V}=this.measureText();Q.width=q.width=Math.ceil(Math.max(1,K)),Q.height=q.height=Math.ceil(Math.max(1,V)),this._updateID++;let H=this._updateID;await new Promise((X)=>{q.onload=async()=>{if(H<this._updateID){X();return}await Z.onBeforeDraw(),Q.src=q.src,q.onload=null,q.src="",this.updateTexture(),X()};let W=new XMLSerializer().serializeToString(this._svgRoot);q.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(W)}`})}get source(){return this._image}updateTexture(){let{style:J,texture:Z,_image:Q,resolution:q}=this,{padding:K}=J,{baseTexture:V}=Z;Z.trim.width=Z._frame.width=Q.width/q,Z.trim.height=Z._frame.height=Q.height/q,Z.trim.x=-K,Z.trim.y=-K,Z.orig.width=Z._frame.width-K*2,Z.orig.height=Z._frame.height-K*2,this._onTextureUpdate(),V.setRealSize(Q.width,Q.height,q),this.dirty=!1}_render(J){this._autoResolution&&this._resolution!==J.resolution&&(this._resolution=J.resolution,this.dirty=!0),this.updateText(!0),super._render(J)}_renderCanvas(J){this._autoResolution&&this._resolution!==J.resolution&&(this._resolution=J.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(J)}getLocalBounds(J){return this.updateText(!0),super.getLocalBounds(J)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(J){typeof J=="boolean"&&(J={children:J}),J=Object.assign({},$.defaultDestroyOptions,J),super.destroy(J);let Z=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=Z,this._svgRoot?.remove(),this._svgRoot=Z,this._domElement?.remove(),this._domElement=Z,this._foreignObject?.remove(),this._foreignObject=Z,this._styleElement?.remove(),this._styleElement=Z,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=Z,this._image.src="",this._image=Z}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(J){this.updateText(!0);let Z=R.sign(this.scale.x)||1;this.scale.x=Z*J/this._image.width/this.resolution,this._width=J}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(J){this.updateText(!0);let Z=R.sign(this.scale.y)||1;this.scale.y=Z*J/this._image.height/this.resolution,this._height=J}get style(){return this._style}set style(J){this._style!==J&&(J=J||{},J instanceof v9?(this.ownsStyle=!1,this._style=J):J instanceof _1?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=v9.from(J)):(this.ownsStyle=!0,this._style=new v9(J)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(J){J=String(J===""||J===null||J===void 0?" ":J),J=this.sanitiseText(J),this._text!==J&&(this._text=J,this.dirty=!0)}get resolution(){return this._resolution}set resolution(J){this._autoResolution=!1,this._resolution!==J&&(this._resolution=J,this.dirty=!0)}sanitiseText(J){return J.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};k7.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},k7.defaultMaxWidth=2024,k7.defaultMaxHeight=2024,k7.defaultAutoResolution=!0;function ZZ($,J,Z){var Q=window,q="application/octet-stream",K=Z||q,V=$,H=!J&&!Z&&V,X=document.createElement("a"),W=function(F){return String(F)},z=Q.Blob||Q.MozBlob||Q.WebKitBlob||W,G=J||"download",Y,w;if(z=z.call?z.bind(Q):Blob,H&&H.length<2048){if(G=H.split("/").pop().split("?")[0],X.href=H,X.href.indexOf(H)!==-1){var U=new XMLHttpRequest;return U.open("GET",H,!0),U.responseType="blob",U.onload=function(F){ZZ(F.target.response,G,q)},setTimeout(function(){U.send()},0),U}}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(V))if(V.length>2096103.424&&z!==W)V=I(V),K=V.type||q;else return navigator.msSaveBlob?navigator.msSaveBlob(I(V),G):B(V);else if(/([\x80-\xff])/.test(V)){var C=0,N=new Uint8Array(V.length),O=N.length;for(C;C<O;++C)N[C]=V.charCodeAt(C);V=new z([N],{type:K})}Y=V instanceof z?V:new z([V],{type:K});function I(F){var P=F.split(/[:;,]/),L=P[1],M=F.indexOf("charset")>0?3:2,E=P[M]=="base64"?atob:decodeURIComponent,g=E(P.pop()),o=g.length,f=0,x=new Uint8Array(o);for(f;f<o;++f)x[f]=g.charCodeAt(f);return new z([x],{type:L})}function B(F,P){if("download"in X)return X.href=F,X.setAttribute("download",G),X.className="download-js-link",X.innerHTML="downloading...",X.style.display="none",X.addEventListener("click",function(M){M.stopPropagation(),this.removeEventListener("click",arguments.callee)}),document.body.appendChild(X),setTimeout(function(){if(X.click(),document.body.removeChild(X),P===!0)setTimeout(function(){Q.URL.revokeObjectURL(X.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)){if(/^data:/.test(F))F="data:"+F.replace(/^data:([\w\/\-\+]+)/,q);if(!window.open(F)){if(confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`))location.href=F}return!0}var L=document.createElement("iframe");if(document.body.appendChild(L),!P&&/^data:/.test(F))F="data:"+F.replace(/^data:([\w\/\-\+]+)/,q);L.src=F,setTimeout(function(){document.body.removeChild(L)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(Y,G);if(Q.URL)B(Q.URL.createObjectURL(Y),!0);else{if(typeof Y==="string"||Y.constructor===W)try{return B("data:"+K+";base64,"+Q.btoa(Y))}catch(F){return B("data:"+K+","+encodeURIComponent(Y))}w=new FileReader,w.onload=function(F){B(this.result)},w.readAsDataURL(Y)}return!0}class m0{static poecdn="http://web.poecdn.com/";static DATA_URI="data";static SKILL_TREES_URI=`${m0.DATA_URI}/skill-trees`;static getKeyByValue($,J){return Object.keys($).find((Z)=>{return $[Z]===J})}static NotUndefined($){return $!==void 0}static NotNullOrWhiteSpace($){return $!==void 0&&$!==null&&$.trim()!==""}static Download($,J,Z){return ZZ($,J,Z)}}class QZ{id;activeEffectImage;activeIcon;ascendancyName;classStartIndex;expansionJewel;flavourText;grantedDexterity;grantedIntelligence;grantedPassivePoints;grantedStrength;group;icon;in;inactiveIcon;isAscendancyStart;isBlighted;isJewelSocket;isKeystone;isMastery;isMultipleChoice;isMultipleChoiceOption;isNotable;isProxy;isWormhole;masteryEffects;name;orbit;orbitIndex;out;recipe;reminderText;skill;stats;state;nodeGroup;orbitAngles;orbitRadii;scale;arc;x;y;isRegular2;isRegular1;targetSize;hoverText=null;patch;distance;earliestMandatoryNode;constructor($,J,Z,Q,q,K,V){this.id=$,this.activeEffectImage=J.activeEffectImage||"",this.activeIcon=J.activeIcon||"",this.ascendancyName=J.ascendancyName||"",this.classStartIndex=J.classStartIndex,this.expansionJewel=J.expansionJewel,this.flavourText=J.flavourText||[],this.grantedDexterity=J.grantedDexterity||0,this.grantedIntelligence=J.grantedIntelligence||0,this.grantedPassivePoints=J.grantedPassivePoints||0,this.grantedStrength=J.grantedStrength||0,this.group=J.group,this.icon=J.icon,this.in=J.in,this.inactiveIcon=J.inactiveIcon||"",this.isAscendancyStart=J.isAscendancyStart||!1,this.isBlighted=J.isBlighted,this.isJewelSocket=J.isJewelSocket,this.isKeystone=J.isKeystone||!1,this.isMastery=J.isMastery||!1,this.isMultipleChoice=J.isMultipleChoice||!1,this.isMultipleChoiceOption=J.isMultipleChoiceOption||!1,this.isNotable=J.isNotable||!1,this.isProxy=J.isProxy||!1,this.isWormhole=J.isWormhole||!1,this.masteryEffects=J.masteryEffects||[],this.name=J.name,this.orbit=J.orbit,this.orbitIndex=J.orbitIndex,this.out=J.out,this.recipe=J.recipe||[],this.reminderText=J.reminderText||[],this.skill=J.skill,this.stats=J.stats,this.distance=J.distance,this.earliestMandatoryNode=J.earliestMandatoryNode,this.state=0,this.nodeGroup=Z,this.orbitAngles=q,this.orbitRadii=Q,this.scale=K,this.arc=this.getArc(this.orbitIndex),this.x=this.getX(this.arc),this.y=this.getY(this.arc),this.isRegular2=!this.isKeystone&&!this.isNotable&&!this.isJewelSocket&&!this.isMastery&&!this.isWormhole,this.isRegular1=this.isRegular2&&(this.grantedStrength>0||this.grantedDexterity>0||this.grantedIntelligence>0)&&this.stats.filter(m0.NotNullOrWhiteSpace).length===1,this.targetSize=this.getTargetSize(),this.patch=V}getArc=($)=>this.orbitAngles[this.orbit]!==void 0&&this.orbitAngles[this.orbit].length>$?this.orbitAngles[this.orbit][$]:0;getX=($)=>this.orbitRadii.length>this.orbit&&this.nodeGroup!==void 0?this.nodeGroup.x*this.scale-this.orbitRadii[this.orbit]*this.scale*Math.sin(-$):0;getY=($)=>this.orbitRadii.length>this.orbit&&this.nodeGroup!==void 0?this.nodeGroup.y*this.scale-this.orbitRadii[this.orbit]*this.scale*Math.cos(-$):0;getTargetSize=()=>{if(this.isRegular1||this.isRegular2)return{width:Math.floor(70*this.scale),height:Math.floor(70*this.scale)};if(this.isNotable||this.isJewelSocket||this.isMastery)return{width:Math.floor(100*this.scale),height:Math.floor(100*this.scale)};if(this.isKeystone||this.isWormhole)return{width:Math.floor(138*this.scale),height:Math.floor(140*this.scale)};return{width:0,height:0}};is=($)=>{return(this.state&$)===$};_add=($)=>{this.state|=$};_remove=($)=>{this.state&=~$};GetId=()=>{return`${this.id}`};GetIcon=()=>{if(this.isMastery){if(this.is(1)&&this.activeIcon)return this.activeIcon;if(this.inactiveIcon)return this.inactiveIcon}else if(this.isWormhole)return"Wormhole";return this.icon};GetDrawType=($)=>{if(this.is(1)||this.is(2)){if(this.expansionJewel!==void 0||this.isProxy||this.nodeGroup?.isProxy)return"Active";if(this.isWormhole&&this.is(2))return"Highlight";return"Allocated"}else if($.filter((J)=>J&&J.is(1)).length>0)return"CanAllocate";else if(this.ascendancyName!==""||this.expansionJewel!==void 0||this.isProxy||this.nodeGroup?.isProxy)return"Normal";return"Unallocated"};GetFrameAssetKey=($)=>{let J=this.GetDrawType($);if(this.isAscendancyStart)return"AscendancyMiddle";else if(this.isJewelSocket){if(this.expansionJewel!==void 0||this.isProxy||this.nodeGroup?.isProxy)return`JewelSocketAlt${J}`;if(this.name==="Charm Socket")return`CharmFrame${J}`;return`JewelFrame${J}`}else if(this.isKeystone)return`KeystoneFrame${J}`;else if(this.isNotable&&this.ascendancyName===""){if(this.isBlighted)return`BlightedNotableFrame${J}`;return`NotableFrame${J}`}else if(this.isNotable&&this.ascendancyName!=="")return`AscendancyFrameLarge${J}`;else if(this.isMastery)return null;else if(this.ascendancyName!=="")return`AscendancyFrameSmall${J}`;else if(this.isWormhole)return`WormholeFrame${J}`;switch(J){case"Normal":case"Unallocated":return"PSSkillFrame";case"CanAllocate":return"PSSkillFrameHighlighted";case"Active":case"Allocated":return"PSSkillFrameActive";default:return null}};GetSpriteSheetKey=()=>{let $=this.is(1)?"Active":"Inactive";if(this.isKeystone)return`keystone${$}`;else if(this.isNotable)return`notable${$}`;else if(this.isMastery)if(this.activeEffectImage!=="")if(this.is(1))return"masteryActiveSelected";else if(this.is(2)||this.is(4))return"masteryConnected";else return"masteryInactive";else if(this.is(1)||this.is(2))return"masteryConnected";else return"mastery";else if(this.isWormhole)return`wormhole${$}`;return`normal${$}`};GetConnectionType=($)=>{return this.is(1)&&$.is(1)?"Active":this.is(1)||$.is(1)||this.is(4)&&$.is(4)?"Intermediate":"Normal"}}class qZ{Initialized=!1;container;skillTreeData;skillTreeDataCompare;_lastTick=Date.now();constructor($,J,Z){this.container=$,this.skillTreeData=J,this.skillTreeDataCompare=Z}Tick(){let $=Date.now(),J=this._lastTick-$;if(this._lastTick=$,this.PreUpdate(J),this.IsDirty())this.Update(J);this.PostUpdate(J),requestAnimationFrame(()=>{this.Tick()})}RenderBase=()=>{if(!this.Initialized)return;this.SetupLayers(),this.GenerateCompare(),this.ClearLayer(0),this.DrawBackground(),this.ClearLayer(2),this.DrawGroupBackgrounds(),this.DrawAscendancyBackgrounds(),this.ClearLayer(13),this.DrawInactiveCharacters(),this.ClearLayer(3),this.DrawConnectionsForNodes(3,this.skillTreeData.nodes),this.ClearLayer(7),this.ClearLayer(10),this.ClearLayer(17),this.DrawInactiveNodes(),this.DrawCompareHighlights()};DrawBackground=()=>{var $=this.skillTreeData.hasSprite("background","Background1")?"Background1":"Background2",J={patch:this.skillTreeData.patch,key:this.skillTreeData.tree.slice(0,5)==="Atlas"?"atlasBackground":"background",icon:this.skillTreeData.tree.slice(0,5)==="Atlas"?"AtlasPassiveBackground":$};this.DrawBackgroundAsset(0,J)};GenerateCompare=()=>{if(this.skillTreeDataCompare===void 0)return;for(let $ in this.skillTreeData.nodes){let J=this.skillTreeData.nodes[$];if(J.nodeGroup===void 0||J.classStartIndex!==void 0)continue;if(this.skillTreeDataCompare.nodes[J.GetId()]===void 0)continue;let Z=this.skillTreeDataCompare.nodes[J.GetId()],Q=J.stats.length!==Z.stats.length;for(let V of J.stats){let H=!1;for(let X of Z.stats)if(V.toUpperCase()===X.toUpperCase())H=!0;if(!H){Q=!0;break}}if(Q)this.skillTreeDataCompare.addState(Z,16);let q=J.targetSize;if(q.width!==0&&q.height!==0&&(Math.abs(J.x-Z.x)>q.width||Math.abs(J.y-Z.y)>q.height))this.skillTreeDataCompare.addState(Z,32)}};DrawGroupBackgrounds=()=>{let $=[];for(let J in this.skillTreeData.groups){let Z=this.skillTreeData.groups[J],Q=Z.background;if(Q===void 0)continue;$.push({patch:this.skillTreeData.patch,key:"groupBackground",icon:Q.image,x:Math.ceil(Z.x*this.skillTreeData.scale)+(Q.offsetX?Q.offsetX*this.skillTreeData.scale:0),y:Math.ceil(Z.y*this.skillTreeData.scale)+(Q.offsetY?Q.offsetY*this.skillTreeData.scale:0),half:Q.isHalfImage})}this.DrawSpriteSheetAssets(2,$)};DrawAscendancyBackgrounds=()=>{for(let $ in this.skillTreeData.ascendancyNodes){let J=this.skillTreeData.ascendancyNodes[$];if(!J.isAscendancyStart||J.nodeGroup===void 0)continue;let{nodeGroup:Z,ascendancyName:Q}=J,q=`Classes${J.ascendancyName}`;this.DrawAscendancyBackground(this.skillTreeData.classes.flatMap((K)=>K.ascendancies),Z,Q,"ascendancyBackground",q),this.DrawAscendancyBackground(this.skillTreeData.alternate_ascendancies,Z,Q,"azmeriBackground",q)}};DrawAscendancyBackground=($,J,Z,Q,q)=>{if(!this.skillTreeData.hasSprite(Q,q))return;let K={patch:this.skillTreeData.patch,key:Q,icon:q,x:Math.ceil(J.x*this.skillTreeData.scale),y:Math.ceil(J.y*this.skillTreeData.scale),mask:"circle"},V=this.DrawSpriteSheetAsset(2,K);if($===void 0||$.length===0)return;for(let H in $){let X=$[H];if(X.id!==Z||X.flavourTextRect===void 0)continue;let W=[X.flavourTextRect.x,X.flavourTextRect.y],z=Math.ceil((J.x+ +W[0])*this.skillTreeData.scale)-V.width/2,G=Math.ceil((J.y+ +W[1])*this.skillTreeData.scale)-V.height/2,[Y,w,U]=this.ExtractColour(X.flavourTextColour),C="0x"+(16777216+(Y<<16)+(w<<8)+U).toString(16).slice(1);this.DrawText(2,X.flavourText,C,z,G)}};ExtractColour=($)=>{let J=0,Z=0,Q=0;if($.indexOf(",")>0){let q=$.split(",");J=+q[0],Z=+q[1],Q=+q[2]}else{let q=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec("#"+$);if(q&&q.length===4)J=parseInt(q[1],16),Z=parseInt(q[2],16),Q=parseInt(q[3],16)}return[J,Z,Q]};DrawInactiveCharacters=()=>{if(!this.skillTreeData.hasSprite("startNode","PSStartNodeBackgroundInactive"))return;let $=[];for(let J of this.skillTreeData.root.out){let Z=this.skillTreeData.nodes[J];if(Z.classStartIndex===void 0||Z.nodeGroup===void 0||Z.ascendancyName!=="")continue;$.push({patch:this.skillTreeData.patch,key:"startNode",icon:"PSStartNodeBackgroundInactive",x:Z.nodeGroup.x*this.skillTreeData.scale,y:Z.nodeGroup.y*this.skillTreeData.scale})}this.DrawSpriteSheetAssets(13,$)};DrawInactiveNodes=()=>{if(this.DrawNodes(7,this.skillTreeData.nodes,this.skillTreeData.nodes,{filterClassIndex:!0,bindEvents:!0}),this.skillTreeDataCompare===void 0)return;let $={};for(let J in this.skillTreeDataCompare.nodes){let Z=this.skillTreeDataCompare.nodes[J];if(this.skillTreeData.nodes[Z.GetId()]!==void 0)continue;$[J]=Z}this.DrawNodes(17,$,this.skillTreeDataCompare.nodes,{filterClassIndex:!0,bindEvents:!0})};DrawCompareHighlights=()=>{if(this.skillTreeDataCompare===void 0)return;let $=[];for(let Z in this.skillTreeData.nodes){let Q=this.skillTreeData.nodes[Z];if(Q.nodeGroup===void 0||Q.classStartIndex!==void 0)continue;let q=this.skillTreeDataCompare.nodes[Q.GetId()];if(q===void 0)$.push({node:Q,color:65280});else{if(!(q.is(16)||q.is(32)))continue;$.push({node:Q,color:16756736})}}this.DrawHighlights(10,$);let J=[];for(let Z in this.skillTreeDataCompare.nodes){let Q=this.skillTreeDataCompare.nodes[Z];if(this.skillTreeData.nodes[Q.GetId()]!==void 0)continue;this.skillTreeDataCompare.addState(Q,16),J.push({node:Q,color:16711680})}this.DrawHighlights(17,J)};DrawConnectionsForNodes=($,J)=>{let Z=[],Q={};for(let q in J){let K=J[q];if(K.nodeGroup===void 0||$===3&&K.classStartIndex!==void 0)continue;let V=K.in.filter((H)=>!Q[`${+q}-${H}`]||!Q[`${H}-${+q}`]).map((H)=>{return Q[`${+q}-${H}`]=!0,Q[`${H}-${+q}`]=!0,this.skillTreeData.nodes[H]});if($===3)V=V.filter((H)=>H.classStartIndex===void 0);for(let H of V){if(!this.IsValidConnection(K,H))continue;let X=K.GetConnectionType(H),W=K.group===H.group&&K.orbit===H.orbit?1:0,z=W===1?`Orbit${K.orbit}${X}`:`LineConnector${X}`,G=K.is(1|4)&&H.is(1|4);Z.push({patch:K.patch,key:"line",icon:z,style:W,node:K,other:H,removing:G})}}this.DrawConnections($,Z)};IsValidConnection=($,J)=>{if($.ascendancyName!==""&&J.ascendancyName===""||$.ascendancyName===""&&J.ascendancyName!=="")return!1;if($.classStartIndex!==void 0||J.classStartIndex!==void 0){let Z=this.skillTreeData.getStartClass();return $.classStartIndex===Z||J.classStartIndex===Z}if($.isMastery||J.isMastery)return!1;if($.isWormhole&&J.isWormhole)return!1;if(($.is(4)||$.is(2))&&!(J.is(4)||J.is(2)||J.is(1)))return!1;return!0};DrawNodes=($,J,Z,Q)=>{let q=[],K=[],V=[],H=[];for(let X in J){let W=J[X];if(W.nodeGroup===void 0||Q.filterClassIndex&&W.classStartIndex!==void 0)continue;if(W.activeEffectImage!==""&&W.is(1))q.push({patch:W.patch,key:"masteryActiveEffect",icon:W.activeEffectImage,x:W.x,y:W.y});let z=W.GetIcon();if(!W.isAscendancyStart&&z!=="")if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&W.isMastery&&W.is(2))if(this.skillTreeData.hasSprite("masteryOverlay",z))V.push({patch:W.patch,key:"masteryOverlay",icon:z,x:W.x,y:W.y});else V.push({patch:W.patch,key:"mastery",icon:z,x:W.x,y:W.y,scale:2.5});else K.push({patch:W.patch,key:W.GetSpriteSheetKey(),icon:z,x:W.x,y:W.y,node:Q.bindEvents?W:void 0});let G=W.out.map((U)=>Z[U]).filter((U)=>U);if(Q.filterClassIndex)G=G.filter((U)=>U.classStartIndex===void 0);if(Q.outFrames)for(let U of G){if(U.classStartIndex!==void 0)continue;let C=U.in.map((I)=>Z[I]),N=U.GetFrameAssetKey(C),O=this.GetFrameSpriteSheetKey(U,N);if(N!==null)H.push({patch:W.patch,key:O,icon:N,x:U.x,y:U.y})}let Y=W.GetFrameAssetKey(G),w=this.GetFrameSpriteSheetKey(W,Y);if(Y!==null)H.push({patch:W.patch,key:w,icon:Y,x:W.x,y:W.y,node:Q.bindEvents?W:void 0})}this.DrawSpriteSheetAssets(4,q),this.DrawSpriteSheetAssets(20,V),this.DrawSpriteSheetAssets($,K),this.DrawSpriteSheetAssets($+3,H)};GetFrameSpriteSheetKey=($,J)=>{if(this.skillTreeData.isWildwoodAscendancyClass($))return"azmeri";if(J?.startsWith("Ascendancy"))return"ascendancy";return"frame"};RenderActive=()=>{if(!this.Initialized)return;this.ClearLayer(6),this.ClearLayer(5),this.DrawConnectionsForNodes(5,this.skillTreeData.getNodes(1)),this.ClearLayer(9),this.ClearLayer(12),this.ClearLayer(8),this.ClearLayer(11),this.ClearLayer(4),this.DrawNodes(8,this.skillTreeData.getNodes(1),this.skillTreeData.nodes,{outFrames:!0})};RenderCharacterStartsActive=()=>{if(!this.Initialized)return;this.ClearLayer(1),this.ClearLayer(14);let $=[],J=[];for(let Q of this.skillTreeData.root.out){let q=this.skillTreeData.nodes[Q],K=q.classStartIndex;if(K===void 0||!q.is(1)||q.nodeGroup===void 0)continue;let V=m0.getKeyByValue(this.skillTreeData.constants.classes,K);if(this.skillTreeData.hasSprite("startNode","AtlasPassiveSkillScreenStart"))J.push({patch:q.patch,key:"startNode",icon:"AtlasPassiveSkillScreenStart",x:q.x,y:q.y});else if(V!==void 0){let H=this.skillTreeData.constants.classesToName[V];var Z=`Background${V.replace("Class","")}`;if(this.skillTreeData.extraImages!==void 0&&this.skillTreeData.hasSprite("startNode",Z)){let X=this.skillTreeData.extraImages[K];if(X)$.push({patch:q.patch,key:"startNode",icon:Z,x:X.x*this.skillTreeData.scale,y:X.y*this.skillTreeData.scale,offsetX:0})}J.push({patch:q.patch,key:"startNode",icon:`center${H.toLocaleLowerCase()}`,x:q.x,y:q.y})}}this.DrawSpriteSheetAssets(1,$),this.DrawSpriteSheetAssets(14,J)};RenderHighlight=()=>{if(!this.Initialized)return;this.ClearLayer(18);let $=[],J=this.skillTreeData.getNodes(8);for(let K in J)$.push({node:J[K],color:11817727});let Z=this.skillTreeData.root.out,Q=this.skillTreeData.getNodes(64);for(let K in Q)if(Z.indexOf(K)===-1&&!Q[K].isAscendancyStart)$.push({node:Q[K],color:1031494});let q=this.skillTreeData.getNodes(128);for(let K in q)$.push({node:q[K],color:8388640});this.DrawHighlights(18,$)};StartRenderHover=($)=>{if(!this.Initialized)return;if(this.StopRenderHover($),this.DrawConnectionsForNodes(6,this.skillTreeData.getHoveredNodes()),this.DrawNodes(9,this.skillTreeData.getHoveredNodes(),this.skillTreeData.nodes,{}),this.DrawCompareMovedHighlights(),this.skillTreeDataCompare!==void 0&&$.is(16))this.skillTreeDataCompare.addState($,2);this.RenderTooltip($)};StopRenderHover=($)=>{if(!this.Initialized)return;this.ClearLayer(6),this.ClearLayer(9),this.ClearLayer(12),this.ClearLayer(20),this.ClearLayer(19),this.ClearLayer(21),this.ClearLayer(22),this.DestroyTooltips()};DrawCompareMovedHighlights=()=>{if(this.skillTreeDataCompare===void 0)return;this.skillTreeDataCompare.clearState(2);let $=this.skillTreeData.getNodes(2),J=[];for(let Z in $){let Q=$[Z],q=this.skillTreeDataCompare.nodes[Q.GetId()];if(q===void 0)for(let K in this.skillTreeDataCompare.nodes){let V=this.skillTreeDataCompare.nodes[K];if(Math.abs(V.x-Q.x)<5&&Math.abs(V.y-Q.y)<5)q=V}if(q){if(q.is(16))this.skillTreeDataCompare.addState(q,2);if(q.nodeGroup!==void 0&&q.is(32))J.push({node:q,color:16716947})}}this.DrawHighlights(19,J)}}var a0=f5(Z$(),1);class P1{static v3_22_0=new a0.SemVer("3.22.0");static v3_22_0_atlas=new a0.SemVer("3.22.0-atlas");static v3_23_0=new a0.SemVer("3.23.0");static v3_23_0_atlas=new a0.SemVer("3.23.0-atlas");static v3_24_0=new a0.SemVer("3.24.0");static v3_24_0_standard=new a0.SemVer("3.24.0-standard");static v3_24_0_atlas=new a0.SemVer("3.24.0-atlas");static v3_25_0_pre=new a0.SemVer("3.25.0-pre");static v3_25_0_pre_atlas=new a0.SemVer("3.25.0-pre-atlas");static v3_25_0=new a0.SemVer("3.25.0");static v3_25_0_atlas=new a0.SemVer("3.25.0-atlas");static v3_26_0=new a0.SemVer("3.26.0");static v3_26_0_atlas=new a0.SemVer("3.26.0-atlas");static v3_27_0=new a0.SemVer("3.27.0");static v3_27_0_atlas=new a0.SemVer("3.27.0-atlas");static v3_27_0_atlas_league=new a0.SemVer("3.27.0-atlas-league")}class KZ extends qZ{NodeTooltips;NodeSpritesheets;_dirty=!0;pixi;viewport;cull;DO_NOT_CULL=[21,22];LayerContainers={0:new i,1:new i,2:new i,3:new i,4:new i,5:new i,6:new i,7:new i,8:new i,9:new i,10:new i,11:new i,12:new i,13:new i,14:new i,15:new i,16:new i,17:new i,18:new i,19:new i,20:new i,21:new i,22:new i};constructor($,J,Z){super($,J,Z);this.NodeTooltips={},this.NodeSpritesheets={};let Q=J.tree.slice(0,5)==="Atlas"?P1.v3_22_0_atlas:P1.v3_22_0;this.pixi=new X7({width:window.innerWidth,height:window.innerHeight,resolution:devicePixelRatio,sharedTicker:!0,backgroundColor:J.patch.compare(Q)>=0?461584:1709073,powerPreference:"high-performance"}),C0.shared.stop(),C0.system.stop(),$.appendChild(this.pixi.view),i.defaultSortableChildren=!1,l.defaultOptions.scaleMode=I1.LINEAR,_.ROUND_PIXELS=!1,_.RESOLUTION=devicePixelRatio,R.destroyTextureCache(),z8.reset();let q=this.skillTreeData.imageZoomLevels.length>2?this.skillTreeData.imageZoomLevels[1]-this.skillTreeData.imageZoomLevels[0]:0.1,K={minWidth:this.skillTreeData.width*(q/2),minHeight:this.skillTreeData.height*(q/2),maxWidth:this.skillTreeData.width*(q*30),maxHeight:this.skillTreeData.height*(q*30)};if(this.viewport=new e$({screenWidth:this.pixi.renderer.width,screenHeight:this.pixi.renderer.height,worldWidth:this.skillTreeData.width*(this.skillTreeData.scale*1.25),worldHeight:this.skillTreeData.height*(this.skillTreeData.scale*1.25),events:this.pixi.renderer.events,noTicker:!0,stopPropagation:!0,disableOnContextMenu:!0}),this.viewport.name="viewport",this.viewport.drag().wheel({percent:q}).pinch({percent:q*10}),this.viewport.clampZoom(K),J.tree.slice(0,5)==="Atlas")this.viewport.moveCenter(this.viewport.center.x*(q/2),this.viewport.center.y*(q/2)-2000);this.viewport.fitWorld(!0),this.viewport.zoomPercent(1.726),this.viewport.on("pointerdown",(V)=>v.viewport.fire("down",this.viewport.toScreen(V.global))),this.viewport.on("pointermove",(V)=>v.viewport.fire("move",[this.viewport.toWorld(V.global),this.viewport.toScreen(V.global)])),this.viewport.on("pointerup",(V)=>v.viewport.fire("up",this.viewport.toWorld(V.global))),this.viewport.on("rightup",(V)=>v.viewport.fire("rightup",this.viewport.toWorld(V.global))),this.viewport.on("pointercancel",()=>v.viewport.fire("cancel")),this.pixi.stage.addChild(this.viewport),window.onresize=()=>{this.pixi.renderer.resize(window.innerWidth,window.innerHeight),this.viewport.resize(this.pixi.renderer.width,this.pixi.renderer.height,this.skillTreeData.width*(this.skillTreeData.scale*1.25),this.skillTreeData.height*(this.skillTreeData.scale*1.25)),this.viewport.clampZoom(K)},this.cull=new XJ,super.Tick()}IsDirty(){return this._dirty||this.viewport.dirty}PreUpdate($){this.viewport.update($)}Update($){this.cull.cull(this.pixi.renderer.screen),this.pixi.render(),this._dirty=this.viewport.dirty=!1}PostUpdate($){}SetupLayers(){this.viewport.removeChildren();for(let $ in this.LayerContainers){let J=Number($),Z=this.LayerContainers[J];if(this.DO_NOT_CULL.indexOf(J)===-1)this.cull.add(Z);this.viewport.addChild(Z)}}SetLayer($,J){this._dirty=!0,J.eventMode="none",this.LayerContainers[$]=J;let Z=this.viewport.getChildAt($);if(this.DO_NOT_CULL.indexOf($)===-1)this.cull.remove(Z);if(this.DO_NOT_CULL.indexOf($)===-1)this.cull.add(J);if(J===Z)return;this.viewport.addChild(J),this.viewport.swapChildren(Z,J),this.viewport.removeChild(Z)}GetLayer($){return this.viewport.getChildAt($)}ClearLayer($){this.SetLayer($,new i)}async Initialize(){if(this.Initialized)return!0;return await this.LoadAssets([this.skillTreeData,this.skillTreeDataCompare]),this.InitializeSpriteSheets()}LoadAssets=($)=>{let J=$.filter(m0.NotUndefined);if(J.length<=0)throw new Error("SkillTreeData has not been defined. Could not load assets.");let Z=new Array;for(let V of J)for(let H in V.sprites){let X=V.sprites[H],W=X[V.scale.toString()]||X["1"];if(W===void 0)continue;let z=W.filename;if(z==="LOAD_COORDS"){for(let G in W.coords)if(Z.indexOf(G)<0)Z.push(G),z8.add({alias:G,src:`${m0.SKILL_TREES_URI}/${V.patch}/assets/${G}.png`})}else if(Z.indexOf(z)<0)Z.push(z),z8.add({alias:z,src:`${m0.SKILL_TREES_URI}/${V.patch}/assets/${z}`})}let q=J[0].width/2,K="";return z8.load(Z,(V)=>{let H=`${V*100}%`;if(H!==K){this.viewport.removeChildren(),K=H;let X=new t1;X.moveTo(0,0),X.beginFill(16777215,0.75),X.lineStyle(2,13350300),X.drawRect(0,0,V*q,50),X.endFill(),this.viewport.addChild(X);let W=new d1(K,{fontSize:250,fill:16777215});W.position.set(0,-50),this.viewport.addChild(W),this.Tick()}}).then((V)=>!0)};async InitializeSpriteSheets(){if(this.Initialized)return!0;let $=new Promise((J)=>{this.LoadSpriteSheetAssets([this.skillTreeData,this.skillTreeDataCompare]).then(()=>J(!0))});return $.then(()=>this.Initialized=!0),$}LoadSpriteSheetAssets=($)=>{for(let Z of $){if(Z===void 0)continue;let Q=Z.sprites;for(let q in Q){let K=this.GetSpritesheetKey(Z.patch,q);if(this.NodeSpritesheets[K]===void 0)this.NodeSpritesheets[K]=[];let V=Q[q][Z.scale.toString()]||Q[q]["1"];if(V===void 0)continue;let H=V.filename;if(H==="LOAD_COORDS")for(let X in V.coords){let W=b.from(X),z=this.GetCoordSpritesheetData(V,K,X,W);this.NodeSpritesheets[K]?.push(new k5(W.baseTexture,z))}else{let X=b.from(H),W=this.GetSpritesheetData(V,K);this.NodeSpritesheets[K]?.push(new k5(X.baseTexture,W))}}}let J=new Array;for(let Z in this.NodeSpritesheets){let Q=this.NodeSpritesheets[Z];if(Q!==void 0)for(let q in Q){let K=new Promise((V)=>this.NodeSpritesheets[Z][q].parse().then((H)=>V(!0)));J.push(K)}}return Promise.all(J)};GetSpritesheetData=($,J)=>{let Z={frames:{},animations:void 0,meta:{scale:"1"}};for(let Q in $.coords){let q=$.coords[Q],K=this.GetSpritesheetFrameKey(J,Q);Z.frames[K]={frame:q,rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0},sourceSize:{w:q.w,h:q.h}}}return Z};GetCoordSpritesheetData=($,J,Z,Q)=>{let q={frames:{},animations:void 0,meta:{scale:"1"}},K=$.coords[Z],V=this.GetSpritesheetFrameKey(J,Z);if(K.w===-1&&K.h===-1)K.w=Q.width,K.h=Q.height;return q.frames[V]={frame:K,rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0},sourceSize:{w:K.w,h:K.h}},q};GetSpritesheetKey=($,J)=>{return`${$.version}/${J}`};GetSpritesheetFrameKey=($,J)=>{return`${$}/${J.startsWith("PassiveSkillScreen")?J.replace("PassiveSkillScreen",""):J}`};DrawSpriteSheetAsset=($,J)=>{return this.DrawSpriteSheetAssets($,[J])[0]};DrawSpriteSheetAssets=($,J)=>{let Z=[],Q=this.GetLayer($);for(var q of J){let K=this.GetSpritesheetTexture(q.patch,q.key,q.icon);if(K===null||!K.valid)continue;let V=h0.from(K);V.name=`${q.patch}/${q.key}/${q.icon}`,V.position.set(q.x,q.y),V.eventMode="none";let H=q.offsetX===void 0?0.5:q.offsetX;if(V.anchor.set(H,q.offsetY),q.scale!==void 0)V.scale.set(q.scale);if(Q.addChild(V),q.half){V.anchor.set(H,1);let X=h0.from(K);X.name=`${V.name}-half`,X.rotation=Math.PI,X.position.set(q.x,q.y),X.anchor.set(H,1),X.scale=V.scale,Q.addChild(X)}if(q.mask=="circle"){let X=new t1;X.beginFill(65280),X.drawCircle(V.x,V.y,V.height/2),X.endFill(),V.mask=X,Q.addChild(X)}Z.push({width:V.width,height:V.height*(q.half?2:1)})}return this.SetLayer($,Q),Z};DrawText=($,J,Z,Q,q)=>{let K=this.GetLayer($),V=new d1(J,{fill:Z,fontSize:48,fontFamily:"serif",fontStyle:"italic",stroke:0,strokeThickness:4});V.name=J,V.position.set(Q,q),V.scale.set(this.skillTreeData.scale),K.addChild(V),this.SetLayer($,K)};DrawBackgroundAsset=($,J)=>{let Z=this.GetLayer($),Q=this.GetSpritesheetTexture(J.patch,J.key,J.icon);if(Q===null||!Q.valid)return;if(J.icon==="AtlasPassiveBackground"){let q=h0.from(Q);q.name=J.icon,q.scale.set(2.8173),q.anchor.set(0.506,0.931),Z.addChild(q)}else{Q.baseTexture.wrapMode=X1.REPEAT;let q=10,K=10,V=this.skillTreeData.width*(this.skillTreeData.scale*1.25),H=this.skillTreeData.height*(this.skillTreeData.scale*1.25),X=V/q,W=H/K;for(let z=0;z<K;z++)for(let G=0;G<q;G++){let Y=X*G-V/2,w=W*z-H/2,U=h0.from(Q);U.name=`${J.icon}-r:${z}-c:${G}`,U=b9.from(Q.baseTexture,{width:X,height:W}),U.position.set(Y,w),Z.addChild(U)}}this.SetLayer($,Z)};DrawConnections=($,J)=>{let Z=this.GetLayer($),Q=new i;for(let q of J){let K=this.DrawConnection(q);if(K)Q.addChild(K)}Z.addChild(Q),this.SetLayer($,Z)};DrawConnection=($)=>{switch($.style){case 1:return this.DrawArcConnection($);case 0:return this.DrawLineConnection($)}};DrawArcConnection=($)=>{let J=this.GetSpritesheetTexture($.patch,$.key,$.icon);if(J===null||!J.valid)return null;let{node:Z,other:Q}=$;if(Z.nodeGroup===void 0)return null;let q=Z.arc<Q.arc?Z.arc:Q.arc,K=Z.arc<Q.arc?Q.arc:Z.arc,V=K-q;if(V>=Math.PI){let Y=2*Math.PI-V;q=K,K=q+Y}q-=Math.PI/2,K-=Math.PI/2;let H=K-q,X=Math.ceil(H/(Math.PI/2)),W=Math.PI/2+q,z=new i,G=new t1;G.lineStyle(50*Z.scale,16761035),G.arc(Z.nodeGroup.x*Z.scale,Z.nodeGroup.y*Z.scale,Z.orbitRadii[Z.orbit]*Z.scale,q,K,!1),z.addChild(G);for(let Y=0;Y<X;++Y){let w=h0.from(J);if(w.rotation=H+W,w.position.set(Z.nodeGroup.x*Z.scale,Z.nodeGroup.y*Z.scale),w.anchor.set(1),$.removing)w.tint=16711680;if(w.mask=G,z.addChild(w),H<Math.PI/2)continue;H-=Math.PI/2}return z};DrawLineConnection=($)=>{let J=$.node.skill>$.other.skill?$.node:$.other,Z=$.node.skill>$.other.skill?$.other:$.node,Q=this.GetSpritesheetTexture($.patch,$.key,$.icon);if(Q===null||!Q.valid)return null;let q=new i,K=Math.atan2(Z.y-J.y,Z.x-J.x),V=Math.hypot(J.x-Z.x,J.y-Z.y);var H={x:J.x,y:J.y},X=Math.ceil(V/Q.frame.width);for(let W=0;W<X;++W){let z=V>=Q.frame.width?Q:new b(Q.baseTexture,new y(Q.frame.x,Q.frame.y,V,Q.frame.height)),G=h0.from(z);if(G.anchor.set(0,0.5),G.position.set(H.x,H.y),G.rotation=K,$.removing)G.tint=16711680;q.addChild(G),H={x:H.x+G.width*Math.cos(K),y:H.y+G.width*Math.sin(K)},V-=Q.frame.width}return q};DrawHighlights=($,J)=>{let Z=this.GetLayer($);for(var Q of J){let q=Q.node.targetSize;if(q.width===0||q.height===0)continue;let K=new t1;if(K.name=`highlight-${Q.node.id}`,K.beginFill(0,0),K.lineStyle(5,Q.color),Q.node.is(64))K.drawCircle(0,0,Math.max(q.width,q.height)*0.85);else if(Q.node.is(128))K.lineStyle(7,Q.color),K.moveTo(-q.width*0.7,-q.height*0.7),K.lineTo(q.width*0.7,q.height*0.7),K.moveTo(-q.width*0.7,q.height*0.7),K.lineTo(q.width*0.7,-q.height*0.7);else K.drawRoundedRect(-q.width*0.72,-q.height*0.72,q.width/0.68,q.width/0.68,1);K.endFill(),K.position.set(Q.node.x,Q.node.y),Z.addChild(K)}this.SetLayer($,Z)};CreateScreenshot=async($)=>{return await this.pixi.renderer.extract.base64(this.viewport,$,1)};GetSpritesheetTexture=($,J,Z)=>{let Q=this.GetSpritesheetKey($,J),q=this.GetSpritesheetFrameKey(Q,Z),K=this.NodeSpritesheets[Q];if(K!==void 0)for(let V of K){let H=V.textures[q];if(H!==void 0)return H}return console.warn(`Texture not found for ${q}`),null};RenderTooltip=($)=>{let J=this.GetLayer(21),Z=this.GetLayer(22),Q=void 0,q=void 0,K=10,V=this.CreateTooltip($);if(V.position.set(K/2,K/2),this.skillTreeData.patch===$.patch)Q=new t1,Q.beginFill(0,0.75),Q.lineStyle(2,13350300),Q.drawRect(0,0,V.width+K,V.height+K),Q.endFill(),Q.addChild(V);let H=void 0;if(this.skillTreeDataCompare!==void 0){let X=this.skillTreeDataCompare.getNodes(2);for(let W in X){let z=X[W];if(z.nodeGroup===void 0)continue;H=z;let G=10,Y=this.CreateTooltip(z);Y.position.set(G/2,G/2),q=new t1,q.beginFill(0,0.75),q.lineStyle(2,16756736),q.drawRect(0,0,Y.width+G,Y.height+G),q.endFill(),q.addChild(Y)}}if(Q===void 0&&q!==void 0&&H!==void 0)Q=q,$=H,q=void 0,H=void 0;if(Q!==void 0)J.addChild(Q);if(q!==void 0)Z.addChild(q);if(Q!==void 0&&$!==void 0){let X=Q.getBounds(),W=$.targetSize,z=Q.width/X.width/devicePixelRatio,G=Q.height/X.height/devicePixelRatio;if(Q.worldTransform.tx+X.width>screen.width)Q.x=$.x-Q.width*z-W.width;else Q.x=$.x+W.width;if(Q.worldTransform.ty+X.height>screen.height)Q.y=$.y-Q.height*G+W.height/2;else Q.y=$.y-W.height/2;if(Q.scale.set(z,G),q!==void 0&&H!==void 0){let Y=q.getBounds();q.y=Q.y,q.x=Q.x+Q.width,q.scale.set(q.width/Y.width/devicePixelRatio,q.height/Y.height/devicePixelRatio)}}this.SetLayer(21,J),this.SetLayer(22,Z)};CreateTooltip=($)=>{let J=this.NodeTooltips[`${$.GetId()}_${$.patch}`],Z=this.skillTreeData.getNodes(64);if(J===void 0){let Q=$.name.length>0?new d1(`${$.name} [${$.id}]`,{fill:16777215,fontSize:18}):null,q=$.stats.filter(m0.NotNullOrWhiteSpace).length>0?new d1(`
${$.stats.filter(m0.NotNullOrWhiteSpace).join(`
`)}`,{fill:16777215,fontSize:14}):null,K=$.flavourText.filter(m0.NotNullOrWhiteSpace).length>0?new d1(`
${$.flavourText.filter(m0.NotNullOrWhiteSpace).join(`
`)}`,{fill:11493413,fontSize:14}):null,V=$.reminderText.filter(m0.NotNullOrWhiteSpace).length>0?new d1(`
${$.reminderText.filter(m0.NotNullOrWhiteSpace).join(`
`)}`,{fill:8421504,fontSize:14}):null,H=Z[$.id]!==void 0?new d1("Desired",{fill:16777215,fontSize:18}):null;J=new i,J.position.set(0,0);let X=0;if(Q!==null)J.addChild(Q),Q.position.set(0,X),X+=Q.height;if(q!==null)J.addChild(q),q.position.set(0,X),X+=q.height;if(K!==null)J.addChild(K),K.position.set(0,X),X+=K.height;if(V!==null)V.style.wordWrap=!0,V.style.wordWrapWidth=J.width,J.addChild(V),V.position.set(0,X),X+=V.height;if(H!==null)J.addChild(H),H.position.set(0,X),X+=H.height;J.eventMode="none",J.containerUpdateTransform=()=>{},this.NodeTooltips[`${$.GetId()}_${$.patch}`]=J}return J};DestroyTooltips=()=>{for(let $ in this.NodeTooltips){let J=this.NodeTooltips[$];if(J===void 0)continue;J.destroy({children:!0,texture:!0,baseTexture:!0}),delete this.NodeTooltips[$]}}}class VZ{classes;characterAttributes;PSSCentreInnerRadius;skillsPerOrbit;orbitRadii;classesToName;classIdToName;constructor($){this.classes=$.classes,this.characterAttributes=$.characterAttributes,this.PSSCentreInnerRadius=$.PSSCentreInnerRadius,this.skillsPerOrbit=$.skillsPerOrbit,this.orbitRadii=$.orbitRadii,this.classesToName={StrClass:"Marauder",DexClass:"Ranger",IntClass:"Witch",StrDexClass:"Duelist",StrIntClass:"Templar",DexIntClass:"Shadow",StrDexIntClass:"Scion"},this.classIdToName={0:"Scion",1:"Marauder",2:"Ranger",3:"Witch",4:"Duelist",5:"Templar",6:"Shadow"}}}class HZ{_cells;_bounds;_dimensions;_queryIds;constructor($,J){let[Z,Q]=J;this._cells=[...Array(Z)].map((q)=>[...Array(Q)].map((K)=>null)),this._dimensions=J,this._bounds=$,this._queryIds=0}getCellIndex=($)=>{let J=this.sat(($.x-this._bounds[0][0])/(this._bounds[1][0]-this._bounds[0][0])),Z=this.sat(($.y-this._bounds[0][1])/(this._bounds[1][1]-this._bounds[0][1])),Q=Math.floor(J*(this._dimensions[0]-1)),q=Math.floor(Z*(this._dimensions[1]-1));return[Q,q]};add=($,J,Z)=>{let Q={id:$,position:J,dimensions:Z,_cells:{min:null,max:null,nodes:null},_queryId:-1},q=Q.position.x,K=Q.position.y,V=Q.dimensions.width,H=Q.dimensions.height,X=this.getCellIndex({x:q-V/2,y:K-H/2}),W=this.getCellIndex({x:q+V/2,y:K+H/2}),z=new Array;for(let G=X[0],Y=W[0];G<=Y;++G){z.push([]);for(let w=X[1],U=W[1];w<=U;++w){let C=G-X[0],N={next:null,prev:null,client:Q};if(z[C].push(N),N.next=this._cells[G][w],this._cells[G][w]!==null)this._cells[G][w].prev=N;this._cells[G][w]=N}}Q._cells.min=X,Q._cells.max=W,Q._cells.nodes=z};find=($,J)=>{let{x:Z,y:Q}=$,q=J.width,K=J.height,V=this.getCellIndex({x:Z-q/2,y:Q-K/2}),H=this.getCellIndex({x:Z+q/2,y:Q+K/2}),X=new Array,W=this._queryIds++;for(let z=V[0],G=H[0];z<=G;++z)for(let Y=V[1],w=H[1];Y<=w;++Y){let U=this._cells[z][Y];while(U){let C=U.client;if(U=U.next,C._queryId!=W)C._queryId=W,X.push(C.id)}}return X};sat=($)=>{return Math.min(Math.max($,0),1)}}class XZ{tree;patch;version;masteryEffects;classes;alternate_ascendancies;groups;root;nodes;min_x;min_y;max_x;max_y;desired_min_x;desired_min_y;desired_max_x;desired_max_y;imageZoomLevels;sprites;constants;points;jewelSlots;extraImages;width;height;maxZoomLevel;scale;classStartNodes;ascendancyNodes;nodesInState={0:new Array,1:new Array,2:new Array,4:new Array,8:new Array,16:new Array,32:new Array,64:new Array,128:new Array};grid;constructor($,J){this.tree=$.tree||"Default",this.patch=J,this.version=4,$.version=this.version,this.masteryEffects=[],this.jewelSlots=$.jewelSlots,this.extraImages=$.extraImages,this.groups=$.groups,this.root=$.nodes.root,this.extraImages=$.extraImages,this.min_x=$.min_x,this.max_x=$.max_x,this.min_y=$.min_y,this.max_y=$.max_y,this.desired_min_x=1e5,this.desired_max_x=-1e5,this.desired_min_y=1e5,this.desired_max_y=-1e5,this.imageZoomLevels=$.imageZoomLevels,this.constants=new VZ($.constants),this.points=$.points||{totalPoints:121,ascendancyPoints:8},this.width=Math.abs(this.min_x)+Math.abs(this.max_x),this.height=Math.abs(this.min_y)+Math.abs(this.max_y),this.maxZoomLevel=$.imageZoomLevels.length-1,this.scale=$.imageZoomLevels[this.maxZoomLevel],this.sprites=$.sprites,this.classes=$.classes||[],this.alternate_ascendancies=$.alternate_ascendancies||[],this.root.id="root",delete $.nodes.root;let Z=1450;if(this.classes.length>0){let q={};for(let K in $.nodes){let V=$.nodes[K],H=`${V.group||0}`;if(V.isAscendancyStart&&q[H]===void 0){let X=void 0;for(let U of V.out)if($.nodes[U].classStartIndex!==void 0)X=$.nodes[U];for(let U of V.in)if($.nodes[U].classStartIndex!==void 0)X=$.nodes[U];if(X===void 0)continue;let W=0;if(X.classStartIndex!==void 0){let U=this.classes[X.classStartIndex].ascendancies;for(let C in U)if(V.ascendancyName&&U[C].id.toLowerCase().includes(V.ascendancyName.toLowerCase())){W=+C-1;break}}let z=100,G=0,Y=0,w=this.groups[X.group||0];if(w.x>-z&&w.x<z&&(w.y>-z&&w.y<z)){if(G=this.min_x*0.65,Y=this.max_y*0.95,this.patch.compare(P1.v3_22_0)>=0)G=this.min_x*0.85,Y=this.max_y*0.85}else if(w.x>-z&&w.x<z)G=w.x+Math.sign(w.x)*W*Z,Y=Math.sign(w.y)>0?this.max_y*1.05:this.min_y;else if(G=w.x<0?this.min_x*0.8:this.max_x,Y=w.y+Math.sign(w.y)*(W+1)*Z,this.patch.compare(P1.v3_22_0)>=0)G=w.x<0?this.min_x*1.05:this.max_x;q[H]=!0;for(let U in $.nodes){let C=$.nodes[U],N=`${C.group||0}`;if(q[N]===void 0&&C.ascendancyName===V.ascendancyName){let O=this.groups[H].x-this.groups[N].x,I=this.groups[H].y-this.groups[N].y;this.groups[N].x=G-O,this.groups[N].y=Y-I,q[N]=!0}}this.groups[H].x=G,this.groups[H].y=Y}}}if(this.alternate_ascendancies.length>0){let q={};for(let K in $.nodes){let V=$.nodes[K],H=`${V.group||0}`;if(!V.isAscendancyStart||q[H]!==void 0)continue;let X=-1;for(let Y in this.alternate_ascendancies)if(this.alternate_ascendancies[Y].id===V.ascendancyName){X=+Y;break}if(X===-1)continue;let W=X-1,z=this.max_x*0.8+W*-Z*0.75,G=this.max_y*0.9+W*Z*0.75;q[H]=!0;for(let Y in $.nodes){let w=$.nodes[Y],U=`${w.group||0}`;if(q[U]===void 0&&w.ascendancyName===V.ascendancyName){let C=this.groups[H].x-this.groups[U].x,N=this.groups[H].y-this.groups[U].y;this.groups[U].x=z-C,this.groups[U].y=G-N,q[U]=!0}}this.groups[H].x=z,this.groups[H].y=G}}this.grid=new HZ([[this.min_x,this.min_y],[this.max_x,this.max_y]],[100,100]),this.nodes={},this.classStartNodes={},this.ascendancyNodes={};let Q=this.getOrbitAngles($.constants.skillsPerOrbit);for(let q in $.nodes){let K=$.nodes[q].group||0,V=new QZ(q,$.nodes[q],this.groups[K],$.constants.orbitRadii,Q,this.scale,this.patch);if(this.root.out.indexOf(q)>=0){if(V.classStartIndex===void 0&&V.ascendancyName==="")V.classStartIndex=this.root.out.indexOf(q);if(V.ascendancyName!=="")V.isAscendancyStart=!0}if(this.nodes[q]=V,V.classStartIndex===this.getDefaultStartNode())this.addState(V,1),this.addState(V,64);if(V.ascendancyName!=="")this.ascendancyNodes[q]=V;if(V.classStartIndex!==void 0)this.classStartNodes[q]=V;if(this.shouldAddToGrid(V))this.grid.add(V.id,{x:V.x,y:V.y},V.targetSize)}}getDefaultStartNode=()=>{if(this.tree.slice(0,5)==="Atlas")return 0;return 3};shouldAddToGrid=($)=>{return $.group!==void 0&&$.classStartIndex===void 0};getOrbitAngles=($)=>{let J={};for(let q in $){let K=$[q];if(J[q]=[],K===16)J[q]=[0,30,45,60,90,120,135,150,180,210,225,240,270,300,315,330];else if(K===40)J[q]=[0,10,20,30,40,45,50,60,70,80,90,100,110,120,130,135,140,150,160,170,180,190,200,210,220,225,230,240,250,260,270,280,290,300,310,315,320,330,340,350];else for(let V=0;V<K;V++)J[q].push(360*V/K)}let Z={},Q=Math.PI/180;for(let q in J){let K=J[q];Z[q]=[];for(let V of K)Z[q].push(V*Q)}return Z};getStartClass=()=>{for(let $ in this.classStartNodes)if(this.nodes[$].is(1))return this.nodes[$].classStartIndex||0;for(let $ in this.classStartNodes)return this.addState(this.nodes[$],1),this.addState(this.nodes[$],64),this.nodes[$].classStartIndex||0;return 0};getAscendancyClass=()=>{if(this.classes===void 0||this.classes.length===0)return 0;for(let $ in this.ascendancyNodes)if(this.nodes[$].isAscendancyStart&&this.nodes[$].is(1))for(let J in this.classes){let Z=this.classes[J].ascendancies;if(Z===void 0)continue;for(let Q in Z)if(Z[Q].id===this.nodes[$].ascendancyName)return+Q+1}return 0};getWildwoodAscendancyClass=()=>{if(this.alternate_ascendancies===void 0||this.alternate_ascendancies.length===0)return 0;for(let $ in this.ascendancyNodes)if(this.nodes[$].isAscendancyStart&&this.nodes[$].is(1)){for(let J in this.alternate_ascendancies)if(this.alternate_ascendancies[J].id===this.nodes[$].ascendancyName)return+J+1}return 0};isWildwoodAscendancyClass=($)=>{if($.ascendancyName==="")return!1;for(let J of this.alternate_ascendancies)if($.ascendancyName===J.id)return!0;return!1};getMasteryForGroup=($)=>{if($===void 0||$.nodes===void 0)return null;for(let J of $.nodes){let Z=this.nodes[J];if(!Z.isMastery)continue;return Z}return null};getSkilledNodes=()=>this.getNodes(1);getDesiredNodes=()=>this.getNodes(64);getUndesiredNodes=()=>this.getNodes(128);getClassStartNodes=()=>this.classStartNodes;getHoveredNodes=()=>{let $={};for(let J in this.getNodes(2))$[J]=this.nodes[J];for(let J in this.getNodes(4))$[J]=this.nodes[J];return $};getNodes=($)=>{let J={};for(let Z of this.nodesInState[$])if(this.nodes[Z].is($))J[Z]=this.nodes[Z];return J};getNodesInRange=($,J,Z)=>{let Q=[];for(let q in this.nodes){let K=this.nodes[q];if(K.isMastery)continue;let V=Math.abs(K.x-$),H=Math.abs(K.y-J);if(V*V+H*H<Z*Z&&Math.abs(K.y-J)<Z)Q.push(K)}return Q};getNodeAtPoint=($)=>{let J=this.grid.find($,{width:0,height:0});if(J.length===0)return null;let Z=null,Q=null;for(let q of J){let K=this.nodes[q],V=this.inRange(K,$);if(V===null)continue;if(Q===null||V<Q)Z=K,Q=V}return Z};inRange=($,J)=>{let Z=$.targetSize,Q=Z.width*Z.height*this.scale,q=this.getDistance($,J);return q<Q?q:null};getDistance=($,J)=>{let Z={x:$.x-J.x,y:$.y-J.y};return Z.x*Z.x+Z.y*Z.y};addState=($,J)=>this.addStateById($.GetId(),J);addStateById=($,J)=>{if(this.nodes[$]===void 0)return;if(this.nodes[$].is(J))return;if(J===64)this.desired_min_x=this.nodes[$].x<this.desired_min_x?this.nodes[$].x:this.desired_min_x,this.desired_min_y=this.nodes[$].y<this.desired_min_y?this.nodes[$].y:this.desired_min_y,this.desired_max_x=this.nodes[$].x>this.desired_max_x?this.nodes[$].x:this.desired_max_x,this.desired_max_y=this.nodes[$].y>this.desired_max_y?this.nodes[$].y:this.desired_max_y;this.nodes[$]._add(J),this.nodesInState[J].push($)};removeState=($,J)=>this.removeStateById($.GetId(),J);removeStateById=($,J)=>{if(this.nodes[$]===void 0)return;if(!this.nodes[$].is(J))return;if(this.nodes[$]._remove(J),this.nodesInState[J].splice(this.nodesInState[J].indexOf($),1),J===64){this.desired_min_x=1e5,this.desired_max_x=-1e5,this.desired_min_y=1e5,this.desired_max_y=-1e5;for(let Z of Object.values(this.getNodes(J)))this.desired_min_x=Z.x<this.desired_min_x?Z.x:this.desired_min_x,this.desired_min_y=Z.y<this.desired_min_y?Z.y:this.desired_min_y,this.desired_max_x=Z.x>this.desired_max_x?Z.x:this.desired_max_x,this.desired_max_y=Z.y>this.desired_max_y?Z.y:this.desired_max_y}};clearState=($)=>{for(let J in this.getNodes($))if(this.nodes[J]._remove($),$===2)this.nodes[J].hoverText=null;this.nodesInState[$]=new Array};hasSprite=($,J)=>{return this.sprites[$]&&(this.sprites[$][this.scale.toString()]&&this.sprites[$][this.scale.toString()].coords[J]!==void 0||this.sprites[$]["1"]&&this.sprites[$]["1"].coords[J]!==void 0)}}class WZ{skillTreeData;fixedGroups;constructor($,J){this.skillTreeData=$,this.fixedGroups=J}Execute($,J){let Q=Object.values(this.skillTreeData.getNodes(1)).filter((N)=>!N.is(64)&&N.classStartIndex===void 0&&!N.isAscendancyStart);for(let N of Q)this.skillTreeData.removeState(N,1);let q=Object.values(this.skillTreeData.getNodes(64)),K=[];for(let N of q)this.skillTreeData.addState(N,1),K.push([N]);let V=!1;while(!V){let N=void 0,O=void 0;for(let I of K){for(let B of I){if(B.isMastery)continue;let F=[...B.in,...B.out];for(let P of F){let L=this.skillTreeData.nodes[P];if(L.isMastery)continue;if(L.is(1)&&!I.includes(L)){N=B,O=L;break}}if(N&&O)break}if(N&&O)break}if(N&&O){let I=K.find((P)=>P.includes(N)),B=K.find((P)=>P.includes(O)),F=this.mergeGroups(I,B);K=K.filter((P)=>P.map((L)=>L.skill).sort().join(",")!==I.map((L)=>L.skill).sort().join(",")&&P.map((L)=>L.skill).sort().join(",")!=B.map((L)=>L.skill).sort().join(",")),K.push(F)}else V=!0}let H=0.01,X=this.adjustDesiredGroupDistances(q.filter((N)=>N.isNotable),H*3);for(let N of Object.values(this.skillTreeData.nodes).filter((O)=>O.isNotable)){X[N.skill]=X[N.skill]?X[N.skill]-0.5:0.5;for(let O of N.stats)if(O.includes("maximum Life"))X[N.skill]=X[N.skill]?X[N.skill]-2*H:1-2*H}let W=["0.5% chance for map drops to be duplicated","1% increased quantity of items found in your maps","3% increased scarabs found in your maps","2% increased effect of modifiers on your maps","2% chance for one monster in each of your maps to drop an additional connected map"];for(let N in K){if(K[N].some((O)=>O.classStartIndex!==void 0))continue;for(let O of K[N]){let I=O.earliestMandatoryNode;if(I===O.skill||O.ascendancyName!==void 0&&O.ascendancyName!=="")continue;let B=this.skillTreeData.nodes[I];if(!B.is(1)){this.skillTreeData.addState(B,1);let F=[...new Set([...B.in,...B.out])],P=!1;for(let L in K){if(K[L].map((M)=>M.GetId()).includes(B.GetId()))continue;if(K[L].some((M)=>F.includes(M.GetId()))){K[L].push(B),P=!0;break}}if(!P)K.push([B])}}}let z=Object.values(this.skillTreeData.nodes).filter((N)=>this.skillTreeData.tree==="Default"?N.isRegular1:N.isRegular2&&N.stats.some((O)=>W.includes(O.toLowerCase())));for(let N of z)X[N.id]=X[N.id]!==void 0?X[N.id]-H:1-H;if(this.skillTreeData.tree.slice(0,5)==="Atlas"){let N=["Alva","Anarchy","Bestiary","Beyond","Blight","Breach","CleansingFire","Conqueror","Delirium","Delve","Domination","ElderShaper","Essence","Expedition","Harbinger","Harvest","Heist","Jun","Kirac","Labyrinth","Legion","Map","Metamorph","Necropolis","Ritual","Scarab","Sextant","Strongbox","Synthesis","Tangle","Torment","Vaal"];for(let I of N)if(q.filter((B)=>B.GetIcon().toLowerCase().indexOf(I.toLowerCase())>-1&&B.GetIcon().toLowerCase().indexOf("wheelofdisabling")===-1).filter((B)=>!z.includes(B)).length>0){let B=Object.values(this.skillTreeData.nodes).filter((F)=>F.GetIcon().toLowerCase().indexOf(I.toLowerCase())>-1&&F.GetIcon().toLowerCase().indexOf("wheelofdisabling")===-1).filter((F)=>!z.includes(F));for(let F of B)X[F.id]=X[F.id]!==void 0?X[F.id]-2*H:1-2*H}let O=Object.values(this.skillTreeData.nodes).filter((I)=>I.isRegular2);for(let I of O){let B=!1;for(let L of I.stats)if(W.includes(L.toLowerCase()))B=!0;if(B)continue;let F=[...new Set([...I.in,...I.out])],P=!1;for(let L of F){let M=this.skillTreeData.nodes[L];for(let E of M.stats){if(W.includes(E.toLowerCase()))P=!0;if(P){X[I.id]=X[I.id]!==void 0?X[I.id]-H:1-H;break}}if(P)break}}for(let I of Object.values(this.skillTreeData.nodes).filter((B)=>B.isWormhole))X[I.id]=1.5;if(this.skillTreeData.nodes["65225"].is(64))for(let I of Object.values(this.skillTreeData.nodes).filter((B)=>B.isRegular2&&B.stats.some((F)=>F.toLowerCase()==="3% increased scarabs found in your maps")))X[I.id]=1.1}if(K.length>1){let N=0,O=!0;while(K.length>1){let L=function(n,S){let Z0=n.reduce((t,I0)=>t+P[I0.skill],0)/(n.length-2),V0=S.reduce((t,I0)=>t+P[I0.skill],0)/(S.length-2);if(Z0===void 0||V0===void 0)return 0;if(Z0<V0)return 1;if(Z0>V0)return-1;return 0},M=function(n,S){let Z0=n.reduce((t,I0)=>t+=I0.is(64)||I0.is(1)?0:X[I0.GetId()]?X[I0.GetId()]:1,0),V0=S.reduce((t,I0)=>t+=I0.is(64)||I0.is(1)?0:X[I0.GetId()]?X[I0.GetId()]:1,0);if(O){let t=n.some((b5)=>b5.classStartIndex!==void 0),I0=S.some((b5)=>b5.classStartIndex!==void 0);if(t&&I0)return 0;if(t&&!I0)return 1;if(!t&&I0)return-1}if(Z0===void 0||V0===void 0)return 0;if(Z0<V0)return-1;if(Z0>V0)return 1;return 0};if(++N>400){console.log("Infinite loop detection triggered. Please report this as a bug.");break}if(!1)return;let B=[],F=K.some((n)=>n.every((S)=>!S.isMastery));for(let n of K){if(F&&n.length===1&&(n[0].isMastery&&[...new Set([...n[0].in,...n[0].out])].map((Z0)=>this.skillTreeData.nodes[Z0]).some((Z0)=>Z0.is(1)||Z0.is(64))))continue;let S=$.Execute(this.skillTreeData,n,X,!1);for(let Z0 of S)if(Z0.length>0)B.push(Z0)}let P={};for(let n of B)for(let S of n)if(n.indexOf(S)!==0&&n.indexOf(S)!==n.length-1)P[S.skill]=P[S.skill]?P[S.skill]+1:1;else P[S.skill]=P[S.skill]?P[S.skill]:0;if(B.sort(L),B.sort(M),K.length<=2)O=!1;if(B.length==0)break;let E=B.shift();if(E===void 0)return;let g=E.shift();if(g===void 0)return;if(!g.is(1))this.skillTreeData.addState(g,1);for(let n of E)if(!n.is(1))this.skillTreeData.addState(n,1);let o=E[E.length-1],f=K.find((n)=>n.includes(g)),x=K.find((n)=>n.includes(o));if(f===void 0||x===void 0){console.log(K),console.log(f,g),console.log(x,o);return}let k=this.mergeGroups(f,x);K=K.filter((n)=>n.map((S)=>S.skill).sort().join(",")!==f.map((S)=>S.skill).sort().join(",")&&n.map((S)=>S.skill).sort().join(",")!=x.map((S)=>S.skill).sort().join(","));let T=E.filter((n)=>![...k].includes(n)),J0=[...k,...T];K.push(J0)}}let G={},Y=[...q],w={};while(Y.length>0){let N=Y.shift();if(N===void 0)break;w[N.GetId()]=N,G[N.GetId()]=N;let O=[...new Set([...N.out,...N.in])].map((I)=>this.skillTreeData.nodes[I]).filter((I)=>I.is(1));if(O.length>1)continue;for(let I of O){if(w[I.GetId()])continue;Y.push(I)}}if(Object.values(this.skillTreeData.getNodes(1)).length<=1)return;let U=Object.values(this.skillTreeData.getNodes(1)).filter((N)=>N.classStartIndex!==void 0)[0]?.out.filter((N)=>this.skillTreeData.nodes[N].is(1)).map((N)=>this.skillTreeData.nodes[N]);for(let N of U)G[N.GetId()]=N;let C=Object.values(this.skillTreeData.getNodes(1)).filter((N)=>!G[N.GetId()]);for(let N of C){let O=[...U],I={};while(O.length>0){let F=O.shift();if(F===void 0)break;if(I[F.GetId()]=F,F.isMastery)continue;let P=[...new Set([...F.out,...F.in])].filter((L)=>!I[L]).map((L)=>this.skillTreeData.nodes[L]).filter((L)=>L.is(1)).filter((L)=>L.GetId()!==N.GetId());for(let L of P){if(I[L.GetId()])continue;O.unshift(L)}}let B=!0;for(let F of q)if(!I[F.GetId()]){B=!1;break}if(!B)G[N.GetId()]=N;else{let F=N;if(F===void 0)break;this.skillTreeData.removeState(F,1)}}}mergeGroups=($,J)=>{if($===void 0||J===void 0)return console.log("Group undefined"),console.log($),console.log(J),new Array;return[...$,...J]};adjustDesiredGroupDistances=($,J)=>{let Z={};function Q(q,K,V,H){let X=V-q,W=H-K;return Math.sqrt(X*X+W*W)}for(let q of $){let K=q.group;if(K===void 0)continue;let H=this.skillTreeData.groups[K].nodes,X=0,W=0,z=0,G="";for(let N of H){let O=this.skillTreeData.nodes[N];if(O.isMastery)G=O.name;W+=O.x,z+=O.y}let Y=W/H.length,w=z/H.length,U=!1;for(let N of H){let O=this.skillTreeData.nodes[N];if(O.name==="Map Drop Duplication"||O.name==="Adjacent Map Drop Chance")continue;if(U)console.log(O.name);let I=Q(Y,w,O.x,O.y);X=I>X?I:X}let C=this.skillTreeData.getNodesInRange(Y,w,X*1.05);for(let N of C){let O=!1;if(G!=""&&N.group&&N.group!==K)for(let I of this.skillTreeData.groups[N.group].nodes){let B=this.skillTreeData.nodes[I];if(B.isMastery&&B.name!==G)O=!0}if(O)continue;Z[N.id]=1-J}}return Z}}var cZ=f5(bW(),1);class mZ{Execute($,J,Z,Q){if(Q=!1,J.length===0)return new Array;let q=[],K=999,V=new cZ.FibonacciHeap((U,C)=>{let N=X[U.id],O=X[C.id];if(N===void 0||O===void 0)return 0;if(N<O)return-1;if(N>O)return 1;return 0}),H=new cZ.FibonacciHeap((U,C)=>{if(U.length===void 0||C.length===void 0)return 0;if(U.length<C.length)return-1;if(U.length>C.length)return 1;return 0}),X={},W={},z={},G={};for(let U of J)V.push(U),X[U.id]=0;while(V.size>0){let U=V.pop();if(U===void 0){if(Q)console.log("frontierNode undefined");break}if(q.includes(U.GetId()))continue;if(Q)console.log("Current frontier ID",U.GetId());W[U.GetId()]=U;let C=X[U.GetId()],N=0,O=[...new Set([...U.out,...U.in])];for(let I of O){if(++N>20)break;if(Q)console.log("Current out ID",I);let B=$.nodes[I];if(U.ascendancyName===""&&B.ascendancyName!==""&&!B.is(1)||U.ascendancyName!==""&&B.ascendancyName===""&&!U.is(1))continue;let F=C+(B.classStartIndex||B.is(1||J.includes(B))?0:Z[I]!==void 0?Z[I]:1);if(Q)console.log("Shortest path "+K+" and newDist "+F);if(W[I]||K<F||X[I]&&X[I]<F)continue;if((B.classStartIndex!==void 0||B.isAscendancyStart)&&!B.is(1))continue;if(B.is(128)||B.isMastery)continue;if(Q&&!B.isMastery)console.log("Adding out node to frontier");if(X[I]=F,Q)console.log("Distance to out node",X[I]);if(z[I]=U,!B.isMastery)V.push(B);if(Q)console.log("Is out active?",B.is(1));if(!J.includes(B)&&B.is(1)){let P=B;if(Q)console.log("FOUND NODE");if(P===U||X[P.GetId()]===void 0);G[P.GetId()]=X[P.GetId()];let L=P,M=J.map((o)=>o.GetId()),E=new Array,g=!1;while(L!==void 0){if(!M.includes(L.GetId())){if(Q)console.log("Added "+L.GetId()+", "+L.name+" to path");E.push(L)}else if(!g){if(Q)console.log("Added "+L.GetId()+", "+L.name+" to path");E.push(L),g=!0}if(!q.includes(L.GetId()))q.push(L.GetId());L=z[L.GetId()]}if(G[E[0].GetId()]>K*2){let o=[],f=H.pop();while(f!==void 0){if(Q)console.log("Path distances",G[f[0].GetId()],K);if(G[f[0].GetId()]<=K)o.push(f);else break;f=H.pop()}if(Q)console.log("Returning "+o.length+" paths");return o}K=G[E[0].GetId()]+1,H.push(E.reverse())}}}let Y=[],w=H.pop();while(w!==void 0){if(Q)console.log("Path distances 2",G[w[w.length-1].GetId()],K);if(G[w[w.length-1].GetId()]<=K)Y.push(w);else break;w=H.pop()}if(Q)console.log("Returning "+Y.length+" paths");return Y}}class uZ{canDecode($){return $.length>=6&&this.version($)==3}decode($){let J=this.version($),Z=this.class($),Q=this.fullscreen($),q=new Array;for(let K=6;K<$.length;K+=2){if(K+1>$.length)break;q.push($[K]<<8|$[K+1])}return{version:J,class:Z,ascendancy:0,wildwoodAscendancy:0,nodeCount:q.length,nodes:q,extendedNodeCount:0,extendedNodes:[],masteryEffectCount:0,masteryEffects:[]}}version($){return $[0]<<24|$[1]<<16|$[2]<<8|$[3]}class($){return $[4]}fullscreen($){return $[5]}}class dZ{canDecode($){return $.length>=7&&this.version($)==4}decode($){let J=this.version($),Z=this.class($),Q=this.ascendancy($),q=this.fullscreen($),K=new Array;for(let V=7;V<$.length;V+=2){if(V+1>$.length)break;K.push($[V]<<8|$[V+1])}return{version:J,class:Z,ascendancy:Q,wildwoodAscendancy:0,nodeCount:K.length,nodes:K,extendedNodeCount:0,extendedNodes:[],masteryEffectCount:0,masteryEffects:[]}}version($){return $[0]<<24|$[1]<<16|$[2]<<8|$[3]}class($){return $[4]}ascendancy($){return $[5]}fullscreen($){return $[6]}}class pZ{canDecode($){return $.length>=8&&this.version($)==5}decode($){let J=this.version($),Z=this.class($),Q=this.ascendancy($),q=6,K=$[q++],V=new Array;for(let W=0;W<K;W++){if(q+1>$.length)break;V.push($[q++]<<8|$[q++])}let H=$[q++],X=new Array;for(let W=0;W<H;W++){if(q+1>$.length)break;X.push($[q++]<<8|$[q++])}return{version:J,class:Z,ascendancy:Q,wildwoodAscendancy:0,nodeCount:V.length,nodes:V,extendedNodeCount:X.length,extendedNodes:X,masteryEffectCount:0,masteryEffects:[]}}version($){return $[0]<<24|$[1]<<16|$[2]<<8|$[3]}class($){return $[4]}ascendancy($){return $[5]}}class lZ{canDecode($){return $.length>=9&&this.version($)==6}decode($,J){let Z=this.version($),Q=this.class($),q=this.ascendancyByte($),K=q&3,V=q>>2,H=6,X=$[H++],W=J?0:$[H++],z=J?0:$[H++],G=new Array,Y=new Array,w=new Array,U=new Array;if(J){for(let F=0;F<X;F++){if(H+1>$.length)break;G.push($[H++]<<8|$[H++])}let B=$[H++];for(let F=0;F<B;F++){if(H+1>$.length)break;Y.push($[H++]<<8|$[H++])}}else{for(let B=0;B<W;B++){if(H+1>$.length)break;w.push($[H++]<<8|$[H++])}for(let B=0;B<z;B++){if(H+1>$.length)break;U.push($[H++]<<8|$[H++])}G.push($[H++]<<8|$[H++])}let C=$[H++],N=new Array;for(let B=0;B<C;B++){if(H+3>$.length)break;var O=$[H++]<<8|$[H++],I=$[H++]<<8|$[H++];N.push([I,O])}return{version:Z,class:Q,ascendancy:K,wildwoodAscendancy:V,nodeCount:G.length,nodes:G,extendedNodeCount:Y.length,extendedNodes:Y,masteryEffectCount:N.length,masteryEffects:N,desiredNodes:w,undesiredNodes:U}}version($){return $[0]<<24|$[1]<<16|$[2]<<8|$[3]}class($){return $[4]}ascendancyByte($){return $[5]}}class u7{static _decoders=[new lZ,new pZ,new dZ,new uZ];encodeURL($,J){let Z=[],Q=6;Z.push(0),Z.push(0),Z.push(0),Z.push(6),Z.push($.getStartClass());let q=$.getAscendancyClass(),K=$.getWildwoodAscendancyClass();Z.push(K<<2|q&3);let V=$.getSkilledNodes(),H=new Array,X=new Array,W=$.getDesiredNodes(),z=$.getUndesiredNodes();if(!J){for(let w in W)H.push(W[w]);for(let w in z)H.push(z[w]);let Y=Object.values($.getClassStartNodes()).filter((w)=>Object.keys(V).includes(w.id||String(w.skill)))[0];H.push(Y)}else{for(let Y in V){let w=V[Y];if(w.classStartIndex!==void 0||w.isAscendancyStart)continue;if(w.expansionJewel!==void 0)X.push(w);else if(!w.isMastery)H.push(w)}H.sort((Y,w)=>{return+(Y.id||Y.skill)-+(w.id||Y.skill)})}if(Z.push(H.length),!J)Z.push(Object.keys(W).length),Z.push(Object.keys(z).length);for(let Y of H)Z.push(+(Y.id||Y.skill)>>8&255),Z.push(+(Y.id||Y.skill)&255);Z.push(X.length);for(let Y of X)Z.push(+(Y.id||Y.skill)>>8&255),Z.push(+(Y.id||Y.skill)&255);let G=new Array;for(let Y in $.masteryEffects){let w=$.masteryEffects[Y];G.push([+Y,w])}Z.push(G.length);for(let[Y,w]of G)Z.push(w>>8&255),Z.push(w&255),Z.push(Y>>8&255),Z.push(Y&255);return this.Uint8ArryToBase64(new Uint8Array(Z))}decodeURL($,J,Z){let Q=this.Base64ToUint8Array($),q=this.decode(Q,Z),K={Version:q.version,Class:q.class,Ascendancy:q.ascendancy,WildwoodAscendancy:q.wildwoodAscendancy,Nodes:[],ExtendedNodes:[],MasteryEffects:[],Desired:new Array,Undesired:new Array};for(let V of q.nodes){let H=J.nodes[V.toString()];if(H!==void 0)K.Nodes.push(H)}for(let V of q.desiredNodes){let H=J.nodes[V.toString()];if(H!==void 0)K.Desired.push(H)}for(let V of q.undesiredNodes){let H=J.nodes[V.toString()];if(H!==void 0)K.Undesired.push(H)}for(let V of q.extendedNodes){let H=J.nodes[V.toString()];if(H!==void 0)K.ExtendedNodes.push(H)}for(let[V,H]of q.masteryEffects){let X=J.nodes[V.toString()];if(X!==void 0)K.MasteryEffects.push([X,H])}return K}decode($,J){for(let Z of u7._decoders)if(Z.canDecode($))return Z.decode($,J);return{version:6,class:3,ascendancy:0,wildwoodAscendancy:0,nodeCount:0,nodes:[],extendedNodeCount:0,extendedNodes:[],masteryEffectCount:0,masteryEffects:[],desiredNodes:[],undesiredNodes:[]}}Uint8ArryToBase64=($)=>{return btoa(Array.prototype.map.call($,(J)=>String.fromCharCode(J)).join("")).replace(/\+/gi,"-").replace(/\//gi,"_")};Base64ToUint8Array=($)=>{$=atob($.replace(/-/gi,"+").replace(/_/gi,"/"));let J=new Uint8Array($.length);for(let Z=0;Z<$.length;Z++)J[Z]=$.charCodeAt(Z);return J}}class nZ{skillTreeData;skillTreeDataCompare;skillTreeCodec;shortestPath;allocationAlgorithm;abyssGroup=0;exarchGroup=0;notableException;pause=!1;maxSteps;constructor($,J){if(this.skillTreeData=$,this.skillTreeDataCompare=J,this.skillTreeCodec=new u7,this.maxSteps=10,this.skillTreeData.patch.compare(P1.v3_24_0_atlas)==0)this.abyssGroup=140,this.exarchGroup=28;else if(this.skillTreeData.patch.compare(P1.v3_24_0_standard)==0)this.abyssGroup=136,this.exarchGroup=25;else if(this.skillTreeData.patch.compare(P1.v3_23_0_atlas)==0)this.abyssGroup=127,this.exarchGroup=25;else if(this.skillTreeData.patch.compare(P1.v3_22_0_atlas)==0)this.abyssGroup=126,this.exarchGroup=25;this.shortestPath=new mZ,this.allocationAlgorithm=new WZ(this.skillTreeData,{abyssGroup:this.abyssGroup,exarchGroup:this.exarchGroup}),this.notableException=["3315","1444","44954","49699","23485"],v.node.on("click",this.click),v.node.on("in",this.mouseover),v.node.on("out",this.mouseout),v.node.on("rightclick",this.rightclick),v.controls.on("class-change",this.changeStartClass),v.controls.on("ascendancy-class-change",this.changeAscendancyClass),v.controls.on("wildwood-ascendancy-class-change",this.changeWildwoodAscendancyClass),v.controls.on("search-change",this.searchChange),v.controls.on("import-change",this.importChange),v.controls.on("pause-change",()=>{this.pause=!this.pause,this.allocateNodes(!1)}),v.controls.on("increment-max-steps",this.incrementStep),v.controls.on("decrement-max-steps",this.decrementStep),v.skill_tree.on("recalculate",this.allocateNodes),v.skill_tree.on("encode-url",this.encodeURL)}incrementStep=()=>{this.maxSteps+=1,this.allocateNodes(!1)};decrementStep=()=>{this.maxSteps-=1,this.allocateNodes(!1)};decodeImport=($=void 0)=>{if($===void 0)return;let Z=$.replace("https://www.pathofexile.com/","").replace("fullscreen-","").replace("passive-skill-tree/","").replace("atlas-skill-tree/",""),Q=/\d\.\d\d\.\d\//g,q=Z.replace(Q,""),K=/\?accountName.*/g,V=q.replace(K,"");try{if(V===null)return;let H=this.skillTreeCodec.decodeURL(V,this.skillTreeData,!0);this.skillTreeData.version=H.Version,this.changeStartClass(H.Class,!1),this.changeAscendancyClass(H.Ascendancy-1,!1);let X=Object.values(this.skillTreeData.getNodes(64));for(let w of X)this.skillTreeData.removeState(w,64);let W=Object.values(this.skillTreeData.getClassStartNodes())[0];for(let w in this.skillTreeData.classStartNodes){let U=this.skillTreeData.nodes[w];if(U.classStartIndex===void 0)continue;if(U.classStartIndex!==H.Class)continue;W=U}if(W===void 0)return;this.skillTreeData.addState(W,64);let z=H.Nodes.map((w)=>w.skill),G=[],Y=[...new Set([...W.out,...W.in])].map((w)=>Number(w));Y=Y.filter((w)=>z.includes(w)&&!G.includes(w));while(Y.length>0){let w=Y.shift();if(w===void 0)break;G.push(w);let U=this.skillTreeData.nodes[String(w)];Y.push(...[...new Set([...U.out,...U.in])].map((C)=>Number(C)).filter((C)=>z.includes(C)&&!G.includes(C)))}for(let w of H.Nodes){if(!G.includes(w.skill))continue;if(w.isNotable||w.isKeystone||w.isJewelSocket||w.isAscendancyStart||w.classStartIndex!==void 0)this.skillTreeData.addStateById(`${w.skill}`,64)}for(let w of H.ExtendedNodes){if(!G.includes(w.skill))continue;if(w.isNotable||w.isKeystone||w.isJewelSocket||w.isAscendancyStart||w.classStartIndex!==void 0)this.skillTreeData.addStateById(`${w.skill}`,64)}for(let[w,U]of H.MasteryEffects){if(!G.includes(w.skill))continue;this.skillTreeData.addStateById(`${w.skill}`,64)}for(let w of H.Desired)this.skillTreeData.addStateById(`${w.skill}`,64);for(let w of H.Undesired)this.skillTreeData.addStateById(`${w.skill}`,128);window.location.hash="#"+this.encodeURL(!1),this.allocateNodes(!1)}catch(H){console.log(H)}};lastHash="";decodeURL=($)=>{if(window.location.hash==="")this.changeStartClass(this.skillTreeData.getDefaultStartNode(),!1);if(this.lastHash===window.location.hash)return;this.lastHash=window.location.hash;try{let J=window.location.hash.replace("#","");if(J===null){window.location.hash="";return}let Z=this.skillTreeCodec.decodeURL(J,this.skillTreeData,$);this.skillTreeData.version=Z.Version,this.changeStartClass(Z.Class,!1),this.changeAscendancyClass(Z.Ascendancy,!1),this.changeWildwoodAscendancyClass(Z.WildwoodAscendancy,!1);for(let Q of Z.Nodes)this.skillTreeData.addStateById(`${Q.skill}`,1);for(let Q of Z.ExtendedNodes)this.skillTreeData.addStateById(`${Q.skill}`,1);for(let[Q,q]of Z.MasteryEffects)this.skillTreeData.addStateById(`${Q.skill}`,1),this.skillTreeData.masteryEffects[Q.skill]=q;for(let Q of Z.Desired)this.skillTreeData.addStateById(`${Q.skill}`,64);for(let Q of Z.Undesired)this.skillTreeData.addStateById(`${Q.skill}`,128);window.location.hash="#"+this.encodeURL(!1)}catch(J){window.location.hash="",console.log(J)}};encodeURL=($)=>{return v.skill_tree.fire("active-nodes-update"),v.skill_tree.fire("highlighted-nodes-update"),this.broadcastSkillCounts(),`${this.skillTreeCodec.encodeURL(this.skillTreeData,$)}`};broadcastSkillCounts=()=>{let $=this.skillTreeData.points.totalPoints,J=this.skillTreeData.points.ascendancyPoints,Z=0,Q=0,q=0,K=this.skillTreeData.getNodes(1);for(let V in K){let H=K[V];if(H.classStartIndex===void 0&&!H.isAscendancyStart&&!H.isMultipleChoice){if(H.ascendancyName==="")Z++;else if(this.skillTreeData.isWildwoodAscendancyClass(H))q++;else Q++;$+=H.grantedPassivePoints}}v.skill_tree.fire("normal-node-count",Z),v.skill_tree.fire("normal-node-count-maximum",$),v.skill_tree.fire("ascendancy-node-count",Q),v.skill_tree.fire("ascendancy-node-count-maximum",J),v.skill_tree.fire("wildwood-ascendancy-node-count",q),v.skill_tree.fire("wildwood-ascendancy-node-count-maximum",J)};changeStartClass=($,J=!0)=>{for(let Z in this.skillTreeData.classStartNodes){let Q=this.skillTreeData.nodes[Z];if(Q.classStartIndex===void 0)continue;if(Q.classStartIndex!==$){this.skillTreeData.removeState(Q,1),this.skillTreeData.removeState(Q,64);continue}this.skillTreeData.addState(Q,1),this.skillTreeData.addState(Q,64),v.skill_tree.fire("class-change",Q)}if(this.changeAscendancyClass(0,!1,!0),this.changeWildwoodAscendancyClass(0,!1,!0),this.allocateNodes(!1),J)window.location.hash="#"+this.encodeURL(!1)};changeAscendancyClass=($,J=!0,Z=!1)=>{if(Z)v.skill_tree.fire("ascendancy-class-change");if(this.skillTreeData.classes.length===0)return;let Q=this.skillTreeData.classes[this.skillTreeData.getStartClass()].ascendancies;if(Q===void 0)return;this.changeAscendancyClassInternal(!1,$,Q,J)};changeWildwoodAscendancyClass=($,J=!0,Z=!1)=>{if(Z)v.skill_tree.fire("wildwood-ascendancy-class-change");if(this.skillTreeData.alternate_ascendancies.length===0)return;let Q=this.skillTreeData.alternate_ascendancies;if(Q===void 0)return;this.changeAscendancyClassInternal(!0,$,Q,J)};changeAscendancyClassInternal=($,J,Z,Q)=>{let q=Z[J-1],K=q!==void 0?q.id:void 0;for(let V in this.skillTreeData.ascendancyNodes){let H=this.skillTreeData.nodes[V];if(this.skillTreeData.isWildwoodAscendancyClass(H)!==$)continue;if(H.ascendancyName!==K){this.skillTreeData.removeState(H,1),this.skillTreeData.removeState(H,64);continue}if(H.isAscendancyStart)this.skillTreeData.addState(H,1),this.skillTreeData.addState(H,64),v.skill_tree.fire("highlighted-nodes-update")}if(Q)window.location.hash="#"+this.encodeURL(!1)};searchChange=($=void 0)=>{if(this.skillTreeData.clearState(8),$!==void 0&&$.length!==0){let J=new RegExp($,"gi");for(let Z in this.skillTreeData.nodes){let Q=this.skillTreeData.nodes[Z];if(Q.isAscendancyStart||Q.classStartIndex!==void 0)continue;if(Q.name.match(J)!==null||Q.stats.find((q)=>q.match(J)!==null)!==void 0)this.skillTreeData.addState(Q,8)}}v.skill_tree.fire("highlighted-nodes-update")};importChange=($=void 0)=>{this.decodeImport($)};wanderingPathButtonClick=()=>{let $=0;for(let J of Object.values(this.skillTreeData.nodes))if(!J.is(128)&&!J.is(64)&&!J.isNotable&&!J.isKeystone)for(let Z of J.stats){if($<100&&Z.indexOf("additional connected Map")!==-1)$+=4,this.skillTreeData.addState(J,64);if(Z.indexOf("increased Quantity of Items found in your Maps")!==-1)this.skillTreeData.addState(J,64);if(Z.indexOf("increased effect of Modifiers on your Non-Unique Maps")!==-1)this.skillTreeData.addState(J,64)}};seventhGateClick=($,J)=>{let Z=Object.values(this.skillTreeData.nodes).filter((Q)=>Q.isWormhole);if($){for(let Q of Z)this.skillTreeData.removeState(Q,64),this.skillTreeData.removeState(Q,128);return}for(let Q of Z)if(J.is(64))this.skillTreeData.removeState(Q,64),this.skillTreeData.addState(Q,128);else if(J.is(128))this.skillTreeData.removeState(Q,128);else this.skillTreeData.addState(Q,64)};click=($)=>{if($.is(16))return;if($.classStartIndex!==void 0||$.isAscendancyStart)return;if($.classStartIndex!==void 0||$.isAscendancyStart)return;let J=Object.values(this.skillTreeData.getNodes(1)).filter((Z)=>Z.isAscendancyStart).filter((Z)=>this.skillTreeData.isWildwoodAscendancyClass($)==this.skillTreeData.isWildwoodAscendancyClass(Z))[0];if($.ascendancyName!==""&&J.ascendancyName!==$.ascendancyName)return;if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.id==="41153")this.seventhGateClick(!1,$);if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.isMastery){let Z=[];for(let z in this.skillTreeData.nodes){let G=this.skillTreeData.nodes[z];if(!G.isMastery)continue;if(G.name!==$.name)continue;if(G.group===void 0)continue;if(!Z.includes(G.group))Z.push(G.group)}let Q,q,K=Z.map((z)=>this.skillTreeData.groups[z].nodes).map((z)=>z.map((G)=>this.skillTreeData.nodes[G])),V=K.map((z)=>z.filter((G)=>G.isNotable&&!G.is(64)&&!G.is(128))).flat().length,H=K.map((z)=>z.filter((G)=>G.isNotable&&G.is(64))).flat().length,X=K.map((z)=>z.filter((G)=>G.isNotable&&G.is(128))).flat().length,W=Math.max(V,H,X);if(V==W)Q=64,q=void 0;else if(H==W)Q=128,q=64;else Q=void 0,q=128;for(let z of Z){let G=[...this.skillTreeData.groups[z].nodes];if(G.includes("65499"))G.push("54499","55003");if(G.includes("19599"))G.push("9338","50203","5515");for(let Y of G){let w=this.skillTreeData.nodes[Y];if(!w.isMastery&&(w.isNotable||this.notableException.includes(Y))){if(Q!==void 0)this.skillTreeData.addState(w,Q);if(q!==void 0)this.skillTreeData.removeState(w,q)}}}v.skill_tree.fire("highlighted-nodes-update")}else{if($.is(64))this.skillTreeData.removeState($,64),this.skillTreeData.addState($,128);else if($.is(128))this.skillTreeData.removeState($,128);else this.skillTreeData.addState($,64);v.skill_tree.fire("highlighted-nodes-update")}this.allocateNodes(!1)};rightclick=($)=>{if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.id==="41153")this.seventhGateClick(!0,$);if(this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.isMastery){let J=[];for(let Z in this.skillTreeData.nodes){let Q=this.skillTreeData.nodes[Z];if(!Q.isMastery)continue;if(Q.name!==$.name)continue;if(Q.group===void 0)continue;if(!J.includes(Q.group))J.push(Q.group)}for(let Z of J){let Q=[...this.skillTreeData.groups[Z].nodes];if(Q.includes("65499"))Q.push("54499","55003");if(Q.includes("19599"))Q.push("9338","50203","5515");for(let q of Q){let K=this.skillTreeData.nodes[q];if(K.isNotable||this.notableException.includes(q))this.skillTreeData.removeState(K,64),this.skillTreeData.removeState(K,128)}}}else this.skillTreeData.removeState($,64),this.skillTreeData.removeState($,128);this.allocateNodes(!1),v.skill_tree.fire("highlighted-nodes-update")};allocateNodes=($)=>{if(!$&&this.pause)return;let J=!1,Z=performance.now();this.allocationAlgorithm.Execute(this.shortestPath,this.maxSteps);let Q=performance.now()-Z;if(J&&Q>5)console.log("Execution time: "+Q+" ms");this.skillTreeData.clearState(2),this.skillTreeData.clearState(4),this.skillTreeDataCompare?.clearState(2),window.location.hash="#"+this.encodeURL(!1)};mouseover=($)=>{if(this.skillTreeData.clearState(2),this.skillTreeData.clearState(4),this.skillTreeDataCompare?.clearState(2),$.classStartIndex===void 0){if($.is(16))this.skillTreeDataCompare?.addState($,2);else if(this.skillTreeData.addState($,2),this.skillTreeData.tree.slice(0,5)==="Atlas"&&$.isMastery)for(let J in this.skillTreeData.nodes){let Z=this.skillTreeData.nodes[J];if(!Z.isMastery)continue;if(Z.name!==$.name)continue;this.skillTreeData.addState(Z,2)}}v.skill_tree.fire("hovered-nodes-start",$)};mouseout=($)=>{this.skillTreeData.clearState(2),this.skillTreeData.clearState(4),this.skillTreeDataCompare?.clearState(2),v.skill_tree.fire("hovered-nodes-end",$)}}class oZ{CanProcess($){return $.circles===void 0}Process($){let J=$;return J.realm="pc",J.circles={Small:[{level:0.1246,width:199},{level:0.2109,width:337},{level:0.2972,width:476},{level:0.3835,width:614}],Medium:[{level:0.1246,width:299},{level:0.2109,width:506},{level:0.2972,width:713},{level:0.3835,width:920}],Large:[{level:0.1246,width:374},{level:0.2109,width:633},{level:0.2972,width:892},{level:0.3835,width:1151}]},J}}class sZ{CanProcess($,J){return J!==void 0}Process($,J){if(J===void 0)return $;if($.classes===void 0)$.classes=[];for(let Z in J.ascClasses){let Q=J.ascClasses[Z],q=$.classes[+Z]||{};q.name=q.name||Q.name,q.ascendancies=[];for(let K in Q.classes){let V=Q.classes[K];q.ascendancies[+K-1]={flavourText:V.flavourText,flavourTextColour:V.flavourTextColour,flavourTextRect:this.UpgradeFlavourTextRect(V.flavourTextRect),id:V.displayName,name:V.name}}$.classes[+Z]=q}return $}UpgradeFlavourTextRect($){let J=$.split(",");return{x:+J[0],y:+J[1],width:+J[2],height:+J[3]}}}class iZ{CanProcess($){return!0}Process($){$.nodes.root.in=$.nodes.root.in||[],$.nodes.root.out=$.nodes.root.out||[];let J={};for(let q in $.nodes)J[q.toString()]=this.FixNode(q,$.nodes[q]);for(let q in J){if(q==="root")continue;for(let K of J[q].out){if(K==="root")continue;if(J[q].in.indexOf(K)<0)J[q].in.push(K);if(!J[K].isMastery&&J[K].out.indexOf(q)<0)J[K].out.push(q)}for(let K of J[q].in){if(K==="root")continue;if(!J[q].isMastery&&J[q].out.indexOf(K)<0)J[q].out.push(K);if(J[K].in.indexOf(q)<0)J[K].in.push(q)}}$.nodes=J;for(var Z in $.sprites)for(var Q in $.sprites[Z])$.sprites[Z][Q].filename=$.sprites[Z][Q].filename.replace("https://web.poecdn.com/image/passive-skill/","");for(let q in $.groups){let K=$.groups[q];$.groups[q].nodes=(K.nodes||[]).map((V)=>V.toString()),$.groups[q].orbits=K.orbits||[]}return $}FixNode($,J){return J.in=(J.in||[]).map((Z)=>Z.toString())||[],J.out=(J.out||[]).map((Z)=>Z.toString())||[],J.in=J.in.filter((Z)=>Z!==$),J.out=J.out.filter((Z)=>Z!==$),J}}class aZ{CanProcess($){return $.root!==void 0&&$.root.g!==void 0&&Array.isArray($.nodes)&&Object.keys($.skillSprites).length===2&&$.skillSprites.active!==void 0&&$.skillSprites.inactive!==void 0}Process($){var J=JSON.parse(JSON.stringify($));for(let Z in $.skillSprites){let Q=$.skillSprites[Z];if(!(Z==="active"||Z==="inactive"))continue;let q=Z.charAt(0).toUpperCase()+Z.slice(1),K={};K[`notable${q}`]=[],K[`keystone${q}`]=[],K[`normal${q}`]=[];for(let V of Q){let H=V.notableCoords===void 0?V.coords:V.notableCoords,X=V.notableCoords===void 0?V.coords:V.notableCoords,W=V.coords;K[`notable${q}`].push({filename:V.filename,coords:H}),K[`keystone${q}`].push({filename:V.filename,coords:X}),K[`normal${q}`].push({filename:V.filename,coords:W})}for(let V in K)J.skillSprites[V]=K[V]}return J}}class rZ{CanProcess($){if(!($.root!==void 0&&$.root.g!==void 0&&Array.isArray($.nodes)&&Object.keys($.skillSprites).length>=6))return!1;for(var Z in $.nodes){let Q=$.nodes[Z];if(Q.ascendancyName!==void 0&&Q.ascendancyName!=="")return!1}return!0}Process($){var J=JSON.parse(JSON.stringify($)),Z=[];for(let Q of $.nodes)Z.push(this.UpgradeNode(Q));return J.nodes=Z,J}UpgradeNode($){var J=$;return J.isJewelSocket=!1,J.isMultipleChoice=!1,J.isMultipleChoiceOption=!1,J.passivePointsGranted=0,J.ascendancyName="",J.isAscendancyStart=!1,J.flavourText=[],J.reminderText=[],J}}class tZ{CanProcess($){return $.extraImages===void 0}Process($){var J=JSON.parse(JSON.stringify($));return J.extraImages={},J}}class eZ{CanProcess($){return Array.isArray($.nodes)}Process($){var J=JSON.parse(JSON.stringify($));let Z={};for(let Q of $.nodes)Z[Q.id.toString()]=this.UpgradeNode(Q);return J.nodes=Z,J}UpgradeNode($){var J=$;if(J.out===void 0)J.out=[];if(J.in===void 0)J.in=[];return J}}class $Q{CanProcess($){for(var J in $.nodes)if($.nodes[J].isBlighted===!0)return!1;return!0}Process($){var J=JSON.parse(JSON.stringify($));let Z={};for(let Q in $.nodes)Z[Q.toString()]=this.UpgradeNode($.nodes[Q]);return J.nodes=Z,J}UpgradeNode($){var J=$;return J.isBlighted=!1,J}}class JQ{CanProcess($){return $.root!==void 0}Process($){var J={assets:$.assets||{},classes:[],constants:$.constants||{},extraImages:$.extraImages||{},groups:{},imageZoomLevels:$.imageZoomLevels||[],jewelSlots:[],max_x:$.max_x,max_y:$.max_y,min_x:$.min_x,min_y:$.min_y,nodes:{},skillSprites:$.skillSprites||{}};for(let q in $.characterData){let K=$.characterData[q],V=this.ClassIdToName(+q);if(V===null)continue;J.classes[+q]={ascendancies:[],base_dex:K.base_dex,base_int:K.base_int,base_str:K.base_str,name:V}}let Z={};for(let q in $.nodes)Z[q.toString()]=this.UpgradeNode($.nodes[q]);Z.root=this.UpgradeNode($.root),J.nodes=Z;let Q={};for(let q in $.groups)Q[q.toString()]=this.UpgradeGroup($.groups[q]);return J.groups=Q,J}UpgradeNode($){return{ascendancyName:$.ascendancyName||"",classStartIndex:$.spc&&$.spc.length>0?$.spc[0]:void 0,expansionJewel:void 0,flavourText:$.flavourText||[],grantedDexterity:$.da||0,grantedIntelligence:$.ia||0,grantedPassivePoints:$.passivePointsGranted||0,grantedStrength:$.sa||0,group:$.g,icon:$.icon,in:($.in||[]).map((J)=>J.toString())||[],isAscendancyStart:$.isAscendancyStart||!1,isBlighted:$.isBlighted||!1,isJewelSocket:$.isJewelSocket||!1,isKeystone:$.ks||!1,isMastery:$.m||!1,isMultipleChoice:$.isMultipleChoice||!1,isMultipleChoiceOption:$.isMultipleChoiceOption||!1,isNotable:$.not||!1,isProxy:!1,name:$.dn||"",orbit:$.o||0,orbitIndex:$.oidx||0,out:($.out||[]).map((J)=>J.toString())||[],recipe:[],reminderText:$.reminderText||[],skill:+$.id||-1,stats:$.sd||[]}}UpgradeGroup($){var J=[];if(Array.isArray($.oo))$.oo={"0":$.oo[0]};for(let Z in $.oo)J.push(+Z);return{isProxy:!1,nodes:($.n||[]).map((Z)=>Z.toString()),orbits:J,x:$.x,y:$.y}}ClassIdToName($){switch($){case 0:return"Scion";case 1:return"Marauder";case 2:return"Ranger";case 3:return"Witch";case 4:return"Duelist";case 5:return"Templar";case 6:return"Shadow";default:return null}}}class ZQ{CanProcess($){return $.tree===void 0}Process($){var J=$;return J.tree="Default",J}}class QQ{CanProcess($){for(var J in $.nodes)if($.nodes[J].activeEffectImage!==void 0)return!1;return!0}Process($){var J=$;let Z={};for(let Q in $.nodes)Z[Q.toString()]=this.UpgradeNode($.nodes[Q]);return J.nodes=Z,J}UpgradeNode($){var J=$;return J.activeEffectImage=void 0,J.activeIcon=void 0,J.inactiveIcon=void 0,J.masteryEffects=void 0,J}}class qQ{CanProcess($){return $.points===void 0}Process($){var J=$;return J.points={totalPoints:121,ascendancyPoints:8},J}}class KQ{CanProcess($){return $.assets!==void 0}Process($){let J=JSON.parse(JSON.stringify($)),Z={},Q=this.UpgradeSpriteSheets($);for(let K in Q){Z[K]={};let V=Q[K];for(let H in V)Z[K][H]=Q[K][H]}let q=this.UpgradeAssets($);for(let K in q){Z[K]={};let V=q[K];for(let H in V)Z[K][H]=q[K][H]}return J.sprites=Z,delete J.assets,delete J.skillSprites,J}UpgradeSpriteSheets($){let J={};for(let Q in $.skillSprites){let q=$.skillSprites[Q];for(let K in $.imageZoomLevels){let V=$.imageZoomLevels[K].toString(),H=q[K];if(H===void 0)continue;let X=J[`${H.filename}-${V}`]||{w:0,h:0};J[`${H.filename}-${V}`]=this.CalculateWidthAndHeight(X,H)}}let Z={};for(let Q in $.skillSprites){Z[Q]={};let q=$.skillSprites[Q];for(let K in $.imageZoomLevels){let V=$.imageZoomLevels[K].toString(),H=q[K];if(H===void 0)continue;Z[Q][V]=this.UpgradeSpriteSheet(H,J[`${H.filename}-${V}`])}}return Z}UpgradeSpriteSheet($,J){let Z=$;return Z.w=J.w,Z.h=J.h,Z}CalculateWidthAndHeight($,J){let{w:Z,h:Q}=$;for(let q in J.coords){let K=J.coords[q];Z=Math.max(Z,K.x+K.w),Q=Math.max(Q,K.y+K.h)}return{w:Z,h:Q}}UpgradeAssets($){let J={};for(let Z in $.assets){let Q=this.MapAssetToGroup(Z);if(Q===null)continue;if(J[Q]===void 0)J[Q]={};for(let q in $.assets[Z]){if(J[Q][q]===void 0)J[Q][q]={filename:"LOAD_COORDS",h:-1,w:-1,coords:{}};J[Q][q].coords[Z]={x:0,y:0,h:-1,w:-1}}}return J}MapAssetToGroup($){if($=$.startsWith("PassiveSkillScreen")?$.replace("PassiveSkillScreen",""):$,$==="Background2"||$==="Background1")return"background";if($==="PassiveMasteryConnectedButton")return"masteryActiveSelected";if($.startsWith("Classes"))return"ascendancyBackground";if($.startsWith("Ascendancy"))return"ascendancy";if($.startsWith("Background")||$.startsWith("center")||$==="PSStartNodeBackgroundInactive")return"startNode";if($.startsWith("PSGroupBackground")||$.startsWith("GroupBackground"))return"groupBackground";if($.indexOf("Frame")>=0||$.startsWith("JewelSocketClusterAlt")||$.startsWith("JewelSocketAlt"))return"frame";if($.startsWith("JewelSocket"))return"jewel";if($.startsWith("LineConnector")||$.startsWith("Orbit")||$.startsWith("PSLineDeco"))return"line";if($.indexOf("JewelCircle")>=0)return"jewelRadius";if($==="AtlasPassiveSkillScreenStart")return"startNode";if($==="AtlasPassiveBackground")return"atlasBackground";if($==="PSStartNodeBackgroundActive")return null;if($.startsWith("imgPSFade"))return null;if($.endsWith("Oil"))return null;throw new Error(`Unhandled Asset: ${$}`)}}class VQ{CanProcess($){for(let J in $.groups)if($.groups[J].background)return!1;return!0}Process($){let J=JSON.parse(JSON.stringify($)),Z=this.UpgradeGroups($);return J.groups=Z,delete J.uiArtOptions,J}UpgradeGroups($){var J={};for(let Z in $.groups){let Q=$.groups[Z],q=Q.nodes||[];if(q.length===0||q.find((H)=>$.nodes[H].ascendancyName!==void 0)!==void 0){J[Z]=this.CopyGroup(Q);continue}let K=Q.orbits||[];K=K.filter((H)=>H<=3);let V=Q.backgroundOverride!==void 0&&Q.backgroundOverride!==0?Q.backgroundOverride:Math.max(...K);if(V<=0||V>3){J[Z]=this.CopyGroup(Q);continue}J[Z]=this.UpgradeGroup(Q,V,$.uiArtOptions==null?!0:$.uiArtOptions.largeGroupUsesHalfImage)}return J}CopyGroup($){return{x:$.x,y:$.y,isProxy:$.isProxy,orbits:$.orbits,nodes:$.nodes,background:void 0}}UpgradeGroup($,J,Z){var Q=this.CopyGroup($);return Q.background={image:this.MapBackground(J),isHalfImage:J===3&&Z?!0:void 0,offsetX:void 0,offsetY:void 0},Q}MapBackground($){switch($){case 1:return"PSGroupBackground1";case 2:return"PSGroupBackground2";case 3:return"PSGroupBackground3";default:throw new Error(`Unhandled BackgroundKey: ${$}`)}}}class HQ{CanProcess($){return $.tree.slice(0,5)==="Atlas"&&$.sprites.wormholeInactive===void 0}Process($){return JSON.parse(JSON.stringify($))}}class XQ{CanProcess($){return $.sprites.tattooActiveEffect===void 0}Process($){return JSON.parse(JSON.stringify($))}}class WQ{CanProcess($){return $.sprites.azmeri===void 0}Process($){return JSON.parse(JSON.stringify($))}}class zQ{static _preprocessors=[new aZ,new rZ,new tZ,new eZ,new $Q,new JQ,new ZQ,new QQ,new qQ,new KQ,new VQ,new HQ,new XQ,new WQ,new sZ,new iZ];static _optionsPreprocessors=[new oZ];static Decode($,J){if(J!==void 0){for(let Z of this._optionsPreprocessors)if(Z.CanProcess(J))J=Z.Process(J)}for(let Z of this._preprocessors)if(Z.CanProcess($,J))$=Z.Process($,J);return $}}class P6{skillTreeData;skillTreeDataCompare;skillTreeUtilities;renderer;uievents;launch=async($,J,Z)=>{for(let C of[$,J]){if(C==="")continue;let N=void 0,O=new fW.SemVer(C),I="0";var Q=await fetch(`${m0.SKILL_TREES_URI}/${C}/SkillTree.json?${I}`).then((F)=>F.json()),q=Q;let B=new XZ(zQ.Decode(q,N),O);if(C===$)this.skillTreeData=B;if(C===J)this.skillTreeDataCompare=void 0}this.uievents=new b6(this.skillTreeData,this.skillTreeDataCompare),this.skillTreeUtilities=new nZ(this.skillTreeData,this.skillTreeDataCompare);let K=document.getElementById("skillTreeControl_Version");for(let C of Z.versions){let N=document.createElement("option");if(N.text=N.value=C,C===$)N.setAttribute("selected","selected");K.appendChild(N);let O=document.createElement("option");if(O.text=O.value=C,C===J)O.setAttribute("selected","selected")}K.onchange=()=>{let C=K.value!=="0"?K.value:"";P6.ChangeSkillTreeVersion(C,"","")};let V=document.getElementsByClassName("skillTreeVersions");for(let C in V)if(V[C].style!==void 0)V[C].style.removeProperty("display");document.getElementById("skillTreeControl_Reset").addEventListener("click",()=>{let C=this.skillTreeData.getStartClass(),N=this.skillTreeData.getAscendancyClass(),O=this.skillTreeData.getWildwoodAscendancyClass(),I=document.getElementById("skillTreeControl_Import");I.value="",this.skillTreeData.clearState(1),this.skillTreeData.clearState(64),this.skillTreeData.clearState(128),v.controls.fire("class-change",C),v.controls.fire("ascendancy-class-change",N),v.skill_tree.fire("highlighted-nodes-update"),v.controls.fire("wildwood-ascendancy-class-change",O)}),document.getElementById("skillTreeControl_Export").addEventListener("click",()=>{let C=this.skillTreeUtilities.encodeURL(!0),O="https://www.pathofexile.com/fullscreen-"+(this.skillTreeData.tree.slice(0,5)==="Atlas"?"atlas":"passive")+"-skill-tree/"+C;navigator.clipboard.writeText(O)});let W=document.getElementById("poePlanner_Button");if(W.addEventListener("click",()=>{let N="https://poeplanner.com/atlas-tree/"+this.skillTreeUtilities.encodeURL(!0);window.open(N,"_blank")}),Z.versions[Z.versions.length-1].slice(0,4)!==$.slice(0,4))W.style.setProperty("display","none");else W.style.setProperty("display","inline");let z=document.getElementById("skillTreeStats_ShowHide");z.addEventListener("click",()=>{let C=document.getElementById("skillTreeStats_Content"),N=document.getElementById("skillTreeStats");if(C.toggleAttribute("hidden"))N.style.setProperty("height","1.6em"),z.innerText="Show stats";else N.style.setProperty("height","80%"),z.innerText="Hide stats"});let G=document.getElementById("help_ShowHide");G.addEventListener("click",()=>{let C=document.getElementById("help_Content"),N=document.getElementById("help");if(C.toggleAttribute("hidden"))G.innerText="Show help";else G.innerText="Hide help"});let Y=document.getElementById("skillTreeControl_Recalculate");Y.addEventListener("click",()=>{v.skill_tree.fire("recalculate",!0)});let w=document.getElementById("skillTreeControl_Pause");w.addEventListener("click",()=>{if(w.innerText=="Pause Allocation")w.innerText="Unpause Allocation",Y.style.setProperty("display","inline");else w.innerText="Pause Allocation",Y.style.setProperty("display","none");v.controls.fire("pause-change")}),document.getElementById("skillTreeContainer").addEventListener("wheel",(C)=>{if(C.ctrlKey)C.preventDefault()},!0),document.addEventListener("keydown",function(C){if((C.ctrlKey||C.metaKey)&&(C.key==="+"||C.key==="-"||C.key==="="))C.preventDefault();if(C.key==="e")v.controls.fire("increment-max-steps");else if(C.key==="r")v.controls.fire("decrement-max-steps")});let U=document.getElementById("skillTreeContainer");if(U!==null)this.renderer=new KZ(U,this.skillTreeData,this.skillTreeDataCompare),this.renderer.Initialize().then(()=>{this.SetupEventsAndControls(),this.renderer.RenderBase(),this.skillTreeUtilities.decodeURL(!1),this.skillTreeUtilities.allocateNodes(!1),this.renderer.RenderCharacterStartsActive(),this.renderer.RenderActive()}).catch((C)=>console.error(C))};SetupPregeneration=($)=>{let J=Object.values($.nodes).map((Z)=>Z.skill);this.PreGenerateShortestDistances($,J)};PreGenerateShortestDistances=($,J)=>{let Z=$.nodes;console.log("Shortest distances started");let Q=["0.5% chance for map drops to be duplicated","1% increased quantity of items found in your maps","3% increased scarabs found in your maps","2% increased effect of modifiers on your maps","2% chance for one monster in each of your maps to drop an additional connected map","+10 to strength","+10 to intelligence","+10 to dexterity"],q=0;console.log("Checking "+J.length);for(let H of J){if(H==="root"){console.log("Skipping root");continue}if(H===void 0||Z[H]===void 0){console.log("Skipping undefined node");continue}if($.tree.slice(0,5)!=="Atlas"&&Z[H].ascendancyName!==void 0){console.log("Skipping ascendancy node");continue}if(Z[H].out===void 0&&Z[H].in===void 0||Z[H].out&&Z[H].out.length===0&&Z[H].in&&Z[H].in.length===0){console.log("Skipping no adjacent nodes");continue}let X=[Z[H]],W=[],z=[H],G,Y=!1;while(X.length>0){q++;let w=X.shift();if(w===void 0)continue;console.log("Checking",H+": "+w.skill);let U=[...new Set([...w.in,...w.out])].filter((C)=>![...W,...z].includes(Number(C)));if(!Y){if(G=w.skill,U.length>1)Y=!0}for(let C of U){let N=Z[C];if(N.isRegular1||N.stats.some((O)=>Q.includes(O.toLowerCase())))W.push(N.skill),console.log("Exitnode");else X.push(N),z.push(N.skill),console.log("Visited")}}if(W.length===1)Z[H].earliestMandatoryNode=W[0];else Z[H].earliestMandatoryNode=G}console.log("Total frontier checks: "+q);var K=document.createElement("a"),V=new Blob([JSON.stringify($,null,4)],{type:"text/plain"});K.href=URL.createObjectURL(V),K.download="updated.json",K.click()};SetupEventsAndControls=()=>{v.skill_tree.on("highlighted-nodes-update",this.renderer.RenderHighlight),v.skill_tree.on("class-change",this.renderer.RenderCharacterStartsActive),v.skill_tree.on("class-change",this.updateClassControl),v.skill_tree.on("ascendancy-class-change",this.updateAscClassControl),v.skill_tree.on("wildwood-ascendancy-class-change",this.updateWildwoodAscClassControl),v.skill_tree.on("hovered-nodes-start",this.renderer.StartRenderHover),v.skill_tree.on("hovered-nodes-end",this.renderer.StopRenderHover),v.skill_tree.on("active-nodes-update",this.renderer.RenderActive),v.skill_tree.on("active-nodes-update",this.updateStats),v.skill_tree.on("normal-node-count",(Z)=>{let Q=document.getElementById("skillTreeNormalNodeCount");if(Q!==null)Q.innerHTML=Z.toString()}),v.skill_tree.on("normal-node-count-maximum",(Z)=>{let Q=document.getElementById("skillTreeNormalNodeCountMaximum");if(Q!==null)Q.innerHTML=Z.toString()}),v.skill_tree.on("ascendancy-node-count",(Z)=>{let Q=document.getElementById("skillTreeAscendancyNodeCount");if(Q!==null)Q.innerHTML=Z.toString()}),v.skill_tree.on("ascendancy-node-count-maximum",(Z)=>{let Q=document.getElementById("skillTreeAscendancyNodeCountMaximum");if(Q!==null)Q.innerHTML=Z.toString()}),v.skill_tree.on("wildwood-ascendancy-node-count",(Z)=>{let Q=document.getElementById("skillTreeWildwoodAscendancyNodeCount");if(Q!==null)Q.innerHTML=Z.toString()}),v.skill_tree.on("wildwood-ascendancy-node-count-maximum",(Z)=>{let Q=document.getElementById("skillTreeWildwoodAscendancyNodeCountMaximum");if(Q!==null)Q.innerHTML=Z.toString()}),this.populateStartClasses(document.getElementById("skillTreeControl_Class")),this.bindSearchBox(document.getElementById("skillTreeControl_Search")),this.bindImportBox(document.getElementById("skillTreeControl_Import"));let $=document.getElementsByClassName("skillTreeControls");for(let Z in $)if($[Z].style!==void 0)$[Z].style.removeProperty("display");let J=document.getElementsByClassName("skillTreePoints");for(let Z in J)if(J[Z].style!==void 0)J[Z].style.removeProperty("display")};masteries=void 0;masteryTest=void 0;defaultStats=void 0;buildStatLookups=($)=>{if(this.masteries===void 0||this.masteryTest===void 0){let J=["The Maven"],Z={"The Maven":" Maven"};for(let Q in this.skillTreeData.nodes){let q=this.skillTreeData.nodes[Q],K=this.skillTreeData.getMasteryForGroup(q.nodeGroup);if(K!==null&&K.name!==$)J.push(K.name),Z[K.name]=K.name.replace("The","").replace("Mastery","")}this.masteries=J,this.masteryTest=Z}if(this.defaultStats===void 0){let J={};for(let Z in this.skillTreeData.nodes){let Q=this.skillTreeData.nodes[Z];for(let q of Q.stats){if(J[q]!==void 0)continue;if(this.skillTreeData.getMasteryForGroup(Q.nodeGroup)===null){let V=!1;for(let H of this.masteries)if(q.indexOf(this.masteryTest[H])>=0){V=!0;break}if(!V)J[q]=!0}}}this.defaultStats=J}return[this.masteries,this.masteryTest,this.defaultStats]};updateStats=()=>{let $=this.skillTreeData.tree.slice(0,5)==="Atlas"?"Maps":"Default",[J,Z,Q]=this.buildStatLookups($),q={},K={},V={},H=this.skillTreeData.getSkilledNodes();for(let W in H){let z=H[W];for(let G of z.stats){let Y=G.match("^(Tier 1-15.*have )([\\d.]+)(%\\D*.*)$"),w=Y!==null?Y:G.match("^(\\D*)([\\d.]+)(\\D*.*)$");if(w!==null){let C=w[1]+w[3],N=Number(w[2]);if(V[C]!==void 0){let O=String((Number(V[C][0])+N).toFixed(2));if(O.endsWith(".00"))O=O.substring(0,O.length-3);V[C][0]=O}else V[C]=[String(N),w[1],w[3]]}else V[G]=["",G,""];if(K[G]!==void 0){let C=K[G];if(q[C].indexOf(G)===-1)q[C].push(G);continue}if(Q[G]){if(q[$]===void 0)q[$]=[];if(q[$].indexOf(G)===-1)K[G]=$,q[$].push(G);continue}let U=this.skillTreeData.getMasteryForGroup(z.nodeGroup);if(U!==null){if(q[U.name]===void 0)q[U.name]=[];if(q[U.name].indexOf(G)===-1)K[G]=U.name,q[U.name].push(G)}else{let C=$;for(let N of J)if(G.indexOf(Z[N])>=0){C=N;break}if(q[C]===void 0)q[C]=[];if(q[C].indexOf(G)===-1)K[G]=C,q[C].push(G)}}}let X=document.getElementById("skillTreeStats_Content");while(X.firstChild)X.removeChild(X.firstChild);for(let W of Object.keys(q).sort((z,G)=>z===$?-1:G===$?1:z<G?-1:1)){let z={};for(let Y of q[W]){let w=Y.match("^(Tier 1-15.*have )([\\d.]+)(%\\D*.*)$"),U=w!==null?w:Y.match("^(\\D*)([\\d.]+)(\\D*.*)$"),C=U!==null?U[1]+U[3]:void 0;if(C!==void 0)z[C]=V[C];else z[Y]=V[Y]}let G=this.createSummedStatGroup(W,z);X.appendChild(G)}};createSummedStatGroup=($,J)=>{let Z=document.createElement("div");Z.className="group";let Q=document.createElement("span");Q.className="title",Q.innerText=$,Q.addEventListener("click",()=>{document.querySelectorAll(`[data-group-name="${$}"]`).forEach((K)=>{K.toggleAttribute("hidden")})}),Z.appendChild(Q);for(let q of Object.keys(J).sort((K,V)=>{let H=K.toLowerCase().includes("chance to contain"),X=V.toLowerCase().includes("chance to contain");if(H&&!X)return-1;if(!H&&X)return 1;return 0})){let K=J[q][1]+J[q][0]+J[q][2];Z.appendChild(this.createStat($,K))}return Z};createStat=($,J)=>{let Z=document.createElement("div");return Z.className="stat",Z.innerText=J,Z.setAttribute("data-group-name",$),Z};populateStartClasses=($)=>{while($.firstChild)$.removeChild($.firstChild);let J=new Array;for(let q in this.skillTreeData.classStartNodes){let K=this.skillTreeData.nodes[q].classStartIndex;if(K===void 0)continue;let V=document.createElement("option");if(V.text=this.skillTreeData.root.out.length===1?"Atlas":this.skillTreeData.constants.classIdToName[K],V.value=K.toString(),K===this.skillTreeData.getStartClass())V.setAttribute("selected","selected");J.push(V)}J.sort((q,K)=>{let V=q.value,H=K.value;if(V!==null&&H!==null)return+V-+H;return 0});for(let q of J)$.append(q);let Z=document.getElementById("skillTreeControl_Ascendancy");if(Z!==null)this.populateAscendancyClasses(Z);let Q=document.getElementById("skillTreeControl_WildwoodAscendancy");if(Q!==null)this.populateWildwoodAscendancyClasses(Q);$.onchange=()=>{let q=$.value;if(v.controls.fire("class-change",+q),Z!==null)this.populateAscendancyClasses(Z,+q,0);if(Q!==null)this.populateWildwoodAscendancyClasses(Q,0)}};updateClassControl=()=>{let $=this.skillTreeData.getStartClass();document.getElementById("skillTreeControl_Class").value=String($)};updateAscClassControl=()=>{if(this.skillTreeData.classes.length===0)return;let $=this.skillTreeData.getAscendancyClass(),J=this.skillTreeData.classes[this.skillTreeData.getStartClass()].ascendancies;if(J===void 0)return;let Z=document.getElementById("skillTreeControl_Ascendancy");this.createAscendancyClassOptions(Z,J,$)};populateAscendancyClasses=($,J=void 0,Z=void 0)=>{while($.firstChild)$.removeChild($.firstChild);if(this.skillTreeData.classes.length===0){$.style.display="none";let V=document.getElementById("skillTreeAscendancy");if(V!==null)V.style.display="none";return}let Q=J!==void 0?J:this.skillTreeData.getStartClass(),q=this.skillTreeData.classes[Q].ascendancies;if(q===void 0)return;let K=Z!==void 0?Z:this.skillTreeData.getAscendancyClass();this.createAscendancyClassOptions($,q,K),$.onchange=()=>{v.controls.fire("ascendancy-class-change",+$.value)}};updateWildwoodAscClassControl=()=>{if(this.skillTreeData.alternate_ascendancies.length===0)return;let $=this.skillTreeData.getWildwoodAscendancyClass(),J=this.skillTreeData.alternate_ascendancies;if(J===void 0)return;let Z=document.getElementById("skillTreeControl_WildwoodAscendancy");this.createAscendancyClassOptions(Z,J,$)};populateWildwoodAscendancyClasses=($,J=void 0)=>{while($.firstChild)$.removeChild($.firstChild);if(this.skillTreeData.alternate_ascendancies.length===0){$.style.display="none";let q=document.getElementById("skillTreeWildwoodAscendancy");if(q!==null)q.style.display="none";return}let Z=this.skillTreeData.alternate_ascendancies;if(Z===void 0)return;let Q=J!==void 0?J:this.skillTreeData.getAscendancyClass();this.createAscendancyClassOptions($,Z,Q),$.onchange=()=>{v.controls.fire("wildwood-ascendancy-class-change",+$.value)}};createAscendancyClassOptions=($,J,Z)=>{while($.firstChild)$.removeChild($.firstChild);let Q=document.createElement("option");if(Q.text="None",Q.value="0",Z===0)Q.setAttribute("selected","selected");if($.append(Q),J.length===0)return;for(let q in J){let K=J[q],V=+q+1,H=document.createElement("option");if(H.text=K.id,H.value=`${V}`,V===Z)H.setAttribute("selected","selected");$.append(H)}};searchTimout=null;bindSearchBox=($)=>{$.onkeyup=()=>{if(this.searchTimout!==null)clearTimeout(this.searchTimout);this.searchTimout=setTimeout(()=>{v.controls.fire("search-change",$.value),this.searchTimout=null},250)}};bindImportBox=($)=>{$.onpaste=(J)=>{v.controls.fire("import-change",J.clipboardData?.getData("text"))},$.onclick=()=>{$.select()}};static decodeURLParams=($="")=>{return $.slice($.indexOf("?")+1).split("&").reduce((Z,Q)=>{let q=Q.indexOf("=");if(q<0)return Object.assign(Z,{[Q]:null});let K=Q.slice(0,q),V=Q.slice(q+1);return Object.assign(Z,{[K]:decodeURIComponent(V)})},{})};static ChangeSkillTreeVersion=($,J,Z)=>{let Q="?";if($!=="")Q+=`v=${$}`;if(!Q.endsWith("?")&&J!=="")Q+="&";if(J!=="")Q+=`c=${J}`;if(window.location.hash!==Z)window.location.hash=Z;if(window.location.search!==Q)window.location.search=Q;let q=document.getElementById("skillTreeControl_Class");if($.slice(-5)==="atlas"||$.slice(-8)==="standard")q.style.visibility="hidden";else q.style.visibility="visible"}}window.onload=async()=>{let $=P6.decodeURLParams(window.location.search),J={versions:[]},Z=Object.fromEntries(Object.entries(P1));for(let Q in Z){let q=Z[Q];if(!(q instanceof vW.SemVer))continue;J.versions.push(q.version)}if(J.versions.indexOf($.v)===-1)$.v=J.versions[J.versions.length-1];if(!$.c)$.c="";P6.ChangeSkillTreeVersion($.v,$.c,window.location.hash),new P6().launch($.v,$.c,J)};
